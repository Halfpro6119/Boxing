var Bh=Object.defineProperty;var du=e=>{throw TypeError(e)};var Wh=(e,t,r)=>t in e?Bh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ue=(e,t,r)=>Wh(e,typeof t!="symbol"?t+"":t,r),fu=(e,t,r)=>t.has(e)||du("Cannot "+r);var X=(e,t,r)=>(fu(e,t,"read from private field"),r?r.call(e):t.get(e)),er=(e,t,r)=>t.has(e)?du("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Qn=(e,t,r,n)=>(fu(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Xc={exports:{}},qs={},Kc={exports:{}},K={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fi=Symbol.for("react.element"),$h=Symbol.for("react.portal"),Hh=Symbol.for("react.fragment"),Qh=Symbol.for("react.strict_mode"),Gh=Symbol.for("react.profiler"),Xh=Symbol.for("react.provider"),Kh=Symbol.for("react.context"),Yh=Symbol.for("react.forward_ref"),qh=Symbol.for("react.suspense"),Zh=Symbol.for("react.memo"),Jh=Symbol.for("react.lazy"),hu=Symbol.iterator;function ep(e){return e===null||typeof e!="object"?null:(e=hu&&e[hu]||e["@@iterator"],typeof e=="function"?e:null)}var Yc={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qc=Object.assign,Zc={};function Mn(e,t,r){this.props=e,this.context=t,this.refs=Zc,this.updater=r||Yc}Mn.prototype.isReactComponent={};Mn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Mn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jc(){}Jc.prototype=Mn.prototype;function fl(e,t,r){this.props=e,this.context=t,this.refs=Zc,this.updater=r||Yc}var hl=fl.prototype=new Jc;hl.constructor=fl;qc(hl,Mn.prototype);hl.isPureReactComponent=!0;var pu=Array.isArray,ed=Object.prototype.hasOwnProperty,pl={current:null},td={key:!0,ref:!0,__self:!0,__source:!0};function rd(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)ed.call(t,n)&&!td.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:Fi,type:e,key:s,ref:o,props:i,_owner:pl.current}}function tp(e,t){return{$$typeof:Fi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ml(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fi}function rp(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var mu=/\/+/g;function To(e,t){return typeof e=="object"&&e!==null&&e.key!=null?rp(""+e.key):t.toString(36)}function ds(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Fi:case $h:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+To(o,0):n,pu(i)?(r="",e!=null&&(r=e.replace(mu,"$&/")+"/"),ds(i,t,r,"",function(c){return c})):i!=null&&(ml(i)&&(i=tp(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(mu,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",pu(e))for(var a=0;a<e.length;a++){s=e[a];var l=n+To(s,a);o+=ds(s,t,r,l,i)}else if(l=ep(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=n+To(s,a++),o+=ds(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Xi(e,t,r){if(e==null)return e;var n=[],i=0;return ds(e,n,"","",function(s){return t.call(r,s,i++)}),n}function np(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $e={current:null},fs={transition:null},ip={ReactCurrentDispatcher:$e,ReactCurrentBatchConfig:fs,ReactCurrentOwner:pl};function nd(){throw Error("act(...) is not supported in production builds of React.")}K.Children={map:Xi,forEach:function(e,t,r){Xi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Xi(e,function(){t++}),t},toArray:function(e){return Xi(e,function(t){return t})||[]},only:function(e){if(!ml(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};K.Component=Mn;K.Fragment=Hh;K.Profiler=Gh;K.PureComponent=fl;K.StrictMode=Qh;K.Suspense=qh;K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ip;K.act=nd;K.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=qc({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=pl.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)ed.call(t,l)&&!td.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:Fi,type:e.type,key:i,ref:s,props:n,_owner:o}};K.createContext=function(e){return e={$$typeof:Kh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Xh,_context:e},e.Consumer=e};K.createElement=rd;K.createFactory=function(e){var t=rd.bind(null,e);return t.type=e,t};K.createRef=function(){return{current:null}};K.forwardRef=function(e){return{$$typeof:Yh,render:e}};K.isValidElement=ml;K.lazy=function(e){return{$$typeof:Jh,_payload:{_status:-1,_result:e},_init:np}};K.memo=function(e,t){return{$$typeof:Zh,type:e,compare:t===void 0?null:t}};K.startTransition=function(e){var t=fs.transition;fs.transition={};try{e()}finally{fs.transition=t}};K.unstable_act=nd;K.useCallback=function(e,t){return $e.current.useCallback(e,t)};K.useContext=function(e){return $e.current.useContext(e)};K.useDebugValue=function(){};K.useDeferredValue=function(e){return $e.current.useDeferredValue(e)};K.useEffect=function(e,t){return $e.current.useEffect(e,t)};K.useId=function(){return $e.current.useId()};K.useImperativeHandle=function(e,t,r){return $e.current.useImperativeHandle(e,t,r)};K.useInsertionEffect=function(e,t){return $e.current.useInsertionEffect(e,t)};K.useLayoutEffect=function(e,t){return $e.current.useLayoutEffect(e,t)};K.useMemo=function(e,t){return $e.current.useMemo(e,t)};K.useReducer=function(e,t,r){return $e.current.useReducer(e,t,r)};K.useRef=function(e){return $e.current.useRef(e)};K.useState=function(e){return $e.current.useState(e)};K.useSyncExternalStore=function(e,t,r){return $e.current.useSyncExternalStore(e,t,r)};K.useTransition=function(){return $e.current.useTransition()};K.version="18.3.1";Kc.exports=K;var y=Kc.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sp=y,op=Symbol.for("react.element"),ap=Symbol.for("react.fragment"),lp=Object.prototype.hasOwnProperty,up=sp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cp={key:!0,ref:!0,__self:!0,__source:!0};function id(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)lp.call(t,n)&&!cp.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:op,type:e,key:s,ref:o,props:i,_owner:up.current}}qs.Fragment=ap;qs.jsx=id;qs.jsxs=id;Xc.exports=qs;var u=Xc.exports,sd={exports:{}},lt={},od={exports:{}},ad={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,H){var G=D.length;D.push(H);e:for(;0<G;){var ne=G-1>>>1,q=D[ne];if(0<i(q,H))D[ne]=H,D[G]=q,G=ne;else break e}}function r(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var H=D[0],G=D.pop();if(G!==H){D[0]=G;e:for(var ne=0,q=D.length,wt=q>>>1;ne<wt;){var me=2*(ne+1)-1,Qe=D[me],ge=me+1,J=D[ge];if(0>i(Qe,G))ge<q&&0>i(J,Qe)?(D[ne]=J,D[ge]=G,ne=ge):(D[ne]=Qe,D[me]=G,ne=me);else if(ge<q&&0>i(J,G))D[ne]=J,D[ge]=G,ne=ge;else break e}}return H}function i(D,H){var G=D.sortIndex-H.sortIndex;return G!==0?G:D.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,g=3,C=!1,k=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(D){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=D)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(c)}}function v(D){if(x=!1,m(D),!k)if(r(l)!==null)k=!0,B(w);else{var H=r(c);H!==null&&ie(v,H.startTime-D)}}function w(D,H){k=!1,x&&(x=!1,p(j),j=-1),C=!0;var G=g;try{for(m(H),h=r(l);h!==null&&(!(h.expirationTime>H)||D&&!I());){var ne=h.callback;if(typeof ne=="function"){h.callback=null,g=h.priorityLevel;var q=ne(h.expirationTime<=H);H=e.unstable_now(),typeof q=="function"?h.callback=q:h===r(l)&&n(l),m(H)}else n(l);h=r(l)}if(h!==null)var wt=!0;else{var me=r(c);me!==null&&ie(v,me.startTime-H),wt=!1}return wt}finally{h=null,g=G,C=!1}}var S=!1,T=null,j=-1,F=5,W=-1;function I(){return!(e.unstable_now()-W<F)}function R(){if(T!==null){var D=e.unstable_now();W=D;var H=!0;try{H=T(!0,D)}finally{H?z():(S=!1,T=null)}}else S=!1}var z;if(typeof f=="function")z=function(){f(R)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,$=O.port2;O.port1.onmessage=R,z=function(){$.postMessage(null)}}else z=function(){b(R,0)};function B(D){T=D,S||(S=!0,z())}function ie(D,H){j=b(function(){D(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){k||C||(k=!0,B(w))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(D){switch(g){case 1:case 2:case 3:var H=3;break;default:H=g}var G=g;g=H;try{return D()}finally{g=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,H){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var G=g;g=D;try{return H()}finally{g=G}},e.unstable_scheduleCallback=function(D,H,G){var ne=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?ne+G:ne):G=ne,D){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=G+q,D={id:d++,callback:H,priorityLevel:D,startTime:G,expirationTime:q,sortIndex:-1},G>ne?(D.sortIndex=G,t(c,D),r(l)===null&&D===r(c)&&(x?(p(j),j=-1):x=!0,ie(v,G-ne))):(D.sortIndex=q,t(l,D),k||C||(k=!0,B(w))),D},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(D){var H=g;return function(){var G=g;g=H;try{return D.apply(this,arguments)}finally{g=G}}}})(ad);od.exports=ad;var dp=od.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fp=y,at=dp;function A(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ld=new Set,yi={};function tn(e,t){Nn(e,t),Nn(e+"Capture",t)}function Nn(e,t){for(yi[e]=t,e=0;e<t.length;e++)ld.add(t[e])}var Xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ca=Object.prototype.hasOwnProperty,hp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gu={},yu={};function pp(e){return ca.call(yu,e)?!0:ca.call(gu,e)?!1:hp.test(e)?yu[e]=!0:(gu[e]=!0,!1)}function mp(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gp(e,t,r,n){if(t===null||typeof t>"u"||mp(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function He(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Ne={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ne[e]=new He(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ne[t]=new He(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ne[e]=new He(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ne[e]=new He(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ne[e]=new He(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ne[e]=new He(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ne[e]=new He(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ne[e]=new He(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ne[e]=new He(e,5,!1,e.toLowerCase(),null,!1,!1)});var gl=/[\-:]([a-z])/g;function yl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gl,yl);Ne[t]=new He(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gl,yl);Ne[t]=new He(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gl,yl);Ne[t]=new He(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ne[e]=new He(e,1,!1,e.toLowerCase(),null,!1,!1)});Ne.xlinkHref=new He("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ne[e]=new He(e,1,!1,e.toLowerCase(),null,!0,!0)});function wl(e,t,r,n){var i=Ne.hasOwnProperty(t)?Ne[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(gp(t,r,i,n)&&(r=null),n||i===null?pp(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Zt=fp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ki=Symbol.for("react.element"),cn=Symbol.for("react.portal"),dn=Symbol.for("react.fragment"),vl=Symbol.for("react.strict_mode"),da=Symbol.for("react.profiler"),ud=Symbol.for("react.provider"),cd=Symbol.for("react.context"),xl=Symbol.for("react.forward_ref"),fa=Symbol.for("react.suspense"),ha=Symbol.for("react.suspense_list"),kl=Symbol.for("react.memo"),nr=Symbol.for("react.lazy"),dd=Symbol.for("react.offscreen"),wu=Symbol.iterator;function Gn(e){return e===null||typeof e!="object"?null:(e=wu&&e[wu]||e["@@iterator"],typeof e=="function"?e:null)}var he=Object.assign,_o;function ri(e){if(_o===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);_o=t&&t[1]||""}return`
`+_o+e}var Po=!1;function No(e,t){if(!e||Po)return"";Po=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{Po=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ri(e):""}function yp(e){switch(e.tag){case 5:return ri(e.type);case 16:return ri("Lazy");case 13:return ri("Suspense");case 19:return ri("SuspenseList");case 0:case 2:case 15:return e=No(e.type,!1),e;case 11:return e=No(e.type.render,!1),e;case 1:return e=No(e.type,!0),e;default:return""}}function pa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case dn:return"Fragment";case cn:return"Portal";case da:return"Profiler";case vl:return"StrictMode";case fa:return"Suspense";case ha:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cd:return(e.displayName||"Context")+".Consumer";case ud:return(e._context.displayName||"Context")+".Provider";case xl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kl:return t=e.displayName||null,t!==null?t:pa(e.type)||"Memo";case nr:t=e._payload,e=e._init;try{return pa(e(t))}catch{}}return null}function wp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pa(t);case 8:return t===vl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Er(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function vp(e){var t=fd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yi(e){e._valueTracker||(e._valueTracker=vp(e))}function hd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=fd(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function bs(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ma(e,t){var r=t.checked;return he({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function vu(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Er(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function pd(e,t){t=t.checked,t!=null&&wl(e,"checked",t,!1)}function ga(e,t){pd(e,t);var r=Er(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ya(e,t.type,r):t.hasOwnProperty("defaultValue")&&ya(e,t.type,Er(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xu(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ya(e,t,r){(t!=="number"||bs(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ni=Array.isArray;function En(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Er(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function wa(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(A(91));return he({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ku(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(A(92));if(ni(r)){if(1<r.length)throw Error(A(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Er(r)}}function md(e,t){var r=Er(t.value),n=Er(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Cu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function va(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gd(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qi,yd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qi=qi||document.createElement("div"),qi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function wi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ai={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xp=["Webkit","ms","Moz","O"];Object.keys(ai).forEach(function(e){xp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ai[t]=ai[e]})});function wd(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ai.hasOwnProperty(e)&&ai[e]?(""+t).trim():t+"px"}function vd(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=wd(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var kp=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xa(e,t){if(t){if(kp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(A(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(A(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(A(61))}if(t.style!=null&&typeof t.style!="object")throw Error(A(62))}}function ka(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ca=null;function Cl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ea=null,bn=null,Sn=null;function Eu(e){if(e=Ui(e)){if(typeof Ea!="function")throw Error(A(280));var t=e.stateNode;t&&(t=ro(t),Ea(e.stateNode,e.type,t))}}function xd(e){bn?Sn?Sn.push(e):Sn=[e]:bn=e}function kd(){if(bn){var e=bn,t=Sn;if(Sn=bn=null,Eu(e),t)for(e=0;e<t.length;e++)Eu(t[e])}}function Cd(e,t){return e(t)}function Ed(){}var Ro=!1;function bd(e,t,r){if(Ro)return e(t,r);Ro=!0;try{return Cd(e,t,r)}finally{Ro=!1,(bn!==null||Sn!==null)&&(Ed(),kd())}}function vi(e,t){var r=e.stateNode;if(r===null)return null;var n=ro(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(A(231,t,typeof r));return r}var ba=!1;if(Xt)try{var Xn={};Object.defineProperty(Xn,"passive",{get:function(){ba=!0}}),window.addEventListener("test",Xn,Xn),window.removeEventListener("test",Xn,Xn)}catch{ba=!1}function Cp(e,t,r,n,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var li=!1,Ss=null,Ts=!1,Sa=null,Ep={onError:function(e){li=!0,Ss=e}};function bp(e,t,r,n,i,s,o,a,l){li=!1,Ss=null,Cp.apply(Ep,arguments)}function Sp(e,t,r,n,i,s,o,a,l){if(bp.apply(this,arguments),li){if(li){var c=Ss;li=!1,Ss=null}else throw Error(A(198));Ts||(Ts=!0,Sa=c)}}function rn(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Sd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bu(e){if(rn(e)!==e)throw Error(A(188))}function Tp(e){var t=e.alternate;if(!t){if(t=rn(e),t===null)throw Error(A(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return bu(i),e;if(s===n)return bu(i),t;s=s.sibling}throw Error(A(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(A(189))}}if(r.alternate!==n)throw Error(A(190))}if(r.tag!==3)throw Error(A(188));return r.stateNode.current===r?e:t}function Td(e){return e=Tp(e),e!==null?_d(e):null}function _d(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_d(e);if(t!==null)return t;e=e.sibling}return null}var Pd=at.unstable_scheduleCallback,Su=at.unstable_cancelCallback,_p=at.unstable_shouldYield,Pp=at.unstable_requestPaint,ye=at.unstable_now,Np=at.unstable_getCurrentPriorityLevel,El=at.unstable_ImmediatePriority,Nd=at.unstable_UserBlockingPriority,_s=at.unstable_NormalPriority,Rp=at.unstable_LowPriority,Rd=at.unstable_IdlePriority,Zs=null,Vt=null;function Ap(e){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(Zs,e,void 0,(e.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:Ip,jp=Math.log,Dp=Math.LN2;function Ip(e){return e>>>=0,e===0?32:31-(jp(e)/Dp|0)|0}var Zi=64,Ji=4194304;function ii(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ps(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=ii(a):(s&=o,s!==0&&(n=ii(s)))}else o=r&~i,o!==0?n=ii(o):s!==0&&(n=ii(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pt(t),i=1<<r,n|=e[r],t&=~i;return n}function Op(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mp(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Pt(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Op(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function Ta(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ad(){var e=Zi;return Zi<<=1,!(Zi&4194240)&&(Zi=64),e}function Ao(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function zi(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pt(t),e[t]=r}function Fp(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Pt(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function bl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pt(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var re=0;function jd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Dd,Sl,Id,Od,Md,_a=!1,es=[],hr=null,pr=null,mr=null,xi=new Map,ki=new Map,sr=[],zp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tu(e,t){switch(e){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":pr=null;break;case"mouseover":case"mouseout":mr=null;break;case"pointerover":case"pointerout":xi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ki.delete(t.pointerId)}}function Kn(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Ui(t),t!==null&&Sl(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Vp(e,t,r,n,i){switch(t){case"focusin":return hr=Kn(hr,e,t,r,n,i),!0;case"dragenter":return pr=Kn(pr,e,t,r,n,i),!0;case"mouseover":return mr=Kn(mr,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return xi.set(s,Kn(xi.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,ki.set(s,Kn(ki.get(s)||null,e,t,r,n,i)),!0}return!1}function Fd(e){var t=Ur(e.target);if(t!==null){var r=rn(t);if(r!==null){if(t=r.tag,t===13){if(t=Sd(r),t!==null){e.blockedOn=t,Md(e.priority,function(){Id(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function hs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Pa(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ca=n,r.target.dispatchEvent(n),Ca=null}else return t=Ui(r),t!==null&&Sl(t),e.blockedOn=r,!1;t.shift()}return!0}function _u(e,t,r){hs(e)&&r.delete(t)}function Up(){_a=!1,hr!==null&&hs(hr)&&(hr=null),pr!==null&&hs(pr)&&(pr=null),mr!==null&&hs(mr)&&(mr=null),xi.forEach(_u),ki.forEach(_u)}function Yn(e,t){e.blockedOn===t&&(e.blockedOn=null,_a||(_a=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,Up)))}function Ci(e){function t(i){return Yn(i,e)}if(0<es.length){Yn(es[0],e);for(var r=1;r<es.length;r++){var n=es[r];n.blockedOn===e&&(n.blockedOn=null)}}for(hr!==null&&Yn(hr,e),pr!==null&&Yn(pr,e),mr!==null&&Yn(mr,e),xi.forEach(t),ki.forEach(t),r=0;r<sr.length;r++)n=sr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<sr.length&&(r=sr[0],r.blockedOn===null);)Fd(r),r.blockedOn===null&&sr.shift()}var Tn=Zt.ReactCurrentBatchConfig,Ns=!0;function Lp(e,t,r,n){var i=re,s=Tn.transition;Tn.transition=null;try{re=1,Tl(e,t,r,n)}finally{re=i,Tn.transition=s}}function Bp(e,t,r,n){var i=re,s=Tn.transition;Tn.transition=null;try{re=4,Tl(e,t,r,n)}finally{re=i,Tn.transition=s}}function Tl(e,t,r,n){if(Ns){var i=Pa(e,t,r,n);if(i===null)Lo(e,t,n,Rs,r),Tu(e,n);else if(Vp(i,e,t,r,n))n.stopPropagation();else if(Tu(e,n),t&4&&-1<zp.indexOf(e)){for(;i!==null;){var s=Ui(i);if(s!==null&&Dd(s),s=Pa(e,t,r,n),s===null&&Lo(e,t,n,Rs,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Lo(e,t,n,null,r)}}var Rs=null;function Pa(e,t,r,n){if(Rs=null,e=Cl(n),e=Ur(e),e!==null)if(t=rn(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Sd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Rs=e,null}function zd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Np()){case El:return 1;case Nd:return 4;case _s:case Rp:return 16;case Rd:return 536870912;default:return 16}default:return 16}}var lr=null,_l=null,ps=null;function Vd(){if(ps)return ps;var e,t=_l,r=t.length,n,i="value"in lr?lr.value:lr.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return ps=i.slice(e,1<n?1-n:void 0)}function ms(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ts(){return!0}function Pu(){return!1}function ut(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ts:Pu,this.isPropagationStopped=Pu,this}return he(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ts)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ts)},persist:function(){},isPersistent:ts}),t}var Fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pl=ut(Fn),Vi=he({},Fn,{view:0,detail:0}),Wp=ut(Vi),jo,Do,qn,Js=he({},Vi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nl,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qn&&(qn&&e.type==="mousemove"?(jo=e.screenX-qn.screenX,Do=e.screenY-qn.screenY):Do=jo=0,qn=e),jo)},movementY:function(e){return"movementY"in e?e.movementY:Do}}),Nu=ut(Js),$p=he({},Js,{dataTransfer:0}),Hp=ut($p),Qp=he({},Vi,{relatedTarget:0}),Io=ut(Qp),Gp=he({},Fn,{animationName:0,elapsedTime:0,pseudoElement:0}),Xp=ut(Gp),Kp=he({},Fn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Yp=ut(Kp),qp=he({},Fn,{data:0}),Ru=ut(qp),Zp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},em={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=em[e])?!!t[e]:!1}function Nl(){return tm}var rm=he({},Vi,{key:function(e){if(e.key){var t=Zp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ms(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Jp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nl,charCode:function(e){return e.type==="keypress"?ms(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ms(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nm=ut(rm),im=he({},Js,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Au=ut(im),sm=he({},Vi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nl}),om=ut(sm),am=he({},Fn,{propertyName:0,elapsedTime:0,pseudoElement:0}),lm=ut(am),um=he({},Js,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),cm=ut(um),dm=[9,13,27,32],Rl=Xt&&"CompositionEvent"in window,ui=null;Xt&&"documentMode"in document&&(ui=document.documentMode);var fm=Xt&&"TextEvent"in window&&!ui,Ud=Xt&&(!Rl||ui&&8<ui&&11>=ui),ju=" ",Du=!1;function Ld(e,t){switch(e){case"keyup":return dm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fn=!1;function hm(e,t){switch(e){case"compositionend":return Bd(t);case"keypress":return t.which!==32?null:(Du=!0,ju);case"textInput":return e=t.data,e===ju&&Du?null:e;default:return null}}function pm(e,t){if(fn)return e==="compositionend"||!Rl&&Ld(e,t)?(e=Vd(),ps=_l=lr=null,fn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ud&&t.locale!=="ko"?null:t.data;default:return null}}var mm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mm[e.type]:t==="textarea"}function Wd(e,t,r,n){xd(n),t=As(t,"onChange"),0<t.length&&(r=new Pl("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ci=null,Ei=null;function gm(e){ef(e,0)}function eo(e){var t=mn(e);if(hd(t))return e}function ym(e,t){if(e==="change")return t}var $d=!1;if(Xt){var Oo;if(Xt){var Mo="oninput"in document;if(!Mo){var Ou=document.createElement("div");Ou.setAttribute("oninput","return;"),Mo=typeof Ou.oninput=="function"}Oo=Mo}else Oo=!1;$d=Oo&&(!document.documentMode||9<document.documentMode)}function Mu(){ci&&(ci.detachEvent("onpropertychange",Hd),Ei=ci=null)}function Hd(e){if(e.propertyName==="value"&&eo(Ei)){var t=[];Wd(t,Ei,e,Cl(e)),bd(gm,t)}}function wm(e,t,r){e==="focusin"?(Mu(),ci=t,Ei=r,ci.attachEvent("onpropertychange",Hd)):e==="focusout"&&Mu()}function vm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return eo(Ei)}function xm(e,t){if(e==="click")return eo(t)}function km(e,t){if(e==="input"||e==="change")return eo(t)}function Cm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rt=typeof Object.is=="function"?Object.is:Cm;function bi(e,t){if(Rt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ca.call(t,i)||!Rt(e[i],t[i]))return!1}return!0}function Fu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zu(e,t){var r=Fu(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Fu(r)}}function Qd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Qd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Gd(){for(var e=window,t=bs();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=bs(e.document)}return t}function Al(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Em(e){var t=Gd(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Qd(r.ownerDocument.documentElement,r)){if(n!==null&&Al(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=zu(r,s);var o=zu(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bm=Xt&&"documentMode"in document&&11>=document.documentMode,hn=null,Na=null,di=null,Ra=!1;function Vu(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ra||hn==null||hn!==bs(n)||(n=hn,"selectionStart"in n&&Al(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),di&&bi(di,n)||(di=n,n=As(Na,"onSelect"),0<n.length&&(t=new Pl("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=hn)))}function rs(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var pn={animationend:rs("Animation","AnimationEnd"),animationiteration:rs("Animation","AnimationIteration"),animationstart:rs("Animation","AnimationStart"),transitionend:rs("Transition","TransitionEnd")},Fo={},Xd={};Xt&&(Xd=document.createElement("div").style,"AnimationEvent"in window||(delete pn.animationend.animation,delete pn.animationiteration.animation,delete pn.animationstart.animation),"TransitionEvent"in window||delete pn.transitionend.transition);function to(e){if(Fo[e])return Fo[e];if(!pn[e])return e;var t=pn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Xd)return Fo[e]=t[r];return e}var Kd=to("animationend"),Yd=to("animationiteration"),qd=to("animationstart"),Zd=to("transitionend"),Jd=new Map,Uu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){Jd.set(e,t),tn(t,[e])}for(var zo=0;zo<Uu.length;zo++){var Vo=Uu[zo],Sm=Vo.toLowerCase(),Tm=Vo[0].toUpperCase()+Vo.slice(1);Tr(Sm,"on"+Tm)}Tr(Kd,"onAnimationEnd");Tr(Yd,"onAnimationIteration");Tr(qd,"onAnimationStart");Tr("dblclick","onDoubleClick");Tr("focusin","onFocus");Tr("focusout","onBlur");Tr(Zd,"onTransitionEnd");Nn("onMouseEnter",["mouseout","mouseover"]);Nn("onMouseLeave",["mouseout","mouseover"]);Nn("onPointerEnter",["pointerout","pointerover"]);Nn("onPointerLeave",["pointerout","pointerover"]);tn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));tn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));tn("onBeforeInput",["compositionend","keypress","textInput","paste"]);tn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));tn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));tn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_m=new Set("cancel close invalid load scroll toggle".split(" ").concat(si));function Lu(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Sp(n,t,void 0,e),e.currentTarget=null}function ef(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Lu(i,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Lu(i,a,c),s=l}}}if(Ts)throw e=Sa,Ts=!1,Sa=null,e}function oe(e,t){var r=t[Oa];r===void 0&&(r=t[Oa]=new Set);var n=e+"__bubble";r.has(n)||(tf(t,e,2,!1),r.add(n))}function Uo(e,t,r){var n=0;t&&(n|=4),tf(r,e,n,t)}var ns="_reactListening"+Math.random().toString(36).slice(2);function Si(e){if(!e[ns]){e[ns]=!0,ld.forEach(function(r){r!=="selectionchange"&&(_m.has(r)||Uo(r,!1,e),Uo(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ns]||(t[ns]=!0,Uo("selectionchange",!1,t))}}function tf(e,t,r,n){switch(zd(t)){case 1:var i=Lp;break;case 4:i=Bp;break;default:i=Tl}r=i.bind(null,t,r,e),i=void 0,!ba||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Lo(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ur(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}bd(function(){var c=s,d=Cl(r),h=[];e:{var g=Jd.get(e);if(g!==void 0){var C=Pl,k=e;switch(e){case"keypress":if(ms(r)===0)break e;case"keydown":case"keyup":C=nm;break;case"focusin":k="focus",C=Io;break;case"focusout":k="blur",C=Io;break;case"beforeblur":case"afterblur":C=Io;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=Nu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Hp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=om;break;case Kd:case Yd:case qd:C=Xp;break;case Zd:C=lm;break;case"scroll":C=Wp;break;case"wheel":C=cm;break;case"copy":case"cut":case"paste":C=Yp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=Au}var x=(t&4)!==0,b=!x&&e==="scroll",p=x?g!==null?g+"Capture":null:g;x=[];for(var f=c,m;f!==null;){m=f;var v=m.stateNode;if(m.tag===5&&v!==null&&(m=v,p!==null&&(v=vi(f,p),v!=null&&x.push(Ti(f,v,m)))),b)break;f=f.return}0<x.length&&(g=new C(g,k,null,r,d),h.push({event:g,listeners:x}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",C=e==="mouseout"||e==="pointerout",g&&r!==Ca&&(k=r.relatedTarget||r.fromElement)&&(Ur(k)||k[Kt]))break e;if((C||g)&&(g=d.window===d?d:(g=d.ownerDocument)?g.defaultView||g.parentWindow:window,C?(k=r.relatedTarget||r.toElement,C=c,k=k?Ur(k):null,k!==null&&(b=rn(k),k!==b||k.tag!==5&&k.tag!==6)&&(k=null)):(C=null,k=c),C!==k)){if(x=Nu,v="onMouseLeave",p="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(x=Au,v="onPointerLeave",p="onPointerEnter",f="pointer"),b=C==null?g:mn(C),m=k==null?g:mn(k),g=new x(v,f+"leave",C,r,d),g.target=b,g.relatedTarget=m,v=null,Ur(d)===c&&(x=new x(p,f+"enter",k,r,d),x.target=m,x.relatedTarget=b,v=x),b=v,C&&k)t:{for(x=C,p=k,f=0,m=x;m;m=ln(m))f++;for(m=0,v=p;v;v=ln(v))m++;for(;0<f-m;)x=ln(x),f--;for(;0<m-f;)p=ln(p),m--;for(;f--;){if(x===p||p!==null&&x===p.alternate)break t;x=ln(x),p=ln(p)}x=null}else x=null;C!==null&&Bu(h,g,C,x,!1),k!==null&&b!==null&&Bu(h,b,k,x,!0)}}e:{if(g=c?mn(c):window,C=g.nodeName&&g.nodeName.toLowerCase(),C==="select"||C==="input"&&g.type==="file")var w=ym;else if(Iu(g))if($d)w=km;else{w=vm;var S=wm}else(C=g.nodeName)&&C.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(w=xm);if(w&&(w=w(e,c))){Wd(h,w,r,d);break e}S&&S(e,g,c),e==="focusout"&&(S=g._wrapperState)&&S.controlled&&g.type==="number"&&ya(g,"number",g.value)}switch(S=c?mn(c):window,e){case"focusin":(Iu(S)||S.contentEditable==="true")&&(hn=S,Na=c,di=null);break;case"focusout":di=Na=hn=null;break;case"mousedown":Ra=!0;break;case"contextmenu":case"mouseup":case"dragend":Ra=!1,Vu(h,r,d);break;case"selectionchange":if(bm)break;case"keydown":case"keyup":Vu(h,r,d)}var T;if(Rl)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else fn?Ld(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(Ud&&r.locale!=="ko"&&(fn||j!=="onCompositionStart"?j==="onCompositionEnd"&&fn&&(T=Vd()):(lr=d,_l="value"in lr?lr.value:lr.textContent,fn=!0)),S=As(c,j),0<S.length&&(j=new Ru(j,e,null,r,d),h.push({event:j,listeners:S}),T?j.data=T:(T=Bd(r),T!==null&&(j.data=T)))),(T=fm?hm(e,r):pm(e,r))&&(c=As(c,"onBeforeInput"),0<c.length&&(d=new Ru("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:c}),d.data=T))}ef(h,t)})}function Ti(e,t,r){return{instance:e,listener:t,currentTarget:r}}function As(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=vi(e,r),s!=null&&n.unshift(Ti(e,s,i)),s=vi(e,t),s!=null&&n.push(Ti(e,s,i))),e=e.return}return n}function ln(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Bu(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,i?(l=vi(r,s),l!=null&&o.unshift(Ti(r,l,a))):i||(l=vi(r,s),l!=null&&o.push(Ti(r,l,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Pm=/\r\n?/g,Nm=/\u0000|\uFFFD/g;function Wu(e){return(typeof e=="string"?e:""+e).replace(Pm,`
`).replace(Nm,"")}function is(e,t,r){if(t=Wu(t),Wu(e)!==t&&r)throw Error(A(425))}function js(){}var Aa=null,ja=null;function Da(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ia=typeof setTimeout=="function"?setTimeout:void 0,Rm=typeof clearTimeout=="function"?clearTimeout:void 0,$u=typeof Promise=="function"?Promise:void 0,Am=typeof queueMicrotask=="function"?queueMicrotask:typeof $u<"u"?function(e){return $u.resolve(null).then(e).catch(jm)}:Ia;function jm(e){setTimeout(function(){throw e})}function Bo(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Ci(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Ci(t)}function gr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Hu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var zn=Math.random().toString(36).slice(2),zt="__reactFiber$"+zn,_i="__reactProps$"+zn,Kt="__reactContainer$"+zn,Oa="__reactEvents$"+zn,Dm="__reactListeners$"+zn,Im="__reactHandles$"+zn;function Ur(e){var t=e[zt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Kt]||r[zt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Hu(e);e!==null;){if(r=e[zt])return r;e=Hu(e)}return t}e=r,r=e.parentNode}return null}function Ui(e){return e=e[zt]||e[Kt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function mn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(A(33))}function ro(e){return e[_i]||null}var Ma=[],gn=-1;function _r(e){return{current:e}}function ae(e){0>gn||(e.current=Ma[gn],Ma[gn]=null,gn--)}function se(e,t){gn++,Ma[gn]=e.current,e.current=t}var br={},Fe=_r(br),qe=_r(!1),Kr=br;function Rn(e,t){var r=e.type.contextTypes;if(!r)return br;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ze(e){return e=e.childContextTypes,e!=null}function Ds(){ae(qe),ae(Fe)}function Qu(e,t,r){if(Fe.current!==br)throw Error(A(168));se(Fe,t),se(qe,r)}function rf(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(A(108,wp(e)||"Unknown",i));return he({},r,n)}function Is(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||br,Kr=Fe.current,se(Fe,e),se(qe,qe.current),!0}function Gu(e,t,r){var n=e.stateNode;if(!n)throw Error(A(169));r?(e=rf(e,t,Kr),n.__reactInternalMemoizedMergedChildContext=e,ae(qe),ae(Fe),se(Fe,e)):ae(qe),se(qe,r)}var Wt=null,no=!1,Wo=!1;function nf(e){Wt===null?Wt=[e]:Wt.push(e)}function Om(e){no=!0,nf(e)}function Pr(){if(!Wo&&Wt!==null){Wo=!0;var e=0,t=re;try{var r=Wt;for(re=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Wt=null,no=!1}catch(i){throw Wt!==null&&(Wt=Wt.slice(e+1)),Pd(El,Pr),i}finally{re=t,Wo=!1}}return null}var yn=[],wn=0,Os=null,Ms=0,ft=[],ht=0,Yr=null,Ht=1,Qt="";function Fr(e,t){yn[wn++]=Ms,yn[wn++]=Os,Os=e,Ms=t}function sf(e,t,r){ft[ht++]=Ht,ft[ht++]=Qt,ft[ht++]=Yr,Yr=e;var n=Ht;e=Qt;var i=32-Pt(n)-1;n&=~(1<<i),r+=1;var s=32-Pt(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Ht=1<<32-Pt(t)+i|r<<i|n,Qt=s+e}else Ht=1<<s|r<<i|n,Qt=e}function jl(e){e.return!==null&&(Fr(e,1),sf(e,1,0))}function Dl(e){for(;e===Os;)Os=yn[--wn],yn[wn]=null,Ms=yn[--wn],yn[wn]=null;for(;e===Yr;)Yr=ft[--ht],ft[ht]=null,Qt=ft[--ht],ft[ht]=null,Ht=ft[--ht],ft[ht]=null}var ot=null,st=null,ce=!1,_t=null;function of(e,t){var r=pt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Xu(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ot=e,st=gr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ot=e,st=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Yr!==null?{id:Ht,overflow:Qt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ot=e,st=null,!0):!1;default:return!1}}function Fa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function za(e){if(ce){var t=st;if(t){var r=t;if(!Xu(e,t)){if(Fa(e))throw Error(A(418));t=gr(r.nextSibling);var n=ot;t&&Xu(e,t)?of(n,r):(e.flags=e.flags&-4097|2,ce=!1,ot=e)}}else{if(Fa(e))throw Error(A(418));e.flags=e.flags&-4097|2,ce=!1,ot=e}}}function Ku(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ot=e}function ss(e){if(e!==ot)return!1;if(!ce)return Ku(e),ce=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Da(e.type,e.memoizedProps)),t&&(t=st)){if(Fa(e))throw af(),Error(A(418));for(;t;)of(e,t),t=gr(t.nextSibling)}if(Ku(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(A(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){st=gr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}st=null}}else st=ot?gr(e.stateNode.nextSibling):null;return!0}function af(){for(var e=st;e;)e=gr(e.nextSibling)}function An(){st=ot=null,ce=!1}function Il(e){_t===null?_t=[e]:_t.push(e)}var Mm=Zt.ReactCurrentBatchConfig;function Zn(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(A(309));var n=r.stateNode}if(!n)throw Error(A(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(A(284));if(!r._owner)throw Error(A(290,e))}return e}function os(e,t){throw e=Object.prototype.toString.call(t),Error(A(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yu(e){var t=e._init;return t(e._payload)}function lf(e){function t(p,f){if(e){var m=p.deletions;m===null?(p.deletions=[f],p.flags|=16):m.push(f)}}function r(p,f){if(!e)return null;for(;f!==null;)t(p,f),f=f.sibling;return null}function n(p,f){for(p=new Map;f!==null;)f.key!==null?p.set(f.key,f):p.set(f.index,f),f=f.sibling;return p}function i(p,f){return p=xr(p,f),p.index=0,p.sibling=null,p}function s(p,f,m){return p.index=m,e?(m=p.alternate,m!==null?(m=m.index,m<f?(p.flags|=2,f):m):(p.flags|=2,f)):(p.flags|=1048576,f)}function o(p){return e&&p.alternate===null&&(p.flags|=2),p}function a(p,f,m,v){return f===null||f.tag!==6?(f=Yo(m,p.mode,v),f.return=p,f):(f=i(f,m),f.return=p,f)}function l(p,f,m,v){var w=m.type;return w===dn?d(p,f,m.props.children,v,m.key):f!==null&&(f.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===nr&&Yu(w)===f.type)?(v=i(f,m.props),v.ref=Zn(p,f,m),v.return=p,v):(v=Cs(m.type,m.key,m.props,null,p.mode,v),v.ref=Zn(p,f,m),v.return=p,v)}function c(p,f,m,v){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=qo(m,p.mode,v),f.return=p,f):(f=i(f,m.children||[]),f.return=p,f)}function d(p,f,m,v,w){return f===null||f.tag!==7?(f=Gr(m,p.mode,v,w),f.return=p,f):(f=i(f,m),f.return=p,f)}function h(p,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Yo(""+f,p.mode,m),f.return=p,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ki:return m=Cs(f.type,f.key,f.props,null,p.mode,m),m.ref=Zn(p,null,f),m.return=p,m;case cn:return f=qo(f,p.mode,m),f.return=p,f;case nr:var v=f._init;return h(p,v(f._payload),m)}if(ni(f)||Gn(f))return f=Gr(f,p.mode,m,null),f.return=p,f;os(p,f)}return null}function g(p,f,m,v){var w=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return w!==null?null:a(p,f,""+m,v);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ki:return m.key===w?l(p,f,m,v):null;case cn:return m.key===w?c(p,f,m,v):null;case nr:return w=m._init,g(p,f,w(m._payload),v)}if(ni(m)||Gn(m))return w!==null?null:d(p,f,m,v,null);os(p,m)}return null}function C(p,f,m,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return p=p.get(m)||null,a(f,p,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ki:return p=p.get(v.key===null?m:v.key)||null,l(f,p,v,w);case cn:return p=p.get(v.key===null?m:v.key)||null,c(f,p,v,w);case nr:var S=v._init;return C(p,f,m,S(v._payload),w)}if(ni(v)||Gn(v))return p=p.get(m)||null,d(f,p,v,w,null);os(f,v)}return null}function k(p,f,m,v){for(var w=null,S=null,T=f,j=f=0,F=null;T!==null&&j<m.length;j++){T.index>j?(F=T,T=null):F=T.sibling;var W=g(p,T,m[j],v);if(W===null){T===null&&(T=F);break}e&&T&&W.alternate===null&&t(p,T),f=s(W,f,j),S===null?w=W:S.sibling=W,S=W,T=F}if(j===m.length)return r(p,T),ce&&Fr(p,j),w;if(T===null){for(;j<m.length;j++)T=h(p,m[j],v),T!==null&&(f=s(T,f,j),S===null?w=T:S.sibling=T,S=T);return ce&&Fr(p,j),w}for(T=n(p,T);j<m.length;j++)F=C(T,p,j,m[j],v),F!==null&&(e&&F.alternate!==null&&T.delete(F.key===null?j:F.key),f=s(F,f,j),S===null?w=F:S.sibling=F,S=F);return e&&T.forEach(function(I){return t(p,I)}),ce&&Fr(p,j),w}function x(p,f,m,v){var w=Gn(m);if(typeof w!="function")throw Error(A(150));if(m=w.call(m),m==null)throw Error(A(151));for(var S=w=null,T=f,j=f=0,F=null,W=m.next();T!==null&&!W.done;j++,W=m.next()){T.index>j?(F=T,T=null):F=T.sibling;var I=g(p,T,W.value,v);if(I===null){T===null&&(T=F);break}e&&T&&I.alternate===null&&t(p,T),f=s(I,f,j),S===null?w=I:S.sibling=I,S=I,T=F}if(W.done)return r(p,T),ce&&Fr(p,j),w;if(T===null){for(;!W.done;j++,W=m.next())W=h(p,W.value,v),W!==null&&(f=s(W,f,j),S===null?w=W:S.sibling=W,S=W);return ce&&Fr(p,j),w}for(T=n(p,T);!W.done;j++,W=m.next())W=C(T,p,j,W.value,v),W!==null&&(e&&W.alternate!==null&&T.delete(W.key===null?j:W.key),f=s(W,f,j),S===null?w=W:S.sibling=W,S=W);return e&&T.forEach(function(R){return t(p,R)}),ce&&Fr(p,j),w}function b(p,f,m,v){if(typeof m=="object"&&m!==null&&m.type===dn&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ki:e:{for(var w=m.key,S=f;S!==null;){if(S.key===w){if(w=m.type,w===dn){if(S.tag===7){r(p,S.sibling),f=i(S,m.props.children),f.return=p,p=f;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===nr&&Yu(w)===S.type){r(p,S.sibling),f=i(S,m.props),f.ref=Zn(p,S,m),f.return=p,p=f;break e}r(p,S);break}else t(p,S);S=S.sibling}m.type===dn?(f=Gr(m.props.children,p.mode,v,m.key),f.return=p,p=f):(v=Cs(m.type,m.key,m.props,null,p.mode,v),v.ref=Zn(p,f,m),v.return=p,p=v)}return o(p);case cn:e:{for(S=m.key;f!==null;){if(f.key===S)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){r(p,f.sibling),f=i(f,m.children||[]),f.return=p,p=f;break e}else{r(p,f);break}else t(p,f);f=f.sibling}f=qo(m,p.mode,v),f.return=p,p=f}return o(p);case nr:return S=m._init,b(p,f,S(m._payload),v)}if(ni(m))return k(p,f,m,v);if(Gn(m))return x(p,f,m,v);os(p,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(r(p,f.sibling),f=i(f,m),f.return=p,p=f):(r(p,f),f=Yo(m,p.mode,v),f.return=p,p=f),o(p)):r(p,f)}return b}var jn=lf(!0),uf=lf(!1),Fs=_r(null),zs=null,vn=null,Ol=null;function Ml(){Ol=vn=zs=null}function Fl(e){var t=Fs.current;ae(Fs),e._currentValue=t}function Va(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function _n(e,t){zs=e,Ol=vn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ye=!0),e.firstContext=null)}function gt(e){var t=e._currentValue;if(Ol!==e)if(e={context:e,memoizedValue:t,next:null},vn===null){if(zs===null)throw Error(A(308));vn=e,zs.dependencies={lanes:0,firstContext:e}}else vn=vn.next=e;return t}var Lr=null;function zl(e){Lr===null?Lr=[e]:Lr.push(e)}function cf(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,zl(t)):(r.next=i.next,i.next=r),t.interleaved=r,Yt(e,n)}function Yt(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ir=!1;function Vl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function df(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yr(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Z&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Yt(e,r)}return i=n.interleaved,i===null?(t.next=t,zl(n)):(t.next=i.next,i.next=t),n.interleaved=t,Yt(e,r)}function gs(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bl(e,r)}}function qu(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vs(e,t,r,n){var i=e.updateQueue;ir=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var g=a.lane,C=a.eventTime;if((n&g)===g){d!==null&&(d=d.next={eventTime:C,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var k=e,x=a;switch(g=t,C=r,x.tag){case 1:if(k=x.payload,typeof k=="function"){h=k.call(C,h,g);break e}h=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=x.payload,g=typeof k=="function"?k.call(C,h,g):k,g==null)break e;h=he({},h,g);break e;case 2:ir=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else C={eventTime:C,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=C,l=h):d=d.next=C,o|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Zr|=o,e.lanes=o,e.memoizedState=h}}function Zu(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(A(191,i));i.call(n)}}}var Li={},Ut=_r(Li),Pi=_r(Li),Ni=_r(Li);function Br(e){if(e===Li)throw Error(A(174));return e}function Ul(e,t){switch(se(Ni,t),se(Pi,e),se(Ut,Li),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:va(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=va(t,e)}ae(Ut),se(Ut,t)}function Dn(){ae(Ut),ae(Pi),ae(Ni)}function ff(e){Br(Ni.current);var t=Br(Ut.current),r=va(t,e.type);t!==r&&(se(Pi,e),se(Ut,r))}function Ll(e){Pi.current===e&&(ae(Ut),ae(Pi))}var de=_r(0);function Us(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $o=[];function Bl(){for(var e=0;e<$o.length;e++)$o[e]._workInProgressVersionPrimary=null;$o.length=0}var ys=Zt.ReactCurrentDispatcher,Ho=Zt.ReactCurrentBatchConfig,qr=0,fe=null,ke=null,be=null,Ls=!1,fi=!1,Ri=0,Fm=0;function Ie(){throw Error(A(321))}function Wl(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rt(e[r],t[r]))return!1;return!0}function $l(e,t,r,n,i,s){if(qr=s,fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ys.current=e===null||e.memoizedState===null?Lm:Bm,e=r(n,i),fi){s=0;do{if(fi=!1,Ri=0,25<=s)throw Error(A(301));s+=1,be=ke=null,t.updateQueue=null,ys.current=Wm,e=r(n,i)}while(fi)}if(ys.current=Bs,t=ke!==null&&ke.next!==null,qr=0,be=ke=fe=null,Ls=!1,t)throw Error(A(300));return e}function Hl(){var e=Ri!==0;return Ri=0,e}function Ft(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return be===null?fe.memoizedState=be=e:be=be.next=e,be}function yt(){if(ke===null){var e=fe.alternate;e=e!==null?e.memoizedState:null}else e=ke.next;var t=be===null?fe.memoizedState:be.next;if(t!==null)be=t,ke=e;else{if(e===null)throw Error(A(310));ke=e,e={memoizedState:ke.memoizedState,baseState:ke.baseState,baseQueue:ke.baseQueue,queue:ke.queue,next:null},be===null?fe.memoizedState=be=e:be=be.next=e}return be}function Ai(e,t){return typeof t=="function"?t(e):t}function Qo(e){var t=yt(),r=t.queue;if(r===null)throw Error(A(311));r.lastRenderedReducer=e;var n=ke,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((qr&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=n):l=l.next=h,fe.lanes|=d,Zr|=d}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,Rt(n,t.memoizedState)||(Ye=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,fe.lanes|=s,Zr|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Go(e){var t=yt(),r=t.queue;if(r===null)throw Error(A(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Rt(s,t.memoizedState)||(Ye=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function hf(){}function pf(e,t){var r=fe,n=yt(),i=t(),s=!Rt(n.memoizedState,i);if(s&&(n.memoizedState=i,Ye=!0),n=n.queue,Ql(yf.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||be!==null&&be.memoizedState.tag&1){if(r.flags|=2048,ji(9,gf.bind(null,r,n,i,t),void 0,null),Se===null)throw Error(A(349));qr&30||mf(r,t,i)}return i}function mf(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=fe.updateQueue,t===null?(t={lastEffect:null,stores:null},fe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gf(e,t,r,n){t.value=r,t.getSnapshot=n,wf(t)&&vf(e)}function yf(e,t,r){return r(function(){wf(t)&&vf(e)})}function wf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rt(e,r)}catch{return!0}}function vf(e){var t=Yt(e,1);t!==null&&Nt(t,e,1,-1)}function Ju(e){var t=Ft();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:e},t.queue=e,e=e.dispatch=Um.bind(null,fe,e),[t.memoizedState,e]}function ji(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=fe.updateQueue,t===null?(t={lastEffect:null,stores:null},fe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function xf(){return yt().memoizedState}function ws(e,t,r,n){var i=Ft();fe.flags|=e,i.memoizedState=ji(1|t,r,void 0,n===void 0?null:n)}function io(e,t,r,n){var i=yt();n=n===void 0?null:n;var s=void 0;if(ke!==null){var o=ke.memoizedState;if(s=o.destroy,n!==null&&Wl(n,o.deps)){i.memoizedState=ji(t,r,s,n);return}}fe.flags|=e,i.memoizedState=ji(1|t,r,s,n)}function ec(e,t){return ws(8390656,8,e,t)}function Ql(e,t){return io(2048,8,e,t)}function kf(e,t){return io(4,2,e,t)}function Cf(e,t){return io(4,4,e,t)}function Ef(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bf(e,t,r){return r=r!=null?r.concat([e]):null,io(4,4,Ef.bind(null,t,e),r)}function Gl(){}function Sf(e,t){var r=yt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Wl(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Tf(e,t){var r=yt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Wl(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function _f(e,t,r){return qr&21?(Rt(r,t)||(r=Ad(),fe.lanes|=r,Zr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ye=!0),e.memoizedState=r)}function zm(e,t){var r=re;re=r!==0&&4>r?r:4,e(!0);var n=Ho.transition;Ho.transition={};try{e(!1),t()}finally{re=r,Ho.transition=n}}function Pf(){return yt().memoizedState}function Vm(e,t,r){var n=vr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Nf(e))Rf(t,r);else if(r=cf(e,t,r,n),r!==null){var i=We();Nt(r,e,n,i),Af(r,t,n)}}function Um(e,t,r){var n=vr(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Nf(e))Rf(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,Rt(a,o)){var l=t.interleaved;l===null?(i.next=i,zl(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=cf(e,t,i,n),r!==null&&(i=We(),Nt(r,e,n,i),Af(r,t,n))}}function Nf(e){var t=e.alternate;return e===fe||t!==null&&t===fe}function Rf(e,t){fi=Ls=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Af(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,bl(e,r)}}var Bs={readContext:gt,useCallback:Ie,useContext:Ie,useEffect:Ie,useImperativeHandle:Ie,useInsertionEffect:Ie,useLayoutEffect:Ie,useMemo:Ie,useReducer:Ie,useRef:Ie,useState:Ie,useDebugValue:Ie,useDeferredValue:Ie,useTransition:Ie,useMutableSource:Ie,useSyncExternalStore:Ie,useId:Ie,unstable_isNewReconciler:!1},Lm={readContext:gt,useCallback:function(e,t){return Ft().memoizedState=[e,t===void 0?null:t],e},useContext:gt,useEffect:ec,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ws(4194308,4,Ef.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ws(4194308,4,e,t)},useInsertionEffect:function(e,t){return ws(4,2,e,t)},useMemo:function(e,t){var r=Ft();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ft();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Vm.bind(null,fe,e),[n.memoizedState,e]},useRef:function(e){var t=Ft();return e={current:e},t.memoizedState=e},useState:Ju,useDebugValue:Gl,useDeferredValue:function(e){return Ft().memoizedState=e},useTransition:function(){var e=Ju(!1),t=e[0];return e=zm.bind(null,e[1]),Ft().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=fe,i=Ft();if(ce){if(r===void 0)throw Error(A(407));r=r()}else{if(r=t(),Se===null)throw Error(A(349));qr&30||mf(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,ec(yf.bind(null,n,s,e),[e]),n.flags|=2048,ji(9,gf.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ft(),t=Se.identifierPrefix;if(ce){var r=Qt,n=Ht;r=(n&~(1<<32-Pt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ri++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Fm++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Bm={readContext:gt,useCallback:Sf,useContext:gt,useEffect:Ql,useImperativeHandle:bf,useInsertionEffect:kf,useLayoutEffect:Cf,useMemo:Tf,useReducer:Qo,useRef:xf,useState:function(){return Qo(Ai)},useDebugValue:Gl,useDeferredValue:function(e){var t=yt();return _f(t,ke.memoizedState,e)},useTransition:function(){var e=Qo(Ai)[0],t=yt().memoizedState;return[e,t]},useMutableSource:hf,useSyncExternalStore:pf,useId:Pf,unstable_isNewReconciler:!1},Wm={readContext:gt,useCallback:Sf,useContext:gt,useEffect:Ql,useImperativeHandle:bf,useInsertionEffect:kf,useLayoutEffect:Cf,useMemo:Tf,useReducer:Go,useRef:xf,useState:function(){return Go(Ai)},useDebugValue:Gl,useDeferredValue:function(e){var t=yt();return ke===null?t.memoizedState=e:_f(t,ke.memoizedState,e)},useTransition:function(){var e=Go(Ai)[0],t=yt().memoizedState;return[e,t]},useMutableSource:hf,useSyncExternalStore:pf,useId:Pf,unstable_isNewReconciler:!1};function St(e,t){if(e&&e.defaultProps){t=he({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ua(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:he({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var so={isMounted:function(e){return(e=e._reactInternals)?rn(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=We(),i=vr(e),s=Gt(n,i);s.payload=t,r!=null&&(s.callback=r),t=yr(e,s,i),t!==null&&(Nt(t,e,i,n),gs(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=We(),i=vr(e),s=Gt(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=yr(e,s,i),t!==null&&(Nt(t,e,i,n),gs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=We(),n=vr(e),i=Gt(r,n);i.tag=2,t!=null&&(i.callback=t),t=yr(e,i,n),t!==null&&(Nt(t,e,n,r),gs(t,e,n))}};function tc(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!bi(r,n)||!bi(i,s):!0}function jf(e,t,r){var n=!1,i=br,s=t.contextType;return typeof s=="object"&&s!==null?s=gt(s):(i=Ze(t)?Kr:Fe.current,n=t.contextTypes,s=(n=n!=null)?Rn(e,i):br),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function rc(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function La(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Vl(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=gt(s):(s=Ze(t)?Kr:Fe.current,i.context=Rn(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Ua(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&so.enqueueReplaceState(i,i.state,null),Vs(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function In(e,t){try{var r="",n=t;do r+=yp(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Xo(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ba(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var $m=typeof WeakMap=="function"?WeakMap:Map;function Df(e,t,r){r=Gt(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){$s||($s=!0,Za=n),Ba(e,t)},r}function If(e,t,r){r=Gt(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Ba(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ba(e,t),typeof n!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function nc(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new $m;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=i0.bind(null,e,t,r),t.then(e,e))}function ic(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function sc(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Gt(-1,1),t.tag=2,yr(r,t,1))),r.lanes|=1),e)}var Hm=Zt.ReactCurrentOwner,Ye=!1;function Be(e,t,r,n){t.child=e===null?uf(t,null,r,n):jn(t,e.child,r,n)}function oc(e,t,r,n,i){r=r.render;var s=t.ref;return _n(t,i),n=$l(e,t,r,n,s,i),r=Hl(),e!==null&&!Ye?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qt(e,t,i)):(ce&&r&&jl(t),t.flags|=1,Be(e,t,n,i),t.child)}function ac(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!tu(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Of(e,t,s,n,i)):(e=Cs(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:bi,r(o,n)&&e.ref===t.ref)return qt(e,t,i)}return t.flags|=1,e=xr(s,n),e.ref=t.ref,e.return=t,t.child=e}function Of(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(bi(s,n)&&e.ref===t.ref)if(Ye=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Ye=!0);else return t.lanes=e.lanes,qt(e,t,i)}return Wa(e,t,r,n,i)}function Mf(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},se(kn,nt),nt|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,se(kn,nt),nt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,se(kn,nt),nt|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,se(kn,nt),nt|=n;return Be(e,t,i,r),t.child}function Ff(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Wa(e,t,r,n,i){var s=Ze(r)?Kr:Fe.current;return s=Rn(t,s),_n(t,i),r=$l(e,t,r,n,s,i),n=Hl(),e!==null&&!Ye?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qt(e,t,i)):(ce&&n&&jl(t),t.flags|=1,Be(e,t,r,i),t.child)}function lc(e,t,r,n,i){if(Ze(r)){var s=!0;Is(t)}else s=!1;if(_n(t,i),t.stateNode===null)vs(e,t),jf(t,r,n),La(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=gt(c):(c=Ze(r)?Kr:Fe.current,c=Rn(t,c));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&rc(t,o,n,c),ir=!1;var g=t.memoizedState;o.state=g,Vs(t,n,o,i),l=t.memoizedState,a!==n||g!==l||qe.current||ir?(typeof d=="function"&&(Ua(t,r,d,n),l=t.memoizedState),(a=ir||tc(t,r,a,n,g,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,df(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:St(t.type,a),o.props=c,h=t.pendingProps,g=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=gt(l):(l=Ze(r)?Kr:Fe.current,l=Rn(t,l));var C=r.getDerivedStateFromProps;(d=typeof C=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||g!==l)&&rc(t,o,n,l),ir=!1,g=t.memoizedState,o.state=g,Vs(t,n,o,i);var k=t.memoizedState;a!==h||g!==k||qe.current||ir?(typeof C=="function"&&(Ua(t,r,C,n),k=t.memoizedState),(c=ir||tc(t,r,c,n,g,k,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,k,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,k,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=k),o.props=n,o.state=k,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),n=!1)}return $a(e,t,r,n,s,i)}function $a(e,t,r,n,i,s){Ff(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&Gu(t,r,!1),qt(e,t,s);n=t.stateNode,Hm.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=jn(t,e.child,null,s),t.child=jn(t,null,a,s)):Be(e,t,a,s),t.memoizedState=n.state,i&&Gu(t,r,!0),t.child}function zf(e){var t=e.stateNode;t.pendingContext?Qu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qu(e,t.context,!1),Ul(e,t.containerInfo)}function uc(e,t,r,n,i){return An(),Il(i),t.flags|=256,Be(e,t,r,n),t.child}var Ha={dehydrated:null,treeContext:null,retryLane:0};function Qa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vf(e,t,r){var n=t.pendingProps,i=de.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),se(de,i&1),e===null)return za(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=lo(o,n,0,null),e=Gr(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Qa(r),t.memoizedState=Ha,e):Xl(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Qm(e,t,o,n,a,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=xr(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=xr(a,s):(s=Gr(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?Qa(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Ha,n}return s=e.child,e=s.sibling,n=xr(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Xl(e,t){return t=lo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function as(e,t,r,n){return n!==null&&Il(n),jn(t,e.child,null,r),e=Xl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Qm(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Xo(Error(A(422))),as(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=lo({mode:"visible",children:n.children},i,0,null),s=Gr(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&jn(t,e.child,null,o),t.child.memoizedState=Qa(o),t.memoizedState=Ha,s);if(!(t.mode&1))return as(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(A(419)),n=Xo(s,n,void 0),as(e,t,o,n)}if(a=(o&e.childLanes)!==0,Ye||a){if(n=Se,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Yt(e,i),Nt(n,e,i,-1))}return eu(),n=Xo(Error(A(421))),as(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=s0.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,st=gr(i.nextSibling),ot=t,ce=!0,_t=null,e!==null&&(ft[ht++]=Ht,ft[ht++]=Qt,ft[ht++]=Yr,Ht=e.id,Qt=e.overflow,Yr=t),t=Xl(t,n.children),t.flags|=4096,t)}function cc(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Va(e.return,t,r)}function Ko(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Uf(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Be(e,t,n.children,r),n=de.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cc(e,r,t);else if(e.tag===19)cc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(se(de,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Us(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Ko(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Us(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Ko(t,!0,r,null,s);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function vs(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Zr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(A(153));if(t.child!==null){for(e=t.child,r=xr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Gm(e,t,r){switch(t.tag){case 3:zf(t),An();break;case 5:ff(t);break;case 1:Ze(t.type)&&Is(t);break;case 4:Ul(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;se(Fs,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(se(de,de.current&1),t.flags|=128,null):r&t.child.childLanes?Vf(e,t,r):(se(de,de.current&1),e=qt(e,t,r),e!==null?e.sibling:null);se(de,de.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Uf(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),se(de,de.current),n)break;return null;case 22:case 23:return t.lanes=0,Mf(e,t,r)}return qt(e,t,r)}var Lf,Ga,Bf,Wf;Lf=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ga=function(){};Bf=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Br(Ut.current);var s=null;switch(r){case"input":i=ma(e,i),n=ma(e,n),s=[];break;case"select":i=he({},i,{value:void 0}),n=he({},n,{value:void 0}),s=[];break;case"textarea":i=wa(e,i),n=wa(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=js)}xa(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(yi.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(yi.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&oe("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Wf=function(e,t,r,n){r!==n&&(t.flags|=4)};function Jn(e,t){if(!ce)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Oe(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Xm(e,t,r){var n=t.pendingProps;switch(Dl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oe(t),null;case 1:return Ze(t.type)&&Ds(),Oe(t),null;case 3:return n=t.stateNode,Dn(),ae(qe),ae(Fe),Bl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ss(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_t!==null&&(tl(_t),_t=null))),Ga(e,t),Oe(t),null;case 5:Ll(t);var i=Br(Ni.current);if(r=t.type,e!==null&&t.stateNode!=null)Bf(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(A(166));return Oe(t),null}if(e=Br(Ut.current),ss(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[zt]=t,n[_i]=s,e=(t.mode&1)!==0,r){case"dialog":oe("cancel",n),oe("close",n);break;case"iframe":case"object":case"embed":oe("load",n);break;case"video":case"audio":for(i=0;i<si.length;i++)oe(si[i],n);break;case"source":oe("error",n);break;case"img":case"image":case"link":oe("error",n),oe("load",n);break;case"details":oe("toggle",n);break;case"input":vu(n,s),oe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},oe("invalid",n);break;case"textarea":ku(n,s),oe("invalid",n)}xa(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&is(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&is(n.textContent,a,e),i=["children",""+a]):yi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&oe("scroll",n)}switch(r){case"input":Yi(n),xu(n,s,!0);break;case"textarea":Yi(n),Cu(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=js)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gd(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[zt]=t,e[_i]=n,Lf(e,t,!1,!1),t.stateNode=e;e:{switch(o=ka(r,n),r){case"dialog":oe("cancel",e),oe("close",e),i=n;break;case"iframe":case"object":case"embed":oe("load",e),i=n;break;case"video":case"audio":for(i=0;i<si.length;i++)oe(si[i],e);i=n;break;case"source":oe("error",e),i=n;break;case"img":case"image":case"link":oe("error",e),oe("load",e),i=n;break;case"details":oe("toggle",e),i=n;break;case"input":vu(e,n),i=ma(e,n),oe("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=he({},n,{value:void 0}),oe("invalid",e);break;case"textarea":ku(e,n),i=wa(e,n),oe("invalid",e);break;default:i=n}xa(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?vd(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&yd(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&wi(e,l):typeof l=="number"&&wi(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(yi.hasOwnProperty(s)?l!=null&&s==="onScroll"&&oe("scroll",e):l!=null&&wl(e,s,l,o))}switch(r){case"input":Yi(e),xu(e,n,!1);break;case"textarea":Yi(e),Cu(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Er(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?En(e,!!n.multiple,s,!1):n.defaultValue!=null&&En(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=js)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Oe(t),null;case 6:if(e&&t.stateNode!=null)Wf(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(A(166));if(r=Br(Ni.current),Br(Ut.current),ss(t)){if(n=t.stateNode,r=t.memoizedProps,n[zt]=t,(s=n.nodeValue!==r)&&(e=ot,e!==null))switch(e.tag){case 3:is(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&is(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zt]=t,t.stateNode=n}return Oe(t),null;case 13:if(ae(de),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ce&&st!==null&&t.mode&1&&!(t.flags&128))af(),An(),t.flags|=98560,s=!1;else if(s=ss(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(A(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(A(317));s[zt]=t}else An(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Oe(t),s=!1}else _t!==null&&(tl(_t),_t=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||de.current&1?Ce===0&&(Ce=3):eu())),t.updateQueue!==null&&(t.flags|=4),Oe(t),null);case 4:return Dn(),Ga(e,t),e===null&&Si(t.stateNode.containerInfo),Oe(t),null;case 10:return Fl(t.type._context),Oe(t),null;case 17:return Ze(t.type)&&Ds(),Oe(t),null;case 19:if(ae(de),s=t.memoizedState,s===null)return Oe(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Jn(s,!1);else{if(Ce!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Us(e),o!==null){for(t.flags|=128,Jn(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return se(de,de.current&1|2),t.child}e=e.sibling}s.tail!==null&&ye()>On&&(t.flags|=128,n=!0,Jn(s,!1),t.lanes=4194304)}else{if(!n)if(e=Us(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Jn(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ce)return Oe(t),null}else 2*ye()-s.renderingStartTime>On&&r!==1073741824&&(t.flags|=128,n=!0,Jn(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ye(),t.sibling=null,r=de.current,se(de,n?r&1|2:r&1),t):(Oe(t),null);case 22:case 23:return Jl(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?nt&1073741824&&(Oe(t),t.subtreeFlags&6&&(t.flags|=8192)):Oe(t),null;case 24:return null;case 25:return null}throw Error(A(156,t.tag))}function Km(e,t){switch(Dl(t),t.tag){case 1:return Ze(t.type)&&Ds(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dn(),ae(qe),ae(Fe),Bl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ll(t),null;case 13:if(ae(de),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(A(340));An()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ae(de),null;case 4:return Dn(),null;case 10:return Fl(t.type._context),null;case 22:case 23:return Jl(),null;case 24:return null;default:return null}}var ls=!1,Me=!1,Ym=typeof WeakSet=="function"?WeakSet:Set,U=null;function xn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){pe(e,t,n)}else r.current=null}function Xa(e,t,r){try{r()}catch(n){pe(e,t,n)}}var dc=!1;function qm(e,t){if(Aa=Ns,e=Gd(),Al(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=e,g=null;t:for(;;){for(var C;h!==r||i!==0&&h.nodeType!==3||(a=o+i),h!==s||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(C=h.firstChild)!==null;)g=h,h=C;for(;;){if(h===e)break t;if(g===r&&++c===i&&(a=o),g===s&&++d===n&&(l=o),(C=h.nextSibling)!==null)break;h=g,g=h.parentNode}h=C}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ja={focusedElem:e,selectionRange:r},Ns=!1,U=t;U!==null;)if(t=U,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,U=e;else for(;U!==null;){t=U;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var x=k.memoizedProps,b=k.memoizedState,p=t.stateNode,f=p.getSnapshotBeforeUpdate(t.elementType===t.type?x:St(t.type,x),b);p.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(A(163))}}catch(v){pe(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,U=e;break}U=t.return}return k=dc,dc=!1,k}function hi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xa(t,r,s)}i=i.next}while(i!==n)}}function oo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ka(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function $f(e){var t=e.alternate;t!==null&&(e.alternate=null,$f(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zt],delete t[_i],delete t[Oa],delete t[Dm],delete t[Im])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hf(e){return e.tag===5||e.tag===3||e.tag===4}function fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ya(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=js));else if(n!==4&&(e=e.child,e!==null))for(Ya(e,t,r),e=e.sibling;e!==null;)Ya(e,t,r),e=e.sibling}function qa(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(qa(e,t,r),e=e.sibling;e!==null;)qa(e,t,r),e=e.sibling}var _e=null,Tt=!1;function tr(e,t,r){for(r=r.child;r!==null;)Qf(e,t,r),r=r.sibling}function Qf(e,t,r){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(Zs,r)}catch{}switch(r.tag){case 5:Me||xn(r,t);case 6:var n=_e,i=Tt;_e=null,tr(e,t,r),_e=n,Tt=i,_e!==null&&(Tt?(e=_e,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):_e.removeChild(r.stateNode));break;case 18:_e!==null&&(Tt?(e=_e,r=r.stateNode,e.nodeType===8?Bo(e.parentNode,r):e.nodeType===1&&Bo(e,r),Ci(e)):Bo(_e,r.stateNode));break;case 4:n=_e,i=Tt,_e=r.stateNode.containerInfo,Tt=!0,tr(e,t,r),_e=n,Tt=i;break;case 0:case 11:case 14:case 15:if(!Me&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Xa(r,t,o),i=i.next}while(i!==n)}tr(e,t,r);break;case 1:if(!Me&&(xn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){pe(r,t,a)}tr(e,t,r);break;case 21:tr(e,t,r);break;case 22:r.mode&1?(Me=(n=Me)||r.memoizedState!==null,tr(e,t,r),Me=n):tr(e,t,r);break;default:tr(e,t,r)}}function hc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ym),t.forEach(function(n){var i=o0.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function bt(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:_e=a.stateNode,Tt=!1;break e;case 3:_e=a.stateNode.containerInfo,Tt=!0;break e;case 4:_e=a.stateNode.containerInfo,Tt=!0;break e}a=a.return}if(_e===null)throw Error(A(160));Qf(s,o,i),_e=null,Tt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){pe(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Gf(t,e),t=t.sibling}function Gf(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bt(t,e),Mt(e),n&4){try{hi(3,e,e.return),oo(3,e)}catch(x){pe(e,e.return,x)}try{hi(5,e,e.return)}catch(x){pe(e,e.return,x)}}break;case 1:bt(t,e),Mt(e),n&512&&r!==null&&xn(r,r.return);break;case 5:if(bt(t,e),Mt(e),n&512&&r!==null&&xn(r,r.return),e.flags&32){var i=e.stateNode;try{wi(i,"")}catch(x){pe(e,e.return,x)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&pd(i,s),ka(a,o);var c=ka(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?vd(i,h):d==="dangerouslySetInnerHTML"?yd(i,h):d==="children"?wi(i,h):wl(i,d,h,c)}switch(a){case"input":ga(i,s);break;case"textarea":md(i,s);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var C=s.value;C!=null?En(i,!!s.multiple,C,!1):g!==!!s.multiple&&(s.defaultValue!=null?En(i,!!s.multiple,s.defaultValue,!0):En(i,!!s.multiple,s.multiple?[]:"",!1))}i[_i]=s}catch(x){pe(e,e.return,x)}}break;case 6:if(bt(t,e),Mt(e),n&4){if(e.stateNode===null)throw Error(A(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(x){pe(e,e.return,x)}}break;case 3:if(bt(t,e),Mt(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ci(t.containerInfo)}catch(x){pe(e,e.return,x)}break;case 4:bt(t,e),Mt(e);break;case 13:bt(t,e),Mt(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ql=ye())),n&4&&hc(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Me=(c=Me)||d,bt(t,e),Me=c):bt(t,e),Mt(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(U=e,d=e.child;d!==null;){for(h=U=d;U!==null;){switch(g=U,C=g.child,g.tag){case 0:case 11:case 14:case 15:hi(4,g,g.return);break;case 1:xn(g,g.return);var k=g.stateNode;if(typeof k.componentWillUnmount=="function"){n=g,r=g.return;try{t=n,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(x){pe(n,r,x)}}break;case 5:xn(g,g.return);break;case 22:if(g.memoizedState!==null){mc(h);continue}}C!==null?(C.return=g,U=C):mc(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=wd("display",o))}catch(x){pe(e,e.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){pe(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bt(t,e),Mt(e),n&4&&hc(e);break;case 21:break;default:bt(t,e),Mt(e)}}function Mt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Hf(r)){var n=r;break e}r=r.return}throw Error(A(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(wi(i,""),n.flags&=-33);var s=fc(e);qa(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=fc(e);Ya(e,a,o);break;default:throw Error(A(161))}}catch(l){pe(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zm(e,t,r){U=e,Xf(e)}function Xf(e,t,r){for(var n=(e.mode&1)!==0;U!==null;){var i=U,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||ls;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Me;a=ls;var c=Me;if(ls=o,(Me=l)&&!c)for(U=i;U!==null;)o=U,l=o.child,o.tag===22&&o.memoizedState!==null?gc(i):l!==null?(l.return=o,U=l):gc(i);for(;s!==null;)U=s,Xf(s),s=s.sibling;U=i,ls=a,Me=c}pc(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,U=s):pc(e)}}function pc(e){for(;U!==null;){var t=U;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Me||oo(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Me)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:St(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Zu(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Zu(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ci(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(A(163))}Me||t.flags&512&&Ka(t)}catch(g){pe(t,t.return,g)}}if(t===e){U=null;break}if(r=t.sibling,r!==null){r.return=t.return,U=r;break}U=t.return}}function mc(e){for(;U!==null;){var t=U;if(t===e){U=null;break}var r=t.sibling;if(r!==null){r.return=t.return,U=r;break}U=t.return}}function gc(e){for(;U!==null;){var t=U;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{oo(4,t)}catch(l){pe(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){pe(t,i,l)}}var s=t.return;try{Ka(t)}catch(l){pe(t,s,l)}break;case 5:var o=t.return;try{Ka(t)}catch(l){pe(t,o,l)}}}catch(l){pe(t,t.return,l)}if(t===e){U=null;break}var a=t.sibling;if(a!==null){a.return=t.return,U=a;break}U=t.return}}var Jm=Math.ceil,Ws=Zt.ReactCurrentDispatcher,Kl=Zt.ReactCurrentOwner,mt=Zt.ReactCurrentBatchConfig,Z=0,Se=null,ve=null,Pe=0,nt=0,kn=_r(0),Ce=0,Di=null,Zr=0,ao=0,Yl=0,pi=null,Ke=null,ql=0,On=1/0,Bt=null,$s=!1,Za=null,wr=null,us=!1,ur=null,Hs=0,mi=0,Ja=null,xs=-1,ks=0;function We(){return Z&6?ye():xs!==-1?xs:xs=ye()}function vr(e){return e.mode&1?Z&2&&Pe!==0?Pe&-Pe:Mm.transition!==null?(ks===0&&(ks=Ad()),ks):(e=re,e!==0||(e=window.event,e=e===void 0?16:zd(e.type)),e):1}function Nt(e,t,r,n){if(50<mi)throw mi=0,Ja=null,Error(A(185));zi(e,r,n),(!(Z&2)||e!==Se)&&(e===Se&&(!(Z&2)&&(ao|=r),Ce===4&&or(e,Pe)),Je(e,n),r===1&&Z===0&&!(t.mode&1)&&(On=ye()+500,no&&Pr()))}function Je(e,t){var r=e.callbackNode;Mp(e,t);var n=Ps(e,e===Se?Pe:0);if(n===0)r!==null&&Su(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Su(r),t===1)e.tag===0?Om(yc.bind(null,e)):nf(yc.bind(null,e)),Am(function(){!(Z&6)&&Pr()}),r=null;else{switch(jd(n)){case 1:r=El;break;case 4:r=Nd;break;case 16:r=_s;break;case 536870912:r=Rd;break;default:r=_s}r=rh(r,Kf.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Kf(e,t){if(xs=-1,ks=0,Z&6)throw Error(A(327));var r=e.callbackNode;if(Pn()&&e.callbackNode!==r)return null;var n=Ps(e,e===Se?Pe:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Qs(e,n);else{t=n;var i=Z;Z|=2;var s=qf();(Se!==e||Pe!==t)&&(Bt=null,On=ye()+500,Qr(e,t));do try{r0();break}catch(a){Yf(e,a)}while(!0);Ml(),Ws.current=s,Z=i,ve!==null?t=0:(Se=null,Pe=0,t=Ce)}if(t!==0){if(t===2&&(i=Ta(e),i!==0&&(n=i,t=el(e,i))),t===1)throw r=Di,Qr(e,0),or(e,n),Je(e,ye()),r;if(t===6)or(e,n);else{if(i=e.current.alternate,!(n&30)&&!e0(i)&&(t=Qs(e,n),t===2&&(s=Ta(e),s!==0&&(n=s,t=el(e,s))),t===1))throw r=Di,Qr(e,0),or(e,n),Je(e,ye()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(A(345));case 2:zr(e,Ke,Bt);break;case 3:if(or(e,n),(n&130023424)===n&&(t=ql+500-ye(),10<t)){if(Ps(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){We(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ia(zr.bind(null,e,Ke,Bt),t);break}zr(e,Ke,Bt);break;case 4:if(or(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Pt(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ye()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Jm(n/1960))-n,10<n){e.timeoutHandle=Ia(zr.bind(null,e,Ke,Bt),n);break}zr(e,Ke,Bt);break;case 5:zr(e,Ke,Bt);break;default:throw Error(A(329))}}}return Je(e,ye()),e.callbackNode===r?Kf.bind(null,e):null}function el(e,t){var r=pi;return e.current.memoizedState.isDehydrated&&(Qr(e,t).flags|=256),e=Qs(e,t),e!==2&&(t=Ke,Ke=r,t!==null&&tl(t)),e}function tl(e){Ke===null?Ke=e:Ke.push.apply(Ke,e)}function e0(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Rt(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function or(e,t){for(t&=~Yl,t&=~ao,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pt(t),n=1<<r;e[r]=-1,t&=~n}}function yc(e){if(Z&6)throw Error(A(327));Pn();var t=Ps(e,0);if(!(t&1))return Je(e,ye()),null;var r=Qs(e,t);if(e.tag!==0&&r===2){var n=Ta(e);n!==0&&(t=n,r=el(e,n))}if(r===1)throw r=Di,Qr(e,0),or(e,t),Je(e,ye()),r;if(r===6)throw Error(A(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zr(e,Ke,Bt),Je(e,ye()),null}function Zl(e,t){var r=Z;Z|=1;try{return e(t)}finally{Z=r,Z===0&&(On=ye()+500,no&&Pr())}}function Jr(e){ur!==null&&ur.tag===0&&!(Z&6)&&Pn();var t=Z;Z|=1;var r=mt.transition,n=re;try{if(mt.transition=null,re=1,e)return e()}finally{re=n,mt.transition=r,Z=t,!(Z&6)&&Pr()}}function Jl(){nt=kn.current,ae(kn)}function Qr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Rm(r)),ve!==null)for(r=ve.return;r!==null;){var n=r;switch(Dl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ds();break;case 3:Dn(),ae(qe),ae(Fe),Bl();break;case 5:Ll(n);break;case 4:Dn();break;case 13:ae(de);break;case 19:ae(de);break;case 10:Fl(n.type._context);break;case 22:case 23:Jl()}r=r.return}if(Se=e,ve=e=xr(e.current,null),Pe=nt=t,Ce=0,Di=null,Yl=ao=Zr=0,Ke=pi=null,Lr!==null){for(t=0;t<Lr.length;t++)if(r=Lr[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Lr=null}return e}function Yf(e,t){do{var r=ve;try{if(Ml(),ys.current=Bs,Ls){for(var n=fe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ls=!1}if(qr=0,be=ke=fe=null,fi=!1,Ri=0,Kl.current=null,r===null||r.return===null){Ce=1,Di=t,ve=null;break}e:{var s=e,o=r.return,a=r,l=t;if(t=Pe,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var g=d.alternate;g?(d.updateQueue=g.updateQueue,d.memoizedState=g.memoizedState,d.lanes=g.lanes):(d.updateQueue=null,d.memoizedState=null)}var C=ic(o);if(C!==null){C.flags&=-257,sc(C,o,a,s,t),C.mode&1&&nc(s,c,t),t=C,l=c;var k=t.updateQueue;if(k===null){var x=new Set;x.add(l),t.updateQueue=x}else k.add(l);break e}else{if(!(t&1)){nc(s,c,t),eu();break e}l=Error(A(426))}}else if(ce&&a.mode&1){var b=ic(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),sc(b,o,a,s,t),Il(In(l,a));break e}}s=l=In(l,a),Ce!==4&&(Ce=2),pi===null?pi=[s]:pi.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var p=Df(s,l,t);qu(s,p);break e;case 1:a=l;var f=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(wr===null||!wr.has(m)))){s.flags|=65536,t&=-t,s.lanes|=t;var v=If(s,a,t);qu(s,v);break e}}s=s.return}while(s!==null)}Jf(r)}catch(w){t=w,ve===r&&r!==null&&(ve=r=r.return);continue}break}while(!0)}function qf(){var e=Ws.current;return Ws.current=Bs,e===null?Bs:e}function eu(){(Ce===0||Ce===3||Ce===2)&&(Ce=4),Se===null||!(Zr&268435455)&&!(ao&268435455)||or(Se,Pe)}function Qs(e,t){var r=Z;Z|=2;var n=qf();(Se!==e||Pe!==t)&&(Bt=null,Qr(e,t));do try{t0();break}catch(i){Yf(e,i)}while(!0);if(Ml(),Z=r,Ws.current=n,ve!==null)throw Error(A(261));return Se=null,Pe=0,Ce}function t0(){for(;ve!==null;)Zf(ve)}function r0(){for(;ve!==null&&!_p();)Zf(ve)}function Zf(e){var t=th(e.alternate,e,nt);e.memoizedProps=e.pendingProps,t===null?Jf(e):ve=t,Kl.current=null}function Jf(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Km(r,t),r!==null){r.flags&=32767,ve=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ce=6,ve=null;return}}else if(r=Xm(r,t,nt),r!==null){ve=r;return}if(t=t.sibling,t!==null){ve=t;return}ve=t=e}while(t!==null);Ce===0&&(Ce=5)}function zr(e,t,r){var n=re,i=mt.transition;try{mt.transition=null,re=1,n0(e,t,r,n)}finally{mt.transition=i,re=n}return null}function n0(e,t,r,n){do Pn();while(ur!==null);if(Z&6)throw Error(A(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(A(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Fp(e,s),e===Se&&(ve=Se=null,Pe=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||us||(us=!0,rh(_s,function(){return Pn(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=mt.transition,mt.transition=null;var o=re;re=1;var a=Z;Z|=4,Kl.current=null,qm(e,r),Gf(r,e),Em(ja),Ns=!!Aa,ja=Aa=null,e.current=r,Zm(r),Pp(),Z=a,re=o,mt.transition=s}else e.current=r;if(us&&(us=!1,ur=e,Hs=i),s=e.pendingLanes,s===0&&(wr=null),Ap(r.stateNode),Je(e,ye()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if($s)throw $s=!1,e=Za,Za=null,e;return Hs&1&&e.tag!==0&&Pn(),s=e.pendingLanes,s&1?e===Ja?mi++:(mi=0,Ja=e):mi=0,Pr(),null}function Pn(){if(ur!==null){var e=jd(Hs),t=mt.transition,r=re;try{if(mt.transition=null,re=16>e?16:e,ur===null)var n=!1;else{if(e=ur,ur=null,Hs=0,Z&6)throw Error(A(331));var i=Z;for(Z|=4,U=e.current;U!==null;){var s=U,o=s.child;if(U.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(U=c;U!==null;){var d=U;switch(d.tag){case 0:case 11:case 15:hi(8,d,s)}var h=d.child;if(h!==null)h.return=d,U=h;else for(;U!==null;){d=U;var g=d.sibling,C=d.return;if($f(d),d===c){U=null;break}if(g!==null){g.return=C,U=g;break}U=C}}}var k=s.alternate;if(k!==null){var x=k.child;if(x!==null){k.child=null;do{var b=x.sibling;x.sibling=null,x=b}while(x!==null)}}U=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,U=o;else e:for(;U!==null;){if(s=U,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hi(9,s,s.return)}var p=s.sibling;if(p!==null){p.return=s.return,U=p;break e}U=s.return}}var f=e.current;for(U=f;U!==null;){o=U;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,U=m;else e:for(o=f;U!==null;){if(a=U,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:oo(9,a)}}catch(w){pe(a,a.return,w)}if(a===o){U=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,U=v;break e}U=a.return}}if(Z=i,Pr(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(Zs,e)}catch{}n=!0}return n}finally{re=r,mt.transition=t}}return!1}function wc(e,t,r){t=In(r,t),t=Df(e,t,1),e=yr(e,t,1),t=We(),e!==null&&(zi(e,1,t),Je(e,t))}function pe(e,t,r){if(e.tag===3)wc(e,e,r);else for(;t!==null;){if(t.tag===3){wc(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(wr===null||!wr.has(n))){e=In(r,e),e=If(t,e,1),t=yr(t,e,1),e=We(),t!==null&&(zi(t,1,e),Je(t,e));break}}t=t.return}}function i0(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=We(),e.pingedLanes|=e.suspendedLanes&r,Se===e&&(Pe&r)===r&&(Ce===4||Ce===3&&(Pe&130023424)===Pe&&500>ye()-ql?Qr(e,0):Yl|=r),Je(e,t)}function eh(e,t){t===0&&(e.mode&1?(t=Ji,Ji<<=1,!(Ji&130023424)&&(Ji=4194304)):t=1);var r=We();e=Yt(e,t),e!==null&&(zi(e,t,r),Je(e,r))}function s0(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),eh(e,r)}function o0(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(A(314))}n!==null&&n.delete(t),eh(e,r)}var th;th=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||qe.current)Ye=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ye=!1,Gm(e,t,r);Ye=!!(e.flags&131072)}else Ye=!1,ce&&t.flags&1048576&&sf(t,Ms,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;vs(e,t),e=t.pendingProps;var i=Rn(t,Fe.current);_n(t,r),i=$l(null,t,n,e,i,r);var s=Hl();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ze(n)?(s=!0,Is(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Vl(t),i.updater=so,t.stateNode=i,i._reactInternals=t,La(t,n,e,r),t=$a(null,t,n,!0,s,r)):(t.tag=0,ce&&s&&jl(t),Be(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(vs(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=l0(n),e=St(n,e),i){case 0:t=Wa(null,t,n,e,r);break e;case 1:t=lc(null,t,n,e,r);break e;case 11:t=oc(null,t,n,e,r);break e;case 14:t=ac(null,t,n,St(n.type,e),r);break e}throw Error(A(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:St(n,i),Wa(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:St(n,i),lc(e,t,n,i,r);case 3:e:{if(zf(t),e===null)throw Error(A(387));n=t.pendingProps,s=t.memoizedState,i=s.element,df(e,t),Vs(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=In(Error(A(423)),t),t=uc(e,t,n,r,i);break e}else if(n!==i){i=In(Error(A(424)),t),t=uc(e,t,n,r,i);break e}else for(st=gr(t.stateNode.containerInfo.firstChild),ot=t,ce=!0,_t=null,r=uf(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(An(),n===i){t=qt(e,t,r);break e}Be(e,t,n,r)}t=t.child}return t;case 5:return ff(t),e===null&&za(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Da(n,i)?o=null:s!==null&&Da(n,s)&&(t.flags|=32),Ff(e,t),Be(e,t,o,r),t.child;case 6:return e===null&&za(t),null;case 13:return Vf(e,t,r);case 4:return Ul(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=jn(t,null,n,r):Be(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:St(n,i),oc(e,t,n,i,r);case 7:return Be(e,t,t.pendingProps,r),t.child;case 8:return Be(e,t,t.pendingProps.children,r),t.child;case 12:return Be(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,se(Fs,n._currentValue),n._currentValue=o,s!==null)if(Rt(s.value,o)){if(s.children===i.children&&!qe.current){t=qt(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Gt(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Va(s.return,r,t),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(A(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Va(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Be(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,_n(t,r),i=gt(i),n=n(i),t.flags|=1,Be(e,t,n,r),t.child;case 14:return n=t.type,i=St(n,t.pendingProps),i=St(n.type,i),ac(e,t,n,i,r);case 15:return Of(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:St(n,i),vs(e,t),t.tag=1,Ze(n)?(e=!0,Is(t)):e=!1,_n(t,r),jf(t,n,i),La(t,n,i,r),$a(null,t,n,!0,e,r);case 19:return Uf(e,t,r);case 22:return Mf(e,t,r)}throw Error(A(156,t.tag))};function rh(e,t){return Pd(e,t)}function a0(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(e,t,r,n){return new a0(e,t,r,n)}function tu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function l0(e){if(typeof e=="function")return tu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xl)return 11;if(e===kl)return 14}return 2}function xr(e,t){var r=e.alternate;return r===null?(r=pt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cs(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")tu(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case dn:return Gr(r.children,i,s,t);case vl:o=8,i|=8;break;case da:return e=pt(12,r,t,i|2),e.elementType=da,e.lanes=s,e;case fa:return e=pt(13,r,t,i),e.elementType=fa,e.lanes=s,e;case ha:return e=pt(19,r,t,i),e.elementType=ha,e.lanes=s,e;case dd:return lo(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ud:o=10;break e;case cd:o=9;break e;case xl:o=11;break e;case kl:o=14;break e;case nr:o=16,n=null;break e}throw Error(A(130,e==null?e:typeof e,""))}return t=pt(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Gr(e,t,r,n){return e=pt(7,e,n,t),e.lanes=r,e}function lo(e,t,r,n){return e=pt(22,e,n,t),e.elementType=dd,e.lanes=r,e.stateNode={isHidden:!1},e}function Yo(e,t,r){return e=pt(6,e,null,t),e.lanes=r,e}function qo(e,t,r){return t=pt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function u0(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ao(0),this.expirationTimes=Ao(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ao(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ru(e,t,r,n,i,s,o,a,l){return e=new u0(e,t,r,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=pt(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vl(s),e}function c0(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function nh(e){if(!e)return br;e=e._reactInternals;e:{if(rn(e)!==e||e.tag!==1)throw Error(A(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ze(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(A(171))}if(e.tag===1){var r=e.type;if(Ze(r))return rf(e,r,t)}return t}function ih(e,t,r,n,i,s,o,a,l){return e=ru(r,n,!0,e,i,s,o,a,l),e.context=nh(null),r=e.current,n=We(),i=vr(r),s=Gt(n,i),s.callback=t??null,yr(r,s,i),e.current.lanes=i,zi(e,i,n),Je(e,n),e}function uo(e,t,r,n){var i=t.current,s=We(),o=vr(i);return r=nh(r),t.context===null?t.context=r:t.pendingContext=r,t=Gt(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=yr(i,t,o),e!==null&&(Nt(e,i,o,s),gs(e,i,o)),o}function Gs(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function vc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function nu(e,t){vc(e,t),(e=e.alternate)&&vc(e,t)}function d0(){return null}var sh=typeof reportError=="function"?reportError:function(e){console.error(e)};function iu(e){this._internalRoot=e}co.prototype.render=iu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(A(409));uo(e,t,null,null)};co.prototype.unmount=iu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Jr(function(){uo(null,e,null,null)}),t[Kt]=null}};function co(e){this._internalRoot=e}co.prototype.unstable_scheduleHydration=function(e){if(e){var t=Od();e={blockedOn:null,target:e,priority:t};for(var r=0;r<sr.length&&t!==0&&t<sr[r].priority;r++);sr.splice(r,0,e),r===0&&Fd(e)}};function su(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xc(){}function f0(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Gs(o);s.call(c)}}var o=ih(t,n,e,0,null,!1,!1,"",xc);return e._reactRootContainer=o,e[Kt]=o.current,Si(e.nodeType===8?e.parentNode:e),Jr(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var c=Gs(l);a.call(c)}}var l=ru(e,0,!1,null,null,!1,!1,"",xc);return e._reactRootContainer=l,e[Kt]=l.current,Si(e.nodeType===8?e.parentNode:e),Jr(function(){uo(t,l,r,n)}),l}function ho(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Gs(o);a.call(l)}}uo(t,o,e,i)}else o=f0(r,t,e,i,n);return Gs(o)}Dd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ii(t.pendingLanes);r!==0&&(bl(t,r|1),Je(t,ye()),!(Z&6)&&(On=ye()+500,Pr()))}break;case 13:Jr(function(){var n=Yt(e,1);if(n!==null){var i=We();Nt(n,e,1,i)}}),nu(e,1)}};Sl=function(e){if(e.tag===13){var t=Yt(e,134217728);if(t!==null){var r=We();Nt(t,e,134217728,r)}nu(e,134217728)}};Id=function(e){if(e.tag===13){var t=vr(e),r=Yt(e,t);if(r!==null){var n=We();Nt(r,e,t,n)}nu(e,t)}};Od=function(){return re};Md=function(e,t){var r=re;try{return re=e,t()}finally{re=r}};Ea=function(e,t,r){switch(t){case"input":if(ga(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=ro(n);if(!i)throw Error(A(90));hd(n),ga(n,i)}}}break;case"textarea":md(e,r);break;case"select":t=r.value,t!=null&&En(e,!!r.multiple,t,!1)}};Cd=Zl;Ed=Jr;var h0={usingClientEntryPoint:!1,Events:[Ui,mn,ro,xd,kd,Zl]},ei={findFiberByHostInstance:Ur,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},p0={bundleType:ei.bundleType,version:ei.version,rendererPackageName:ei.rendererPackageName,rendererConfig:ei.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Td(e),e===null?null:e.stateNode},findFiberByHostInstance:ei.findFiberByHostInstance||d0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cs.isDisabled&&cs.supportsFiber)try{Zs=cs.inject(p0),Vt=cs}catch{}}lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h0;lt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!su(t))throw Error(A(200));return c0(e,t,null,r)};lt.createRoot=function(e,t){if(!su(e))throw Error(A(299));var r=!1,n="",i=sh;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=ru(e,1,!1,null,null,r,!1,n,i),e[Kt]=t.current,Si(e.nodeType===8?e.parentNode:e),new iu(t)};lt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(A(188)):(e=Object.keys(e).join(","),Error(A(268,e)));return e=Td(t),e=e===null?null:e.stateNode,e};lt.flushSync=function(e){return Jr(e)};lt.hydrate=function(e,t,r){if(!fo(t))throw Error(A(200));return ho(null,e,t,!0,r)};lt.hydrateRoot=function(e,t,r){if(!su(e))throw Error(A(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=sh;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ih(t,null,e,1,r??null,i,!1,s,o),e[Kt]=t.current,Si(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new co(t)};lt.render=function(e,t,r){if(!fo(t))throw Error(A(200));return ho(null,e,t,!1,r)};lt.unmountComponentAtNode=function(e){if(!fo(e))throw Error(A(40));return e._reactRootContainer?(Jr(function(){ho(null,null,e,!1,function(){e._reactRootContainer=null,e[Kt]=null})}),!0):!1};lt.unstable_batchedUpdates=Zl;lt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!fo(r))throw Error(A(200));if(e==null||e._reactInternals===void 0)throw Error(A(38));return ho(e,t,r,!1,n)};lt.version="18.3.1-next-f1338f8080-20240426";function oh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oh)}catch(e){console.error(e)}}oh(),sd.exports=lt;var m0=sd.exports,ah,kc=m0;ah=kc.createRoot,kc.hydrateRoot;function rl(e){const t=[/(?:youtube\.com\/watch\?v=)([^&\s]+)/,/(?:youtu\.be\/)([^?\s]+)/,/(?:youtube\.com\/embed\/)([^?\s]+)/];for(const r of t){const n=e.match(r);if(n)return n[1]}return null}const lh="boxing-recent-video-urls",uh=5;function nl(){try{const e=localStorage.getItem(lh);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t.slice(0,uh):[]}catch{return[]}}function g0(e){const t=e.trim();if(!t)return;const n=nl().filter(s=>s!==t),i=[t,...n].slice(0,uh);try{localStorage.setItem(lh,JSON.stringify(i))}catch{}}const Ii="boxing-saved-videos";function Cc(e){const t=rl(e);return t?`https://www.youtube.com/watch?v=${t}`:e}function y0(e){return Array.isArray(e)?e.map(t=>{const r=t;return r.versions&&Array.isArray(r.versions)?t:{id:r.id??crypto.randomUUID(),youtubeUrl:r.youtubeUrl??"",versions:[{id:crypto.randomUUID(),name:r.name??"Untitled",annotations:r.annotations??[],savedAt:Date.now()}]}}):[]}function kr(){try{const e=localStorage.getItem(Ii);if(!e)return[];const t=JSON.parse(e),r=Array.isArray(t)?t:[];return y0(r)}catch{return[]}}function ch(e){return[...e.versions].sort((r,n)=>n.savedAt-r.savedAt)[0]}function Zo(e){const t=ch(e),r=t.name.replace(/\.\d+$/,"").trim()||t.name,n=e.versions;let i=0;for(const o of n){const a=o.name.match(/\.(\d+)$/);a&&(i=Math.max(i,parseInt(a[1],10)))}const s=i+1;return{baseName:r,nextName:`${r}.${s}`}}function w0(e){const t=Cc(e.youtubeUrl),r=kr(),n=r.find(o=>Cc(o.youtubeUrl)===t),i={id:crypto.randomUUID(),name:e.name,annotations:e.annotations,savedAt:Date.now()};if(n){n.versions.unshift(i),n.youtubeUrl=e.youtubeUrl;try{localStorage.setItem(Ii,JSON.stringify(r))}catch{throw new Error("Failed to save video")}return n}const s={id:crypto.randomUUID(),youtubeUrl:e.youtubeUrl,versions:[i]};r.unshift(s);try{localStorage.setItem(Ii,JSON.stringify(r))}catch{throw new Error("Failed to save video")}return s}function dh(e){const t=kr().filter(r=>r.id!==e);try{localStorage.setItem(Ii,JSON.stringify(t))}catch{}}function v0(e,t){const r=kr(),n=r.find(i=>i.id===e);if(n)if(n.versions=n.versions.filter(i=>i.id!==t),n.versions.length===0)dh(e);else try{localStorage.setItem(Ii,JSON.stringify(r))}catch{}}function x0({onVideoLoaded:e}){const[t,r]=y.useState("file"),[n,i]=y.useState(""),[s,o]=y.useState(""),[a,l]=y.useState([]),[c,d]=y.useState(kr()),[h,g]=y.useState(null),C=y.useRef(null);y.useEffect(()=>{l(nl())},[]);const k=()=>d(kr()),x=(w,S)=>{const T=rl(w.youtubeUrl);T&&e({type:"youtube",videoId:T,url:w.youtubeUrl},{annotations:S.annotations,autoPlay:!0,savedVideoId:w.id})},b=(w,S)=>{w.stopPropagation(),dh(S),k()},p=(w,S,T)=>{w.stopPropagation(),v0(S,T),k()},f=w=>{const S=new Date(w),T=new Date;return S.toDateString()===T.toDateString()?S.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):S.toLocaleDateString()},m=w=>{var j;const S=(j=w.target.files)==null?void 0:j[0];if(!S)return;if(!S.type.startsWith("video/")){o("Please select a video file (mp4, webm, etc.)");return}o("");const T=URL.createObjectURL(S);e({type:"file",url:T,file:S})},v=w=>{w.preventDefault();const S=n.trim(),T=rl(S);if(!T){o("Invalid YouTube URL. Use formats like: youtube.com/watch?v=... or youtu.be/...");return}o(""),g0(S),l(nl()),e({type:"youtube",videoId:T,url:S},{autoPlay:!0})};return u.jsxs("div",{className:"max-w-2xl mx-auto p-8",children:[u.jsx("h2",{className:"font-display text-4xl text-center mb-2 tracking-wider text-white",children:"LOAD VIDEO"}),u.jsx("p",{className:"text-slate-400 text-center mb-8",children:"Import a video file or paste a YouTube link to get started"}),u.jsxs("div",{className:"flex gap-2 mb-6",children:[u.jsx("button",{type:"button",onClick:()=>{r("file"),o("")},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all ${t==="file"?"bg-ring text-white":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:"Upload File"}),u.jsx("button",{type:"button",onClick:()=>{r("url"),o("")},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all ${t==="url"?"bg-ring text-white":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:"YouTube URL"})]}),t==="file"?u.jsxs("div",{onClick:()=>{var w;return(w=C.current)==null?void 0:w.click()},className:"border-2 border-dashed border-slate-500 rounded-xl p-12 text-center cursor-pointer hover:border-accent hover:bg-slate-800/30 transition-all",children:[u.jsx("input",{ref:C,type:"file",accept:"video/*",onChange:m,className:"hidden"}),u.jsx("div",{className:"text-5xl mb-4",children:""}),u.jsx("p",{className:"text-slate-300 mb-1",children:"Click to select a video file"}),u.jsx("p",{className:"text-slate-500 text-sm",children:"MP4, WebM, MOV supported"})]}):u.jsxs("form",{onSubmit:v,className:"space-y-4",children:[u.jsx("input",{type:"url",value:n,onChange:w=>i(w.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"w-full px-4 py-3 rounded-lg bg-slate-800 border border-slate-600 text-white placeholder-slate-500 focus:outline-none focus:border-accent"}),u.jsx("button",{type:"submit",className:"w-full py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Load Video"})]}),t==="url"&&a.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-slate-500 text-sm mb-2",children:"Recent videos"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(w=>u.jsx("button",{type:"button",onClick:()=>{i(w),o("")},className:"px-3 py-1.5 rounded-lg bg-slate-700/80 text-slate-300 hover:bg-slate-600 hover:text-white text-sm truncate max-w-[320px]",title:w,children:w.length>50?`${w.slice(0,47)}...`:w},w))})]}),s&&u.jsx("p",{className:"mt-4 text-red-400 text-sm text-center",children:s}),c.length>0&&u.jsxs("div",{className:"mt-10 pt-8 border-t border-slate-700",children:[u.jsx("h3",{className:"font-display text-xl text-slate-300 mb-3 tracking-wider",children:"SAVED VIDEOS"}),u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:c.map(w=>{const S=ch(w),T=h===w.id,j=w.versions.length>1;return u.jsxs("div",{className:"rounded-lg bg-slate-800/80 border border-slate-600 overflow-hidden",children:[u.jsxs("div",{role:"button",tabIndex:0,onClick:()=>x(w,S),onKeyDown:F=>F.key==="Enter"&&x(w,S),className:"flex items-center justify-between gap-3 p-3 hover:bg-slate-700/80 cursor-pointer transition-all group",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-slate-200 font-medium truncate",children:S.name}),u.jsx("p",{className:"text-slate-500 text-xs truncate mt-0.5",children:w.youtubeUrl}),u.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:[S.annotations.length," annotation",S.annotations.length!==1?"s":"",j&&u.jsxs("span",{className:"ml-2",children:[" ",w.versions.length," version",w.versions.length!==1?"s":""]})]})]}),w.versions.length>0&&u.jsx("button",{type:"button",onClick:F=>{F.stopPropagation(),g(T?null:w.id)},className:"p-1.5 rounded text-slate-400 hover:text-slate-200 hover:bg-slate-600",title:T?"Collapse versions":"Show versions",children:u.jsx("svg",{className:`w-5 h-5 transition-transform ${T?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),u.jsx("button",{type:"button",onClick:F=>b(F,w.id),className:"p-1.5 rounded text-slate-400 hover:text-red-400 hover:bg-slate-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete saved video",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),T&&u.jsx("div",{className:"border-t border-slate-600 bg-slate-900/50",children:w.versions.map(F=>u.jsxs("div",{role:"button",tabIndex:0,onClick:()=>x(w,F),onKeyDown:W=>W.key==="Enter"&&x(w,F),className:"flex items-center justify-between gap-3 px-3 py-2 hover:bg-slate-700/50 cursor-pointer border-b border-slate-700/50 last:border-b-0 group/version",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-slate-300 text-sm truncate",children:F.name}),u.jsxs("p",{className:"text-slate-500 text-xs mt-0.5",children:[F.annotations.length," annotations  ",f(F.savedAt)]})]}),u.jsx("button",{type:"button",onClick:W=>p(W,w.id,F.id),className:"p-1.5 rounded text-slate-400 hover:text-red-400 hover:bg-slate-600 opacity-0 group-hover/version:opacity-100 transition-opacity flex-shrink-0",title:"Delete this version",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},F.id))})]},w.id)})})]})]})}function Ec(e){if(!isFinite(e)||isNaN(e))return"0:00";const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`}function k0({currentTime:e,duration:t,isPlaying:r,onPlayPause:n,onSeek:i,isYouTube:s,isMuted:o,onUnmute:a,playbackRate:l=1,onPlaybackRateChange:c}){const[d,h]=y.useState(String(l)),[g,C]=y.useState(!1);y.useEffect(()=>{g||h(String(l))},[l,g]);const k=m=>Math.max(.25,Math.min(4,Math.round(m*100)/100)),x=m=>{const v=k(m);c==null||c(v),h(String(v))},b=m=>{h(m.target.value)},p=()=>{C(!1);const m=parseFloat(d);Number.isNaN(m)?h(String(l)):x(m)},f=m=>{m.key==="Enter"&&m.target.blur()};return u.jsxs("div",{className:"flex flex-col gap-3 p-3 bg-slate-900/95 rounded-b-lg",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:n,className:"w-10 h-10 rounded-full bg-ring flex items-center justify-center hover:bg-red-600 transition-colors",children:r?u.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),u.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):u.jsx("svg",{className:"w-5 h-5 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}),s&&o&&a&&u.jsx("button",{type:"button",onClick:a,className:"p-2 rounded-lg bg-slate-700/80 text-slate-400 hover:text-white hover:bg-slate-600 transition-colors",title:"Unmute",children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})})}),u.jsx("span",{className:"text-slate-400 text-sm tabular-nums",children:Ec(e)}),u.jsx("div",{className:"flex-1 relative group",children:u.jsx("input",{type:"range",min:0,max:t||100,step:.1,value:e,onChange:m=>i(Number(m.target.value)),className:"w-full h-2 rounded-full appearance-none bg-slate-700 cursor-pointer accent-ring"})}),u.jsx("span",{className:"text-slate-400 text-sm tabular-nums",children:Ec(t)})]}),c&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-slate-400 text-sm shrink-0",children:"Speed"}),u.jsx("input",{type:"range",min:.25,max:4,step:.05,value:l,onChange:m=>x(Number(m.target.value)),className:"flex-1 min-w-0 h-2 rounded-full appearance-none bg-slate-700 cursor-pointer accent-ring"}),u.jsx("input",{type:"number",min:.25,max:4,step:.05,value:d,onChange:b,onFocus:()=>C(!0),onBlur:p,onKeyDown:f,className:"w-16 px-2 py-1 text-sm rounded bg-slate-700 text-slate-200 border border-slate-600 focus:border-ring focus:outline-none focus:ring-1 focus:ring-ring tabular-nums"}),u.jsx("span",{className:"text-slate-500 text-sm shrink-0",children:""})]})]})}const C0=15;function fh(e,t,r,n,i,s){const o=i-r,a=s-n,l=Math.hypot(o,a);if(l===0)return Math.hypot(e-r,t-n);const c=Math.max(0,Math.min(1,((e-r)*o+(t-n)*a)/(l*l))),d=r+c*o,h=n+c*a;return Math.hypot(e-d,t-h)}function E0(e,t,r){let n=1/0;for(let i=0;i<r.length-1;i++){const s=fh(e,t,r[i].x,r[i].y,r[i+1].x,r[i+1].y);n=Math.min(n,s)}return n}function b0(e,t,r,n,i){var c;if(t.type==="clear"||r<t.startTime||r>t.endTime)return!1;const{x:s,y:o}=e,a=Math.min(n,i)||1,l=(C0+t.strokeWidth)/a;if(t.type==="arrow"&&t.points.length>=2){const[d,h]=t.points;return fh(s,o,d.x,d.y,h.x,h.y)<=l}if(t.type==="circle"&&t.points.length>=2){const[d,h]=t.points,g=Math.hypot(h.x-d.x,h.y-d.y),C=Math.hypot(s-d.x,o-d.y);return Math.abs(C-g)<=l||C<=g+l}if(t.type==="rectangle"&&t.points.length>=2){const[d,h]=t.points,g=Math.min(d.x,h.x)-l,C=Math.max(d.x,h.x)+l,k=Math.min(d.y,h.y)-l,x=Math.max(d.y,h.y)+l;return s>=g&&s<=C&&o>=k&&o<=x}if(t.type==="draw"&&t.points.length>=2)return E0(s,o,t.points)<=l;if(t.type==="text"&&t.points.length>=1){const d=t.points[0],h=(((c=t.text)==null?void 0:c.length)??0)*(t.strokeWidth*3)/n,g=t.strokeWidth*5/i;return s>=d.x-l&&s<=d.x+h+l&&o>=d.y-g&&o<=d.y+l}return!1}function S0(e,t,r,n,i){const s={x:e.x/(n||1),y:e.y/(i||1)};for(let o=t.length-1;o>=0;o--)if(b0(s,t[o],r,n,i))return t[o];return null}function hh(e,t){let r=-1;for(let n=0;n<e.length;n++){const i=e[n];i.type==="clear"&&t>=i.startTime&&(r=n)}return e.filter((n,i)=>n.type==="clear"||i<=r?!1:t>=n.startTime&&t<=n.endTime)}function ph(e,t,r){return t<=0||r<=0?e:{x:e.x/t,y:e.y/r}}function T0(e,t,r){return{x:e.x*t,y:e.y*r}}function _0(e){for(const t of e.points)if(t.x>1||t.y>1)return!0;return!1}const P0=640,N0=360;function R0(e,t,r){if(e.type==="clear"||e.points.length===0)return e;const n=P0,i=N0,s=_0(e);return{...e,points:e.points.map(o=>s?ph(o,n,i):o)}}function A0(e,t,r){return e.map(n=>R0(n))}function j0({width:e,height:t,annotations:r,currentTime:n,activeTool:i,color:s,strokeWidth:o,onAnnotationAdd:a,onAnnotationDelete:l,isDrawing:c,onDrawingChange:d,className:h=""}){const g=y.useRef(null),[C,k]=y.useState(null),[x,b]=y.useState([]),[p,f]=y.useState(null),m=y.useCallback(I=>{const R=g.current;if(!R)return{x:0,y:0};const z=R.getBoundingClientRect(),O=R.width/R.height,$=z.width/z.height;let B,ie,D,H;$>O?(H=z.height,D=z.height*O,B=z.left+(z.width-D)/2,ie=z.top):(D=z.width,H=z.width/O,B=z.left,ie=z.top+(z.height-H)/2);const G=R.width/D,ne=R.height/H;return{x:(I.clientX-B)*G,y:(I.clientY-ie)*ne}},[]),v=y.useMemo(()=>hh(r,n),[r,n]),w=y.useCallback((I,R,z=1)=>{if(R.type==="clear"||n<R.startTime||n>R.endTime)return;I.strokeStyle=R.color,I.fillStyle=R.color,I.lineWidth=R.strokeWidth,I.globalAlpha=z;const O=$=>T0($,e,t);if(R.type==="arrow"){if(R.points.length>=2){const[$,B]=R.points.map(O);I.beginPath(),I.moveTo($.x,$.y),I.lineTo(B.x,B.y);const ie=Math.atan2(B.y-$.y,B.x-$.x),D=15;I.moveTo(B.x,B.y),I.lineTo(B.x-D*Math.cos(ie-.4),B.y-D*Math.sin(ie-.4)),I.moveTo(B.x,B.y),I.lineTo(B.x-D*Math.cos(ie+.4),B.y-D*Math.sin(ie+.4)),I.stroke()}}else if(R.type==="circle"){if(R.points.length>=2){const[$,B]=R.points.map(O),ie=Math.hypot(B.x-$.x,B.y-$.y);I.beginPath(),I.arc($.x,$.y,ie,0,Math.PI*2),I.stroke()}}else if(R.type==="rectangle"){if(R.points.length>=2){const[$,B]=R.points.map(O);I.strokeRect(Math.min($.x,B.x),Math.min($.y,B.y),Math.abs(B.x-$.x),Math.abs(B.y-$.y))}}else if(R.type==="draw"&&R.points.length>=2){const $=R.points.map(O);I.beginPath(),I.moveTo($[0].x,$[0].y);for(let B=1;B<$.length;B++)I.lineTo($[B].x,$[B].y);I.stroke()}else if(R.type==="text"&&R.text){I.font=`${R.strokeWidth*4}px sans-serif`;const $=O(R.points[0]);I.fillText(R.text,$.x,$.y)}I.globalAlpha=1},[n,e,t]);y.useEffect(()=>{const I=g.current;if(!I||e<=0||t<=0)return;const R=I.getContext("2d");if(R&&(R.clearRect(0,0,e,t),v.forEach(z=>w(R,z)),c&&x.length>0)){if(R.strokeStyle=s,R.lineWidth=o,i==="arrow"&&x.length>=2){const[z,O]=x;R.beginPath(),R.moveTo(z.x,z.y),R.lineTo(O.x,O.y);const $=Math.atan2(O.y-z.y,O.x-z.x),B=15;R.moveTo(O.x,O.y),R.lineTo(O.x-B*Math.cos($-.4),O.y-B*Math.sin($-.4)),R.moveTo(O.x,O.y),R.lineTo(O.x-B*Math.cos($+.4),O.y-B*Math.sin($+.4)),R.stroke()}else if(i==="circle"&&x.length>=2){const[z,O]=x,$=Math.hypot(O.x-z.x,O.y-z.y);R.beginPath(),R.arc(z.x,z.y,$,0,Math.PI*2),R.stroke()}else if(i==="rectangle"&&x.length>=2){const[z,O]=x;R.strokeRect(Math.min(z.x,O.x),Math.min(z.y,O.y),Math.abs(O.x-z.x),Math.abs(O.y-z.y))}else if(i==="draw"&&x.length>=2){R.beginPath(),R.moveTo(x[0].x,x[0].y);for(let z=1;z<x.length;z++)R.lineTo(x[z].x,x[z].y);R.stroke()}}},[v,n,c,x,i,s,o,e,t,w]);const S=y.useCallback((I,R)=>{if(I.length===0)return;const z=60,O=I.map(B=>ph(B,e,t)),$={id:crypto.randomUUID(),type:i,points:O,startTime:n,endTime:n+z,color:s,strokeWidth:o,text:R};a($),k(null),b([]),f(null),d(!1)},[i,s,o,n,a,d,e,t]),T=I=>{const R=m(I);if(i==="eraser"){const z=S0(R,v,n,e,t);z&&l(z.id);return}if(i==="text"){f({point:R,visible:!0});return}I.target.setPointerCapture(I.pointerId),k(R),b([R]),d(!0)},j=I=>{if(!c||!C)return;const R=m(I);b(i==="draw"?z=>[...z,R]:[C,R])},F=I=>{try{I.target.releasePointerCapture(I.pointerId)}catch{}i!=="text"&&C&&x.length>0&&S(x)},W=I=>{p&&I.trim()&&S([p.point],I.trim()),f(null)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`absolute inset-0 z-[100] ${h}`,style:{pointerEvents:"auto",touchAction:"none"},children:u.jsx("canvas",{ref:g,width:e,height:t,onPointerDown:T,onPointerMove:j,onPointerUp:F,onPointerCancel:F,className:`absolute inset-0 w-full h-full block ${i==="eraser"?"cursor-cell":"cursor-crosshair"}`,style:{pointerEvents:"auto",touchAction:"none"}})}),(p==null?void 0:p.visible)&&u.jsx("div",{className:"absolute z-[110] bg-slate-800 border border-slate-600 rounded p-2 shadow-xl",style:{left:p.point.x+10,top:p.point.y},children:u.jsx("input",{type:"text",autoFocus:!0,placeholder:"Enter text...",className:"bg-transparent text-white outline-none w-48",onKeyDown:I=>{I.key==="Enter"&&W(I.target.value),I.key==="Escape"&&f(null)},onBlur:I=>{const R=I.target.value;R?W(R):f(null)}})})]})}const D0=[{type:"arrow",label:"Arrow",icon:""},{type:"circle",label:"Circle",icon:""},{type:"rectangle",label:"Rectangle",icon:""},{type:"draw",label:"Draw",icon:""},{type:"text",label:"Text",icon:"T"},{type:"eraser",label:"Eraser",icon:""}],I0=["#e63946","#f4a261","#2a9d8f","#264653","#e9c46a","#ffffff"];function O0({activeTool:e,onToolChange:t,color:r,onColorChange:n,strokeWidth:i,onStrokeWidthChange:s,onClearAll:o,onUndo:a,onRedo:l,canUndo:c,canRedo:d}){return u.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-3 bg-slate-900/90 rounded-lg border border-slate-700",children:[u.jsxs("div",{className:"flex gap-1 items-center",children:[u.jsx("button",{type:"button",onClick:a,disabled:!c,title:"Undo (Ctrl+Z)",className:"w-10 h-10 rounded flex items-center justify-center text-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white",children:""}),u.jsx("button",{type:"button",onClick:l,disabled:!d,title:"Redo (Ctrl+Shift+Z)",className:"w-10 h-10 rounded flex items-center justify-center text-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white",children:""}),u.jsx("span",{className:"w-px h-6 bg-slate-600 mx-1"}),D0.map(h=>u.jsx("button",{type:"button",onClick:()=>t(h.type),title:h.label,className:`w-10 h-10 rounded flex items-center justify-center text-lg transition-all ${e===h.type?"bg-ring text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white"}`,children:h.icon},h.type))]}),e!=="eraser"&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Color:"}),I0.map(h=>u.jsx("button",{type:"button",onClick:()=>n(h),className:`w-6 h-6 rounded-full border-2 transition-transform ${r===h?"border-white scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:h}},h))]}),e!=="eraser"&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Size:"}),u.jsx("input",{type:"range",min:1,max:8,value:i,onChange:h=>s(Number(h.target.value)),className:"w-24 accent-ring"}),u.jsxs("span",{className:"text-slate-400 text-xs",children:[i,"px"]})]}),u.jsx("button",{type:"button",onClick:o,className:"px-3 py-1.5 rounded bg-slate-700 text-slate-400 hover:bg-red-900/50 hover:text-red-400 text-sm",children:"Clear All"})]})}function Jo(e){const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`}function M0({annotations:e,onUpdate:t,onDelete:r}){return u.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.length===0?u.jsx("p",{className:"text-slate-500 text-sm py-4",children:"No annotations yet. Use the tools above to add some."}):e.map(n=>n.type==="clear"?u.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-slate-800/80 border border-slate-600 border-dashed",children:[u.jsx("div",{className:"w-4 h-4 rounded flex-shrink-0 bg-slate-600 flex items-center justify-center text-slate-400 text-xs",children:""}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Clear screen"}),u.jsx("div",{className:"text-slate-500 text-xs mt-1",children:Jo(n.startTime)})]}),u.jsx("button",{type:"button",onClick:()=>r(n.id),className:"text-red-400 hover:text-red-300 text-sm",children:""})]},n.id):u.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-slate-800/80 border border-slate-700",children:[u.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-slate-300 text-sm capitalize",children:n.type}),u.jsxs("div",{className:"flex gap-2 items-center mt-1",children:[u.jsxs("span",{className:"text-slate-500 text-xs",children:[Jo(n.startTime),"  ",Jo(n.endTime)]}),u.jsx("input",{type:"number",min:1,max:600,value:Math.round(n.endTime-n.startTime),onChange:i=>{const s=Number(i.target.value);s>0&&t(n.id,{endTime:n.startTime+s})},className:"w-14 px-1 py-0.5 text-xs bg-slate-700 rounded text-white"}),u.jsx("span",{className:"text-slate-500 text-xs",children:"sec"})]})]}),u.jsx("button",{type:"button",onClick:()=>r(n.id),className:"text-red-400 hover:text-red-300 text-sm",children:""})]},n.id))})}const F0=y.forwardRef(function({videoId:t,onTimeUpdate:r,onStateChange:n,isPaused:i,seekTo:s,playbackRate:o=1,className:a=""},l){const c=y.useRef(null),d=y.useRef(null),h=y.useRef(null),[g,C]=y.useState(!1),k=y.useRef(null),x=y.useRef(!1),b=y.useRef(0),p=y.useRef(r),f=y.useRef(n);p.current=r,f.current=n??(()=>{}),y.useEffect(()=>{C(!1),k.current=null,x.current=!1,b.current=0},[t]);const m=y.useCallback(()=>{var v,w;!c.current||!((v=window.YT)!=null&&v.Player)||(C(!1),(w=d.current)!=null&&w.destroy&&d.current.destroy(),d.current=null,h.current&&clearInterval(h.current),new window.YT.Player(c.current,{height:"100%",width:"100%",videoId:t,playerVars:{autoplay:1,controls:0,disablekb:0,fs:1,modestbranding:1,rel:0,enablejsapi:1,iv_load_policy:3,playsinline:1,mute:1},events:{onReady:S=>{d.current=S.target,h.current=window.setInterval(()=>{if(d.current){const T=d.current.getCurrentTime(),j=d.current.getDuration();p.current(T,j)}},50),C(!0)},onStateChange:S=>{const T=S.data,j=T===1||T===3,F=f.current;F&&F(j),j?(x.current=!1,b.current=0):x.current&&(T===-1||T===2)&&b.current<5&&(b.current+=1,setTimeout(()=>{d.current&&x.current&&d.current.playVideo()},100*b.current))}}}))},[t]);return y.useEffect(()=>{var v;return(v=window.YT)!=null&&v.Player?m():window.onYouTubeIframeAPIReady=m,()=>{h.current&&clearInterval(h.current),d.current=null}},[t,m]),y.useEffect(()=>{!g&&i!==void 0&&(k.current=!i)},[i,g]),y.useEffect(()=>{if(!g)return;const v=d.current;if(!v)return;const w=k.current??(i!==void 0&&!i);k.current!==null&&(k.current=null),w?(x.current=!0,b.current=0,v.playVideo()):i&&v.pauseVideo()},[g]),y.useEffect(()=>{if(!g)return;const v=d.current;!v||i===void 0||(i?(x.current=!1,b.current=0,v.pauseVideo()):(x.current=!0,b.current=0,v.playVideo()))},[i,g]),y.useEffect(()=>{const v=d.current;!v||s==null||v.seekTo(s)},[s]),y.useEffect(()=>{var w;const v=d.current;!v||!g||(w=v.setPlaybackRate)==null||w.call(v,o)},[g,o]),y.useImperativeHandle(l,()=>({play:()=>{x.current=!0,b.current=0;const v=d.current;v?v.playVideo():k.current=!0},pause:()=>{x.current=!1,b.current=0;const v=d.current;v?v.pauseVideo():k.current=!1},isReady:()=>g,unMute:()=>{const v=d.current;v!=null&&v.unMute&&v.unMute()},isMuted:()=>{const v=d.current;return v!=null&&v.isMuted?v.isMuted():!0},setPlaybackRate:v=>{var w,S;return(S=(w=d.current)==null?void 0:w.setPlaybackRate)==null?void 0:S.call(w,v)}}),[g]),u.jsxs("div",{className:`relative w-full h-full ${a}`,style:{pointerEvents:"none"},children:[u.jsx("div",{ref:c,className:"w-full h-full min-h-[200px]",style:{pointerEvents:"none"}}),!g&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/90 z-[1]",style:{pointerEvents:"none"},children:u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 border-2 border-ring border-t-transparent rounded-full animate-spin"}),u.jsx("span",{className:"text-slate-400 text-sm",children:"Loading YouTube player..."})]})})]})});function z0(e,t,r,n){if(t.type==="clear")return;const i=Math.min(r,n)/400;e.strokeStyle=t.color,e.fillStyle=t.color,e.lineWidth=t.strokeWidth*i;const s=o=>({x:o.x*r,y:o.y*n});if(t.type==="arrow"&&t.points.length>=2){const[o,a]=t.points.map(s);e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(a.x,a.y);const l=Math.atan2(a.y-o.y,a.x-o.x),c=15*i;e.moveTo(a.x,a.y),e.lineTo(a.x-c*Math.cos(l-.4),a.y-c*Math.sin(l-.4)),e.moveTo(a.x,a.y),e.lineTo(a.x-c*Math.cos(l+.4),a.y-c*Math.sin(l+.4)),e.stroke()}else if(t.type==="circle"&&t.points.length>=2){const[o,a]=t.points.map(s),l=Math.hypot(a.x-o.x,a.y-o.y);e.beginPath(),e.arc(o.x,o.y,l,0,Math.PI*2),e.stroke()}else if(t.type==="rectangle"&&t.points.length>=2){const[o,a]=t.points.map(s);e.strokeRect(Math.min(o.x,a.x),Math.min(o.y,a.y),Math.abs(a.x-o.x),Math.abs(a.y-o.y))}else if(t.type==="draw"&&t.points.length>=2){const o=t.points.map(s);e.beginPath(),e.moveTo(o[0].x,o[0].y);for(let a=1;a<o.length;a++)e.lineTo(o[a].x,o[a].y);e.stroke()}else if(t.type==="text"&&t.text){e.font=`${t.strokeWidth*4*i}px sans-serif`;const o=s(t.points[0]);e.fillText(t.text,o.x,o.y)}}const ea=50;function V0(e=[]){const[t,r]=y.useState([e]),[n,i]=y.useState(0),s=t[n]??[],o=y.useCallback(C=>{r(k=>{const b=[...k.slice(0,n+1),C];return b.length>ea?b.slice(-ea):b}),i(k=>Math.min(k+1,ea-1))},[n]),a=y.useCallback(C=>{const k=typeof C=="function"?C(s):C;o(k)},[s,o]),l=y.useCallback(()=>{i(C=>C>0?C-1:C)},[]),c=y.useCallback(()=>{i(C=>C<t.length-1?C+1:C)},[t.length]),d=n>0,h=n<t.length-1,g=y.useCallback((C=[])=>{r([C]),i(0)},[]);return{annotations:s,setAnnotations:a,undo:l,redo:c,canUndo:d,canRedo:h,pushState:o,reset:g}}function U0(e){const[t,r]=y.useState({width:640,height:360});return y.useEffect(()=>{const n=e.current;if(!n)return;const i=new ResizeObserver(s=>{for(const o of s){const{width:a,height:l}=o.contentRect;a>0&&l>0&&r({width:a,height:l})}});return i.observe(n),r({width:n.clientWidth,height:n.clientHeight}),()=>i.disconnect()},[e]),t}const L0=y.forwardRef(function({initialRecordingBlob:t,onRecordingConsumed:r},n){const[i,s]=y.useState(null),[o,a]=y.useState(0),[l,c]=y.useState(0),[d,h]=y.useState(!1),[g,C]=y.useState(null),[k,x]=y.useState(1),{annotations:b,setAnnotations:p,undo:f,redo:m,canUndo:v,canRedo:w,reset:S}=V0([]),[T,j]=y.useState("arrow"),[F,W]=y.useState("#e63946"),[I,R]=y.useState(3),[z,O]=y.useState(!1),[$,B]=y.useState(!1),[,ie]=y.useState(!1),[D,H]=y.useState(!0),[G,ne]=y.useState(!1),[q,wt]=y.useState(!1),[me,Qe]=y.useState(!1),[ge,J]=y.useState(""),[et,Re]=y.useState(!1),[vt,xt]=y.useState(!1),Te=y.useRef(null),jt=y.useRef(null),Nr=y.useRef(null),Jt=y.useRef(null),Un=y.useRef(null),Ae=y.useRef(null),Rr=y.useRef(null),Ar=y.useRef(null),Ln=y.useRef(null),Bn=U0(Ar),le=y.useRef(!1),Dt=y.useRef(null),ze=y.useRef(null),xe=y.useRef(null);Dt.current=(i==null?void 0:i.type)??null,y.useEffect(()=>{if(!t||t.size===0)return;const E=URL.createObjectURL(t);xe.current=E,s({type:"file",url:E}),r==null||r()},[t]),y.useEffect(()=>{i===null&&xe.current&&(URL.revokeObjectURL(xe.current),xe.current=null)},[i]);const jr=y.useCallback(()=>{var N,V;const E=Ln.current;E&&(le.current=Dt.current==="file"?!!(Ae.current&&!Ae.current.paused):Dt.current==="youtube"?d:!1,(V=(N=E.requestFullscreen)==null?void 0:N.call(E))==null||V.catch(()=>{}))},[d]),It=y.useCallback(()=>{var E,N;document.fullscreenElement&&(le.current=Dt.current==="file"?!!(Ae.current&&!Ae.current.paused):Dt.current==="youtube"?d:!1,(N=(E=document.exitFullscreen)==null?void 0:E.call(document))==null||N.catch(()=>{}))},[d]),Wn=y.useCallback(()=>{var N;if(!le.current)return;const E=Dt.current;if(E==="file"){const V=Ae.current;if(V!=null&&V.paused){const L=V.play();L!=null&&L.catch&&L.catch(()=>{requestAnimationFrame(()=>{V.paused&&le.current&&V.play()})})}}else E==="youtube"&&((N=Rr.current)==null||N.play())},[]);y.useEffect(()=>{const E=()=>{const N=!!document.fullscreenElement;ne(N),ze.current&&(clearTimeout(ze.current),ze.current=null),setTimeout(Wn,50)};return document.addEventListener("fullscreenchange",E),()=>document.removeEventListener("fullscreenchange",E)},[Wn]);const Ot=y.useCallback(()=>{if((i==null?void 0:i.type)==="youtube"){const E=Rr.current;if(E)d?(E.pause(),h(!1),le.current=!1):(E.play(),h(!0),le.current=!0);else{const N=!d;h(N),le.current=N}}else{const E=Ae.current;if(!E)return;E.paused?(E.play(),le.current=!0):(E.pause(),le.current=!1)}},[i==null?void 0:i.type,d]),sn=y.useCallback(E=>{var N,V;if(x(E),(i==null?void 0:i.type)==="file"){const L=Ae.current;L&&(L.playbackRate=E)}else(i==null?void 0:i.type)==="youtube"&&((V=(N=Rr.current)==null?void 0:N.setPlaybackRate)==null||V.call(N,E))},[i==null?void 0:i.type]),yo=y.useCallback(E=>{if((i==null?void 0:i.type)==="youtube")C(E);else{const N=Ae.current;N&&(N.currentTime=E)}a(E)},[i==null?void 0:i.type]);y.useEffect(()=>{const E=Ae.current;!E||(i==null?void 0:i.type)!=="file"||(E.playbackRate=k)},[i==null?void 0:i.type,k]),y.useEffect(()=>{const E=Ae.current;if(!E||(i==null?void 0:i.type)!=="file")return;const N=()=>a(E.currentTime),V=()=>c(E.duration),L=()=>{h(!0),le.current=!0,ze.current&&(clearTimeout(ze.current),ze.current=null)},we=()=>{h(!1),ze.current=window.setTimeout(()=>{ze.current=null,le.current=!1},150)};return E.addEventListener("timeupdate",N),E.addEventListener("durationchange",V),E.addEventListener("play",L),E.addEventListener("pause",we),()=>{E.removeEventListener("timeupdate",N),E.removeEventListener("durationchange",V),E.removeEventListener("play",L),E.removeEventListener("pause",we),ze.current&&clearTimeout(ze.current)}},[i==null?void 0:i.type]);const wo=y.useCallback(E=>{p(N=>[...N,E])},[p]),vo=y.useCallback((E,N)=>{p(V=>V.map(L=>L.id===E?{...L,...N}:L))},[p]),Bi=y.useCallback(E=>{p(N=>N.filter(V=>V.id!==E))},[p]),xo=y.useCallback(()=>{const E={id:crypto.randomUUID(),type:"clear",points:[],startTime:o,endTime:o,color:"#000000",strokeWidth:1};p(N=>[...N,E])},[p,o]);y.useEffect(()=>{const E=N=>{(N.ctrlKey||N.metaKey)&&(N.key==="z"?(N.preventDefault(),N.shiftKey?m():f()):N.key==="y"&&(N.preventDefault(),m()))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[f,m]),y.useEffect(()=>{i||S([]),ie(!1),H(!0)},[i,S]),y.useEffect(()=>{q&&(h(!0),le.current=!0,wt(!1))},[q]);const ko=y.useCallback((E,N)=>{var V;if(xe.current&&(URL.revokeObjectURL(xe.current),xe.current=null),s(E),(V=N==null?void 0:N.annotations)!=null&&V.length){const L=A0(N.annotations);S(L),Nr.current=N.annotations}else Nr.current=null;Jt.current=(N==null?void 0:N.savedVideoId)??null,wt(!!(N!=null&&N.autoPlay))},[S]),on=y.useCallback(()=>{const E=Nr.current;if(E===null||b.length!==E.length)return!1;const N=L=>`${L.startTime}-${L.id}`,V=L=>[...L].sort((we,Ee)=>N(we).localeCompare(N(Ee)));return JSON.stringify(V(b))===JSON.stringify(V(E))},[b]),ct=b.length>0&&((i==null?void 0:i.type)==="youtube"||(i==null?void 0:i.type)==="file"&&i.youtubeUrl),Wi=y.useCallback(()=>{if(!ct)return;const E=Jt.current;if(E){const V=kr().find(L=>L.id===E);if(V){const{baseName:L}=Zo(V);J(L)}else J("My Annotated Video")}else J("My Annotated Video");Qe(!0)},[ct]);y.useEffect(()=>{if(me){const E=setTimeout(()=>{const N=Un.current;N&&(N.focus(),N.select())},0);return()=>clearTimeout(E)}},[me]);const kt=y.useCallback(()=>{Qe(!1),J(""),xt(!1)},[]),Dr=y.useCallback(()=>{var E,N;Re(!1),(E=jt.current)==null||E.call(jt),jt.current=null,(N=Te.current)==null||N.call(Te,!0),Te.current=null},[]),$i=y.useCallback(()=>{var E;Re(!1),jt.current=null,(E=Te.current)==null||E.call(Te,!1),Te.current=null},[]),$n=y.useCallback(()=>{if(!ct){s(null);return}jt.current=()=>s(null),Te.current=null,Re(!0)},[ct]);y.useImperativeHandle(n,()=>({confirmLeave:()=>ct?new Promise(E=>{Te.current=E,jt.current=null,Re(!0)}):Promise.resolve(!0)}),[ct]);const Co=y.useCallback(()=>{const E=Jt.current;if(E){const V=kr().find(L=>L.id===E);if(V){const{baseName:L}=Zo(V);J(L)}else J("My Annotated Video")}else J("My Annotated Video");Qe(!0),xt(!0),Re(!1)},[]),Hi=y.useCallback(()=>{Dr()},[Dr]),P=y.useCallback(()=>{if(!ct||!i)return;if(on()){kt(),vt&&Dr();return}const E=i.type==="youtube"?i.url:i.youtubeUrl;if(!E)return;let N;const V=Jt.current;if(V){const we=kr().find(Ee=>Ee.id===V);if(we){const{nextName:Ee}=Zo(we);N=Ee}else N=ge.trim()||"My Annotated Video"}else N=ge.trim();if(N)try{const L=w0({name:N,youtubeUrl:E,annotations:b});Nr.current=b,Jt.current=L.id,kt(),vt&&Dr()}catch{window.alert("Failed to save video.")}},[ct,i,b,ge,kt,vt,Dr,on]),M=y.useCallback(async()=>{if(!(!Ar.current||(i==null?void 0:i.type)!=="file")){B(!0);try{const E=Ae.current;if(!E)throw new Error("No video");const N=document.createElement("canvas");N.width=E.videoWidth,N.height=E.videoHeight;const V=N.getContext("2d");if(!V)throw new Error("No canvas context");const L=N.captureStream(30),we=new MediaRecorder(L,{mimeType:"video/webm;codecs=vp9"}),Ee=[];we.ondataavailable=tt=>tt.data.size&&Ee.push(tt.data),we.onstop=()=>{const tt=new Blob(Ee,{type:"video/webm"}),je=URL.createObjectURL(tt),dt=document.createElement("a");dt.href=je,dt.download=`boxing-annotated-${Date.now()}.webm`,dt.click(),URL.revokeObjectURL(je),B(!1)},we.start(100),E.currentTime=0,await E.play();const Ct=()=>{if(E.ended||E.paused){we.stop();return}V.drawImage(E,0,0);const tt=E.videoWidth,je=E.videoHeight;hh(b,E.currentTime).forEach(Lt=>{z0(V,Lt,tt,je)}),requestAnimationFrame(Ct)};Ct()}catch(E){console.error(E),B(!1)}}},[i==null?void 0:i.type,b]);return i?u.jsx("div",{className:"min-h-screen p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"BOXING VIDEO ANALYZER"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{type:"button",onClick:$n,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Back to home",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Home"]}),u.jsxs("button",{type:"button",onClick:jr,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Fullscreen annotation mode",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),"Fullscreen"]}),u.jsx("button",{type:"button",onClick:$n,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"New Video"}),ct&&u.jsxs("button",{type:"button",onClick:Wi,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Save video with annotations",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save"]}),i.type==="file"&&u.jsx("button",{type:"button",onClick:M,disabled:$,className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 disabled:opacity-50",children:$?"Exporting...":"Download Annotated Video"})]})]}),u.jsxs("div",{ref:Ln,className:"fullscreen-annotator grid grid-cols-1 lg:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"fullscreen-video-area lg:col-span-3 space-y-4",children:[u.jsxs("div",{ref:Ar,className:"relative aspect-video bg-black rounded-t-lg overflow-hidden fullscreen-video-container",children:[i.type==="file"?u.jsx(u.Fragment,{children:u.jsx("video",{ref:Ae,src:i.url,className:"w-full h-full object-contain pointer-events-none",playsInline:!0,preload:"auto",onError:()=>ie(!0),onLoadedData:()=>ie(!1)})}):u.jsx("div",{className:"absolute inset-0 pointer-events-none youtube-embed-root",children:u.jsx(F0,{ref:Rr,videoId:i.videoId,onTimeUpdate:(E,N)=>{a(E),c(N)},onStateChange:h,isPaused:!d,seekTo:g,className:"absolute inset-0"},i.videoId)}),u.jsx(j0,{width:Bn.width,height:Bn.height,annotations:b,currentTime:o,activeTool:T,color:F,strokeWidth:I,onAnnotationAdd:wo,onAnnotationDelete:Bi,isDrawing:z,onDrawingChange:O})]}),u.jsxs("div",{className:"fullscreen-controls-overlay flex flex-col gap-0 rounded-b-lg",children:[u.jsx(k0,{currentTime:o,duration:l,isPlaying:d,onPlayPause:Ot,onSeek:yo,playbackRate:k,onPlaybackRateChange:sn,isYouTube:i.type==="youtube",isMuted:i.type==="youtube"&&D,onUnmute:i.type==="youtube"?()=>{var E,N;(N=(E=Rr.current)==null?void 0:E.unMute)==null||N.call(E),H(!1)}:void 0}),u.jsx(O0,{activeTool:T,onToolChange:j,color:F,onColorChange:W,strokeWidth:I,onStrokeWidthChange:R,onClearAll:xo,onUndo:f,onRedo:m,canUndo:v,canRedo:w})]})]}),u.jsxs("div",{className:"fullscreen-annotations-panel space-y-2",children:[u.jsx("h3",{className:"font-display text-xl text-slate-300",children:"Annotations"}),u.jsx(M0,{annotations:b,onUpdate:vo,onDelete:Bi})]}),G&&u.jsx("div",{className:"fixed top-4 left-4 z-[200] flex gap-2",children:u.jsx("button",{type:"button",onClick:It,className:"p-2 rounded-lg bg-slate-800/95 border border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white transition-colors",title:"Exit fullscreen (Esc)",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),et&&u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60",onClick:$i,children:u.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-xl p-6 w-full max-w-md shadow-xl",onClick:E=>E.stopPropagation(),children:[u.jsx("h3",{className:"font-display text-xl text-white mb-2",children:"Save before leaving?"}),u.jsx("p",{className:"text-slate-400 text-sm mb-6",children:"You have unsaved annotations. Would you like to save this video before leaving?"}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{type:"button",onClick:$i,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Cancel"}),u.jsx("button",{type:"button",onClick:Hi,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Don't Save"}),u.jsx("button",{type:"button",onClick:Co,className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400",children:"Save"})]})]})}),me&&u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60",onClick:kt,children:u.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-xl p-6 w-full max-w-md shadow-xl",onClick:E=>E.stopPropagation(),children:[u.jsx("h3",{className:"font-display text-xl text-white mb-4",children:"Save Video"}),u.jsx("label",{className:"block text-slate-400 text-sm mb-2",children:"Name"}),u.jsx("input",{ref:Un,type:"text",value:ge,onChange:E=>J(E.target.value),onKeyDown:E=>{E.key==="Enter"&&P(),E.key==="Escape"&&kt()},placeholder:"My Annotated Video",className:"w-full px-4 py-3 rounded-lg bg-slate-900 border border-slate-600 text-white placeholder-slate-500 focus:outline-none focus:border-accent mb-4"}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{type:"button",onClick:kt,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Cancel"}),u.jsx("button",{type:"button",onClick:P,disabled:!ge.trim(),className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]})]})})]})]})}):u.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-8",children:[u.jsx("h1",{className:"font-display text-6xl tracking-widest text-white mb-4",children:"BOXING VIDEO ANALYZER"}),u.jsx(x0,{onVideoLoaded:ko})]})});/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */function Q(e){if(!e)throw new Error("Assertion failed.")}const B0=e=>{const t=(e%360+360)%360;if(t===0||t===90||t===180||t===270)return t;throw new Error(`Invalid rotation ${e}.`)},oi=e=>e&&e[e.length-1];class Vn{constructor(t){this.bytes=t,this.pos=0}seekToByte(t){this.pos=8*t}readBit(){const t=Math.floor(this.pos/8),r=this.bytes[t]??0,n=7-(this.pos&7),i=(r&1<<n)>>n;return this.pos++,i}readBits(t){if(t===1)return this.readBit();let r=0;for(let n=0;n<t;n++)r<<=1,r|=this.readBit();return r}writeBits(t,r){const n=this.pos+t;for(let i=this.pos;i<n;i++){const s=Math.floor(i/8);let o=this.bytes[s];const a=7-(i&7);o&=~(1<<a),o|=(r&1<<n-i-1)>>n-i-1<<a,this.bytes[s]=o}this.pos=n}readAlignedByte(){if(this.pos%8!==0)throw new Error("Bitstream is not byte-aligned.");const t=this.pos/8,r=this.bytes[t]??0;return this.pos+=8,r}skipBits(t){this.pos+=t}getBitsLeft(){return this.bytes.length*8-this.pos}clone(){const t=new Vn(this.bytes);return t.pos=this.pos,t}}const W0=(e,t,r,n)=>{for(let i=t;i<r;i++){const s=Math.floor(i/8);let o=e[s];const a=7-(i&7);o&=~(1<<a),o|=(n&1<<r-i-1)>>r-i-1<<a,e[s]=o}},Xr=e=>e.constructor===Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),cr=e=>e.constructor===DataView?e:ArrayBuffer.isView(e)?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(e),Es=new TextEncoder,mh={bt709:1,bt470bg:5,smpte170m:6,bt2020:9,smpte432:12},gh={bt709:1,smpte170m:6,linear:8,"iec61966-2-1":13,pq:16,hlg:18},yh={rgb:0,bt709:1,bt470bg:5,smpte170m:6,"bt2020-ncl":9},$0=e=>!!e&&!!e.primaries&&!!e.transfer&&!!e.matrix&&e.fullRange!==void 0,po=e=>e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer||ArrayBuffer.isView(e);class wh{constructor(){this.currentPromise=Promise.resolve(),this.pending=0}async acquire(){let t;const r=new Promise(i=>{let s=!1;t=()=>{s||(i(),this.pending--,s=!0)}}),n=this.currentPromise;return this.currentPromise=r,this.pending++,await n,t}}const vh=()=>{let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}},mo=e=>{throw new Error(`Unexpected value: ${e}`)},xh=(e,t,r,n)=>{r=r>>>0,r=r&16777215,n?(e.setUint8(t,r&255),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,r>>>16&255)):(e.setUint8(t,r>>>16&255),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,r&255))},H0=(e,t,r,n)=>{r=Xe(r,-8388608,8388607),r<0&&(r=r+16777216&16777215),xh(e,t,r,n)},Xe=(e,t,r)=>Math.max(t,Math.min(r,e)),Q0="und",bc=(e,t)=>Math.round(e/t)*t,G0=/^[a-z]{3}$/,X0=e=>G0.test(e),dr=1e6*(1+Number.EPSILON);class kh{constructor(){this.currentPromise=Promise.resolve()}call(t){return this.currentPromise=this.currentPromise.then(t)}}let ta=null;const K0=()=>{var e;return ta!==null?ta:ta=!!(typeof navigator<"u"&&((e=navigator.vendor)!=null&&e.match(/apple/i)||/AppleWebKit/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)||/\b(iPad|iPhone|iPod)\b/.test(navigator.userAgent)))};let ra=null;const Xs=()=>{var e;return ra!==null?ra:ra=typeof navigator<"u"&&((e=navigator.userAgent)==null?void 0:e.includes("Firefox"))},Y0=function*(e){for(const t in e){const r=e[t];r!==void 0&&(yield{key:t,value:r})}},q0=e=>{switch(e.toLowerCase()){case"image/jpeg":case"image/jpg":return".jpg";case"image/png":return".png";case"image/gif":return".gif";case"image/webp":return".webp";case"image/bmp":return".bmp";case"image/svg+xml":return".svg";case"image/tiff":return".tiff";case"image/avif":return".avif";case"image/x-icon":case"image/vnd.microsoft.icon":return".ico";default:return null}},Z0=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},J0=()=>{Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose"))};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class eg{constructor(t,r){if(this.data=t,this.mimeType=r,!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(typeof r!="string")throw new TypeError("mimeType must be a string.")}}class Ch{constructor(t,r,n,i){if(this.data=t,this.mimeType=r,this.name=n,this.description=i,!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(r!==void 0&&typeof r!="string")throw new TypeError("mimeType, when provided, must be a string.");if(n!==void 0&&typeof n!="string")throw new TypeError("name, when provided, must be a string.");if(i!==void 0&&typeof i!="string")throw new TypeError("description, when provided, must be a string.")}}const tg=e=>{if(!e||typeof e!="object")throw new TypeError("tags must be an object.");if(e.title!==void 0&&typeof e.title!="string")throw new TypeError("tags.title, when provided, must be a string.");if(e.description!==void 0&&typeof e.description!="string")throw new TypeError("tags.description, when provided, must be a string.");if(e.artist!==void 0&&typeof e.artist!="string")throw new TypeError("tags.artist, when provided, must be a string.");if(e.album!==void 0&&typeof e.album!="string")throw new TypeError("tags.album, when provided, must be a string.");if(e.albumArtist!==void 0&&typeof e.albumArtist!="string")throw new TypeError("tags.albumArtist, when provided, must be a string.");if(e.trackNumber!==void 0&&(!Number.isInteger(e.trackNumber)||e.trackNumber<=0))throw new TypeError("tags.trackNumber, when provided, must be a positive integer.");if(e.tracksTotal!==void 0&&(!Number.isInteger(e.tracksTotal)||e.tracksTotal<=0))throw new TypeError("tags.tracksTotal, when provided, must be a positive integer.");if(e.discNumber!==void 0&&(!Number.isInteger(e.discNumber)||e.discNumber<=0))throw new TypeError("tags.discNumber, when provided, must be a positive integer.");if(e.discsTotal!==void 0&&(!Number.isInteger(e.discsTotal)||e.discsTotal<=0))throw new TypeError("tags.discsTotal, when provided, must be a positive integer.");if(e.genre!==void 0&&typeof e.genre!="string")throw new TypeError("tags.genre, when provided, must be a string.");if(e.date!==void 0&&(!(e.date instanceof Date)||Number.isNaN(e.date.getTime())))throw new TypeError("tags.date, when provided, must be a valid Date.");if(e.lyrics!==void 0&&typeof e.lyrics!="string")throw new TypeError("tags.lyrics, when provided, must be a string.");if(e.images!==void 0){if(!Array.isArray(e.images))throw new TypeError("tags.images, when provided, must be an array.");for(const t of e.images){if(!t||typeof t!="object")throw new TypeError("Each image in tags.images must be an object.");if(!(t.data instanceof Uint8Array))throw new TypeError("Each image.data must be a Uint8Array.");if(typeof t.mimeType!="string")throw new TypeError("Each image.mimeType must be a string.");if(!["coverFront","coverBack","unknown"].includes(t.kind))throw new TypeError("Each image.kind must be 'coverFront', 'coverBack', or 'unknown'.")}}if(e.comment!==void 0&&typeof e.comment!="string")throw new TypeError("tags.comment, when provided, must be a string.");if(e.raw!==void 0){if(!e.raw||typeof e.raw!="object")throw new TypeError("tags.raw, when provided, must be an object.");for(const t of Object.values(e.raw))if(t!==null&&typeof t!="string"&&!(t instanceof Uint8Array)&&!(t instanceof eg)&&!(t instanceof Ch))throw new TypeError("Each value in tags.raw must be a string, Uint8Array, RichImageData, AttachedFile, or null.")}},rg=e=>{if(!e||typeof e!="object")throw new TypeError("disposition must be an object.");if(e.default!==void 0&&typeof e.default!="boolean")throw new TypeError("disposition.default must be a boolean.");if(e.forced!==void 0&&typeof e.forced!="boolean")throw new TypeError("disposition.forced must be a boolean.");if(e.original!==void 0&&typeof e.original!="boolean")throw new TypeError("disposition.original must be a boolean.");if(e.commentary!==void 0&&typeof e.commentary!="boolean")throw new TypeError("disposition.commentary must be a boolean.");if(e.hearingImpaired!==void 0&&typeof e.hearingImpaired!="boolean")throw new TypeError("disposition.hearingImpaired must be a boolean.");if(e.visuallyImpaired!==void 0&&typeof e.visuallyImpaired!="boolean")throw new TypeError("disposition.visuallyImpaired must be a boolean.")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Sr=["avc","hevc","vp9","av1","vp8"],At=["pcm-s16","pcm-s16be","pcm-s24","pcm-s24be","pcm-s32","pcm-s32be","pcm-f32","pcm-f32be","pcm-f64","pcm-f64be","pcm-u8","pcm-s8","ulaw","alaw"],Eh=["aac","opus","mp3","vorbis","flac","ac3","eac3"],en=[...Eh,...At],Oi=["webvtt"],Sc=[{maxMacroblocks:99,maxBitrate:64e3,maxDpbMbs:396,level:10},{maxMacroblocks:396,maxBitrate:192e3,maxDpbMbs:900,level:11},{maxMacroblocks:396,maxBitrate:384e3,maxDpbMbs:2376,level:12},{maxMacroblocks:396,maxBitrate:768e3,maxDpbMbs:2376,level:13},{maxMacroblocks:396,maxBitrate:2e6,maxDpbMbs:2376,level:20},{maxMacroblocks:792,maxBitrate:4e6,maxDpbMbs:4752,level:21},{maxMacroblocks:1620,maxBitrate:4e6,maxDpbMbs:8100,level:22},{maxMacroblocks:1620,maxBitrate:1e7,maxDpbMbs:8100,level:30},{maxMacroblocks:3600,maxBitrate:14e6,maxDpbMbs:18e3,level:31},{maxMacroblocks:5120,maxBitrate:2e7,maxDpbMbs:20480,level:32},{maxMacroblocks:8192,maxBitrate:2e7,maxDpbMbs:32768,level:40},{maxMacroblocks:8192,maxBitrate:5e7,maxDpbMbs:32768,level:41},{maxMacroblocks:8704,maxBitrate:5e7,maxDpbMbs:34816,level:42},{maxMacroblocks:22080,maxBitrate:135e6,maxDpbMbs:110400,level:50},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:51},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:52},{maxMacroblocks:139264,maxBitrate:24e7,maxDpbMbs:696320,level:60},{maxMacroblocks:139264,maxBitrate:48e7,maxDpbMbs:696320,level:61},{maxMacroblocks:139264,maxBitrate:8e8,maxDpbMbs:696320,level:62}],Tc=[{maxPictureSize:36864,maxBitrate:128e3,tier:"L",level:30},{maxPictureSize:122880,maxBitrate:15e5,tier:"L",level:60},{maxPictureSize:245760,maxBitrate:3e6,tier:"L",level:63},{maxPictureSize:552960,maxBitrate:6e6,tier:"L",level:90},{maxPictureSize:983040,maxBitrate:1e7,tier:"L",level:93},{maxPictureSize:2228224,maxBitrate:12e6,tier:"L",level:120},{maxPictureSize:2228224,maxBitrate:3e7,tier:"H",level:120},{maxPictureSize:2228224,maxBitrate:2e7,tier:"L",level:123},{maxPictureSize:2228224,maxBitrate:5e7,tier:"H",level:123},{maxPictureSize:8912896,maxBitrate:25e6,tier:"L",level:150},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:150},{maxPictureSize:8912896,maxBitrate:4e7,tier:"L",level:153},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:153},{maxPictureSize:8912896,maxBitrate:6e7,tier:"L",level:156},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:156},{maxPictureSize:35651584,maxBitrate:6e7,tier:"L",level:180},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:180},{maxPictureSize:35651584,maxBitrate:12e7,tier:"L",level:183},{maxPictureSize:35651584,maxBitrate:48e7,tier:"H",level:183},{maxPictureSize:35651584,maxBitrate:24e7,tier:"L",level:186},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:186}],_c=[{maxPictureSize:36864,maxBitrate:2e5,level:10},{maxPictureSize:73728,maxBitrate:8e5,level:11},{maxPictureSize:122880,maxBitrate:18e5,level:20},{maxPictureSize:245760,maxBitrate:36e5,level:21},{maxPictureSize:552960,maxBitrate:72e5,level:30},{maxPictureSize:983040,maxBitrate:12e6,level:31},{maxPictureSize:2228224,maxBitrate:18e6,level:40},{maxPictureSize:2228224,maxBitrate:3e7,level:41},{maxPictureSize:8912896,maxBitrate:6e7,level:50},{maxPictureSize:8912896,maxBitrate:12e7,level:51},{maxPictureSize:8912896,maxBitrate:18e7,level:52},{maxPictureSize:35651584,maxBitrate:18e7,level:60},{maxPictureSize:35651584,maxBitrate:24e7,level:61},{maxPictureSize:35651584,maxBitrate:48e7,level:62}],Pc=[{maxPictureSize:147456,maxBitrate:15e5,tier:"M",level:0},{maxPictureSize:278784,maxBitrate:3e6,tier:"M",level:1},{maxPictureSize:665856,maxBitrate:6e6,tier:"M",level:4},{maxPictureSize:1065024,maxBitrate:1e7,tier:"M",level:5},{maxPictureSize:2359296,maxBitrate:12e6,tier:"M",level:8},{maxPictureSize:2359296,maxBitrate:3e7,tier:"H",level:8},{maxPictureSize:2359296,maxBitrate:2e7,tier:"M",level:9},{maxPictureSize:2359296,maxBitrate:5e7,tier:"H",level:9},{maxPictureSize:8912896,maxBitrate:3e7,tier:"M",level:12},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:12},{maxPictureSize:8912896,maxBitrate:4e7,tier:"M",level:13},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:13},{maxPictureSize:8912896,maxBitrate:6e7,tier:"M",level:14},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:14},{maxPictureSize:35651584,maxBitrate:6e7,tier:"M",level:15},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:15},{maxPictureSize:35651584,maxBitrate:6e7,tier:"M",level:16},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:16},{maxPictureSize:35651584,maxBitrate:1e8,tier:"M",level:17},{maxPictureSize:35651584,maxBitrate:48e7,tier:"H",level:17},{maxPictureSize:35651584,maxBitrate:16e7,tier:"M",level:18},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:18},{maxPictureSize:35651584,maxBitrate:16e7,tier:"M",level:19},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:19}],ng=(e,t,r,n)=>{if(e==="avc"){const s=Math.ceil(t/16)*Math.ceil(r/16),o=Sc.find(h=>s<=h.maxMacroblocks&&n<=h.maxBitrate)??oi(Sc),a=o?o.level:0,l="64".padStart(2,"0"),c="00",d=a.toString(16).padStart(2,"0");return`avc1.${l}${c}${d}`}else if(e==="hevc"){const i="",o="6",a=t*r,l=Tc.find(d=>a<=d.maxPictureSize&&n<=d.maxBitrate)??oi(Tc);return`hev1.${i}1.${o}.${l.tier}${l.level}.B0`}else{if(e==="vp8")return"vp8";if(e==="vp9"){const i="00",s=t*r,o=_c.find(l=>s<=l.maxPictureSize&&n<=l.maxBitrate)??oi(_c);return`vp09.${i}.${o.level.toString().padStart(2,"0")}.08`}else if(e==="av1"){const s=t*r,o=Pc.find(c=>s<=c.maxPictureSize&&n<=c.maxBitrate)??oi(Pc);return`av01.0.${o.level.toString().padStart(2,"0")}${o.tier}.08`}}throw new TypeError(`Unhandled codec '${e}'.`)},ig=e=>{const t=e.split("."),r=Number(t[1]),n=Number(t[2]),i=Number(t[3]),s=t[4]?Number(t[4]):1;return[1,1,r,2,1,n,3,1,i,4,1,s]},sg=e=>{const t=e.split("."),i=(1<<7)+1,s=Number(t[1]),o=t[2],a=Number(o.slice(0,-1)),l=(s<<5)+a,c=o.slice(-1)==="H"?1:0,h=Number(t[3])===8?0:1,g=0,C=t[4]?Number(t[4]):0,k=t[5]?Number(t[5][0]):1,x=t[5]?Number(t[5][1]):1,b=t[5]?Number(t[5][2]):0,p=(c<<7)+(h<<6)+(g<<5)+(C<<4)+(k<<3)+(x<<2)+b;return[i,l,p,0]},og=(e,t,r)=>{if(e==="aac")return t>=2&&r<=24e3?"mp4a.40.29":r<=24e3?"mp4a.40.5":"mp4a.40.2";if(e==="mp3")return"mp3";if(e==="opus")return"opus";if(e==="vorbis")return"vorbis";if(e==="flac")return"flac";if(e==="ac3")return"ac-3";if(e==="eac3")return"ec-3";if(At.includes(e))return e;throw new TypeError(`Unhandled codec '${e}'.`)},Ks=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ou=[-1,1,2,3,4,5,6,8],ag=e=>{if(!e||e.byteLength<2)throw new TypeError("AAC description must be at least 2 bytes long.");const t=new Vn(e);let r=t.readBits(5);r===31&&(r=32+t.readBits(6));const n=t.readBits(4);let i=null;n===15?i=t.readBits(24):n<Ks.length&&(i=Ks[n]);const s=t.readBits(4);let o=null;return s>=1&&s<=7&&(o=ou[s]),{objectType:r,frequencyIndex:n,sampleRate:i,channelConfiguration:s,numberOfChannels:o}},bh=e=>{let t=Ks.indexOf(e.sampleRate),r=null;t===-1&&(t=15,r=e.sampleRate);const n=ou.indexOf(e.numberOfChannels);if(n===-1)throw new TypeError(`Unsupported number of channels: ${e.numberOfChannels}`);let i=13;e.objectType>=32&&(i+=6),t===15&&(i+=24);const s=Math.ceil(i/8),o=new Uint8Array(s),a=new Vn(o);return e.objectType<32?a.writeBits(5,e.objectType):(a.writeBits(5,31),a.writeBits(6,e.objectType-32)),a.writeBits(4,t),t===15&&a.writeBits(24,r),a.writeBits(4,n),o},lg=48e3,Sh=/^pcm-([usf])(\d+)+(be)?$/,Th=e=>{if(Q(At.includes(e)),e==="ulaw")return{dataType:"ulaw",sampleSize:1,littleEndian:!0,silentValue:255};if(e==="alaw")return{dataType:"alaw",sampleSize:1,littleEndian:!0,silentValue:213};const t=Sh.exec(e);Q(t);let r;t[1]==="u"?r="unsigned":t[1]==="s"?r="signed":r="float";const n=Number(t[2])/8,i=t[3]!=="be",s=e==="pcm-u8"?2**7:0;return{dataType:r,sampleSize:n,littleEndian:i,silentValue:s}},_h=e=>e.startsWith("avc1")||e.startsWith("avc3")?"avc":e.startsWith("hev1")||e.startsWith("hvc1")?"hevc":e==="vp8"?"vp8":e.startsWith("vp09")?"vp9":e.startsWith("av01")?"av1":e.startsWith("mp4a.40")||e==="mp4a.67"?"aac":e==="mp3"||e==="mp4a.69"||e==="mp4a.6B"||e==="mp4a.6b"?"mp3":e==="opus"?"opus":e==="vorbis"?"vorbis":e==="flac"?"flac":e==="ac-3"||e==="ac3"?"ac3":e==="ec-3"||e==="eac3"?"eac3":e==="ulaw"?"ulaw":e==="alaw"?"alaw":Sh.test(e)?e:e==="webvtt"?"webvtt":null,ug=e=>e==="avc"?{avc:{format:"avc"}}:e==="hevc"?{hevc:{format:"hevc"}}:{},cg=e=>e==="aac"?{aac:{format:"aac"}}:e==="opus"?{opus:{format:"opus"}}:{},dg=["avc1","avc3","hev1","hvc1","vp8","vp09","av01"],fg=/^(avc1|avc3)\.[0-9a-fA-F]{6}$/,hg=/^(hev1|hvc1)\.(?:[ABC]?\d+)\.[0-9a-fA-F]{1,8}\.[LH]\d+(?:\.[0-9a-fA-F]{1,2}){0,6}$/,pg=/^vp09(?:\.\d{2}){3}(?:(?:\.\d{2}){5})?$/,mg=/^av01\.\d\.\d{2}[MH]\.\d{2}(?:\.\d\.\d{3}\.\d{2}\.\d{2}\.\d{2}\.\d)?$/,gg=e=>{if(!e)throw new TypeError("Video chunk metadata must be provided.");if(typeof e!="object")throw new TypeError("Video chunk metadata must be an object.");if(!e.decoderConfig)throw new TypeError("Video chunk metadata must include a decoder configuration.");if(typeof e.decoderConfig!="object")throw new TypeError("Video chunk metadata decoder configuration must be an object.");if(typeof e.decoderConfig.codec!="string")throw new TypeError("Video chunk metadata decoder configuration must specify a codec string.");if(!dg.some(t=>e.decoderConfig.codec.startsWith(t)))throw new TypeError("Video chunk metadata decoder configuration codec string must be a valid video codec string as specified in the Mediabunny Codec Registry.");if(!Number.isInteger(e.decoderConfig.codedWidth)||e.decoderConfig.codedWidth<=0)throw new TypeError("Video chunk metadata decoder configuration must specify a valid codedWidth (positive integer).");if(!Number.isInteger(e.decoderConfig.codedHeight)||e.decoderConfig.codedHeight<=0)throw new TypeError("Video chunk metadata decoder configuration must specify a valid codedHeight (positive integer).");if(e.decoderConfig.description!==void 0&&!po(e.decoderConfig.description))throw new TypeError("Video chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(e.decoderConfig.colorSpace!==void 0){const{colorSpace:t}=e.decoderConfig;if(typeof t!="object")throw new TypeError("Video chunk metadata decoder configuration colorSpace, when provided, must be an object.");const r=Object.keys(mh);if(t.primaries!=null&&!r.includes(t.primaries))throw new TypeError(`Video chunk metadata decoder configuration colorSpace primaries, when defined, must be one of ${r.join(", ")}.`);const n=Object.keys(gh);if(t.transfer!=null&&!n.includes(t.transfer))throw new TypeError(`Video chunk metadata decoder configuration colorSpace transfer, when defined, must be one of ${n.join(", ")}.`);const i=Object.keys(yh);if(t.matrix!=null&&!i.includes(t.matrix))throw new TypeError(`Video chunk metadata decoder configuration colorSpace matrix, when defined, must be one of ${i.join(", ")}.`);if(t.fullRange!=null&&typeof t.fullRange!="boolean")throw new TypeError("Video chunk metadata decoder configuration colorSpace fullRange, when defined, must be a boolean.")}if(e.decoderConfig.codec.startsWith("avc1")||e.decoderConfig.codec.startsWith("avc3")){if(!fg.test(e.decoderConfig.codec))throw new TypeError("Video chunk metadata decoder configuration codec string for AVC must be a valid AVC codec string as specified in Section 3.4 of RFC 6381.")}else if(e.decoderConfig.codec.startsWith("hev1")||e.decoderConfig.codec.startsWith("hvc1")){if(!hg.test(e.decoderConfig.codec))throw new TypeError("Video chunk metadata decoder configuration codec string for HEVC must be a valid HEVC codec string as specified in Section E.3 of ISO 14496-15.")}else if(e.decoderConfig.codec.startsWith("vp8")){if(e.decoderConfig.codec!=="vp8")throw new TypeError('Video chunk metadata decoder configuration codec string for VP8 must be "vp8".')}else if(e.decoderConfig.codec.startsWith("vp09")){if(!pg.test(e.decoderConfig.codec))throw new TypeError('Video chunk metadata decoder configuration codec string for VP9 must be a valid VP9 codec string as specified in Section "Codecs Parameter String" of https://www.webmproject.org/vp9/mp4/.')}else if(e.decoderConfig.codec.startsWith("av01")&&!mg.test(e.decoderConfig.codec))throw new TypeError('Video chunk metadata decoder configuration codec string for AV1 must be a valid AV1 codec string as specified in Section "Codecs Parameter String" of https://aomediacodec.github.io/av1-isobmff/.')},yg=["mp4a","mp3","opus","vorbis","flac","ulaw","alaw","pcm","ac-3","ec-3"],wg=e=>{if(!e)throw new TypeError("Audio chunk metadata must be provided.");if(typeof e!="object")throw new TypeError("Audio chunk metadata must be an object.");if(!e.decoderConfig)throw new TypeError("Audio chunk metadata must include a decoder configuration.");if(typeof e.decoderConfig!="object")throw new TypeError("Audio chunk metadata decoder configuration must be an object.");if(typeof e.decoderConfig.codec!="string")throw new TypeError("Audio chunk metadata decoder configuration must specify a codec string.");if(!yg.some(t=>e.decoderConfig.codec.startsWith(t)))throw new TypeError("Audio chunk metadata decoder configuration codec string must be a valid audio codec string as specified in the Mediabunny Codec Registry.");if(!Number.isInteger(e.decoderConfig.sampleRate)||e.decoderConfig.sampleRate<=0)throw new TypeError("Audio chunk metadata decoder configuration must specify a valid sampleRate (positive integer).");if(!Number.isInteger(e.decoderConfig.numberOfChannels)||e.decoderConfig.numberOfChannels<=0)throw new TypeError("Audio chunk metadata decoder configuration must specify a valid numberOfChannels (positive integer).");if(e.decoderConfig.description!==void 0&&!po(e.decoderConfig.description))throw new TypeError("Audio chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(e.decoderConfig.codec.startsWith("mp4a")&&e.decoderConfig.codec!=="mp4a.69"&&e.decoderConfig.codec!=="mp4a.6B"&&e.decoderConfig.codec!=="mp4a.6b"){if(!["mp4a.40.2","mp4a.40.02","mp4a.40.5","mp4a.40.05","mp4a.40.29","mp4a.67"].includes(e.decoderConfig.codec))throw new TypeError("Audio chunk metadata decoder configuration codec string for AAC must be a valid AAC codec string as specified in https://www.w3.org/TR/webcodecs-aac-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("mp3")||e.decoderConfig.codec.startsWith("mp4a")){if(e.decoderConfig.codec!=="mp3"&&e.decoderConfig.codec!=="mp4a.69"&&e.decoderConfig.codec!=="mp4a.6B"&&e.decoderConfig.codec!=="mp4a.6b")throw new TypeError('Audio chunk metadata decoder configuration codec string for MP3 must be "mp3", "mp4a.69" or "mp4a.6B".')}else if(e.decoderConfig.codec.startsWith("opus")){if(e.decoderConfig.codec!=="opus")throw new TypeError('Audio chunk metadata decoder configuration codec string for Opus must be "opus".');if(e.decoderConfig.description&&e.decoderConfig.description.byteLength<18)throw new TypeError("Audio chunk metadata decoder configuration description, when specified, is expected to be an Identification Header as specified in Section 5.1 of RFC 7845.")}else if(e.decoderConfig.codec.startsWith("vorbis")){if(e.decoderConfig.codec!=="vorbis")throw new TypeError('Audio chunk metadata decoder configuration codec string for Vorbis must be "vorbis".');if(!e.decoderConfig.description)throw new TypeError("Audio chunk metadata decoder configuration for Vorbis must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-vorbis-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("flac")){if(e.decoderConfig.codec!=="flac")throw new TypeError('Audio chunk metadata decoder configuration codec string for FLAC must be "flac".');if(!e.decoderConfig.description||e.decoderConfig.description.byteLength<42)throw new TypeError("Audio chunk metadata decoder configuration for FLAC must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-flac-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("ac-3")||e.decoderConfig.codec.startsWith("ac3")){if(e.decoderConfig.codec!=="ac-3")throw new TypeError('Audio chunk metadata decoder configuration codec string for AC-3 must be "ac-3".')}else if(e.decoderConfig.codec.startsWith("ec-3")||e.decoderConfig.codec.startsWith("eac3")){if(e.decoderConfig.codec!=="ec-3")throw new TypeError('Audio chunk metadata decoder configuration codec string for EC-3 must be "ec-3".')}else if((e.decoderConfig.codec.startsWith("pcm")||e.decoderConfig.codec.startsWith("ulaw")||e.decoderConfig.codec.startsWith("alaw"))&&!At.includes(e.decoderConfig.codec))throw new TypeError(`Audio chunk metadata decoder configuration codec string for PCM must be one of the supported PCM codecs (${At.join(", ")}).`)},vg=e=>{if(!e)throw new TypeError("Subtitle metadata must be provided.");if(typeof e!="object")throw new TypeError("Subtitle metadata must be an object.");if(!e.config)throw new TypeError("Subtitle metadata must include a config object.");if(typeof e.config!="object")throw new TypeError("Subtitle metadata config must be an object.");if(typeof e.config.description!="string")throw new TypeError("Subtitle metadata config description must be a string.")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */var Nc;(function(e){e[e.NON_IDR_SLICE=1]="NON_IDR_SLICE",e[e.SLICE_DPA=2]="SLICE_DPA",e[e.SLICE_DPB=3]="SLICE_DPB",e[e.SLICE_DPC=4]="SLICE_DPC",e[e.IDR=5]="IDR",e[e.SEI=6]="SEI",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.AUD=9]="AUD",e[e.SPS_EXT=13]="SPS_EXT"})(Nc||(Nc={}));var Rc;(function(e){e[e.RASL_N=8]="RASL_N",e[e.RASL_R=9]="RASL_R",e[e.BLA_W_LP=16]="BLA_W_LP",e[e.RSV_IRAP_VCL23=23]="RSV_IRAP_VCL23",e[e.VPS_NUT=32]="VPS_NUT",e[e.SPS_NUT=33]="SPS_NUT",e[e.PPS_NUT=34]="PPS_NUT",e[e.AUD_NUT=35]="AUD_NUT",e[e.PREFIX_SEI_NUT=39]="PREFIX_SEI_NUT",e[e.SUFFIX_SEI_NUT=40]="SUFFIX_SEI_NUT"})(Rc||(Rc={}));const xg=e=>{const t=cr(e),r=t.getUint8(9),n=t.getUint16(10,!0),i=t.getUint32(12,!0),s=t.getInt16(16,!0),o=t.getUint8(18);let a=null;return o&&(a=e.subarray(19,21+r)),{outputChannelCount:r,preSkip:n,inputSampleRate:i,outputGain:s,channelMappingFamily:o,channelMappingTable:a}};var Ac;(function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.PICTURE=6]="PICTURE"})(Ac||(Ac={}));/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const il=[],sl=[];/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const jc=new Uint8Array(0);class Cr{constructor(t,r,n,i,s=-1,o,a){if(this.data=t,this.type=r,this.timestamp=n,this.duration=i,this.sequenceNumber=s,t===jc&&o===void 0)throw new Error("Internal error: byteLength must be explicitly provided when constructing metadata-only packets.");if(o===void 0&&(o=t.byteLength),!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(r!=="key"&&r!=="delta")throw new TypeError('type must be either "key" or "delta".');if(!Number.isFinite(n))throw new TypeError("timestamp must be a number.");if(!Number.isFinite(i)||i<0)throw new TypeError("duration must be a non-negative number.");if(!Number.isFinite(s))throw new TypeError("sequenceNumber must be a number.");if(!Number.isInteger(o)||o<0)throw new TypeError("byteLength must be a non-negative integer.");if(a!==void 0&&(typeof a!="object"||!a))throw new TypeError("sideData, when provided, must be an object.");if((a==null?void 0:a.alpha)!==void 0&&!(a.alpha instanceof Uint8Array))throw new TypeError("sideData.alpha, when provided, must be a Uint8Array.");if((a==null?void 0:a.alphaByteLength)!==void 0&&(!Number.isInteger(a.alphaByteLength)||a.alphaByteLength<0))throw new TypeError("sideData.alphaByteLength, when provided, must be a non-negative integer.");this.byteLength=o,this.sideData=a??{},this.sideData.alpha&&this.sideData.alphaByteLength===void 0&&(this.sideData.alphaByteLength=this.sideData.alpha.byteLength)}get isMetadataOnly(){return this.data===jc}get microsecondTimestamp(){return Math.trunc(dr*this.timestamp)}get microsecondDuration(){return Math.trunc(dr*this.duration)}toEncodedVideoChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if(typeof EncodedVideoChunk>"u")throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}alphaToEncodedVideoChunk(t=this.type){if(!this.sideData.alpha)throw new TypeError("This packet does not contain alpha side data.");if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if(typeof EncodedVideoChunk>"u")throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.sideData.alpha,type:t,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}toEncodedAudioChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to an audio chunk.");if(typeof EncodedAudioChunk>"u")throw new Error("Your browser does not support EncodedAudioChunk.");return new EncodedAudioChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}static fromEncodedChunk(t,r){if(!(t instanceof EncodedVideoChunk||t instanceof EncodedAudioChunk))throw new TypeError("chunk must be an EncodedVideoChunk or EncodedAudioChunk.");const n=new Uint8Array(t.byteLength);return t.copyTo(n),new Cr(n,t.type,t.timestamp/1e6,(t.duration??0)/1e6,void 0,void 0,r)}clone(t){if(t!==void 0&&(typeof t!="object"||t===null))throw new TypeError("options, when provided, must be an object.");if((t==null?void 0:t.data)!==void 0&&!(t.data instanceof Uint8Array))throw new TypeError("options.data, when provided, must be a Uint8Array.");if((t==null?void 0:t.type)!==void 0&&t.type!=="key"&&t.type!=="delta")throw new TypeError('options.type, when provided, must be either "key" or "delta".');if((t==null?void 0:t.timestamp)!==void 0&&!Number.isFinite(t.timestamp))throw new TypeError("options.timestamp, when provided, must be a number.");if((t==null?void 0:t.duration)!==void 0&&!Number.isFinite(t.duration))throw new TypeError("options.duration, when provided, must be a number.");if((t==null?void 0:t.sequenceNumber)!==void 0&&!Number.isFinite(t.sequenceNumber))throw new TypeError("options.sequenceNumber, when provided, must be a number.");if((t==null?void 0:t.sideData)!==void 0&&(typeof t.sideData!="object"||t.sideData===null))throw new TypeError("options.sideData, when provided, must be an object.");return new Cr((t==null?void 0:t.data)??this.data,(t==null?void 0:t.type)??this.type,(t==null?void 0:t.timestamp)??this.timestamp,(t==null?void 0:t.duration)??this.duration,(t==null?void 0:t.sequenceNumber)??this.sequenceNumber,this.byteLength,(t==null?void 0:t.sideData)??this.sideData)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const kg=e=>{let n=e,i=4096,s=0,o=12,a=0;for(n<0&&(n=-n,s=128),n+=33,n>8191&&(n=8191);(n&i)!==i&&o>=5;)i>>=1,o--;return a=n>>o-4&15,~(s|o-5<<4|a)&255},Cg=e=>{let r=2048,n=0,i=11,s=0,o=e;for(o<0&&(o=-o,n=128),o>4095&&(o=4095);(o&r)!==r&&i>=5;)r>>=1,i--;return s=o>>(i===4?1:i-4)&15,(n|i-4<<4|s)^85};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */J0();let Dc=-1/0,Ic=-1/0,it=null;typeof FinalizationRegistry<"u"&&(it=new FinalizationRegistry(e=>{const t=Date.now();e.type==="video"?(t-Dc>=1e3&&(console.error("A VideoSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your VideoSamples as soon as you're done using them."),Dc=t),typeof VideoFrame<"u"&&e.data instanceof VideoFrame&&e.data.close()):(t-Ic>=1e3&&(console.error("An AudioSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your AudioSamples as soon as you're done using them."),Ic=t),typeof AudioData<"u"&&e.data instanceof AudioData&&e.data.close())}));const Ph=["I420","I420P10","I420P12","I420A","I420AP10","I420AP12","I422","I422P10","I422P12","I422A","I422AP10","I422AP12","I444","I444P10","I444P12","I444A","I444AP10","I444AP12","NV12","RGBA","RGBX","BGRA","BGRX"],Eg=new Set(Ph);class Wr{get displayWidth(){return this.rotation%180===0?this.codedWidth:this.codedHeight}get displayHeight(){return this.rotation%180===0?this.codedHeight:this.codedWidth}get microsecondTimestamp(){return Math.trunc(dr*this.timestamp)}get microsecondDuration(){return Math.trunc(dr*this.duration)}get hasAlpha(){return this.format&&this.format.includes("A")}constructor(t,r){if(this._closed=!1,t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer||ArrayBuffer.isView(t)){if(!r||typeof r!="object")throw new TypeError("init must be an object.");if(r.format===void 0||!Eg.has(r.format))throw new TypeError("init.format must be one of: "+Ph.join(", "));if(!Number.isInteger(r.codedWidth)||r.codedWidth<=0)throw new TypeError("init.codedWidth must be a positive integer.");if(!Number.isInteger(r.codedHeight)||r.codedHeight<=0)throw new TypeError("init.codedHeight must be a positive integer.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(r.timestamp))throw new TypeError("init.timestamp must be a number.");if(r.duration!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");this._data=Xr(t).slice(),this._layout=r.layout??Tg(r.format,r.codedWidth,r.codedHeight),this.format=r.format,this.codedWidth=r.codedWidth,this.codedHeight=r.codedHeight,this.rotation=r.rotation??0,this.timestamp=r.timestamp,this.duration=r.duration??0,this.colorSpace=new na(r.colorSpace)}else if(typeof VideoFrame<"u"&&t instanceof VideoFrame){if((r==null?void 0:r.rotation)!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if((r==null?void 0:r.timestamp)!==void 0&&!Number.isFinite(r==null?void 0:r.timestamp))throw new TypeError("init.timestamp, when provided, must be a number.");if((r==null?void 0:r.duration)!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");this._data=t,this._layout=null,this.format=t.format,this.codedWidth=t.displayWidth,this.codedHeight=t.displayHeight,this.rotation=(r==null?void 0:r.rotation)??0,this.timestamp=(r==null?void 0:r.timestamp)??t.timestamp/1e6,this.duration=(r==null?void 0:r.duration)??(t.duration??0)/1e6,this.colorSpace=new na(t.colorSpace)}else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof SVGImageElement<"u"&&t instanceof SVGImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){if(!r||typeof r!="object")throw new TypeError("init must be an object.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(r.timestamp))throw new TypeError("init.timestamp must be a number.");if(r.duration!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");if(typeof VideoFrame<"u")return new Wr(new VideoFrame(t,{timestamp:Math.trunc(r.timestamp*dr),duration:Math.trunc((r.duration??0)*dr)||void 0}),r);let n=0,i=0;if("naturalWidth"in t?(n=t.naturalWidth,i=t.naturalHeight):"videoWidth"in t?(n=t.videoWidth,i=t.videoHeight):"width"in t&&(n=Number(t.width),i=Number(t.height)),!n||!i)throw new TypeError("Could not determine dimensions.");const s=new OffscreenCanvas(n,i),o=s.getContext("2d",{alpha:Xs(),willReadFrequently:!0});Q(o),o.drawImage(t,0,0),this._data=s,this._layout=null,this.format="RGBX",this.codedWidth=n,this.codedHeight=i,this.rotation=r.rotation??0,this.timestamp=r.timestamp,this.duration=r.duration??0,this.colorSpace=new na({matrix:"rgb",primaries:"bt709",transfer:"iec61966-2-1",fullRange:!0})}else throw new TypeError("Invalid data type: Must be a BufferSource or CanvasImageSource.");it==null||it.register(this,{type:"video",data:this._data},this)}clone(){if(this._closed)throw new Error("VideoSample is closed.");return Q(this._data!==null),Mr(this._data)?new Wr(this._data.clone(),{timestamp:this.timestamp,duration:this.duration,rotation:this.rotation}):this._data instanceof Uint8Array?(Q(this._layout),new Wr(this._data,{format:this.format,layout:this._layout,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})):new Wr(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})}close(){this._closed||(it==null||it.unregister(this),Mr(this._data)?this._data.close():this._data=null,this._closed=!0)}allocationSize(t={}){if(Oc(t),this._closed)throw new Error("VideoSample is closed.");if(this.format===null)throw new Error("Cannot get allocation size when format is null. Sorry!");if(Q(this._data!==null),!Mr(this._data)&&(t.colorSpace||t.format&&t.format!==this.format||t.layout||t.rect)){const r=this.toVideoFrame(),n=r.allocationSize(t);return r.close(),n}return Mr(this._data)?this._data.allocationSize(t):this._data instanceof Uint8Array?this._data.byteLength:this.codedWidth*this.codedHeight*4}async copyTo(t,r={}){if(!po(t))throw new TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(Oc(r),this._closed)throw new Error("VideoSample is closed.");if(this.format===null)throw new Error("Cannot copy video sample data when format is null. Sorry!");if(Q(this._data!==null),!Mr(this._data)&&(r.colorSpace||r.format&&r.format!==this.format||r.layout||r.rect)){const n=this.toVideoFrame(),i=await n.copyTo(t,r);return n.close(),i}if(Mr(this._data))return this._data.copyTo(t,r);if(this._data instanceof Uint8Array)return Q(this._layout),Xr(t).set(this._data),this._layout;{const i=this._data.getContext("2d");Q(i);const s=i.getImageData(0,0,this.codedWidth,this.codedHeight);return Xr(t).set(s.data),[{offset:0,stride:4*this.codedWidth}]}}toVideoFrame(){if(this._closed)throw new Error("VideoSample is closed.");return Q(this._data!==null),Mr(this._data)?new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0}):this._data instanceof Uint8Array?new VideoFrame(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0,colorSpace:this.colorSpace}):new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0})}draw(t,r,n,i,s,o,a,l,c){let d=0,h=0,g=this.displayWidth,C=this.displayHeight,k=0,x=0,b=this.displayWidth,p=this.displayHeight;if(o!==void 0?(d=r,h=n,g=i,C=s,k=o,x=a,l!==void 0?(b=l,p=c):(b=g,p=C)):(k=r,x=n,i!==void 0&&(b=i,p=s)),!(typeof CanvasRenderingContext2D<"u"&&t instanceof CanvasRenderingContext2D||typeof OffscreenCanvasRenderingContext2D<"u"&&t instanceof OffscreenCanvasRenderingContext2D))throw new TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!Number.isFinite(d))throw new TypeError("sx must be a number.");if(!Number.isFinite(h))throw new TypeError("sy must be a number.");if(!Number.isFinite(g)||g<0)throw new TypeError("sWidth must be a non-negative number.");if(!Number.isFinite(C)||C<0)throw new TypeError("sHeight must be a non-negative number.");if(!Number.isFinite(k))throw new TypeError("dx must be a number.");if(!Number.isFinite(x))throw new TypeError("dy must be a number.");if(!Number.isFinite(b)||b<0)throw new TypeError("dWidth must be a non-negative number.");if(!Number.isFinite(p)||p<0)throw new TypeError("dHeight must be a non-negative number.");if(this._closed)throw new Error("VideoSample is closed.");({sx:d,sy:h,sWidth:g,sHeight:C}=this._rotateSourceRegion(d,h,g,C,this.rotation));const f=this.toCanvasImageSource();t.save();const m=k+b/2,v=x+p/2;t.translate(m,v),t.rotate(this.rotation*Math.PI/180);const w=this.rotation%180===0?1:b/p;t.scale(1/w,w),t.drawImage(f,d,h,g,C,-b/2,-p/2,b,p),t.restore()}drawWithFit(t,r){var p,f,m,v;if(!(typeof CanvasRenderingContext2D<"u"&&t instanceof CanvasRenderingContext2D||typeof OffscreenCanvasRenderingContext2D<"u"&&t instanceof OffscreenCanvasRenderingContext2D))throw new TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!r||typeof r!="object")throw new TypeError("options must be an object.");if(!["fill","contain","cover"].includes(r.fit))throw new TypeError("options.fit must be 'fill', 'contain', or 'cover'.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("options.rotation, when provided, must be 0, 90, 180, or 270.");r.crop!==void 0&&Sg(r.crop,"options.");const n=t.canvas.width,i=t.canvas.height,s=r.rotation??this.rotation,[o,a]=s%180===0?[this.codedWidth,this.codedHeight]:[this.codedHeight,this.codedWidth];r.crop&&bg(r.crop,o,a);let l,c,d,h;const{sx:g,sy:C,sWidth:k,sHeight:x}=this._rotateSourceRegion(((p=r.crop)==null?void 0:p.left)??0,((f=r.crop)==null?void 0:f.top)??0,((m=r.crop)==null?void 0:m.width)??o,((v=r.crop)==null?void 0:v.height)??a,s);if(r.fit==="fill")l=0,c=0,d=n,h=i;else{const[w,S]=r.crop?[r.crop.width,r.crop.height]:[o,a],T=r.fit==="contain"?Math.min(n/w,i/S):Math.max(n/w,i/S);d=w*T,h=S*T,l=(n-d)/2,c=(i-h)/2}t.save();const b=s%180===0?1:d/h;t.translate(n/2,i/2),t.rotate(s*Math.PI/180),t.scale(1/b,b),t.translate(-n/2,-i/2),t.drawImage(this.toCanvasImageSource(),g,C,k,x,l,c,d,h),t.restore()}_rotateSourceRegion(t,r,n,i,s){return s===90?[t,r,n,i]=[r,this.codedHeight-t-n,i,n]:s===180?[t,r]=[this.codedWidth-t-n,this.codedHeight-r-i]:s===270&&([t,r,n,i]=[this.codedWidth-r-i,t,i,n]),{sx:t,sy:r,sWidth:n,sHeight:i}}toCanvasImageSource(){if(this._closed)throw new Error("VideoSample is closed.");if(Q(this._data!==null),this._data instanceof Uint8Array){const t=this.toVideoFrame();return queueMicrotask(()=>t.close()),t}else return this._data}setRotation(t){if(![0,90,180,270].includes(t))throw new TypeError("newRotation must be 0, 90, 180, or 270.");this.rotation=t}setTimestamp(t){if(!Number.isFinite(t))throw new TypeError("newTimestamp must be a number.");this.timestamp=t}setDuration(t){if(!Number.isFinite(t)||t<0)throw new TypeError("newDuration must be a non-negative number.");this.duration=t}[Symbol.dispose](){this.close()}}class na{constructor(t){this.primaries=(t==null?void 0:t.primaries)??null,this.transfer=(t==null?void 0:t.transfer)??null,this.matrix=(t==null?void 0:t.matrix)??null,this.fullRange=(t==null?void 0:t.fullRange)??null}toJSON(){return{primaries:this.primaries,transfer:this.transfer,matrix:this.matrix,fullRange:this.fullRange}}}const Mr=e=>typeof VideoFrame<"u"&&e instanceof VideoFrame,bg=(e,t,r)=>{e.left=Math.min(e.left,t),e.top=Math.min(e.top,r),e.width=Math.min(e.width,t-e.left),e.height=Math.min(e.height,r-e.top),Q(e.width>=0),Q(e.height>=0)},Sg=(e,t)=>{if(!e||typeof e!="object")throw new TypeError(t+"crop, when provided, must be an object.");if(!Number.isInteger(e.left)||e.left<0)throw new TypeError(t+"crop.left must be a non-negative integer.");if(!Number.isInteger(e.top)||e.top<0)throw new TypeError(t+"crop.top must be a non-negative integer.");if(!Number.isInteger(e.width)||e.width<0)throw new TypeError(t+"crop.width must be a non-negative integer.");if(!Number.isInteger(e.height)||e.height<0)throw new TypeError(t+"crop.height must be a non-negative integer.")},Oc=e=>{if(!e||typeof e!="object")throw new TypeError("options must be an object.");if(e.colorSpace!==void 0&&!["display-p3","srgb"].includes(e.colorSpace))throw new TypeError("options.colorSpace, when provided, must be 'display-p3' or 'srgb'.");if(e.format!==void 0&&typeof e.format!="string")throw new TypeError("options.format, when provided, must be a string.");if(e.layout!==void 0){if(!Array.isArray(e.layout))throw new TypeError("options.layout, when provided, must be an array.");for(const t of e.layout){if(!t||typeof t!="object")throw new TypeError("Each entry in options.layout must be an object.");if(!Number.isInteger(t.offset)||t.offset<0)throw new TypeError("plane.offset must be a non-negative integer.");if(!Number.isInteger(t.stride)||t.stride<0)throw new TypeError("plane.stride must be a non-negative integer.")}}if(e.rect!==void 0){if(!e.rect||typeof e.rect!="object")throw new TypeError("options.rect, when provided, must be an object.");if(e.rect.x!==void 0&&(!Number.isInteger(e.rect.x)||e.rect.x<0))throw new TypeError("options.rect.x, when provided, must be a non-negative integer.");if(e.rect.y!==void 0&&(!Number.isInteger(e.rect.y)||e.rect.y<0))throw new TypeError("options.rect.y, when provided, must be a non-negative integer.");if(e.rect.width!==void 0&&(!Number.isInteger(e.rect.width)||e.rect.width<0))throw new TypeError("options.rect.width, when provided, must be a non-negative integer.");if(e.rect.height!==void 0&&(!Number.isInteger(e.rect.height)||e.rect.height<0))throw new TypeError("options.rect.height, when provided, must be a non-negative integer.")}},Tg=(e,t,r)=>{const n=_g(e),i=[];let s=0;for(const o of n){const a=Math.ceil(t/o.widthDivisor),l=Math.ceil(r/o.heightDivisor),c=a*o.sampleBytes,d=c*l;i.push({offset:s,stride:c}),s+=d}return i},_g=e=>{const t=(r,n,i,s,o)=>{const a=[{sampleBytes:r,widthDivisor:1,heightDivisor:1},{sampleBytes:n,widthDivisor:i,heightDivisor:s},{sampleBytes:n,widthDivisor:i,heightDivisor:s}];return o&&a.push({sampleBytes:r,widthDivisor:1,heightDivisor:1}),a};switch(e){case"I420":return t(1,1,2,2,!1);case"I420P10":case"I420P12":return t(2,2,2,2,!1);case"I420A":return t(1,1,2,2,!0);case"I420AP10":case"I420AP12":return t(2,2,2,2,!0);case"I422":return t(1,1,2,1,!1);case"I422P10":case"I422P12":return t(2,2,2,1,!1);case"I422A":return t(1,1,2,1,!0);case"I422AP10":case"I422AP12":return t(2,2,2,1,!0);case"I444":return t(1,1,1,1,!1);case"I444P10":case"I444P12":return t(2,2,1,1,!1);case"I444A":return t(1,1,1,1,!0);case"I444AP10":case"I444AP12":return t(2,2,1,1,!0);case"NV12":return[{sampleBytes:1,widthDivisor:1,heightDivisor:1},{sampleBytes:2,widthDivisor:2,heightDivisor:2}];case"RGBA":case"RGBX":case"BGRA":case"BGRX":return[{sampleBytes:4,widthDivisor:1,heightDivisor:1}];default:mo(e),Q(!1)}},ia=new Set(["f32","f32-planar","s16","s16-planar","s32","s32-planar","u8","u8-planar"]);class fr{get microsecondTimestamp(){return Math.trunc(dr*this.timestamp)}get microsecondDuration(){return Math.trunc(dr*this.duration)}constructor(t){if(this._closed=!1,ti(t)){if(t.format===null)throw new TypeError("AudioData with null format is not supported.");this._data=t,this.format=t.format,this.sampleRate=t.sampleRate,this.numberOfFrames=t.numberOfFrames,this.numberOfChannels=t.numberOfChannels,this.timestamp=t.timestamp/1e6,this.duration=t.numberOfFrames/t.sampleRate}else{if(!t||typeof t!="object")throw new TypeError("Invalid AudioDataInit: must be an object.");if(!ia.has(t.format))throw new TypeError("Invalid AudioDataInit: invalid format.");if(!Number.isFinite(t.sampleRate)||t.sampleRate<=0)throw new TypeError("Invalid AudioDataInit: sampleRate must be > 0.");if(!Number.isInteger(t.numberOfChannels)||t.numberOfChannels===0)throw new TypeError("Invalid AudioDataInit: numberOfChannels must be an integer > 0.");if(!Number.isFinite(t==null?void 0:t.timestamp))throw new TypeError("init.timestamp must be a number.");const r=t.data.byteLength/(Vr(t.format)*t.numberOfChannels);if(!Number.isInteger(r))throw new TypeError("Invalid AudioDataInit: data size is not a multiple of frame size.");this.format=t.format,this.sampleRate=t.sampleRate,this.numberOfFrames=r,this.numberOfChannels=t.numberOfChannels,this.timestamp=t.timestamp,this.duration=r/t.sampleRate;let n;if(t.data instanceof ArrayBuffer)n=new Uint8Array(t.data);else if(ArrayBuffer.isView(t.data))n=new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength);else throw new TypeError("Invalid AudioDataInit: data is not a BufferSource.");const i=this.numberOfFrames*this.numberOfChannels*Vr(this.format);if(n.byteLength<i)throw new TypeError("Invalid AudioDataInit: insufficient data size.");this._data=n}it==null||it.register(this,{type:"audio",data:this._data},this)}allocationSize(t){if(!t||typeof t!="object")throw new TypeError("options must be an object.");if(!Number.isInteger(t.planeIndex)||t.planeIndex<0)throw new TypeError("planeIndex must be a non-negative integer.");if(t.format!==void 0&&!ia.has(t.format))throw new TypeError("Invalid format.");if(t.frameOffset!==void 0&&(!Number.isInteger(t.frameOffset)||t.frameOffset<0))throw new TypeError("frameOffset must be a non-negative integer.");if(t.frameCount!==void 0&&(!Number.isInteger(t.frameCount)||t.frameCount<0))throw new TypeError("frameCount must be a non-negative integer.");if(this._closed)throw new Error("AudioSample is closed.");const r=t.format??this.format,n=t.frameOffset??0;if(n>=this.numberOfFrames)throw new RangeError("frameOffset out of range");const i=t.frameCount!==void 0?t.frameCount:this.numberOfFrames-n;if(i>this.numberOfFrames-n)throw new RangeError("frameCount out of range");const s=Vr(r),o=Cn(r);if(o&&t.planeIndex>=this.numberOfChannels)throw new RangeError("planeIndex out of range");if(!o&&t.planeIndex!==0)throw new RangeError("planeIndex out of range");return(o?i:i*this.numberOfChannels)*s}copyTo(t,r){if(!po(t))throw new TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(!r||typeof r!="object")throw new TypeError("options must be an object.");if(!Number.isInteger(r.planeIndex)||r.planeIndex<0)throw new TypeError("planeIndex must be a non-negative integer.");if(r.format!==void 0&&!ia.has(r.format))throw new TypeError("Invalid format.");if(r.frameOffset!==void 0&&(!Number.isInteger(r.frameOffset)||r.frameOffset<0))throw new TypeError("frameOffset must be a non-negative integer.");if(r.frameCount!==void 0&&(!Number.isInteger(r.frameCount)||r.frameCount<0))throw new TypeError("frameCount must be a non-negative integer.");if(this._closed)throw new Error("AudioSample is closed.");const{planeIndex:n,format:i,frameCount:s,frameOffset:o}=r,a=this.format,l=i??this.format;if(!l)throw new Error("Destination format not determined");const c=this.numberOfFrames,d=this.numberOfChannels,h=o??0;if(h>=c)throw new RangeError("frameOffset out of range");const g=s!==void 0?s:c-h;if(g>c-h)throw new RangeError("frameCount out of range");const C=Vr(l),k=Cn(l);if(k&&n>=d)throw new RangeError("planeIndex out of range");if(!k&&n!==0)throw new RangeError("planeIndex out of range");const b=(k?g:g*d)*C;if(t.byteLength<b)throw new RangeError("Destination buffer is too small");const p=cr(t),f=Rh(l);if(ti(this._data))K0()&&d>2&&l!==a?Pg(this._data,p,a,l,d,n,h,g):this._data.copyTo(t,{planeIndex:n,frameOffset:h,frameCount:g,format:l});else{const m=this._data,v=cr(m),w=Nh(a),S=Vr(a),T=Cn(a);for(let j=0;j<g;j++)if(k){const F=j*C;let W;T?W=(n*c+(j+h))*S:W=((j+h)*d+n)*S;const I=w(v,W);f(p,F,I)}else for(let F=0;F<d;F++){const I=(j*d+F)*C;let R;T?R=(F*c+(j+h))*S:R=((j+h)*d+F)*S;const z=w(v,R);f(p,I,z)}}}clone(){if(this._closed)throw new Error("AudioSample is closed.");if(ti(this._data)){const t=new fr(this._data.clone());return t.setTimestamp(this.timestamp),t}else return new fr({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.timestamp,data:this._data})}close(){this._closed||(it==null||it.unregister(this),ti(this._data)?this._data.close():this._data=new Uint8Array(0),this._closed=!0)}toAudioData(){if(this._closed)throw new Error("AudioSample is closed.");if(ti(this._data)){if(this._data.timestamp===this.microsecondTimestamp)return this._data.clone();if(Cn(this.format)){const t=this.allocationSize({planeIndex:0,format:this.format}),r=new ArrayBuffer(t*this.numberOfChannels);for(let n=0;n<this.numberOfChannels;n++)this.copyTo(new Uint8Array(r,n*t,t),{planeIndex:n,format:this.format});return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:r})}else{const t=new ArrayBuffer(this.allocationSize({planeIndex:0,format:this.format}));return this.copyTo(t,{planeIndex:0,format:this.format}),new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:t})}}else return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:this._data.buffer instanceof ArrayBuffer?this._data.buffer:this._data.slice()})}toAudioBuffer(){if(this._closed)throw new Error("AudioSample is closed.");const t=new AudioBuffer({numberOfChannels:this.numberOfChannels,length:this.numberOfFrames,sampleRate:this.sampleRate}),r=new Float32Array(this.allocationSize({planeIndex:0,format:"f32-planar"})/4);for(let n=0;n<this.numberOfChannels;n++)this.copyTo(r,{planeIndex:n,format:"f32-planar"}),t.copyToChannel(r,n);return t}setTimestamp(t){if(!Number.isFinite(t))throw new TypeError("newTimestamp must be a number.");this.timestamp=t}[Symbol.dispose](){this.close()}static*_fromAudioBuffer(t,r){if(!(t instanceof AudioBuffer))throw new TypeError("audioBuffer must be an AudioBuffer.");const n=48e3*5,i=t.numberOfChannels,s=t.sampleRate,o=t.length,a=Math.floor(n/i);let l=0,c=o;for(;c>0;){const d=Math.min(a,c),h=new Float32Array(i*d);for(let g=0;g<i;g++)t.copyFromChannel(h.subarray(g*d,(g+1)*d),g,l);yield new fr({format:"f32-planar",sampleRate:s,numberOfFrames:d,numberOfChannels:i,timestamp:r+l/s,data:h}),l+=d,c-=d}}static fromAudioBuffer(t,r){if(!(t instanceof AudioBuffer))throw new TypeError("audioBuffer must be an AudioBuffer.");const n=48e3*5,i=t.numberOfChannels,s=t.sampleRate,o=t.length,a=Math.floor(n/i);let l=0,c=o;const d=[];for(;c>0;){const h=Math.min(a,c),g=new Float32Array(i*h);for(let k=0;k<i;k++)t.copyFromChannel(g.subarray(k*h,(k+1)*h),k,l);const C=new fr({format:"f32-planar",sampleRate:s,numberOfFrames:h,numberOfChannels:i,timestamp:r+l/s,data:g});d.push(C),l+=h,c-=h}return d}}const Vr=e=>{switch(e){case"u8":case"u8-planar":return 1;case"s16":case"s16-planar":return 2;case"s32":case"s32-planar":return 4;case"f32":case"f32-planar":return 4;default:throw new Error("Unknown AudioSampleFormat")}},Cn=e=>{switch(e){case"u8-planar":case"s16-planar":case"s32-planar":case"f32-planar":return!0;default:return!1}},Nh=e=>{switch(e){case"u8":case"u8-planar":return(t,r)=>(t.getUint8(r)-128)/128;case"s16":case"s16-planar":return(t,r)=>t.getInt16(r,!0)/32768;case"s32":case"s32-planar":return(t,r)=>t.getInt32(r,!0)/2147483648;case"f32":case"f32-planar":return(t,r)=>t.getFloat32(r,!0)}},Rh=e=>{switch(e){case"u8":case"u8-planar":return(t,r,n)=>t.setUint8(r,Xe((n+1)*127.5,0,255));case"s16":case"s16-planar":return(t,r,n)=>t.setInt16(r,Xe(Math.round(n*32767),-32768,32767),!0);case"s32":case"s32-planar":return(t,r,n)=>t.setInt32(r,Xe(Math.round(n*2147483647),-2147483648,2147483647),!0);case"f32":case"f32-planar":return(t,r,n)=>t.setFloat32(r,n,!0)}},ti=e=>typeof AudioData<"u"&&e instanceof AudioData,Pg=(e,t,r,n,i,s,o,a)=>{const l=Nh(r),c=Rh(n),d=Vr(r),h=Vr(n),g=Cn(r);if(Cn(n))if(g){const k=new ArrayBuffer(a*d),x=cr(k);e.copyTo(k,{planeIndex:s,frameOffset:o,frameCount:a,format:r});for(let b=0;b<a;b++){const p=b*d,f=b*h,m=l(x,p);c(t,f,m)}}else{const k=new ArrayBuffer(a*i*d),x=cr(k);e.copyTo(k,{planeIndex:0,frameOffset:o,frameCount:a,format:r});for(let b=0;b<a;b++){const p=(b*i+s)*d,f=b*h,m=l(x,p);c(t,f,m)}}else if(g){const k=a*d,x=new ArrayBuffer(k),b=cr(x);for(let p=0;p<i;p++){e.copyTo(x,{planeIndex:p,frameOffset:o,frameCount:a,format:r});for(let f=0;f<a;f++){const m=f*d,v=(f*i+p)*h,w=l(b,m);c(t,v,w)}}}else{const k=new ArrayBuffer(a*i*d),x=cr(k);e.copyTo(k,{planeIndex:0,frameOffset:o,frameCount:a,format:r});for(let b=0;b<a;b++)for(let p=0;p<i;p++){const f=b*i+p,m=f*d,v=f*h,w=l(x,m);c(t,v,w)}}};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class ol{constructor(t){this.value=t}}class al{constructor(t){this.value=t}}class Ah{constructor(t){this.value=t}}class rr{constructor(t){this.value=t}}var _;(function(e){e[e.EBML=440786851]="EBML",e[e.EBMLVersion=17030]="EBMLVersion",e[e.EBMLReadVersion=17143]="EBMLReadVersion",e[e.EBMLMaxIDLength=17138]="EBMLMaxIDLength",e[e.EBMLMaxSizeLength=17139]="EBMLMaxSizeLength",e[e.DocType=17026]="DocType",e[e.DocTypeVersion=17031]="DocTypeVersion",e[e.DocTypeReadVersion=17029]="DocTypeReadVersion",e[e.Void=236]="Void",e[e.Segment=408125543]="Segment",e[e.SeekHead=290298740]="SeekHead",e[e.Seek=19899]="Seek",e[e.SeekID=21419]="SeekID",e[e.SeekPosition=21420]="SeekPosition",e[e.Duration=17545]="Duration",e[e.Info=357149030]="Info",e[e.TimestampScale=2807729]="TimestampScale",e[e.MuxingApp=19840]="MuxingApp",e[e.WritingApp=22337]="WritingApp",e[e.Tracks=374648427]="Tracks",e[e.TrackEntry=174]="TrackEntry",e[e.TrackNumber=215]="TrackNumber",e[e.TrackUID=29637]="TrackUID",e[e.TrackType=131]="TrackType",e[e.FlagEnabled=185]="FlagEnabled",e[e.FlagDefault=136]="FlagDefault",e[e.FlagForced=21930]="FlagForced",e[e.FlagOriginal=21934]="FlagOriginal",e[e.FlagHearingImpaired=21931]="FlagHearingImpaired",e[e.FlagVisualImpaired=21932]="FlagVisualImpaired",e[e.FlagCommentary=21935]="FlagCommentary",e[e.FlagLacing=156]="FlagLacing",e[e.Name=21358]="Name",e[e.Language=2274716]="Language",e[e.LanguageBCP47=2274717]="LanguageBCP47",e[e.CodecID=134]="CodecID",e[e.CodecPrivate=25506]="CodecPrivate",e[e.CodecDelay=22186]="CodecDelay",e[e.SeekPreRoll=22203]="SeekPreRoll",e[e.DefaultDuration=2352003]="DefaultDuration",e[e.Video=224]="Video",e[e.PixelWidth=176]="PixelWidth",e[e.PixelHeight=186]="PixelHeight",e[e.AlphaMode=21440]="AlphaMode",e[e.Audio=225]="Audio",e[e.SamplingFrequency=181]="SamplingFrequency",e[e.Channels=159]="Channels",e[e.BitDepth=25188]="BitDepth",e[e.SimpleBlock=163]="SimpleBlock",e[e.BlockGroup=160]="BlockGroup",e[e.Block=161]="Block",e[e.BlockAdditions=30113]="BlockAdditions",e[e.BlockMore=166]="BlockMore",e[e.BlockAdditional=165]="BlockAdditional",e[e.BlockAddID=238]="BlockAddID",e[e.BlockDuration=155]="BlockDuration",e[e.ReferenceBlock=251]="ReferenceBlock",e[e.Cluster=524531317]="Cluster",e[e.Timestamp=231]="Timestamp",e[e.Cues=475249515]="Cues",e[e.CuePoint=187]="CuePoint",e[e.CueTime=179]="CueTime",e[e.CueTrackPositions=183]="CueTrackPositions",e[e.CueTrack=247]="CueTrack",e[e.CueClusterPosition=241]="CueClusterPosition",e[e.Colour=21936]="Colour",e[e.MatrixCoefficients=21937]="MatrixCoefficients",e[e.TransferCharacteristics=21946]="TransferCharacteristics",e[e.Primaries=21947]="Primaries",e[e.Range=21945]="Range",e[e.Projection=30320]="Projection",e[e.ProjectionType=30321]="ProjectionType",e[e.ProjectionPoseRoll=30325]="ProjectionPoseRoll",e[e.Attachments=423732329]="Attachments",e[e.AttachedFile=24999]="AttachedFile",e[e.FileDescription=18046]="FileDescription",e[e.FileName=18030]="FileName",e[e.FileMediaType=18016]="FileMediaType",e[e.FileData=18012]="FileData",e[e.FileUID=18094]="FileUID",e[e.Chapters=272869232]="Chapters",e[e.Tags=307544935]="Tags",e[e.Tag=29555]="Tag",e[e.Targets=25536]="Targets",e[e.TargetTypeValue=26826]="TargetTypeValue",e[e.TargetType=25546]="TargetType",e[e.TagTrackUID=25541]="TagTrackUID",e[e.TagEditionUID=25545]="TagEditionUID",e[e.TagChapterUID=25540]="TagChapterUID",e[e.TagAttachmentUID=25542]="TagAttachmentUID",e[e.SimpleTag=26568]="SimpleTag",e[e.TagName=17827]="TagName",e[e.TagLanguage=17530]="TagLanguage",e[e.TagString=17543]="TagString",e[e.TagBinary=17541]="TagBinary",e[e.ContentEncodings=28032]="ContentEncodings",e[e.ContentEncoding=25152]="ContentEncoding",e[e.ContentEncodingOrder=20529]="ContentEncodingOrder",e[e.ContentEncodingScope=20530]="ContentEncodingScope",e[e.ContentCompression=20532]="ContentCompression",e[e.ContentCompAlgo=16980]="ContentCompAlgo",e[e.ContentCompSettings=16981]="ContentCompSettings",e[e.ContentEncryption=20533]="ContentEncryption"})(_||(_={}));_.EBML,_.Segment;_.SeekHead,_.Info,_.Cluster,_.Tracks,_.Cues,_.Attachments,_.Chapters,_.Tags;const Mc=e=>e<256?1:e<65536?2:e<1<<24?3:e<2**32?4:e<2**40?5:6,Fc=e=>e<1n<<8n?1:e<1n<<16n?2:e<1n<<24n?3:e<1n<<32n?4:e<1n<<40n?5:e<1n<<48n?6:e<1n<<56n?7:8,zc=e=>e>=-64&&e<64?1:e>=-8192&&e<8192?2:e>=-1048576&&e<1<<20?3:e>=-134217728&&e<1<<27?4:e>=-17179869184&&e<2**34?5:6,Ng=e=>{if(e<127)return 1;if(e<16383)return 2;if(e<(1<<21)-1)return 3;if(e<(1<<28)-1)return 4;if(e<2**35-1)return 5;if(e<2**42-1)return 6;throw new Error("EBML varint size not supported "+e)};class Rg{constructor(t){this.writer=t,this.helper=new Uint8Array(8),this.helperView=new DataView(this.helper.buffer),this.offsets=new WeakMap,this.dataOffsets=new WeakMap}writeByte(t){this.helperView.setUint8(0,t),this.writer.write(this.helper.subarray(0,1))}writeFloat32(t){this.helperView.setFloat32(0,t,!1),this.writer.write(this.helper.subarray(0,4))}writeFloat64(t){this.helperView.setFloat64(0,t,!1),this.writer.write(this.helper)}writeUnsignedInt(t,r=Mc(t)){let n=0;switch(r){case 6:this.helperView.setUint8(n++,t/2**40|0);case 5:this.helperView.setUint8(n++,t/2**32|0);case 4:this.helperView.setUint8(n++,t>>24);case 3:this.helperView.setUint8(n++,t>>16);case 2:this.helperView.setUint8(n++,t>>8);case 1:this.helperView.setUint8(n++,t);break;default:throw new Error("Bad unsigned int size "+r)}this.writer.write(this.helper.subarray(0,n))}writeUnsignedBigInt(t,r=Fc(t)){let n=0;for(let i=r-1;i>=0;i--)this.helperView.setUint8(n++,Number(t>>BigInt(i*8)&0xffn));this.writer.write(this.helper.subarray(0,n))}writeSignedInt(t,r=zc(t)){t<0&&(t+=2**(r*8)),this.writeUnsignedInt(t,r)}writeVarInt(t,r=Ng(t)){let n=0;switch(r){case 1:this.helperView.setUint8(n++,128|t);break;case 2:this.helperView.setUint8(n++,64|t>>8),this.helperView.setUint8(n++,t);break;case 3:this.helperView.setUint8(n++,32|t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 4:this.helperView.setUint8(n++,16|t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 5:this.helperView.setUint8(n++,8|t/2**32&7),this.helperView.setUint8(n++,t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 6:this.helperView.setUint8(n++,4|t/2**40&3),this.helperView.setUint8(n++,t/2**32|0),this.helperView.setUint8(n++,t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;default:throw new Error("Bad EBML varint size "+r)}this.writer.write(this.helper.subarray(0,n))}writeAsciiString(t){this.writer.write(new Uint8Array(t.split("").map(r=>r.charCodeAt(0))))}writeEBML(t){if(t!==null)if(t instanceof Uint8Array)this.writer.write(t);else if(Array.isArray(t))for(const r of t)this.writeEBML(r);else if(this.offsets.set(t,this.writer.getPos()),this.writeUnsignedInt(t.id),Array.isArray(t.data)){const r=this.writer.getPos(),n=t.size===-1?1:t.size??4;t.size===-1?this.writeByte(255):this.writer.seek(this.writer.getPos()+n);const i=this.writer.getPos();if(this.dataOffsets.set(t,i),this.writeEBML(t.data),t.size!==-1){const s=this.writer.getPos()-i,o=this.writer.getPos();this.writer.seek(r),this.writeVarInt(s,n),this.writer.seek(o)}}else if(typeof t.data=="number"){const r=t.size??Mc(t.data);this.writeVarInt(r),this.writeUnsignedInt(t.data,r)}else if(typeof t.data=="bigint"){const r=t.size??Fc(t.data);this.writeVarInt(r),this.writeUnsignedBigInt(t.data,r)}else if(typeof t.data=="string")this.writeVarInt(t.data.length),this.writeAsciiString(t.data);else if(t.data instanceof Uint8Array)this.writeVarInt(t.data.byteLength,t.size),this.writer.write(t.data);else if(t.data instanceof ol)this.writeVarInt(4),this.writeFloat32(t.data.value);else if(t.data instanceof al)this.writeVarInt(8),this.writeFloat64(t.data.value);else if(t.data instanceof Ah){const r=t.size??zc(t.data.value);this.writeVarInt(r),this.writeSignedInt(t.data.value,r)}else if(t.data instanceof rr){const r=Es.encode(t.data.value);this.writeVarInt(r.length),this.writer.write(r)}else mo(t.data)}}const Ag={avc:"V_MPEG4/ISO/AVC",hevc:"V_MPEGH/ISO/HEVC",vp8:"V_VP8",vp9:"V_VP9",av1:"V_AV1",aac:"A_AAC",mp3:"A_MPEG/L3",opus:"A_OPUS",vorbis:"A_VORBIS",flac:"A_FLAC",ac3:"A_AC3",eac3:"A_EAC3","pcm-u8":"A_PCM/INT/LIT","pcm-s16":"A_PCM/INT/LIT","pcm-s16be":"A_PCM/INT/BIG","pcm-s24":"A_PCM/INT/LIT","pcm-s24be":"A_PCM/INT/BIG","pcm-s32":"A_PCM/INT/LIT","pcm-s32be":"A_PCM/INT/BIG","pcm-f32":"A_PCM/FLOAT/IEEE","pcm-f64":"A_PCM/FLOAT/IEEE",webvtt:"S_TEXT/WEBVTT"};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const jg=e=>{let r=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isWebM?"webm":"x-matroska");if(e.codecStrings.length>0){const n=[...new Set(e.codecStrings.filter(Boolean))];r+=`; codecs="${n.join(", ")}"`}return r};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Dg=7,Ig=9,Vc=e=>{const t=e.filePos,r=Mg(e,9),n=new Vn(r);if(n.readBits(12)!==4095||(n.skipBits(1),n.readBits(2)!==0))return null;const o=n.readBits(1),a=n.readBits(2)+1,l=n.readBits(4);if(l===15)return null;n.skipBits(1);const c=n.readBits(3);if(c===0)throw new Error("ADTS frames with channel configuration 0 are not supported.");n.skipBits(1),n.skipBits(1),n.skipBits(1),n.skipBits(1);const d=n.readBits(13);n.skipBits(11);const h=n.readBits(2)+1;if(h!==1)throw new Error("ADTS frames with more than one AAC frame are not supported.");let g=null;return o===1?e.filePos-=2:g=n.readBits(16),{objectType:a,samplingFrequencyIndex:l,channelConfiguration:c,frameLength:d,numberOfAacFrames:h,crcCheck:g,startPos:t}};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Mi{constructor(t,r,n,i,s){this.bytes=t,this.view=r,this.offset=n,this.start=i,this.end=s,this.bufferPos=i-n}static tempFromBytes(t){return new Mi(t,cr(t),0,0,t.length)}get length(){return this.end-this.start}get filePos(){return this.offset+this.bufferPos}set filePos(t){this.bufferPos=t-this.offset}get remainingLength(){return Math.max(this.end-this.filePos,0)}skip(t){this.bufferPos+=t}slice(t,r=this.end-t){if(t<this.start||t+r>this.end)throw new RangeError("Slicing outside of original slice.");return new Mi(this.bytes,this.view,this.offset,t,t+r)}}const Og=(e,t)=>{if(e.filePos<e.start||e.filePos+t>e.end)throw new RangeError(`Tried reading [${e.filePos}, ${e.filePos+t}), but slice is [${e.start}, ${e.end}). This is likely an internal error, please report it alongside the file that caused it.`)},Mg=(e,t)=>{Og(e,t);const r=e.bytes.subarray(e.bufferPos,e.bufferPos+t);return e.bufferPos+=t,r};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Fg{constructor(t){this.mutex=new wh,this.firstMediaStreamTimestamp=null,this.trackTimestampInfo=new WeakMap,this.output=t}onTrackClose(t){}validateAndNormalizeTimestamp(t,r,n){r+=t.source._timestampOffset;let i=this.trackTimestampInfo.get(t);if(!i){if(!n)throw new Error("First packet must be a key packet.");i={maxTimestamp:r,maxTimestampBeforeLastKeyPacket:r},this.trackTimestampInfo.set(t,i)}if(r<0)throw new Error(`Timestamps must be non-negative (got ${r}s).`);if(n&&(i.maxTimestampBeforeLastKeyPacket=i.maxTimestamp),r<i.maxTimestampBeforeLastKeyPacket)throw new Error(`Timestamps cannot be smaller than the largest timestamp of the previous GOP (a GOP begins with a key packet and ends right before the next key packet). Got ${r}s, but largest timestamp is ${i.maxTimestampBeforeLastKeyPacket}s.`);return i.maxTimestamp=Math.max(i.maxTimestamp,r),r}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Uc=/<(?:(\d{2}):)?(\d{2}):(\d{2}).(\d{3})>/g,zg=/(?:(\d{2}):)?(\d{2}):(\d{2}).(\d{3})/,Vg=e=>{const t=zg.exec(e);if(!t)throw new Error("Expected match.");return 60*60*1e3*Number(t[1]||"0")+60*1e3*Number(t[2])+1e3*Number(t[3])+Number(t[4])},Ug=e=>{const t=Math.floor(e/36e5),r=Math.floor(e%(60*60*1e3)/(60*1e3)),n=Math.floor(e%(60*1e3)/1e3),i=e%1e3;return t.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+"."+i.toString().padStart(3,"0")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Lg{constructor(){this.ensureMonotonicity=!1,this.trackedWrites=null,this.trackedStart=-1,this.trackedEnd=-1}start(){}maybeTrackWrites(t){if(!this.trackedWrites)return;let r=this.getPos();if(r<this.trackedStart){if(r+t.byteLength<=this.trackedStart)return;t=t.subarray(this.trackedStart-r),r=0}const n=r+t.byteLength-this.trackedStart;let i=this.trackedWrites.byteLength;for(;i<n;)i*=2;if(i!==this.trackedWrites.byteLength){const s=new Uint8Array(i);s.set(this.trackedWrites,0),this.trackedWrites=s}this.trackedWrites.set(t,r-this.trackedStart),this.trackedEnd=Math.max(this.trackedEnd,r+t.byteLength)}startTrackingWrites(){this.trackedWrites=new Uint8Array(2**10),this.trackedStart=this.getPos(),this.trackedEnd=this.trackedStart}stopTrackingWrites(){if(!this.trackedWrites)throw new Error("Internal error: Can't get tracked writes since nothing was tracked.");const r={data:this.trackedWrites.subarray(0,this.trackedEnd-this.trackedStart),start:this.trackedStart,end:this.trackedEnd};return this.trackedWrites=null,r}}const sa=2**16,oa=2**32;class Bg extends Lg{constructor(t){if(super(),this.pos=0,this.maxPos=0,this.target=t,this.supportsResize="resize"in new ArrayBuffer(0),this.supportsResize)try{this.buffer=new ArrayBuffer(sa,{maxByteLength:oa})}catch{this.buffer=new ArrayBuffer(sa),this.supportsResize=!1}else this.buffer=new ArrayBuffer(sa);this.bytes=new Uint8Array(this.buffer)}ensureSize(t){let r=this.buffer.byteLength;for(;r<t;)r*=2;if(r!==this.buffer.byteLength){if(r>oa)throw new Error(`ArrayBuffer exceeded maximum size of ${oa} bytes. Please consider using another target.`);if(this.supportsResize)this.buffer.resize(r);else{const n=new ArrayBuffer(r),i=new Uint8Array(n);i.set(this.bytes,0),this.buffer=n,this.bytes=i}}}write(t){var r,n;this.maybeTrackWrites(t),this.ensureSize(this.pos+t.byteLength),this.bytes.set(t,this.pos),(n=(r=this.target).onwrite)==null||n.call(r,this.pos,this.pos+t.byteLength),this.pos+=t.byteLength,this.maxPos=Math.max(this.maxPos,this.pos)}seek(t){this.pos=t}getPos(){return this.pos}async flush(){}async finalize(){this.ensureSize(this.pos),this.target.buffer=this.buffer.slice(0,Math.max(this.maxPos,this.pos))}async close(){}getSlice(t,r){return this.bytes.slice(t,r)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class jh{constructor(){this._output=null,this.onwrite=null}}class Wg extends jh{constructor(){super(...arguments),this.buffer=null}_createWriter(){return new Bg(this)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const $g=-32768,Hg=2**15-1,Lc="Mediabunny",Bc=6,Wc=5,Qg={video:1,audio:2,subtitle:17};class Gg extends Fg{constructor(t,r){super(t),this.trackDatas=[],this.allTracksKnown=vh(),this.segment=null,this.segmentInfo=null,this.seekHead=null,this.tracksElement=null,this.tagsElement=null,this.attachmentsElement=null,this.segmentDuration=null,this.cues=null,this.currentCluster=null,this.currentClusterStartMsTimestamp=null,this.currentClusterMaxMsTimestamp=null,this.trackDatasInCurrentCluster=new Map,this.duration=0,this.writer=t._writer,this.format=r,this.ebmlWriter=new Rg(this.writer),this.format._options.appendOnly&&(this.writer.ensureMonotonicity=!0)}async start(){const t=await this.mutex.acquire();this.writeEBMLHeader(),this.createSegmentInfo(),this.createCues(),await this.writer.flush(),t()}writeEBMLHeader(){this.format._options.onEbmlHeader&&this.writer.startTrackingWrites();const t={id:_.EBML,data:[{id:_.EBMLVersion,data:1},{id:_.EBMLReadVersion,data:1},{id:_.EBMLMaxIDLength,data:4},{id:_.EBMLMaxSizeLength,data:8},{id:_.DocType,data:this.format instanceof ll?"webm":"matroska"},{id:_.DocTypeVersion,data:2},{id:_.DocTypeReadVersion,data:2}]};if(this.ebmlWriter.writeEBML(t),this.format._options.onEbmlHeader){const{data:r,start:n}=this.writer.stopTrackingWrites();this.format._options.onEbmlHeader(r,n)}}maybeCreateSeekHead(t){if(this.format._options.appendOnly)return;const r=new Uint8Array([28,83,187,107]),n=new Uint8Array([21,73,169,102]),i=new Uint8Array([22,84,174,107]),s=new Uint8Array([25,65,164,105]),o=new Uint8Array([18,84,195,103]),a={id:_.SeekHead,data:[{id:_.Seek,data:[{id:_.SeekID,data:r},{id:_.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.cues)-this.segmentDataOffset:0}]},{id:_.Seek,data:[{id:_.SeekID,data:n},{id:_.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.segmentInfo)-this.segmentDataOffset:0}]},{id:_.Seek,data:[{id:_.SeekID,data:i},{id:_.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.tracksElement)-this.segmentDataOffset:0}]},this.attachmentsElement?{id:_.Seek,data:[{id:_.SeekID,data:s},{id:_.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.attachmentsElement)-this.segmentDataOffset:0}]}:null,this.tagsElement?{id:_.Seek,data:[{id:_.SeekID,data:o},{id:_.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.tagsElement)-this.segmentDataOffset:0}]}:null]};this.seekHead=a}createSegmentInfo(){const t={id:_.Duration,data:new al(0)};this.segmentDuration=t;const r={id:_.Info,data:[{id:_.TimestampScale,data:1e6},{id:_.MuxingApp,data:Lc},{id:_.WritingApp,data:Lc},this.format._options.appendOnly?null:t]};this.segmentInfo=r}createTracks(){var r,n,i,s,o,a;const t={id:_.Tracks,data:[]};this.tracksElement=t;for(const l of this.trackDatas){const c=Ag[l.track.source._codec];Q(c);let d=0;if(l.type==="audio"&&l.track.source._codec==="opus"){d=1e6*80;const h=l.info.decoderConfig.description;if(h){const g=Xr(h),C=xg(g);d=Math.round(1e9*(C.preSkip/lg))}}t.data.push({id:_.TrackEntry,data:[{id:_.TrackNumber,data:l.track.id},{id:_.TrackUID,data:l.track.id},{id:_.TrackType,data:Qg[l.type]},((r=l.track.metadata.disposition)==null?void 0:r.default)===!1?{id:_.FlagDefault,data:0}:null,(n=l.track.metadata.disposition)!=null&&n.forced?{id:_.FlagForced,data:1}:null,(i=l.track.metadata.disposition)!=null&&i.hearingImpaired?{id:_.FlagHearingImpaired,data:1}:null,(s=l.track.metadata.disposition)!=null&&s.visuallyImpaired?{id:_.FlagVisualImpaired,data:1}:null,(o=l.track.metadata.disposition)!=null&&o.original?{id:_.FlagOriginal,data:1}:null,(a=l.track.metadata.disposition)!=null&&a.commentary?{id:_.FlagCommentary,data:1}:null,{id:_.FlagLacing,data:0},{id:_.Language,data:l.track.metadata.languageCode??Q0},{id:_.CodecID,data:c},{id:_.CodecDelay,data:0},{id:_.SeekPreRoll,data:d},l.track.metadata.name!==void 0?{id:_.Name,data:new rr(l.track.metadata.name)}:null,l.type==="video"?this.videoSpecificTrackInfo(l):null,l.type==="audio"?this.audioSpecificTrackInfo(l):null,l.type==="subtitle"?this.subtitleSpecificTrackInfo(l):null]})}}videoSpecificTrackInfo(t){const{frameRate:r,rotation:n}=t.track.metadata,i=[t.info.decoderConfig.description?{id:_.CodecPrivate,data:Xr(t.info.decoderConfig.description)}:null,r?{id:_.DefaultDuration,data:1e9/r}:null],s=n?B0(-n):0,o=t.info.decoderConfig.colorSpace,a={id:_.Video,data:[{id:_.PixelWidth,data:t.info.width},{id:_.PixelHeight,data:t.info.height},t.info.alphaMode?{id:_.AlphaMode,data:1}:null,$0(o)?{id:_.Colour,data:[{id:_.MatrixCoefficients,data:yh[o.matrix]},{id:_.TransferCharacteristics,data:gh[o.transfer]},{id:_.Primaries,data:mh[o.primaries]},{id:_.Range,data:o.fullRange?2:1}]}:null,s?{id:_.Projection,data:[{id:_.ProjectionType,data:0},{id:_.ProjectionPoseRoll,data:new ol((s+180)%360-180)}]}:null]};return i.push(a),i}audioSpecificTrackInfo(t){const r=At.includes(t.track.source._codec)?Th(t.track.source._codec):null;return[t.info.decoderConfig.description?{id:_.CodecPrivate,data:Xr(t.info.decoderConfig.description)}:null,{id:_.Audio,data:[{id:_.SamplingFrequency,data:new ol(t.info.sampleRate)},{id:_.Channels,data:t.info.numberOfChannels},r?{id:_.BitDepth,data:8*r.sampleSize}:null]}]}subtitleSpecificTrackInfo(t){return[{id:_.CodecPrivate,data:Es.encode(t.info.config.description)}]}maybeCreateTags(){const t=[],r=(s,o)=>{t.push({id:_.SimpleTag,data:[{id:_.TagName,data:new rr(s)},typeof o=="string"?{id:_.TagString,data:new rr(o)}:{id:_.TagBinary,data:o}]})},n=this.output._metadataTags,i=new Set;for(const{key:s,value:o}of Y0(n))switch(s){case"title":r("TITLE",o),i.add("TITLE");break;case"description":r("DESCRIPTION",o),i.add("DESCRIPTION");break;case"artist":r("ARTIST",o),i.add("ARTIST");break;case"album":r("ALBUM",o),i.add("ALBUM");break;case"albumArtist":r("ALBUM_ARTIST",o),i.add("ALBUM_ARTIST");break;case"genre":r("GENRE",o),i.add("GENRE");break;case"comment":r("COMMENT",o),i.add("COMMENT");break;case"lyrics":r("LYRICS",o),i.add("LYRICS");break;case"date":r("DATE",o.toISOString().slice(0,10)),i.add("DATE");break;case"trackNumber":{const a=n.tracksTotal!==void 0?`${o}/${n.tracksTotal}`:o.toString();r("PART_NUMBER",a),i.add("PART_NUMBER")}break;case"discNumber":{const a=n.discsTotal!==void 0?`${o}/${n.discsTotal}`:o.toString();r("DISC",a),i.add("DISC")}break;case"tracksTotal":case"discsTotal":break;case"images":case"raw":break;default:mo(s)}if(n.raw)for(const s in n.raw){const o=n.raw[s];o==null||i.has(s)||(typeof o=="string"||o instanceof Uint8Array)&&r(s,o)}t.length!==0&&(this.tagsElement={id:_.Tags,data:[{id:_.Tag,data:[{id:_.Targets,data:[{id:_.TargetTypeValue,data:50},{id:_.TargetType,data:"MOVIE"}]},...t]}]})}maybeCreateAttachments(){const t=this.output._metadataTags,r=[],n=new Set,i=t.images??[];for(const s of i){let o=s.name;o===void 0&&(o=(s.kind==="coverFront"?"cover":s.kind==="coverBack"?"back":"image")+(q0(s.mimeType)??""));let a;for(;;){a=0n;for(let l=0;l<8;l++)a<<=8n,a|=BigInt(Math.floor(Math.random()*256));if(a!==0n&&!n.has(a))break}n.add(a),r.push({id:_.AttachedFile,data:[s.description!==void 0?{id:_.FileDescription,data:new rr(s.description)}:null,{id:_.FileName,data:new rr(o)},{id:_.FileMediaType,data:s.mimeType},{id:_.FileData,data:s.data},{id:_.FileUID,data:a}]})}for(const[s,o]of Object.entries(t.raw??{}))!(o instanceof Ch)||!/^\d+$/.test(s)||i.find(l=>l.mimeType===o.mimeType&&Z0(l.data,o.data))||r.push({id:_.AttachedFile,data:[o.description!==void 0?{id:_.FileDescription,data:new rr(o.description)}:null,{id:_.FileName,data:new rr(o.name??"")},{id:_.FileMediaType,data:o.mimeType??""},{id:_.FileData,data:o.data},{id:_.FileUID,data:BigInt(s)}]});r.length!==0&&(this.attachmentsElement={id:_.Attachments,data:r})}createSegment(){this.createTracks(),this.maybeCreateTags(),this.maybeCreateAttachments(),this.maybeCreateSeekHead(!1);const t={id:_.Segment,size:this.format._options.appendOnly?-1:Bc,data:[this.seekHead,this.segmentInfo,this.tracksElement,this.attachmentsElement,this.tagsElement]};if(this.segment=t,this.format._options.onSegmentHeader&&this.writer.startTrackingWrites(),this.ebmlWriter.writeEBML(t),this.format._options.onSegmentHeader){const{data:r,start:n}=this.writer.stopTrackingWrites();this.format._options.onSegmentHeader(r,n)}}createCues(){this.cues={id:_.Cues,data:[]}}get segmentDataOffset(){return Q(this.segment),this.ebmlWriter.dataOffsets.get(this.segment)}allTracksAreKnown(){for(const t of this.output._tracks)if(!t.source._closed&&!this.trackDatas.some(r=>r.track===t))return!1;return!0}async getMimeType(){await this.allTracksKnown.promise;const t=this.trackDatas.map(r=>r.type==="video"||r.type==="audio"?r.info.decoderConfig.codec:{webvtt:"wvtt"}[r.track.source._codec]);return jg({isWebM:this.format instanceof ll,hasVideo:this.trackDatas.some(r=>r.type==="video"),hasAudio:this.trackDatas.some(r=>r.type==="audio"),codecStrings:t})}getVideoTrackData(t,r,n){const i=this.trackDatas.find(o=>o.track===t);if(i)return i;gg(n),Q(n),Q(n.decoderConfig),Q(n.decoderConfig.codedWidth!==void 0),Q(n.decoderConfig.codedHeight!==void 0);const s={track:t,type:"video",info:{width:n.decoderConfig.codedWidth,height:n.decoderConfig.codedHeight,decoderConfig:n.decoderConfig,alphaMode:!!r.sideData.alpha},chunkQueue:[],lastWrittenMsTimestamp:null};return t.source._codec==="vp9"?s.info.decoderConfig={...s.info.decoderConfig,description:new Uint8Array(ig(s.info.decoderConfig.codec))}:t.source._codec==="av1"&&(s.info.decoderConfig={...s.info.decoderConfig,description:new Uint8Array(sg(s.info.decoderConfig.codec))}),this.trackDatas.push(s),this.trackDatas.sort((o,a)=>o.track.id-a.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),s}getAudioTrackData(t,r,n){const i=this.trackDatas.find(l=>l.track===t);if(i)return i;wg(n),Q(n),Q(n.decoderConfig);const s={...n.decoderConfig};let o=!1;if(t.source._codec==="aac"&&!s.description){const l=Vc(Mi.tempFromBytes(r.data));if(!l)throw new Error("Couldn't parse ADTS header from the AAC packet. Make sure the packets are in ADTS format (as specified in ISO 13818-7) when not providing a description, or provide a description (must be an AudioSpecificConfig as specified in ISO 14496-3) and ensure the packets are raw AAC data.");const c=Ks[l.samplingFrequencyIndex],d=ou[l.channelConfiguration];if(c===void 0||d===void 0)throw new Error("Invalid ADTS frame header.");s.description=bh({objectType:l.objectType,sampleRate:c,numberOfChannels:d}),o=!0}const a={track:t,type:"audio",info:{numberOfChannels:n.decoderConfig.numberOfChannels,sampleRate:n.decoderConfig.sampleRate,decoderConfig:s,requiresAdtsStripping:o},chunkQueue:[],lastWrittenMsTimestamp:null};return this.trackDatas.push(a),this.trackDatas.sort((l,c)=>l.track.id-c.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),a}getSubtitleTrackData(t,r){const n=this.trackDatas.find(s=>s.track===t);if(n)return n;vg(r),Q(r),Q(r.config);const i={track:t,type:"subtitle",info:{config:r.config},chunkQueue:[],lastWrittenMsTimestamp:null};return this.trackDatas.push(i),this.trackDatas.sort((s,o)=>s.track.id-o.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),i}async addEncodedVideoPacket(t,r,n){const i=await this.mutex.acquire();try{const s=this.getVideoTrackData(t,r,n),o=r.type==="key";let a=this.validateAndNormalizeTimestamp(s.track,r.timestamp,o),l=r.duration;t.metadata.frameRate!==void 0&&(a=bc(a,1/t.metadata.frameRate),l=bc(l,1/t.metadata.frameRate));const c=s.info.alphaMode?r.sideData.alpha??null:null,d=this.createInternalChunk(r.data,a,l,r.type,c);t.source._codec==="vp9"&&this.fixVP9ColorSpace(s,d),s.chunkQueue.push(d),await this.interleaveChunks()}finally{i()}}async addEncodedAudioPacket(t,r,n){const i=await this.mutex.acquire();try{const s=this.getAudioTrackData(t,r,n);let o=r.data;if(s.info.requiresAdtsStripping){const d=Vc(Mi.tempFromBytes(o));if(!d)throw new Error("Expected ADTS frame, didn't get one.");const h=d.crcCheck===null?Dg:Ig;o=o.subarray(h)}const a=r.type==="key",l=this.validateAndNormalizeTimestamp(s.track,r.timestamp,a),c=this.createInternalChunk(o,l,r.duration,r.type);s.chunkQueue.push(c),await this.interleaveChunks()}finally{i()}}async addSubtitleCue(t,r,n){const i=await this.mutex.acquire();try{const s=this.getSubtitleTrackData(t,n),o=this.validateAndNormalizeTimestamp(s.track,r.timestamp,!0);let a=r.text;const l=Math.round(o*1e3);Uc.lastIndex=0,a=a.replace(Uc,g=>{const k=Vg(g.slice(1,-1))-l;return`<${Ug(k)}>`});const c=Es.encode(a),d=`${r.settings??""}
${r.identifier??""}
${r.notes??""}`,h=this.createInternalChunk(c,o,r.duration,"key",d.trim()?Es.encode(d):null);s.chunkQueue.push(h),await this.interleaveChunks()}finally{i()}}async interleaveChunks(t=!1){if(!(!t&&!this.allTracksAreKnown())){e:for(;;){let r=null,n=1/0;for(const s of this.trackDatas){if(!t&&s.chunkQueue.length===0&&!s.track.source._closed)break e;s.chunkQueue.length>0&&s.chunkQueue[0].timestamp<n&&(r=s,n=s.chunkQueue[0].timestamp)}if(!r)break;const i=r.chunkQueue.shift();this.writeBlock(r,i)}t||await this.writer.flush()}}fixVP9ColorSpace(t,r){if(r.type!=="key"||!t.info.decoderConfig.colorSpace||!t.info.decoderConfig.colorSpace.matrix)return;const n=new Vn(r.data);n.skipBits(2);const i=n.readBits(1),o=(n.readBits(1)<<1)+i;if(o===3&&n.skipBits(1),n.readBits(1)||n.readBits(1)!==0||(n.skipBits(2),n.readBits(24)!==4817730))return;o>=2&&n.skipBits(1);const d={rgb:7,bt709:2,bt470bg:1,smpte170m:3}[t.info.decoderConfig.colorSpace.matrix];W0(r.data,n.pos,n.pos+3,d)}createInternalChunk(t,r,n,i,s=null){return{data:t,type:i,timestamp:r,duration:n,additions:s}}writeBlock(t,r){this.segment||this.createSegment();const n=Math.round(1e3*r.timestamp),i=this.trackDatas.every(d=>{if(t===d)return r.type==="key";const h=d.chunkQueue[0];return h?h.type==="key":d.track.source._closed});let s=!1;if(!this.currentCluster)s=!0;else{Q(this.currentClusterStartMsTimestamp!==null),Q(this.currentClusterMaxMsTimestamp!==null);const d=n-this.currentClusterStartMsTimestamp;s=i&&n>this.currentClusterMaxMsTimestamp&&d>=1e3*(this.format._options.minimumClusterDuration??1)||d>Hg}s&&this.createNewCluster(n);const o=n-this.currentClusterStartMsTimestamp;if(o<$g)return;const a=new Uint8Array(4),l=new DataView(a.buffer);l.setUint8(0,128|t.track.id),l.setInt16(1,o,!1);const c=Math.round(1e3*r.duration);if(r.additions){const d={id:_.BlockGroup,data:[{id:_.Block,data:[a,r.data]},r.type==="delta"?{id:_.ReferenceBlock,data:new Ah(t.lastWrittenMsTimestamp-n)}:null,r.additions?{id:_.BlockAdditions,data:[{id:_.BlockMore,data:[{id:_.BlockAddID,data:1},{id:_.BlockAdditional,data:r.additions}]}]}:null,c>0?{id:_.BlockDuration,data:c}:null]};this.ebmlWriter.writeEBML(d)}else{l.setUint8(3,+(r.type==="key")<<7);const d={id:_.SimpleBlock,data:[a,r.data]};this.ebmlWriter.writeEBML(d)}this.duration=Math.max(this.duration,n+c),t.lastWrittenMsTimestamp=n,this.trackDatasInCurrentCluster.has(t)||this.trackDatasInCurrentCluster.set(t,{firstMsTimestamp:n}),this.currentClusterMaxMsTimestamp=Math.max(this.currentClusterMaxMsTimestamp,n)}createNewCluster(t){this.currentCluster&&this.finalizeCurrentCluster(),this.format._options.onCluster&&this.writer.startTrackingWrites(),this.currentCluster={id:_.Cluster,size:this.format._options.appendOnly?-1:Wc,data:[{id:_.Timestamp,data:t}]},this.ebmlWriter.writeEBML(this.currentCluster),this.currentClusterStartMsTimestamp=t,this.currentClusterMaxMsTimestamp=t,this.trackDatasInCurrentCluster.clear()}finalizeCurrentCluster(){if(Q(this.currentCluster),!this.format._options.appendOnly){const i=this.writer.getPos()-this.ebmlWriter.dataOffsets.get(this.currentCluster),s=this.writer.getPos();this.writer.seek(this.ebmlWriter.offsets.get(this.currentCluster)+4),this.ebmlWriter.writeVarInt(i,Wc),this.writer.seek(s)}if(this.format._options.onCluster){Q(this.currentClusterStartMsTimestamp!==null);const{data:i,start:s}=this.writer.stopTrackingWrites();this.format._options.onCluster(i,s,this.currentClusterStartMsTimestamp/1e3)}const t=this.ebmlWriter.offsets.get(this.currentCluster)-this.segmentDataOffset,r=new Map;for(const[i,{firstMsTimestamp:s}]of this.trackDatasInCurrentCluster)r.has(s)||r.set(s,[]),r.get(s).push(i);const n=[...r.entries()].sort((i,s)=>i[0]-s[0]);for(const[i,s]of n)Q(this.cues),this.cues.data.push({id:_.CuePoint,data:[{id:_.CueTime,data:i},...s.map(o=>({id:_.CueTrackPositions,data:[{id:_.CueTrack,data:o.track.id},{id:_.CueClusterPosition,data:t}]}))]})}async onTrackClose(){const t=await this.mutex.acquire();this.allTracksAreKnown()&&this.allTracksKnown.resolve(),await this.interleaveChunks(),t()}async finalize(){const t=await this.mutex.acquire();if(this.allTracksKnown.resolve(),this.segment||this.createSegment(),await this.interleaveChunks(!0),this.currentCluster&&this.finalizeCurrentCluster(),Q(this.cues),this.ebmlWriter.writeEBML(this.cues),!this.format._options.appendOnly){const r=this.writer.getPos(),n=this.writer.getPos()-this.segmentDataOffset;this.writer.seek(this.ebmlWriter.offsets.get(this.segment)+4),this.ebmlWriter.writeVarInt(n,Bc),this.segmentDuration.data=new al(this.duration),this.writer.seek(this.ebmlWriter.offsets.get(this.segmentDuration)),this.ebmlWriter.writeEBML(this.segmentDuration),Q(this.seekHead),this.writer.seek(this.ebmlWriter.offsets.get(this.seekHead)),this.maybeCreateSeekHead(!0),this.ebmlWriter.writeEBML(this.seekHead),this.writer.seek(r)}t()}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Dh{getSupportedVideoCodecs(){return this.getSupportedCodecs().filter(t=>Sr.includes(t))}getSupportedAudioCodecs(){return this.getSupportedCodecs().filter(t=>en.includes(t))}getSupportedSubtitleCodecs(){return this.getSupportedCodecs().filter(t=>Oi.includes(t))}_codecUnsupportedHint(t){return""}}class $c extends Dh{constructor(t={}){if(!t||typeof t!="object")throw new TypeError("options must be an object.");if(t.appendOnly!==void 0&&typeof t.appendOnly!="boolean")throw new TypeError("options.appendOnly, when provided, must be a boolean.");if(t.minimumClusterDuration!==void 0&&(!Number.isFinite(t.minimumClusterDuration)||t.minimumClusterDuration<0))throw new TypeError("options.minimumClusterDuration, when provided, must be a non-negative number.");if(t.onEbmlHeader!==void 0&&typeof t.onEbmlHeader!="function")throw new TypeError("options.onEbmlHeader, when provided, must be a function.");if(t.onSegmentHeader!==void 0&&typeof t.onSegmentHeader!="function")throw new TypeError("options.onHeader, when provided, must be a function.");if(t.onCluster!==void 0&&typeof t.onCluster!="function")throw new TypeError("options.onCluster, when provided, must be a function.");super(),this._options=t}_createMuxer(t){return new Gg(t,this)}get _name(){return"Matroska"}getSupportedTrackCounts(){return{video:{min:0,max:127},audio:{min:0,max:127},subtitle:{min:0,max:127},total:{min:1,max:127}}}get fileExtension(){return".mkv"}get mimeType(){return"video/x-matroska"}getSupportedCodecs(){return[...Sr,...Eh,...At.filter(t=>!["pcm-s8","pcm-f32be","pcm-f64be","ulaw","alaw"].includes(t)),...Oi]}get supportsVideoRotationMetadata(){return!1}get supportsTimestampedMediaData(){return!0}}class ll extends $c{constructor(t){super(t)}getSupportedCodecs(){return[...Sr.filter(t=>["vp8","vp9","av1"].includes(t)),...en.filter(t=>["opus","vorbis"].includes(t)),...Oi]}get _name(){return"WebM"}get fileExtension(){return".webm"}get mimeType(){return"video/webm"}_codecUnsupportedHint(t){return new $c().getSupportedCodecs().includes(t)?" Switching to MKV will grant support for this codec.":""}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Xg=e=>{if(!e||typeof e!="object")throw new TypeError("Encoding config must be an object.");if(!Sr.includes(e.codec))throw new TypeError(`Invalid video codec '${e.codec}'. Must be one of: ${Sr.join(", ")}.`);if(!(e.bitrate instanceof nn)&&(!Number.isInteger(e.bitrate)||e.bitrate<=0))throw new TypeError("config.bitrate must be a positive integer or a quality.");if(e.keyFrameInterval!==void 0&&(!Number.isFinite(e.keyFrameInterval)||e.keyFrameInterval<0))throw new TypeError("config.keyFrameInterval, when provided, must be a non-negative number.");if(e.sizeChangeBehavior!==void 0&&!["deny","passThrough","fill","contain","cover"].includes(e.sizeChangeBehavior))throw new TypeError("config.sizeChangeBehavior, when provided, must be 'deny', 'passThrough', 'fill', 'contain' or 'cover'.");if(e.onEncodedPacket!==void 0&&typeof e.onEncodedPacket!="function")throw new TypeError("config.onEncodedChunk, when provided, must be a function.");if(e.onEncoderConfig!==void 0&&typeof e.onEncoderConfig!="function")throw new TypeError("config.onEncoderConfig, when provided, must be a function.");Ih(e.codec,e)},Ih=(e,t)=>{if(!t||typeof t!="object")throw new TypeError("Encoding options must be an object.");if(t.alpha!==void 0&&!["discard","keep"].includes(t.alpha))throw new TypeError("options.alpha, when provided, must be 'discard' or 'keep'.");if(t.bitrateMode!==void 0&&!["constant","variable"].includes(t.bitrateMode))throw new TypeError("bitrateMode, when provided, must be 'constant' or 'variable'.");if(t.latencyMode!==void 0&&!["quality","realtime"].includes(t.latencyMode))throw new TypeError("latencyMode, when provided, must be 'quality' or 'realtime'.");if(t.fullCodecString!==void 0&&typeof t.fullCodecString!="string")throw new TypeError("fullCodecString, when provided, must be a string.");if(t.fullCodecString!==void 0&&_h(t.fullCodecString)!==e)throw new TypeError(`fullCodecString, when provided, must be a string that matches the specified codec (${e}).`);if(t.hardwareAcceleration!==void 0&&!["no-preference","prefer-hardware","prefer-software"].includes(t.hardwareAcceleration))throw new TypeError("hardwareAcceleration, when provided, must be 'no-preference', 'prefer-hardware' or 'prefer-software'.");if(t.scalabilityMode!==void 0&&typeof t.scalabilityMode!="string")throw new TypeError("scalabilityMode, when provided, must be a string.");if(t.contentHint!==void 0&&typeof t.contentHint!="string")throw new TypeError("contentHint, when provided, must be a string.")},ul=e=>{const t=e.bitrate instanceof nn?e.bitrate._toVideoBitrate(e.codec,e.width,e.height):e.bitrate;return{codec:e.fullCodecString??ng(e.codec,e.width,e.height,t),width:e.width,height:e.height,bitrate:t,bitrateMode:e.bitrateMode,alpha:e.alpha??"discard",framerate:e.framerate,latencyMode:e.latencyMode,hardwareAcceleration:e.hardwareAcceleration,scalabilityMode:e.scalabilityMode,contentHint:e.contentHint,...ug(e.codec)}},Kg=e=>{if(!e||typeof e!="object")throw new TypeError("Encoding config must be an object.");if(!en.includes(e.codec))throw new TypeError(`Invalid audio codec '${e.codec}'. Must be one of: ${en.join(", ")}.`);if(e.bitrate===void 0&&(!At.includes(e.codec)||e.codec==="flac"))throw new TypeError("config.bitrate must be provided for compressed audio codecs.");if(e.bitrate!==void 0&&!(e.bitrate instanceof nn)&&(!Number.isInteger(e.bitrate)||e.bitrate<=0))throw new TypeError("config.bitrate, when provided, must be a positive integer or a quality.");if(e.onEncodedPacket!==void 0&&typeof e.onEncodedPacket!="function")throw new TypeError("config.onEncodedChunk, when provided, must be a function.");if(e.onEncoderConfig!==void 0&&typeof e.onEncoderConfig!="function")throw new TypeError("config.onEncoderConfig, when provided, must be a function.");Oh(e.codec,e)},Oh=(e,t)=>{if(!t||typeof t!="object")throw new TypeError("Encoding options must be an object.");if(t.bitrateMode!==void 0&&!["constant","variable"].includes(t.bitrateMode))throw new TypeError("bitrateMode, when provided, must be 'constant' or 'variable'.");if(t.fullCodecString!==void 0&&typeof t.fullCodecString!="string")throw new TypeError("fullCodecString, when provided, must be a string.");if(t.fullCodecString!==void 0&&_h(t.fullCodecString)!==e)throw new TypeError(`fullCodecString, when provided, must be a string that matches the specified codec (${e}).`)},cl=e=>{const t=e.bitrate instanceof nn?e.bitrate._toAudioBitrate(e.codec):e.bitrate;return{codec:e.fullCodecString??og(e.codec,e.numberOfChannels,e.sampleRate),numberOfChannels:e.numberOfChannels,sampleRate:e.sampleRate,bitrate:t,bitrateMode:e.bitrateMode,...cg(e.codec)}};class nn{constructor(t){this._factor=t}_toVideoBitrate(t,r,n){const i=r*n,s={avc:1,hevc:.6,vp9:.6,av1:.4,vp8:1.2},o=1920*1080,a=3e6,l=Math.pow(i/o,.95),h=a*l*s[t]*this._factor;return Math.ceil(h/1e3)*1e3}_toAudioBitrate(t){if(At.includes(t)||t==="flac")return;const n={aac:128e3,opus:64e3,mp3:16e4,vorbis:64e3,ac3:384e3,eac3:192e3}[t];if(!n)throw new Error(`Unhandled codec: ${t}`);let i=n*this._factor;return t==="aac"?i=[96e3,128e3,16e4,192e3].reduce((o,a)=>Math.abs(a-i)<Math.abs(o-i)?a:o):t==="opus"||t==="vorbis"?i=Math.max(6e3,i):t==="mp3"&&(i=[8e3,16e3,24e3,32e3,4e4,48e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4].reduce((o,a)=>Math.abs(a-i)<Math.abs(o-i)?a:o)),Math.round(i/1e3)*1e3}}const Yg=new nn(2),qg=async(e,t={})=>{const{width:r=1280,height:n=720,bitrate:i=1e6,...s}=t;if(!Sr.includes(e))return!1;if(!Number.isInteger(r)||r<=0)throw new TypeError("width must be a positive integer.");if(!Number.isInteger(n)||n<=0)throw new TypeError("height must be a positive integer.");if(!(i instanceof nn)&&(!Number.isInteger(i)||i<=0))throw new TypeError("bitrate must be a positive integer or a quality.");Ih(e,s);let o=null;return il.length>0&&(o??(o=ul({codec:e,width:r,height:n,bitrate:i,framerate:void 0,...s})),il.some(l=>l.supports(e,o)))?!0:typeof VideoEncoder>"u"||(o??(o=ul({codec:e,width:r,height:n,bitrate:i,framerate:void 0,...s,alpha:"discard"})),!(await VideoEncoder.isConfigSupported(o)).supported)?!1:Xs()?new Promise(async l=>{try{const c=new VideoEncoder({output:()=>{},error:()=>l(!1)});c.configure(o);const d=new Uint8Array(r*n*4),h=new VideoFrame(d,{format:"RGBA",codedWidth:r,codedHeight:n,timestamp:0});c.encode(h),h.close(),await c.flush(),l(!0)}catch{l(!1)}}):!0},Zg=async(e,t={})=>{const{numberOfChannels:r=2,sampleRate:n=48e3,bitrate:i=128e3,...s}=t;if(!en.includes(e))return!1;if(!Number.isInteger(r)||r<=0)throw new TypeError("numberOfChannels must be a positive integer.");if(!Number.isInteger(n)||n<=0)throw new TypeError("sampleRate must be a positive integer.");if(!(i instanceof nn)&&(!Number.isInteger(i)||i<=0))throw new TypeError("bitrate must be a positive integer.");Oh(e,s);let o=null;return sl.length>0&&(o??(o=cl({codec:e,numberOfChannels:r,sampleRate:n,bitrate:i,...s})),sl.some(l=>l.supports(e,o)))||At.includes(e)?!0:typeof AudioEncoder>"u"?!1:(o??(o=cl({codec:e,numberOfChannels:r,sampleRate:n,bitrate:i,...s})),(await AudioEncoder.isConfigSupported(o)).supported===!0)};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class au{constructor(){this._connectedTrack=null,this._closingPromise=null,this._closed=!1,this._timestampOffset=0}_ensureValidAdd(){if(!this._connectedTrack)throw new Error("Source is not connected to an output track.");if(this._connectedTrack.output.state==="canceled")throw new Error("Output has been canceled.");if(this._connectedTrack.output.state==="finalizing"||this._connectedTrack.output.state==="finalized")throw new Error("Output has been finalized.");if(this._connectedTrack.output.state==="pending")throw new Error("Output has not started.");if(this._closed)throw new Error("Source is closed.")}async _start(){}async _flushAndClose(t){}close(){if(this._closingPromise)return;const t=this._connectedTrack;if(!t)throw new Error("Cannot call close without connecting the source to an output track.");if(t.output.state==="pending")throw new Error("Cannot call close before output has been started.");this._closingPromise=(async()=>{await this._flushAndClose(!1),this._closed=!0,!(t.output.state==="finalizing"||t.output.state==="finalized")&&t.output._muxer.onTrackClose(t)})()}async _flushOrWaitForOngoingClose(t){return this._closingPromise??(this._closingPromise=(async()=>{await this._flushAndClose(t),this._closed=!0})())}}class Mh extends au{constructor(t){if(super(),this._connectedTrack=null,!Sr.includes(t))throw new TypeError(`Invalid video codec '${t}'. Must be one of: ${Sr.join(", ")}.`);this._codec=t}}class Jg{constructor(t,r){this.source=t,this.encodingConfig=r,this.ensureEncoderPromise=null,this.encoderInitialized=!1,this.encoder=null,this.muxer=null,this.lastMultipleOfKeyFrameInterval=-1,this.codedWidth=null,this.codedHeight=null,this.resizeCanvas=null,this.customEncoder=null,this.customEncoderCallSerializer=new kh,this.customEncoderQueueSize=0,this.alphaEncoder=null,this.splitter=null,this.splitterCreationFailed=!1,this.alphaFrameQueue=[],this.error=null}async add(t,r,n){try{if(this.checkForEncoderError(),this.source._ensureValidAdd(),this.codedWidth!==null&&this.codedHeight!==null){if(t.codedWidth!==this.codedWidth||t.codedHeight!==this.codedHeight){const a=this.encodingConfig.sizeChangeBehavior??"deny";if(a!=="passThrough"){if(a==="deny")throw new Error(`Video sample size must remain constant. Expected ${this.codedWidth}x${this.codedHeight}, got ${t.codedWidth}x${t.codedHeight}. To allow the sample size to change over time, set \`sizeChangeBehavior\` to a value other than 'strict' in the encoding options.`);{let l=!1;this.resizeCanvas||(typeof document<"u"?(this.resizeCanvas=document.createElement("canvas"),this.resizeCanvas.width=this.codedWidth,this.resizeCanvas.height=this.codedHeight):this.resizeCanvas=new OffscreenCanvas(this.codedWidth,this.codedHeight),l=!0);const c=this.resizeCanvas.getContext("2d",{alpha:Xs()});Q(c),l||(Xs()?(c.fillStyle="black",c.fillRect(0,0,this.codedWidth,this.codedHeight)):c.clearRect(0,0,this.codedWidth,this.codedHeight)),t.drawWithFit(c,{fit:a}),r&&t.close(),t=new Wr(this.resizeCanvas,{timestamp:t.timestamp,duration:t.duration,rotation:t.rotation}),r=!0}}}}else this.codedWidth=t.codedWidth,this.codedHeight=t.codedHeight;this.encoderInitialized||(this.ensureEncoderPromise||this.ensureEncoder(t),this.encoderInitialized||await this.ensureEncoderPromise),Q(this.encoderInitialized);const i=this.encodingConfig.keyFrameInterval??5,s=Math.floor(t.timestamp/i),o={...n,keyFrame:(n==null?void 0:n.keyFrame)||i===0||s!==this.lastMultipleOfKeyFrameInterval};if(this.lastMultipleOfKeyFrameInterval=s,this.customEncoder){this.customEncoderQueueSize++;const a=t.clone(),l=this.customEncoderCallSerializer.call(()=>this.customEncoder.encode(a,o)).then(()=>this.customEncoderQueueSize--).catch(c=>this.error??(this.error=c)).finally(()=>{a.close()});this.customEncoderQueueSize>=4&&await l}else{Q(this.encoder);const a=t.toVideoFrame();if(!this.alphaEncoder)this.encoder.encode(a,o),a.close();else if(!!a.format&&!a.format.includes("A")||this.splitterCreationFailed)this.alphaFrameQueue.push(null),this.encoder.encode(a,o),a.close();else{const c=a.displayWidth,d=a.displayHeight;if(!this.splitter)try{this.splitter=new ey(c,d)}catch(h){console.error("Due to an error, only color data will be encoded.",h),this.splitterCreationFailed=!0,this.alphaFrameQueue.push(null),this.encoder.encode(a,o),a.close()}if(this.splitter){const h=this.splitter.extractColor(a),g=this.splitter.extractAlpha(a);this.alphaFrameQueue.push(g),this.encoder.encode(h,o),h.close(),a.close()}}r&&t.close(),this.encoder.encodeQueueSize>=4&&await new Promise(l=>this.encoder.addEventListener("dequeue",l,{once:!0}))}await this.muxer.mutex.currentPromise}finally{r&&t.close()}}ensureEncoder(t){this.ensureEncoderPromise=(async()=>{var i,s,o;const r=ul({width:t.codedWidth,height:t.codedHeight,...this.encodingConfig,framerate:(i=this.source._connectedTrack)==null?void 0:i.metadata.frameRate});(o=(s=this.encodingConfig).onEncoderConfig)==null||o.call(s,r);const n=il.find(a=>a.supports(this.encodingConfig.codec,r));if(n)this.customEncoder=new n,this.customEncoder.codec=this.encodingConfig.codec,this.customEncoder.config=r,this.customEncoder.onPacket=(a,l)=>{var c,d;if(!(a instanceof Cr))throw new TypeError("The first argument passed to onPacket must be an EncodedPacket.");if(l!==void 0&&(!l||typeof l!="object"))throw new TypeError("The second argument passed to onPacket must be an object or undefined.");(d=(c=this.encodingConfig).onEncodedPacket)==null||d.call(c,a,l),this.muxer.addEncodedVideoPacket(this.source._connectedTrack,a,l).catch(h=>{this.error??(this.error=h)})},await this.customEncoder.init();else{if(typeof VideoEncoder>"u")throw new Error("VideoEncoder is not supported by this browser.");if(r.alpha="discard",this.encodingConfig.alpha==="keep"&&(r.latencyMode="quality"),(r.width%2===1||r.height%2===1)&&(this.encodingConfig.codec==="avc"||this.encodingConfig.codec==="hevc"))throw new Error(`The dimensions ${r.width}x${r.height} are not supported for codec '${this.encodingConfig.codec}'; both width and height must be even numbers. Make sure to round your dimensions to the nearest even number.`);if(!(await VideoEncoder.isConfigSupported(r)).supported)throw new Error(`This specific encoder configuration (${r.codec}, ${r.bitrate} bps, ${r.width}x${r.height}, hardware acceleration: ${r.hardwareAcceleration??"no-preference"}) is not supported by this browser. Consider using another codec or changing your video parameters.`);const c=[],d=[];let h=0,g=0;const C=(x,b,p)=>{var v,w;const f={};if(b){const S=new Uint8Array(b.byteLength);b.copyTo(S),f.alpha=S}const m=Cr.fromEncodedChunk(x,f);(w=(v=this.encodingConfig).onEncodedPacket)==null||w.call(v,m,p),this.muxer.addEncodedVideoPacket(this.source._connectedTrack,m,p).catch(S=>{this.error??(this.error=S)})},k=new Error("Encoding error").stack;if(this.encoder=new VideoEncoder({output:(x,b)=>{if(!this.alphaEncoder){C(x,null,b);return}const p=this.alphaFrameQueue.shift();Q(p!==void 0),p?(this.alphaEncoder.encode(p,{keyFrame:x.type==="key"}),g++,p.close(),c.push({chunk:x,meta:b})):g===0?C(x,null,b):(d.push(h+g),c.push({chunk:x,meta:b}))},error:x=>{x.stack=k,this.error??(this.error=x)}}),this.encoder.configure(r),this.encodingConfig.alpha==="keep"){const x=new Error("Encoding error").stack;this.alphaEncoder=new VideoEncoder({output:(b,p)=>{g--;const f=c.shift();for(Q(f!==void 0),C(f.chunk,b,f.meta),h++;d.length>0&&d[0]===h;){d.shift();const m=c.shift();Q(m!==void 0),C(m.chunk,null,m.meta)}},error:b=>{b.stack=x,this.error??(this.error=b)}}),this.alphaEncoder.configure(r)}}Q(this.source._connectedTrack),this.muxer=this.source._connectedTrack.output._muxer,this.encoderInitialized=!0})()}async flushAndClose(t){var r,n;t||this.checkForEncoderError(),this.customEncoder?(t||this.customEncoderCallSerializer.call(()=>this.customEncoder.flush()),await this.customEncoderCallSerializer.call(()=>this.customEncoder.close())):this.encoder&&(t||(await this.encoder.flush(),await((r=this.alphaEncoder)==null?void 0:r.flush())),this.encoder.state!=="closed"&&this.encoder.close(),this.alphaEncoder&&this.alphaEncoder.state!=="closed"&&this.alphaEncoder.close(),this.alphaFrameQueue.forEach(i=>i==null?void 0:i.close()),(n=this.splitter)==null||n.close()),t||this.checkForEncoderError()}getQueueSize(){var t;return this.customEncoder?this.customEncoderQueueSize:((t=this.encoder)==null?void 0:t.encodeQueueSize)??0}checkForEncoderError(){if(this.error)throw this.error}}class ey{constructor(t,r){this.lastFrame=null,typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(t,r):(this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=r);const n=this.canvas.getContext("webgl2",{alpha:!0});if(!n)throw new Error("Couldn't acquire WebGL 2 context.");this.gl=n,this.colorProgram=this.createColorProgram(),this.alphaProgram=this.createAlphaProgram(),this.vao=this.createVAO(),this.sourceTexture=this.createTexture(),this.alphaResolutionLocation=this.gl.getUniformLocation(this.alphaProgram,"u_resolution"),this.gl.useProgram(this.colorProgram),this.gl.uniform1i(this.gl.getUniformLocation(this.colorProgram,"u_sourceTexture"),0),this.gl.useProgram(this.alphaProgram),this.gl.uniform1i(this.gl.getUniformLocation(this.alphaProgram,"u_sourceTexture"),0)}createVertexShader(){return this.createShader(this.gl.VERTEX_SHADER,`#version 300 es
			in vec2 a_position;
			in vec2 a_texCoord;
			out vec2 v_texCoord;
			
			void main() {
				gl_Position = vec4(a_position, 0.0, 1.0);
				v_texCoord = a_texCoord;
			}
		`)}createColorProgram(){const t=this.createVertexShader(),r=this.createShader(this.gl.FRAGMENT_SHADER,`#version 300 es
			precision highp float;
			
			uniform sampler2D u_sourceTexture;
			in vec2 v_texCoord;
			out vec4 fragColor;
			
			void main() {
				vec4 source = texture(u_sourceTexture, v_texCoord);
				fragColor = vec4(source.rgb, 1.0);
			}
		`),n=this.gl.createProgram();return this.gl.attachShader(n,t),this.gl.attachShader(n,r),this.gl.linkProgram(n),n}createAlphaProgram(){const t=this.createVertexShader(),r=this.createShader(this.gl.FRAGMENT_SHADER,`#version 300 es
			precision highp float;
			
			uniform sampler2D u_sourceTexture;
			uniform vec2 u_resolution; // The width and height of the canvas
			in vec2 v_texCoord;
			out vec4 fragColor;

			// This function determines the value for a single byte in the YUV stream
			float getByteValue(float byteOffset) {
				float width = u_resolution.x;
				float height = u_resolution.y;

				float yPlaneSize = width * height;

				if (byteOffset < yPlaneSize) {
					// This byte is in the luma plane. Find the corresponding pixel coordinates to sample from
					float y = floor(byteOffset / width);
					float x = mod(byteOffset, width);
					
					// Add 0.5 to sample the center of the texel
					vec2 sampleCoord = (vec2(x, y) + 0.5) / u_resolution;
					
					// The luma value is the alpha from the source texture
					return texture(u_sourceTexture, sampleCoord).a;
				} else {
					// Write a fixed value for chroma and beyond
					return 128.0 / 255.0;
				}
			}
			
			void main() {
				// Each fragment writes 4 bytes (R, G, B, A)
				float pixelIndex = floor(gl_FragCoord.y) * u_resolution.x + floor(gl_FragCoord.x);
				float baseByteOffset = pixelIndex * 4.0;

				vec4 result;
				for (int i = 0; i < 4; i++) {
					float currentByteOffset = baseByteOffset + float(i);
					result[i] = getByteValue(currentByteOffset);
				}
				
				fragColor = result;
			}
		`),n=this.gl.createProgram();return this.gl.attachShader(n,t),this.gl.attachShader(n,r),this.gl.linkProgram(n),n}createShader(t,r){const n=this.gl.createShader(t);return this.gl.shaderSource(n,r),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)||console.error("Shader compile error:",this.gl.getShaderInfoLog(n)),n}createVAO(){const t=this.gl.createVertexArray();this.gl.bindVertexArray(t);const r=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),n=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.STATIC_DRAW);const i=this.gl.getAttribLocation(this.colorProgram,"a_position"),s=this.gl.getAttribLocation(this.colorProgram,"a_texCoord");return this.gl.enableVertexAttribArray(i),this.gl.vertexAttribPointer(i,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(s),this.gl.vertexAttribPointer(s,2,this.gl.FLOAT,!1,16,8),t}createTexture(){const t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),t}updateTexture(t){this.lastFrame!==t&&((t.displayWidth!==this.canvas.width||t.displayHeight!==this.canvas.height)&&(this.canvas.width=t.displayWidth,this.canvas.height=t.displayHeight),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.sourceTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.lastFrame=t)}extractColor(t){return this.updateTexture(t),this.gl.useProgram(this.colorProgram),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindVertexArray(this.vao),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),new VideoFrame(this.canvas,{timestamp:t.timestamp,duration:t.duration??void 0,alpha:"discard"})}extractAlpha(t){this.updateTexture(t),this.gl.useProgram(this.alphaProgram),this.gl.uniform2f(this.alphaResolutionLocation,this.canvas.width,this.canvas.height),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindVertexArray(this.vao),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const{width:r,height:n}=this.canvas,i=Math.ceil(r/2)*Math.ceil(n/2),s=r*n+i*2,o=Math.ceil(s/(r*4));let a=new Uint8Array(4*r*o);this.gl.readPixels(0,0,r,o,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),a=a.subarray(0,s),Q(a[r*n]===128),Q(a[a.length-1]===128);const l={format:"I420",codedWidth:r,codedHeight:n,timestamp:t.timestamp,duration:t.duration??void 0,transfer:[a.buffer]};return new VideoFrame(a,l)}close(){var t;(t=this.gl.getExtension("WEBGL_lose_context"))==null||t.loseContext(),this.gl=null}}class ty extends Mh{constructor(t,r){if(!(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement)&&!(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas))throw new TypeError("canvas must be an HTMLCanvasElement or OffscreenCanvas.");Xg(r),super(r.codec),this._encoder=new Jg(this,r),this._canvas=t}add(t,r=0,n){if(!Number.isFinite(t)||t<0)throw new TypeError("timestamp must be a non-negative number.");if(!Number.isFinite(r)||r<0)throw new TypeError("duration must be a non-negative number.");const i=new Wr(this._canvas,{timestamp:t,duration:r});return this._encoder.add(i,!0,n)}_flushAndClose(t){return this._encoder.flushAndClose(t)}}class Fh extends au{constructor(t){if(super(),this._connectedTrack=null,!en.includes(t))throw new TypeError(`Invalid audio codec '${t}'. Must be one of: ${en.join(", ")}.`);this._codec=t}}class ry{constructor(t,r){this.source=t,this.encodingConfig=r,this.ensureEncoderPromise=null,this.encoderInitialized=!1,this.encoder=null,this.muxer=null,this.lastNumberOfChannels=null,this.lastSampleRate=null,this.isPcmEncoder=!1,this.outputSampleSize=null,this.writeOutputValue=null,this.customEncoder=null,this.customEncoderCallSerializer=new kh,this.customEncoderQueueSize=0,this.lastEndSampleIndex=null,this.error=null}async add(t,r){try{if(this.checkForEncoderError(),this.source._ensureValidAdd(),this.lastNumberOfChannels!==null&&this.lastSampleRate!==null){if(t.numberOfChannels!==this.lastNumberOfChannels||t.sampleRate!==this.lastSampleRate)throw new Error(`Audio parameters must remain constant. Expected ${this.lastNumberOfChannels} channels at ${this.lastSampleRate} Hz, got ${t.numberOfChannels} channels at ${t.sampleRate} Hz.`)}else this.lastNumberOfChannels=t.numberOfChannels,this.lastSampleRate=t.sampleRate;this.encoderInitialized||(this.ensureEncoderPromise||this.ensureEncoder(t),this.encoderInitialized||await this.ensureEncoderPromise),Q(this.encoderInitialized);{const n=Math.round(t.timestamp*t.sampleRate),i=Math.round((t.timestamp+t.duration)*t.sampleRate);if(this.lastEndSampleIndex===null)this.lastEndSampleIndex=i;else{const s=n-this.lastEndSampleIndex;if(s>=64){const o=new fr({data:new Float32Array(s*t.numberOfChannels),format:"f32-planar",sampleRate:t.sampleRate,numberOfChannels:t.numberOfChannels,numberOfFrames:s,timestamp:this.lastEndSampleIndex/t.sampleRate});await this.add(o,!0)}this.lastEndSampleIndex+=t.numberOfFrames}}if(this.customEncoder){this.customEncoderQueueSize++;const n=t.clone(),i=this.customEncoderCallSerializer.call(()=>this.customEncoder.encode(n)).then(()=>this.customEncoderQueueSize--).catch(s=>this.error??(this.error=s)).finally(()=>{n.close()});this.customEncoderQueueSize>=4&&await i,await this.muxer.mutex.currentPromise}else if(this.isPcmEncoder)await this.doPcmEncoding(t,r);else{Q(this.encoder);const n=t.toAudioData();this.encoder.encode(n),n.close(),r&&t.close(),this.encoder.encodeQueueSize>=4&&await new Promise(i=>this.encoder.addEventListener("dequeue",i,{once:!0})),await this.muxer.mutex.currentPromise}}finally{r&&t.close()}}async doPcmEncoding(t,r){var g,C;Q(this.outputSampleSize),Q(this.writeOutputValue);const{numberOfChannels:n,numberOfFrames:i,sampleRate:s,timestamp:o}=t,a=2048,l=[];for(let k=0;k<i;k+=a){const x=Math.min(a,t.numberOfFrames-k),b=x*n*this.outputSampleSize,p=new ArrayBuffer(b),f=new DataView(p);l.push({frameCount:x,view:f})}const c=t.allocationSize({planeIndex:0,format:"f32-planar"}),d=new Float32Array(c/Float32Array.BYTES_PER_ELEMENT);for(let k=0;k<n;k++){t.copyTo(d,{planeIndex:k,format:"f32-planar"});for(let x=0;x<l.length;x++){const{frameCount:b,view:p}=l[x];for(let f=0;f<b;f++)this.writeOutputValue(p,(f*n+k)*this.outputSampleSize,d[x*a+f])}}r&&t.close();const h={decoderConfig:{codec:this.encodingConfig.codec,numberOfChannels:n,sampleRate:s}};for(let k=0;k<l.length;k++){const{frameCount:x,view:b}=l[k],p=b.buffer,f=k*a,m=new Cr(new Uint8Array(p),"key",o+f/s,x/s);(C=(g=this.encodingConfig).onEncodedPacket)==null||C.call(g,m,h),await this.muxer.addEncodedAudioPacket(this.source._connectedTrack,m,h)}}ensureEncoder(t){this.ensureEncoderPromise=(async()=>{var o,a;const{numberOfChannels:r,sampleRate:n}=t,i=cl({numberOfChannels:r,sampleRate:n,...this.encodingConfig});(a=(o=this.encodingConfig).onEncoderConfig)==null||a.call(o,i);const s=sl.find(l=>l.supports(this.encodingConfig.codec,i));if(s)this.customEncoder=new s,this.customEncoder.codec=this.encodingConfig.codec,this.customEncoder.config=i,this.customEncoder.onPacket=(l,c)=>{var d,h;if(!(l instanceof Cr))throw new TypeError("The first argument passed to onPacket must be an EncodedPacket.");if(c!==void 0&&(!c||typeof c!="object"))throw new TypeError("The second argument passed to onPacket must be an object or undefined.");(h=(d=this.encodingConfig).onEncodedPacket)==null||h.call(d,l,c),this.muxer.addEncodedAudioPacket(this.source._connectedTrack,l,c).catch(g=>{this.error??(this.error=g)})},await this.customEncoder.init();else if(At.includes(this.encodingConfig.codec))this.initPcmEncoder();else{if(typeof AudioEncoder>"u")throw new Error("AudioEncoder is not supported by this browser.");if(!(await AudioEncoder.isConfigSupported(i)).supported)throw new Error(`This specific encoder configuration (${i.codec}, ${i.bitrate} bps, ${i.numberOfChannels} channels, ${i.sampleRate} Hz) is not supported by this browser. Consider using another codec or changing your audio parameters.`);const c=new Error("Encoding error").stack;this.encoder=new AudioEncoder({output:(d,h)=>{var C,k;if(this.encodingConfig.codec==="aac"&&(h!=null&&h.decoderConfig)){let x=!1;if(!h.decoderConfig.description||h.decoderConfig.description.byteLength<2?x=!0:x=ag(Xr(h.decoderConfig.description)).objectType===0,x){const b=Number(oi(i.codec.split(".")));h.decoderConfig.description=bh({objectType:b,numberOfChannels:h.decoderConfig.numberOfChannels,sampleRate:h.decoderConfig.sampleRate})}}const g=Cr.fromEncodedChunk(d);(k=(C=this.encodingConfig).onEncodedPacket)==null||k.call(C,g,h),this.muxer.addEncodedAudioPacket(this.source._connectedTrack,g,h).catch(x=>{this.error??(this.error=x)})},error:d=>{d.stack=c,this.error??(this.error=d)}}),this.encoder.configure(i)}Q(this.source._connectedTrack),this.muxer=this.source._connectedTrack.output._muxer,this.encoderInitialized=!0})()}initPcmEncoder(){this.isPcmEncoder=!0;const t=this.encodingConfig.codec,{dataType:r,sampleSize:n,littleEndian:i}=Th(t);switch(this.outputSampleSize=n,n){case 1:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint8(o,Xe((a+1)*127.5,0,255)):r==="signed"?this.writeOutputValue=(s,o,a)=>{s.setInt8(o,Xe(Math.round(a*128),-128,127))}:r==="ulaw"?this.writeOutputValue=(s,o,a)=>{const l=Xe(Math.floor(a*32767),-32768,32767);s.setUint8(o,kg(l))}:r==="alaw"?this.writeOutputValue=(s,o,a)=>{const l=Xe(Math.floor(a*32767),-32768,32767);s.setUint8(o,Cg(l))}:Q(!1);break;case 2:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint16(o,Xe((a+1)*32767.5,0,65535),i):r==="signed"?this.writeOutputValue=(s,o,a)=>s.setInt16(o,Xe(Math.round(a*32767),-32768,32767),i):Q(!1);break;case 3:r==="unsigned"?this.writeOutputValue=(s,o,a)=>xh(s,o,Xe((a+1)*83886075e-1,0,16777215),i):r==="signed"?this.writeOutputValue=(s,o,a)=>H0(s,o,Xe(Math.round(a*8388607),-8388608,8388607),i):Q(!1);break;case 4:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint32(o,Xe((a+1)*21474836475e-1,0,4294967295),i):r==="signed"?this.writeOutputValue=(s,o,a)=>s.setInt32(o,Xe(Math.round(a*2147483647),-2147483648,2147483647),i):r==="float"?this.writeOutputValue=(s,o,a)=>s.setFloat32(o,a,i):Q(!1);break;case 8:r==="float"?this.writeOutputValue=(s,o,a)=>s.setFloat64(o,a,i):Q(!1);break;default:mo(n),Q(!1)}}async flushAndClose(t){t||this.checkForEncoderError(),this.customEncoder?(t||this.customEncoderCallSerializer.call(()=>this.customEncoder.flush()),await this.customEncoderCallSerializer.call(()=>this.customEncoder.close())):this.encoder&&(t||await this.encoder.flush(),this.encoder.state!=="closed"&&this.encoder.close()),t||this.checkForEncoderError()}getQueueSize(){var t;return this.customEncoder?this.customEncoderQueueSize:this.isPcmEncoder?0:((t=this.encoder)==null?void 0:t.encodeQueueSize)??0}checkForEncoderError(){if(this.error)throw this.error}}class ny extends Fh{get errorPromise(){return this._errorPromiseAccessed=!0,this._promiseWithResolvers.promise}get paused(){return this._paused}constructor(t,r){if(!(t instanceof MediaStreamTrack)||t.kind!=="audio")throw new TypeError("track must be an audio MediaStreamTrack.");Kg(r),super(r.codec),this._abortController=null,this._audioContext=null,this._scriptProcessorNode=null,this._promiseWithResolvers=vh(),this._errorPromiseAccessed=!1,this._paused=!1,this._lastSampleTimestamp=null,this._pauseOffset=0,this._encoder=new ry(this,r),this._track=t}async _start(){this._errorPromiseAccessed||console.warn("Make sure not to ignore the `errorPromise` field on MediaStreamVideoTrackSource, so that any internal errors get bubbled up properly."),this._abortController=new AbortController;let t=null,r=!1;const n=i=>{if(r){i.close();return}const s=i.timestamp;if(this._paused){if(t!==null){if(this._lastSampleTimestamp!==null){const a=s-this._lastSampleTimestamp;this._pauseOffset-=a}this._lastSampleTimestamp=s}i.close();return}if(t===null){t=i.timestamp;const o=this._connectedTrack.output._muxer;o.firstMediaStreamTimestamp===null?(o.firstMediaStreamTimestamp=performance.now()/1e3,this._timestampOffset=-t):this._timestampOffset=performance.now()/1e3-o.firstMediaStreamTimestamp-t}if(this._lastSampleTimestamp=s,this._encoder.getQueueSize()>=4){i.close();return}i.setTimestamp(s+this._pauseOffset),this._encoder.add(i,!0).catch(o=>{var a,l;r=!0,(a=this._abortController)==null||a.abort(),this._promiseWithResolvers.reject(o),(l=this._audioContext)==null||l.suspend()})};if(typeof MediaStreamTrackProcessor<"u"){const i=new MediaStreamTrackProcessor({track:this._track}),s=new WritableStream({write:o=>n(new fr(o))});i.readable.pipeTo(s,{signal:this._abortController.signal}).catch(o=>{o instanceof DOMException&&o.name==="AbortError"||this._promiseWithResolvers.reject(o)})}else{const i=window.AudioContext||window.webkitAudioContext;this._audioContext=new i({sampleRate:this._track.getSettings().sampleRate});const s=this._audioContext.createMediaStreamSource(new MediaStream([this._track]));this._scriptProcessorNode=this._audioContext.createScriptProcessor(4096),this._audioContext.state==="suspended"&&await this._audioContext.resume(),s.connect(this._scriptProcessorNode),this._scriptProcessorNode.connect(this._audioContext.destination);let o=0;this._scriptProcessorNode.onaudioprocess=a=>{const l=fr._fromAudioBuffer(a.inputBuffer,o);o+=a.inputBuffer.duration;for(const c of l)n(c)}}}pause(){this._paused=!0}resume(){this._paused=!1}async _flushAndClose(t){this._abortController&&(this._abortController.abort(),this._abortController=null),this._audioContext&&(Q(this._scriptProcessorNode),this._scriptProcessorNode.disconnect(),await this._audioContext.suspend()),await this._encoder.flushAndClose(t)}}class iy extends au{constructor(t){if(super(),this._connectedTrack=null,!Oi.includes(t))throw new TypeError(`Invalid subtitle codec '${t}'. Must be one of: ${Oi.join(", ")}.`);this._codec=t}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const sy=["video","audio","subtitle"],aa=e=>{if(!e||typeof e!="object")throw new TypeError("metadata must be an object.");if(e.languageCode!==void 0&&!X0(e.languageCode))throw new TypeError("metadata.languageCode, when provided, must be a three-letter, ISO 639-2/T language code.");if(e.name!==void 0&&typeof e.name!="string")throw new TypeError("metadata.name, when provided, must be a string.");if(e.disposition!==void 0&&rg(e.disposition),e.maximumPacketCount!==void 0&&(!Number.isInteger(e.maximumPacketCount)||e.maximumPacketCount<0))throw new TypeError("metadata.maximumPacketCount, when provided, must be a non-negative integer.")};class oy{constructor(t){if(this.state="pending",this._tracks=[],this._startPromise=null,this._cancelPromise=null,this._finalizePromise=null,this._mutex=new wh,this._metadataTags={},!t||typeof t!="object")throw new TypeError("options must be an object.");if(!(t.format instanceof Dh))throw new TypeError("options.format must be an OutputFormat.");if(!(t.target instanceof jh))throw new TypeError("options.target must be a Target.");if(t.target._output)throw new Error("Target is already used for another output.");t.target._output=this,this.format=t.format,this.target=t.target,this._writer=t.target._createWriter(),this._muxer=t.format._createMuxer(this)}addVideoTrack(t,r={}){if(!(t instanceof Mh))throw new TypeError("source must be a VideoSource.");if(aa(r),r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError(`Invalid video rotation: ${r.rotation}. Has to be 0, 90, 180 or 270.`);if(!this.format.supportsVideoRotationMetadata&&r.rotation)throw new Error(`${this.format._name} does not support video rotation metadata.`);if(r.frameRate!==void 0&&(!Number.isFinite(r.frameRate)||r.frameRate<=0))throw new TypeError(`Invalid video frame rate: ${r.frameRate}. Must be a positive number.`);this._addTrack("video",t,r)}addAudioTrack(t,r={}){if(!(t instanceof Fh))throw new TypeError("source must be an AudioSource.");aa(r),this._addTrack("audio",t,r)}addSubtitleTrack(t,r={}){if(!(t instanceof iy))throw new TypeError("source must be a SubtitleSource.");aa(r),this._addTrack("subtitle",t,r)}setMetadataTags(t){if(tg(t),this.state!=="pending")throw new Error("Cannot set metadata tags after output has been started or canceled.");this._metadataTags=t}_addTrack(t,r,n){if(this.state!=="pending")throw new Error("Cannot add track after output has been started or canceled.");if(r._connectedTrack)throw new Error("Source is already used for a track.");const i=this.format.getSupportedTrackCounts(),s=this._tracks.reduce((c,d)=>c+(d.type===t?1:0),0),o=i[t].max;if(s===o)throw new Error(o===0?`${this.format._name} does not support ${t} tracks.`:`${this.format._name} does not support more than ${o} ${t} track${o===1?"":"s"}.`);const a=i.total.max;if(this._tracks.length===a)throw new Error(`${this.format._name} does not support more than ${a} tracks${a===1?"":"s"} in total.`);const l={id:this._tracks.length+1,output:this,type:t,source:r,metadata:n};if(l.type==="video"){const c=this.format.getSupportedVideoCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support video tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported video codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}else if(l.type==="audio"){const c=this.format.getSupportedAudioCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support audio tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported audio codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}else if(l.type==="subtitle"){const c=this.format.getSupportedSubtitleCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support subtitle tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported subtitle codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}this._tracks.push(l),r._connectedTrack=l}async start(){const t=this.format.getSupportedTrackCounts();for(const n of sy){const i=this._tracks.reduce((o,a)=>o+(a.type===n?1:0),0),s=t[n].min;if(i<s)throw new Error(s===t[n].max?`${this.format._name} requires exactly ${s} ${n} track${s===1?"":"s"}.`:`${this.format._name} requires at least ${s} ${n} track${s===1?"":"s"}.`)}const r=t.total.min;if(this._tracks.length<r)throw new Error(r===t.total.max?`${this.format._name} requires exactly ${r} track${r===1?"":"s"}.`:`${this.format._name} requires at least ${r} track${r===1?"":"s"}.`);if(this.state==="canceled")throw new Error("Output has been canceled.");return this._startPromise?(console.warn("Output has already been started."),this._startPromise):this._startPromise=(async()=>{this.state="started",this._writer.start();const n=await this._mutex.acquire();await this._muxer.start();const i=this._tracks.map(s=>s.source._start());await Promise.all(i),n()})()}getMimeType(){return this._muxer.getMimeType()}async cancel(){if(this._cancelPromise)return console.warn("Output has already been canceled."),this._cancelPromise;if(this.state==="finalizing"||this.state==="finalized"){console.warn("Output has already been finalized.");return}return this._cancelPromise=(async()=>{this.state="canceled";const t=await this._mutex.acquire(),r=this._tracks.map(n=>n.source._flushOrWaitForOngoingClose(!0));await Promise.all(r),await this._writer.close(),t()})()}async finalize(){if(this.state==="pending")throw new Error("Cannot finalize before starting.");if(this.state==="canceled")throw new Error("Cannot finalize after canceling.");return this._finalizePromise?(console.warn("Output has already been finalized."),this._finalizePromise):this._finalizePromise=(async()=>{this.state="finalizing";const t=await this._mutex.acquire(),r=this._tracks.map(n=>n.source._flushOrWaitForOngoingClose(!1));await Promise.all(r),await this._muxer.finalize(),await this._writer.flush(),await this._writer.finalize(),this.state="finalized",t()})()}}const dl={status:"idle",duration:0,blob:null,pauseRecording:()=>{},resumeRecording:()=>{},stopRecording:()=>{}},zh=y.createContext({recording:dl,setRecording:()=>{},dismissRecording:()=>{},openInAnalyzerBlob:null,openRecordingInAnalyzer:()=>{},clearOpenInAnalyzer:()=>{}});function ay({children:e}){const[t,r]=y.useState(dl),[n,i]=y.useState(null),s=y.useCallback(c=>{r(d=>({...d,...c}))},[]),o=y.useCallback(()=>{r(dl)},[]),a=y.useCallback(c=>{i(c)},[]),l=y.useCallback(()=>{i(null)},[]);return u.jsx(zh.Provider,{value:{recording:t,setRecording:s,dismissRecording:o,openInAnalyzerBlob:n,openRecordingInAnalyzer:a,clearOpenInAnalyzer:l},children:e})}function go(){return y.useContext(zh)}function gi(e){const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function ly({onBack:e,hidden:t=!1,onRecordingComplete:r}){var Hi;const{setRecording:n,recording:i}=go(),[s,o]=y.useState("idle"),[a,l]=y.useState(0),[c,d]=y.useState(!0),[h,g]=y.useState(!0),[C,k]=y.useState([]),[x,b]=y.useState([]),[p,f]=y.useState(""),[m,v]=y.useState(""),[w,S]=y.useState(null),[T,j]=y.useState(null),[F,W]=y.useState(null),[I,R]=y.useState(null),[z,O]=y.useState(null),[$,B]=y.useState(null),[ie,D]=y.useState("top-right"),[H,G]=y.useState(!0),ne=y.useRef(null),q=y.useRef(null),wt=y.useRef([]),me=y.useRef(null),Qe=y.useRef(null),ge=y.useRef([]),J=y.useRef(null),et=y.useRef(null),Re=y.useRef(null),vt=y.useRef(0),xt=y.useRef(0),Te=y.useRef(0),jt=y.useRef(null),Nr=y.useRef(null),Jt=y.useRef(null),Un=y.useRef(ie),Ae=y.useRef(!1),Rr=y.useRef(0),Ar=y.useRef(r);Un.current=ie,Rr.current=a,Ar.current=r;const Ln=y.useRef(!1),Bn=y.useRef(!1),le=y.useRef(null),Dt=y.useRef(null),ze=y.useRef(null),xe=y.useRef(null),jr=y.useRef(-1),It=y.useRef(!1),Wn=y.useRef(()=>{}),Ot=y.useCallback(async()=>{if(!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{const P=await navigator.mediaDevices.enumerateDevices();if(k(P.filter(M=>M.kind==="videoinput").map(M=>({deviceId:M.deviceId,label:M.label||`Camera ${M.deviceId.slice(0,8)}`,kind:M.kind}))),b(P.filter(M=>M.kind==="audioinput").map(M=>({deviceId:M.deviceId,label:M.label||`Microphone ${M.deviceId.slice(0,8)}`,kind:M.kind}))),P.length&&!Ln.current){const M=P.find(E=>E.kind==="videoinput");M&&(f(M.deviceId),Ln.current=!0)}if(P.length&&!Bn.current){const M=P.find(E=>E.kind==="audioinput");M&&(v(M.deviceId),Bn.current=!0)}}catch(P){console.error("Failed to enumerate devices:",P);const M=P instanceof Error?P.message:"Could not list devices";O(`Could not list devices: ${M}`)}},[]);y.useEffect(()=>{Ot()},[Ot]),y.useEffect(()=>{if(!navigator.mediaDevices)return;const P=()=>Ot();return navigator.mediaDevices.addEventListener("devicechange",P),()=>navigator.mediaDevices.removeEventListener("devicechange",P)},[Ot]),y.useEffect(()=>{if(s!=="recording"&&s!=="paused")return;const P=M=>{M.preventDefault()};return window.addEventListener("beforeunload",P),()=>window.removeEventListener("beforeunload",P)},[s]),y.useEffect(()=>{if($===null||$<=0)return;const P=setTimeout(()=>B(M=>(M??0)-1),1e3);return()=>clearTimeout(P)},[$]),jt.current=w,Nr.current=T,Jt.current=F;const sn=y.useCallback(()=>{w==null||w.getTracks().forEach(P=>P.stop()),T==null||T.getTracks().forEach(P=>P.stop()),F==null||F.getTracks().forEach(P=>P.stop()),S(null),j(null),W(null)},[w,T,F]);y.useEffect(()=>()=>{var E,N,V;(E=jt.current)==null||E.getTracks().forEach(L=>L.stop()),(N=Nr.current)==null||N.getTracks().forEach(L=>L.stop()),(V=Jt.current)==null||V.getTracks().forEach(L=>L.stop()),J.current&&(clearInterval(J.current),J.current=null),et.current&&(clearInterval(et.current),et.current=null),xe.current&&(clearInterval(xe.current),xe.current=null),Re.current!=null&&(cancelAnimationFrame(Re.current),Re.current=null);const P=q.current;if((P==null?void 0:P.state)!=="inactive")try{P==null||P.stop()}catch{}const M=le.current;M&&M.state!=="canceled"&&M.state!=="finalized"&&(M.cancel(),le.current=null)},[]);const yo=y.useCallback(async()=>{if(O(null),!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{T==null||T.getTracks().forEach(M=>M.stop());const P=await navigator.mediaDevices.getUserMedia({video:{width:320,height:240,facingMode:"user",deviceId:p||void 0}});j(P),me.current&&(me.current.srcObject=P),await Ot()}catch(P){console.error("Failed to connect camera:",P);const M=P instanceof Error?P.message:"Could not access camera";O(`Camera: ${M}`),j(null)}},[p,T,Ot]),wo=y.useCallback(()=>{T==null||T.getTracks().forEach(P=>P.stop()),j(null),me.current&&(me.current.srcObject=null)},[T]),vo=y.useCallback(async()=>{if(O(null),!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{F==null||F.getTracks().forEach(M=>M.stop());const P=await navigator.mediaDevices.getUserMedia({audio:{deviceId:m||void 0}});W(P),await Ot()}catch(P){console.error("Failed to connect microphone:",P);const M=P instanceof Error?P.message:"Could not access microphone";O(`Microphone: ${M}`),W(null)}},[m,F,Ot]),Bi=y.useCallback(()=>{F==null||F.getTracks().forEach(P=>P.stop()),W(null)},[F]);y.useEffect(()=>{const P=Qe.current;!P||!w||P.srcObject!==w&&(P.srcObject=w,P.play().catch(()=>{}))},[w]);const xo=y.useCallback(async()=>{var P;if(O(null),!((P=navigator.mediaDevices)!=null&&P.getDisplayMedia)){O("Screen sharing is not supported in this browser. Try Chrome, Edge, or Firefox.");return}try{w==null||w.getTracks().forEach(E=>E.stop());let M;try{M=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0})}catch(E){if((E instanceof Error?E.message:String(E)).toLowerCase().includes("not supported"))M=await navigator.mediaDevices.getDisplayMedia({video:!0});else throw E}S(M),M.getVideoTracks()[0].onended=()=>{S(null)}}catch(M){console.error("Failed to connect screen:",M);const E=M instanceof Error?M.message:"Could not share screen",N=E.toLowerCase().includes("not supported")||E.toLowerCase().includes("not allowed")?" Screen sharing requires HTTPS (or localhost) and a supported browser (Chrome, Edge, Firefox, Safari).":"";O(`Could not share screen.${N}`),S(null)}},[w]),ko=y.useCallback(()=>{w==null||w.getTracks().forEach(P=>P.stop()),S(null)},[w]),on=y.useCallback(async()=>{O(null),o("connecting");let P=w,M=null;c&&(T!=null&&T.active)&&T.getVideoTracks().length&&(M=T);let E=h?F:null;try{if(!P){try{P=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0})}catch{P=await navigator.mediaDevices.getDisplayMedia({video:!0})}S(P)}if(!(P!=null&&P.getVideoTracks().length)){O("Could not capture screen. Make sure you selected a window or screen to share."),o("idle");return}if(P.getVideoTracks()[0].onended=()=>{var Y;if(It.current&&((Y=le.current)==null?void 0:Y.state)==="started")Wn.current();else{const ee=q.current;((ee==null?void 0:ee.state)==="recording"||(ee==null?void 0:ee.state)==="paused")&&ee.stop()}},c&&!M)try{M=await navigator.mediaDevices.getUserMedia({video:{width:320,height:240,facingMode:"user",deviceId:p||void 0}}),j(M)}catch(Y){M=null;const ee=Y instanceof Error?Y.message:"Could not access camera";O(`${ee} (camera may be in use by another app). Recording without face camera.`)}h&&!E&&(E=await navigator.mediaDevices.getUserMedia({audio:{deviceId:m||void 0}}),W(E));const N=document.createElement("video");N.srcObject=P,N.muted=!0,await N.play(),N.readyState<2&&await new Promise(Y=>{N.onloadeddata=()=>Y(),setTimeout(Y,500)});const V=ne.current;if(!V){O("Recording canvas not ready. Please try again."),o("idle");return}const L=V.getContext("2d");if(!L){O("Could not initialize recording canvas."),o("idle");return}const we=P.getVideoTracks();if(!we.length){O("No video track from screen share."),o("idle"),sn();return}const Ee=we[0];if(Ee.readyState!=="live"||!Ee.enabled){O("Screen track is not active. Cancel and choose a different window or screen to share."),o("idle"),sn();return}const{width:Ct,height:tt}=Ee.getSettings();V.width=Ct||1920,V.height=tt||1080;const je=document.createElement("video");M&&(je.srcObject=M,je.muted=!0,await je.play(),je.readyState<2&&await new Promise(Y=>{je.onloadeddata=()=>Y(),setTimeout(Y,300)}));const dt=new AudioContext;dt.state==="suspended"&&await dt.resume();const Lt=dt.createMediaStreamDestination();if(P.getAudioTracks().length&&dt.createMediaStreamSource(new MediaStream(P.getAudioTracks())).connect(Lt),E&&dt.createMediaStreamSource(E).connect(Lt),Lt.stream.getAudioTracks().length===0){const Y=dt.createOscillator(),ee=dt.createGain();ee.gain.value=0,Y.connect(ee),ee.connect(Lt),Y.start()}const lu=Lt.stream.getAudioTracks().length>0,Hn=30;let Eo=!1;try{const[Y,ee]=await Promise.all([qg("vp9",{width:V.width,height:V.height,bitrate:25e5}),lu?Zg("opus",{bitrate:128e3}):Promise.resolve(!0)]);Eo=Y&&ee}catch{Eo=!1}It.current=Eo;const Qi=16,Uh=.2,uu=()=>{if(N.readyState>=2&&(L.drawImage(N,0,0,V.width,V.height),M&&je.readyState>=2)){const Y=Math.floor(V.width*Uh),ee=Math.floor(Y*(je.videoHeight/je.videoWidth)),Ve=Un.current,Et=Ve==="top-right"||Ve==="bottom-right"?V.width-Y-Qi:Qi,De=Ve==="top-right"||Ve==="top-left"?Qi:V.height-ee-Qi;L.fillStyle="rgba(0,0,0,0.4)",L.fillRect(Et-4,De-4,Y+8,ee+8),L.drawImage(je,Et,De,Y,ee)}};uu();const bo=()=>{var Ve,Et,De;uu();const Y=((Ve=q.current)==null?void 0:Ve.state)==="recording"||((Et=q.current)==null?void 0:Et.state)==="paused",ee=It.current&&((De=le.current)==null?void 0:De.state)==="started";(Y||ee)&&(Re.current=requestAnimationFrame(bo))},cu=()=>Math.floor((performance.now()-vt.current-xt.current)/1e3),Lh=(Y,ee)=>{R(Y),o("stopped"),n({status:"stopped",duration:ee,blob:Y});const Ve=Ar.current;Ve&&Ve(Y,ee)};if(vt.current=performance.now(),l(0),o("recording"),ge.current=[P],M&&ge.current.push(M),E&&ge.current.push(E),J.current=setInterval(()=>l(cu()),200),It.current){const Y=new oy({format:new ll,target:new Wg});le.current=Y;const ee=new ty(V,{codec:"vp9",bitrate:Yg,keyFrameInterval:1,latencyMode:"realtime"});Dt.current=ee,Y.addVideoTrack(ee,{frameRate:Hn});const Ve=Lt.stream.getAudioTracks()[0];if(Ve){const Ir=new ny(Ve,{codec:"opus",bitrate:128e3});ze.current=Ir,Ir.errorPromise.catch(ue=>{console.error("Mediabunny audio error:",ue),O(`Recording failed: ${ue instanceof Error?ue.message:String(ue)}`)}),Y.addAudioTrack(Ir)}await Y.start(),bo();let Et=!0;jr.current=-1;const De=async()=>{var Or;if(!Et||((Or=le.current)==null?void 0:Or.state)!=="started")return;const Ir=(performance.now()-vt.current-xt.current)/1e3,ue=Math.round(Ir*Hn);if(ue===jr.current)return;jr.current=ue;const Ge=ue/Hn;Et=!1;try{await ee.add(Ge,1/Hn)}catch(an){console.error("Frame capture error:",an)}Et=!0};xe.current=setInterval(()=>void De().catch(console.error),1e3/Hn),De().catch(console.error)}else{const Y=["video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm"],ee=ue=>{for(const Ge of Y)if(MediaRecorder.isTypeSupported(Ge))try{return{recorder:new MediaRecorder(ue,{mimeType:Ge,videoBitsPerSecond:25e5,...lu&&{audioBitsPerSecond:128e3}}),mimeType:Ge}}catch{continue}try{const Ge=new MediaRecorder(ue);return{recorder:Ge,mimeType:Ge.mimeType||"video/webm;codecs=vp9"}}catch{throw new Error("Recording not supported in this browser. Try Chrome or Edge.")}},Ve=P.getVideoTracks()[0],Et=new MediaStream([Ve,...Lt.stream.getAudioTracks()]),{recorder:De,mimeType:Ir}=ee(Et);q.current=De,wt.current=[],De.ondataavailable=ue=>{ue.data&&ue.data.size>0&&wt.current.push(ue.data)},De.onerror=ue=>{const Ge=ue instanceof Error?ue.message:String(ue);O(`Recording failed: ${Ge}. Try again or use Chrome/Edge.`)},De.start(1e3),bo(),et.current=setInterval(()=>{var ue;try{((ue=q.current)==null?void 0:ue.state)==="recording"&&q.current.requestData()}catch{}},1500),De.onstop=()=>{Re.current!=null&&(cancelAnimationFrame(Re.current),Re.current=null),J.current&&(clearInterval(J.current),J.current=null),et.current&&(clearInterval(et.current),et.current=null),ge.current.forEach(Or=>Or.getTracks().forEach(an=>an.stop())),ge.current=[],S(null),j(null),W(null),me.current&&(me.current.srcObject=null),Qe.current&&(Qe.current.srcObject=null);const ue=cu(),Ge=(Or=!1)=>{const an=[...wt.current];try{if(an.length===0){if(!Or){setTimeout(()=>Ge(!0),600);return}O("Recording produced no data. Share a normal app window or your entire screen (not a browser tab with protected content), record for at least 5 seconds, then stop."),o("idle");return}const Gi=De.mimeType.startsWith("video/webm")?De.mimeType:Ir,So=new Blob(an,{type:Gi});if(So.size<100){O(`Recording produced almost no data (${So.size} bytes). Try Chrome or Edge.`),o("idle");return}Lh(So,ue)}catch(Gi){O(Gi instanceof Error?Gi.message:"Recording failed to finalize."),o("idle")}};setTimeout(()=>Ge(!1),1e3)}}}catch(N){console.error("Failed to start recording:",N);const V=N instanceof Error?N.message:"Failed to start recording";let L="";(V.toLowerCase().includes("video source")||V.toLowerCase().includes("videosource")||V.toLowerCase().includes("failed to allocate"))&&(L=' The camera or screen may be in use by another app. Close Zoom, Teams, or other video apps and try again. You can also try unchecking "face camera" to record screen only.'),O(`Could not start recording.${L}`),o("idle"),sn();return}},[c,h,w,T,F,p,m,sn]);y.useEffect(()=>{$===0&&(Ae.current||(Ae.current=!0,B(null),on()))},[$,on]),y.useEffect(()=>{s==="idle"&&(Ae.current=!1)},[s]);const ct=y.useCallback(()=>{var M,E;if(It.current){if(((M=le.current)==null?void 0:M.state)!=="started")return;(E=ze.current)==null||E.pause(),xe.current&&(clearInterval(xe.current),xe.current=null),Te.current=performance.now(),J.current&&(clearInterval(J.current),J.current=null),o("paused");return}const P=q.current;if((P==null?void 0:P.state)==="recording")try{P.pause(),Te.current=performance.now(),J.current&&(clearInterval(J.current),J.current=null),et.current&&(clearInterval(et.current),et.current=null),o("paused")}catch(N){console.error("Failed to pause:",N),O(N instanceof Error?N.message:"Pause not supported in this browser")}},[]),Wi=y.useCallback(()=>{var M,E;if(It.current){if(((M=le.current)==null?void 0:M.state)!=="started")return;(E=ze.current)==null||E.resume(),xt.current+=performance.now()-Te.current,Te.current=0;const N=Dt.current;if(N){let L=!0;const we=async()=>{var tt;if(!L||((tt=le.current)==null?void 0:tt.state)!=="started")return;const Ee=(performance.now()-vt.current-xt.current)/1e3,Ct=Math.round(Ee*30);if(Ct!==jr.current){jr.current=Ct,L=!1;try{await N.add(Ct/30,1/30)}catch{}L=!0}};xe.current=setInterval(()=>void we().catch(()=>{}),1e3/30)}o("recording");const V=()=>Math.floor((performance.now()-vt.current-xt.current)/1e3);J.current=setInterval(()=>l(V()),200);return}const P=q.current;if((P==null?void 0:P.state)==="paused")try{P.resume(),xt.current+=performance.now()-Te.current,Te.current=0,o("recording");const N=()=>Math.floor((performance.now()-vt.current-xt.current)/1e3);J.current=setInterval(()=>l(N()),200),et.current=setInterval(()=>{var V;try{((V=q.current)==null?void 0:V.state)==="recording"&&q.current.requestData()}catch{}},1500)}catch(N){console.error("Failed to resume:",N),O(N instanceof Error?N.message:"Resume not supported in this browser")}},[]),kt=y.useCallback(()=>{if(It.current){const M=le.current;if(!M||M.state!=="started")return;(async()=>{var N,V;try{xe.current&&(clearInterval(xe.current),xe.current=null),Re.current!=null&&(cancelAnimationFrame(Re.current),Re.current=null),J.current&&(clearInterval(J.current),J.current=null),(N=Dt.current)==null||N.close(),(V=ze.current)==null||V.close(),ge.current.forEach(tt=>tt.getTracks().forEach(je=>je.stop())),ge.current=[],S(null),j(null),W(null),me.current&&(me.current.srcObject=null),Qe.current&&(Qe.current.srcObject=null),await M.finalize(),le.current=null;const L=M.target.buffer;if(!L||L.byteLength<100){O("Recording produced almost no data. Try a different browser or disable the face camera."),o("idle");return}const we=Math.floor((performance.now()-vt.current-xt.current)/1e3),Ee=new Blob([L],{type:"video/webm"});R(Ee),o("stopped"),n({status:"stopped",duration:we,blob:Ee});const Ct=Ar.current;Ct&&Ct(Ee,we)}catch(L){console.error("Mediabunny stop error:",L),O(L instanceof Error?L.message:"Recording failed to finalize."),o("idle")}})();return}const P=q.current;if(!(!P||P.state==="inactive")){try{P.requestData()}catch{}P.stop()}},[]);y.useEffect(()=>{Wn.current=kt},[kt]),y.useEffect(()=>{n({status:s,duration:a,blob:I,pauseRecording:ct,resumeRecording:Wi,stopRecording:kt})},[s,a,I,ct,Wi,kt,n]),y.useEffect(()=>{i.status==="idle"&&!i.blob&&(s==="stopped"||I)&&(o("idle"),R(null),l(0),O(null))},[i.status,i.blob,s,I]);const Dr=P=>{const M=Math.floor(P/60),E=P%60;return`${M.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`},$i=w||s==="idle",$n=typeof navigator<"u"&&!!((Hi=navigator.mediaDevices)!=null&&Hi.getDisplayMedia)&&typeof MediaRecorder<"u",Co=s==="recording"||s==="paused"||s==="connecting";return u.jsx("div",{className:t?"sr-only min-h-0 overflow-hidden pointer-events-none":"min-h-screen p-6","aria-hidden":t,children:!t&&u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"RECORDING MODE"}),u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back to Analyzer"})]}),u.jsx("p",{className:"text-slate-400 mb-6",children:"Connect your camera, microphone, and screen before recording. You can preview each source and choose which devices to use."}),!$n&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-amber-900/30 border border-amber-500/50 text-amber-200",children:"Screen recording requires a modern browser with getDisplayMedia and MediaRecorder support (Chrome, Edge, Firefox, or Safari 14.1+). Please use a supported browser."}),z&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-900/30 border border-red-500/50 text-red-300",children:z}),u.jsx("div",{className:Co?"mb-6":"hidden",children:u.jsxs("div",{className:"rounded-xl border-2 border-red-500/50 bg-slate-900/80 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-2 flex items-center gap-2",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-500 animate-pulse ring-2 ring-red-400/50"}),"Live preview  You are recording"]}),u.jsx("p",{className:"text-slate-400 text-sm mb-3",children:It.current?"Screen, face overlay, and audio are being saved. Use the floating toolbar to pause or end.":"Screen and audio are being saved. Face bubble is preview only. Use the floating toolbar to pause or end."}),u.jsxs("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden border border-slate-600",children:[u.jsx("canvas",{ref:ne,className:"w-full h-full",style:{objectFit:"contain"},"aria-hidden":!0}),s==="connecting"&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80",children:u.jsx("p",{className:"text-slate-300 text-lg",children:"Connecting..."})})]}),(s==="recording"||s==="paused")&&u.jsx("p",{className:"text-slate-500 text-sm mt-2 font-mono",children:Dr(a)})]})}),s==="idle"&&u.jsxs("div",{className:"space-y-6 mb-6",children:[u.jsxs("div",{className:"rounded-xl border-2 border-slate-600 bg-slate-900/80 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-2 flex items-center gap-2",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 ring-2 ring-emerald-400/50"}),"Recording preview"]}),u.jsx("p",{className:"text-slate-400 text-sm mb-3",children:w?"This is exactly what will be recorded. Use it to position windows and check your setup.":"Connect a screen below to see a live preview here."}),u.jsx("div",{className:"w-full rounded-lg overflow-hidden border border-slate-600 bg-black min-h-[280px] flex items-center justify-center",children:w?u.jsx("video",{ref:Qe,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full max-h-[70vh] object-contain",style:{aspectRatio:"16/9"}}):u.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-12 px-6 text-slate-500",children:[u.jsx("svg",{className:"w-14 h-14 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":!0,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),u.jsx("span",{className:"text-sm text-center max-w-sm",children:"No screen connected. Click Connect screen below and choose a window or your entire screen to see the live preview here."})]})})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Screen"]}),u.jsx("div",{className:"flex flex-wrap gap-4 items-start",children:u.jsx("div",{className:"flex-1 min-w-[200px]",children:w?u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-slate-400 text-sm",children:"Screen is connected. View the live preview above."}),u.jsx("button",{type:"button",onClick:ko,className:"px-3 py-1.5 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 text-sm",children:"Disconnect screen"})]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:xo,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect screen"}),u.jsx("span",{className:"text-slate-500 text-sm",children:"Share a window or your entire screen"})]})})})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Camera"]}),u.jsxs("div",{className:"flex flex-wrap gap-4 items-start",children:[u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsxs("div",{className:"flex gap-2 mb-2",children:[u.jsxs("select",{value:p,onChange:P=>f(P.target.value),className:"px-3 py-2 rounded-lg bg-slate-700 text-slate-200 border border-slate-600 min-w-[180px]",children:[C.map(P=>u.jsx("option",{value:P.deviceId,children:P.label},P.deviceId)),C.length===0&&u.jsx("option",{value:"",children:"No cameras found"})]}),T?u.jsx("button",{type:"button",onClick:wo,className:"px-3 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500",children:"Disconnect"}):u.jsx("button",{type:"button",onClick:yo,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect camera"})]}),T&&u.jsx("video",{ref:me,autoPlay:!0,muted:!0,playsInline:!0,className:"w-48 aspect-video rounded-lg bg-black object-cover border border-slate-600"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:c,onChange:P=>d(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{className:"text-slate-300",children:"Include in recording (face bubble)"})]}),c&&u.jsxs("label",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[u.jsx("span",{children:"Position:"}),u.jsxs("select",{value:ie,onChange:P=>D(P.target.value),className:"px-2 py-1 rounded bg-slate-700 text-slate-200 border border-slate-600",children:[u.jsx("option",{value:"top-right",children:"Top right"}),u.jsx("option",{value:"top-left",children:"Top left"}),u.jsx("option",{value:"bottom-right",children:"Bottom right"}),u.jsx("option",{value:"bottom-left",children:"Bottom left"})]})]})]})]})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Microphone"]}),u.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[u.jsxs("select",{value:m,onChange:P=>v(P.target.value),className:"px-3 py-2 rounded-lg bg-slate-700 text-slate-200 border border-slate-600 min-w-[180px]",children:[x.map(P=>u.jsx("option",{value:P.deviceId,children:P.label},P.deviceId)),x.length===0&&u.jsx("option",{value:"",children:"No microphones found"})]}),F?u.jsx("button",{type:"button",onClick:Bi,className:"px-3 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500",children:"Disconnect"}):u.jsx("button",{type:"button",onClick:vo,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect mic"}),F&&u.jsxs("span",{className:"text-green-400 text-sm flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"Connected"]}),u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:h,onChange:P=>g(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{className:"text-slate-300",children:"Include in recording"})]})]})]}),u.jsxs("div",{className:"pt-4 border-t border-slate-600/50 space-y-3",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-slate-300",children:[u.jsx("input",{type:"checkbox",checked:H,onChange:P=>G(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{children:"3-second countdown before recording"})]}),u.jsx("button",{type:"button",onClick:()=>H?B(3):on(),disabled:!$i||!$n||$!==null,className:"px-6 py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Recording"}),u.jsx("p",{className:"text-slate-500 text-sm",children:w?"Screen is connected. Click to start recording.":"Connect your screen first, or click Start Recording to choose what to share."})]})]}),$!==null&&$>0&&u.jsx("div",{className:"fixed inset-0 z-[9998] flex items-center justify-center bg-slate-950/90 backdrop-blur-sm",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-slate-400 text-lg mb-2",children:"Recording in"}),u.jsx("p",{className:"text-6xl font-bold text-white tabular-nums",children:$})]})})]})})}function uy(){const{recording:e}=go(),{status:t,duration:r,pauseRecording:n,resumeRecording:i,stopRecording:s}=e,o=y.useRef(null);return y.useEffect(()=>{if(t!=="recording"&&t!=="paused")return;const a=l=>{l.key==="Escape"&&(l.preventDefault(),s())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,s]),t!=="recording"&&t!=="paused"?null:u.jsx("div",{ref:o,className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-[9999]",role:"toolbar","aria-label":"Recording controls",children:u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-900/95 backdrop-blur-sm shadow-xl px-5 py-3 flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`w-3 h-3 rounded-full ${t==="paused"?"bg-amber-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:"text-white font-medium",children:t==="paused"?"Paused":"Recording"})]}),u.jsx("span",{className:"text-slate-400 font-mono tabular-nums text-lg",children:gi(r)}),u.jsx("div",{className:"h-4 w-px bg-slate-600"}),t==="recording"&&u.jsxs("button",{type:"button",onClick:n,className:"px-4 py-2 rounded-lg bg-amber-600 text-white font-medium hover:bg-amber-500 transition-colors flex items-center gap-2",children:[u.jsx("span",{children:""})," Pause"]}),t==="paused"&&u.jsxs("button",{type:"button",onClick:i,className:"px-4 py-2 rounded-lg bg-green-600 text-white font-medium hover:bg-green-500 transition-colors flex items-center gap-2",children:[u.jsx("span",{children:""})," Resume"]}),u.jsxs("button",{type:"button",onClick:s,className:"px-4 py-2 rounded-lg bg-red-900/80 text-white font-medium hover:bg-red-800 border border-red-500/50 transition-colors flex items-center gap-2",title:"End recording (Escape)",children:[u.jsx("span",{children:""})," End"]}),u.jsx("span",{className:"text-slate-500 text-xs ml-1",children:"Esc to end"})]})})}var te;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.FFPROBE="FFPROBE",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(te||(te={}));const cy=(()=>{let e=0;return()=>e++})(),dy=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),fy=new Error("called FFmpeg.terminate()");var rt,ar,$t,$r,Hr,Ys,Le;class hy{constructor(){er(this,rt,null);er(this,ar,{});er(this,$t,{});er(this,$r,[]);er(this,Hr,[]);Ue(this,"loaded",!1);er(this,Ys,()=>{X(this,rt)&&(X(this,rt).onmessage=({data:{id:t,type:r,data:n}})=>{switch(r){case te.LOAD:this.loaded=!0,X(this,ar)[t](n);break;case te.MOUNT:case te.UNMOUNT:case te.EXEC:case te.FFPROBE:case te.WRITE_FILE:case te.READ_FILE:case te.DELETE_FILE:case te.RENAME:case te.CREATE_DIR:case te.LIST_DIR:case te.DELETE_DIR:X(this,ar)[t](n);break;case te.LOG:X(this,$r).forEach(i=>i(n));break;case te.PROGRESS:X(this,Hr).forEach(i=>i(n));break;case te.ERROR:X(this,$t)[t](n);break}delete X(this,ar)[t],delete X(this,$t)[t]})});er(this,Le,({type:t,data:r},n=[],i)=>X(this,rt)?new Promise((s,o)=>{const a=cy();X(this,rt)&&X(this,rt).postMessage({id:a,type:t,data:r},n),X(this,ar)[a]=s,X(this,$t)[a]=o,i==null||i.addEventListener("abort",()=>{o(new DOMException(`Message # ${a} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(dy));Ue(this,"load",({classWorkerURL:t,...r}={},{signal:n}={})=>(X(this,rt)||(Qn(this,rt,t?new Worker(new URL(t,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),X(this,Ys).call(this)),X(this,Le).call(this,{type:te.LOAD,data:r},void 0,n)));Ue(this,"exec",(t,r=-1,{signal:n}={})=>X(this,Le).call(this,{type:te.EXEC,data:{args:t,timeout:r}},void 0,n));Ue(this,"ffprobe",(t,r=-1,{signal:n}={})=>X(this,Le).call(this,{type:te.FFPROBE,data:{args:t,timeout:r}},void 0,n));Ue(this,"terminate",()=>{const t=Object.keys(X(this,$t));for(const r of t)X(this,$t)[r](fy),delete X(this,$t)[r],delete X(this,ar)[r];X(this,rt)&&(X(this,rt).terminate(),Qn(this,rt,null),this.loaded=!1)});Ue(this,"writeFile",(t,r,{signal:n}={})=>{const i=[];return r instanceof Uint8Array&&i.push(r.buffer),X(this,Le).call(this,{type:te.WRITE_FILE,data:{path:t,data:r}},i,n)});Ue(this,"mount",(t,r,n)=>{const i=[];return X(this,Le).call(this,{type:te.MOUNT,data:{fsType:t,options:r,mountPoint:n}},i)});Ue(this,"unmount",t=>{const r=[];return X(this,Le).call(this,{type:te.UNMOUNT,data:{mountPoint:t}},r)});Ue(this,"readFile",(t,r="binary",{signal:n}={})=>X(this,Le).call(this,{type:te.READ_FILE,data:{path:t,encoding:r}},void 0,n));Ue(this,"deleteFile",(t,{signal:r}={})=>X(this,Le).call(this,{type:te.DELETE_FILE,data:{path:t}},void 0,r));Ue(this,"rename",(t,r,{signal:n}={})=>X(this,Le).call(this,{type:te.RENAME,data:{oldPath:t,newPath:r}},void 0,n));Ue(this,"createDir",(t,{signal:r}={})=>X(this,Le).call(this,{type:te.CREATE_DIR,data:{path:t}},void 0,r));Ue(this,"listDir",(t,{signal:r}={})=>X(this,Le).call(this,{type:te.LIST_DIR,data:{path:t}},void 0,r));Ue(this,"deleteDir",(t,{signal:r}={})=>X(this,Le).call(this,{type:te.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?X(this,$r).push(r):t==="progress"&&X(this,Hr).push(r)}off(t,r){t==="log"?Qn(this,$r,X(this,$r).filter(n=>n!==r)):t==="progress"&&Qn(this,Hr,X(this,Hr).filter(n=>n!==r))}}rt=new WeakMap,ar=new WeakMap,$t=new WeakMap,$r=new WeakMap,Hr=new WeakMap,Ys=new WeakMap,Le=new WeakMap;var Hc;(function(e){e.MEMFS="MEMFS",e.NODEFS="NODEFS",e.NODERAWFS="NODERAWFS",e.IDBFS="IDBFS",e.WORKERFS="WORKERFS",e.PROXYFS="PROXYFS"})(Hc||(Hc={}));const py=new Error("failed to get response body reader"),my=new Error("failed to complete download"),gy="Content-Length",yy=async(e,t)=>{var i;const r=await fetch(e);let n;try{const s=parseInt(r.headers.get(gy)||"-1"),o=(i=r.body)==null?void 0:i.getReader();if(!o)throw py;const a=[];let l=0;for(;;){const{done:h,value:g}=await o.read(),C=g?g.length:0;if(h){if(s!=-1&&s!==l)throw my;t&&t({url:e,total:s,received:l,delta:C,done:h});break}a.push(g),l+=C,t&&t({url:e,total:s,received:l,delta:C,done:h})}const c=new Uint8Array(l);let d=0;for(const h of a)c.set(h,d),d+=h.length;n=c.buffer}catch(s){console.log("failed to send download progress event: ",s),n=await r.arrayBuffer()}return n},Qc=async(e,t,r=!1,n)=>{const i=r?await yy(e,n):await(await fetch(e)).arrayBuffer(),s=new Blob([i],{type:t});return URL.createObjectURL(s)};let la=null;async function Gc(){await Vh()}async function Vh(){if(la)return la;const e="https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.10/dist/esm",t=new hy;return await t.load({coreURL:await Qc(`${e}/ffmpeg-core.js`,"text/javascript"),wasmURL:await Qc(`${e}/ffmpeg-core.wasm`,"application/wasm")}),la=t,t}const un=["-avoid_negative_ts","make_zero","-fflags","+genpts"];async function ua(e){try{await e.deleteFile("input.webm")}catch{}try{await e.deleteFile("output.mp4")}catch{}}async function wy(e){const t=await Vh();await ua(t);const r=new Uint8Array(await e.arrayBuffer());if(r.length===0)throw new Error("Recording is empty");await t.writeFile("input.webm",r);const n=[[...un,"-i","input.webm","-c:v","libx264","-preset","ultrafast","-crf","28","-c:a","aac","-movflags","+faststart","output.mp4"],[...un,"-i","input.webm","-c:v","libx264","-preset","ultrafast","-crf","28","-an","-movflags","+faststart","output.mp4"],[...un,"-i","input.webm","-c:v","libx264","-preset","fast","-crf","23","-c:a","aac","-movflags","+faststart","output.mp4"],[...un,"-i","input.webm","-c:v","libx264","-preset","fast","-crf","23","-an","-movflags","+faststart","output.mp4"],[...un,"-i","input.webm","-c:v","mpeg4","-q:v","5","-c:a","aac","-movflags","+faststart","output.mp4"],[...un,"-i","input.webm","-c:v","mpeg4","-q:v","5","-an","-movflags","+faststart","output.mp4"],["-i","input.webm","-c:v","mpeg4","-q:v","8","-an","-movflags","+faststart","output.mp4"]];let i;for(const s of n)try{await t.exec(s),i=null;break}catch(o){i=o,await ua(t),await t.writeFile("input.webm",r)}try{if(i)throw i;const s=await t.readFile("output.mp4");if(!s||s.length===0)throw new Error("Conversion produced empty output");return new Blob([s],{type:"video/mp4"})}finally{await ua(t)}}function vy({blob:e,duration:t,onClose:r,onOpenInAnalyzer:n,onOpenInEditor:i}){const{dismissRecording:s}=go(),o=y.useRef(null),[a,l]=y.useState(!1),[c,d]=y.useState(null),[h,g]=y.useState(null),[C,k]=y.useState(!0),[x,b]=y.useState(null),[p,f]=y.useState(null),[m,v]=y.useState(0),w=y.useRef(null),S=y.useRef(null),T=()=>{s(),r()},j=()=>{s(),r()},F=()=>{e&&(n==null||n(e))},W=()=>{i==null||i()},I=async(R=!1)=>{if(e){d(null);try{let z=e,O=e.type.includes("mp4")?"mp4":"webm";if(e.type.includes("webm")&&!R){l(!0);try{await Gc(),z=await wy(e),O="mp4"}catch(ie){d(ie instanceof Error?ie.message:'Conversion failed. Try "Download as WebM".');return}finally{l(!1)}}else e.type.includes("mp4")&&(O="mp4");const $=URL.createObjectURL(z),B=document.createElement("a");B.href=$,B.download=`boxing-recording-${Date.now()}.${O}`,B.click(),URL.revokeObjectURL($)}catch(z){d(z instanceof Error?z.message:"Download failed")}}};return y.useEffect(()=>{var R;e&&e.size>0&&((R=e.type)!=null&&R.includes("webm"))&&Gc().catch(()=>{})},[e]),y.useEffect(()=>{if(!e||e.size===0){k(!1),g(null),b("Recording produced no data.");return}S.current=e,b(null),f(null),w.current&&(URL.revokeObjectURL(w.current),w.current=null);let R=!1;const z=e,O=(B,ie)=>{R||S.current===z&&(g(B),f(ie),k(!1))};if(!e.type||e.type.includes("webm")||e.type.includes("matroska")){const B=URL.createObjectURL(e);w.current=B,O(B,"webm")}else O(URL.createObjectURL(e),"mp4");return()=>{R=!0,g(B=>(B&&URL.revokeObjectURL(B),null)),w.current&&(URL.revokeObjectURL(w.current),w.current=null)}},[e,m]),e?u.jsx("div",{className:"fixed inset-0 z-[10000] bg-slate-950/98 flex flex-col overflow-auto",children:u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 min-h-0",children:[u.jsx("h2",{className:"text-2xl font-display tracking-wider text-white mb-2",children:"Recording Complete"}),u.jsxs("p",{className:"text-slate-400 mb-6",children:["Duration: ",gi(t)]}),u.jsx("div",{className:"w-full max-w-4xl min-h-[300px] aspect-video bg-black rounded-xl overflow-hidden border border-slate-600 mb-6 flex-shrink-0",children:C?u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400",children:"Preparing preview..."}):h?u.jsx("video",{ref:o,src:h,controls:!0,autoPlay:!0,playsInline:!0,muted:!0,preload:"auto",onError:R=>{var z;p==="webm"?(g(null),f(null),b("Preview not available for this recording. You can still download it below.")):b(((z=R.currentTarget.error)==null?void 0:z.message)||"Video failed to load")},onLoadedData:R=>{R.currentTarget.play().catch(()=>{})},className:"w-full h-full object-contain",style:{minWidth:320,minHeight:180}}):u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-4 text-slate-400 p-4 text-center",children:[u.jsx("span",{children:"No preview available"}),u.jsx("span",{className:"text-sm text-slate-500",children:"You can still download the recording below."}),u.jsx("button",{type:"button",onClick:()=>v(R=>R+1),className:"px-4 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 text-sm",children:"Retry preview"})]})}),(c||x)&&u.jsx("p",{className:"text-red-400 text-sm mb-2",children:c||x}),u.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[u.jsx("button",{type:"button",onClick:W,className:"px-6 py-3 rounded-lg bg-emerald-600 text-white font-medium hover:bg-emerald-500 transition-colors",children:"Open in Video Editor"}),u.jsx("button",{type:"button",onClick:()=>I(!1),disabled:a,className:"px-6 py-3 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Preparing download...":"Download as MP4"}),(!(e!=null&&e.type)||(e==null?void 0:e.type.includes("webm"))||(e==null?void 0:e.type.includes("matroska")))&&u.jsx("button",{type:"button",onClick:()=>I(!0),disabled:a,className:"px-6 py-3 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Download as WebM"}),n&&u.jsx("button",{type:"button",onClick:F,className:"px-6 py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Open in Video Analyzer"}),u.jsx("button",{type:"button",onClick:j,className:"px-6 py-3 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 transition-colors",children:"Record again"}),u.jsx("button",{type:"button",onClick:T,className:"px-6 py-3 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 transition-colors",children:"Done"})]})]})}):null}function xy({blob:e,duration:t,onBack:r}){const n=y.useRef(null),[i,s]=y.useState(null),[o,a]=y.useState(null),[l,c]=y.useState(!1),[d,h]=y.useState(0),[g,C]=y.useState(0);y.useEffect(()=>{if(!e||e.size===0){s(null),a("No recording to play.");return}a(null);const f=URL.createObjectURL(e);return s(f),()=>{URL.revokeObjectURL(f),s(null)}},[e]),y.useEffect(()=>{const f=n.current;if(!f)return;const m=()=>h(f.currentTime),v=()=>C(f.duration),w=()=>c(!0),S=()=>c(!1),T=()=>c(!1);return f.addEventListener("timeupdate",m),f.addEventListener("durationchange",v),f.addEventListener("play",w),f.addEventListener("pause",S),f.addEventListener("ended",T),()=>{f.removeEventListener("timeupdate",m),f.removeEventListener("durationchange",v),f.removeEventListener("play",w),f.removeEventListener("pause",S),f.removeEventListener("ended",T)}},[i]);const k=()=>{const f=n.current;f&&(f.paused?f.play().catch(()=>a("Playback failed")):f.pause())},x=f=>{const m=n.current,v=Number(f.target.value);!m||!isFinite(v)||(m.currentTime=v,h(v))},b=g>0?g:t,p=i?d:0;return e?u.jsxs("div",{className:"min-h-screen flex flex-col p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"VIDEO EDITOR"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back"})]}),u.jsxs("p",{className:"text-slate-400 mb-4",children:["Preview your recording. Duration: ",gi(Math.floor(b))]}),u.jsx("div",{className:"flex-1 min-h-0 flex flex-col max-w-5xl mx-auto w-full",children:u.jsxs("div",{className:"rounded-xl border-2 border-slate-600 bg-black overflow-hidden flex-1 min-h-0 flex flex-col",children:[u.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center p-4",children:i?u.jsx("video",{ref:n,src:i,controls:!0,playsInline:!0,preload:"auto",onError:()=>a("Video failed to load"),className:"w-full h-full max-h-[70vh] object-contain"}):u.jsx("div",{className:"text-slate-500",children:"Loading preview..."})}),o&&u.jsx("p",{className:"text-red-400 text-sm px-4 py-2 bg-red-900/20",children:o}),i&&u.jsx("div",{className:"shrink-0 p-4 bg-slate-900/80 border-t border-slate-600",children:u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 rounded-lg bg-slate-700 text-white hover:bg-slate-600 font-medium flex items-center gap-2","aria-label":l?"Pause":"Play",children:l?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""})," Pause"]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""})," Play"]})}),u.jsxs("span",{className:"text-slate-400 font-mono tabular-nums text-sm",children:[gi(Math.floor(p))," / ",gi(Math.floor(b))]}),u.jsx("div",{className:"flex-1 min-w-[200px] flex items-center gap-2",children:u.jsx("input",{type:"range",min:0,max:b||1,step:.1,value:p,onChange:x,className:"flex-1 h-2 rounded-lg appearance-none bg-slate-600 accent-ring"})})]})})]})})]}):u.jsxs("div",{className:"min-h-screen flex flex-col p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"VIDEO EDITOR"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back"})]}),u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center max-w-md mx-auto text-center",children:[u.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-700/50 flex items-center justify-center mb-6",children:u.jsx("svg",{className:"w-10 h-10 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":!0,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),u.jsx("h2",{className:"text-xl font-medium text-white mb-2",children:"No recording to edit"}),u.jsx("p",{className:"text-slate-400 text-sm mb-6",children:'Record a video in Recording Mode, then when you finish choose "Open in Video Editor" to view and edit it here.'}),u.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Go to Recording Mode"})]})]})}function ky(){const[e,t]=y.useState("analyzer"),[r,n]=y.useState(null),i=y.useRef(null),{recording:s,openInAnalyzerBlob:o,openRecordingInAnalyzer:a,clearOpenInAnalyzer:l,dismissRecording:c}=go(),d=s.status==="recording"||s.status==="paused",h=r!==null,g=y.useCallback((v,w)=>{n({blob:v,duration:w})},[]);y.useEffect(()=>{s.status==="stopped"&&s.blob&&s.blob.size>0&&r===null&&n({blob:s.blob,duration:s.duration})},[s.status,s.blob,s.duration,r]);const C=async()=>{var w;if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}(await((w=i.current)==null?void 0:w.confirmLeave())??!0)&&t("recording")},k=async()=>{var w;if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}(await((w=i.current)==null?void 0:w.confirmLeave())??!0)&&t("analyzer")},x=()=>{if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}t("editor")},b=()=>{if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}t("analyzer")},p=v=>{a(v),c(),n(null),t("analyzer")},f=()=>{n(null),t("recording")},m=()=>{t("editor")};return u.jsxs("div",{className:"min-h-screen flex flex-col",children:[u.jsx("header",{className:"shrink-0 px-6 py-4 border-b border-slate-700/50 bg-slate-900/50",children:u.jsxs("div",{className:"max-w-7xl mx-auto flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:k,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="analyzer"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Video Analyzer"}),u.jsx("button",{type:"button",onClick:C,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="recording"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Recording Mode"}),u.jsx("button",{type:"button",onClick:x,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="editor"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Video Editor"})]})}),u.jsxs("main",{className:"flex-1 min-h-0 relative",children:[(e==="recording"||d)&&u.jsx("div",{className:"min-h-full",children:u.jsx(ly,{onBack:b,onRecordingComplete:g},"recording-mode")},"recording-container"),e==="analyzer"&&!d&&u.jsx(L0,{ref:i,initialRecordingBlob:o,onRecordingConsumed:l}),e==="editor"&&u.jsx(xy,{blob:(r==null?void 0:r.blob)??s.blob,duration:(r==null?void 0:r.duration)??s.duration,onBack:()=>t("recording")})]}),u.jsx(uy,{}),h&&u.jsx(vy,{blob:r.blob,duration:r.duration,onClose:f,onOpenInAnalyzer:p,onOpenInEditor:m})]})}function Cy(){return u.jsx(ay,{children:u.jsx(ky,{})})}ah(document.getElementById("root")).render(u.jsx(y.StrictMode,{children:u.jsx(Cy,{})}));
