var Qh=Object.defineProperty;var yu=e=>{throw TypeError(e)};var Gh=(e,t,r)=>t in e?Qh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var We=(e,t,r)=>Gh(e,typeof t!="symbol"?t+"":t,r),wu=(e,t,r)=>t.has(e)||yu("Cannot "+r);var K=(e,t,r)=>(wu(e,t,"read from private field"),r?r.call(e):t.get(e)),tr=(e,t,r)=>t.has(e)?yu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Kn=(e,t,r,n)=>(wu(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Jc={exports:{}},eo={},ed={exports:{}},q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ui=Symbol.for("react.element"),Xh=Symbol.for("react.portal"),Kh=Symbol.for("react.fragment"),Yh=Symbol.for("react.strict_mode"),qh=Symbol.for("react.profiler"),Zh=Symbol.for("react.provider"),Jh=Symbol.for("react.context"),em=Symbol.for("react.forward_ref"),tm=Symbol.for("react.suspense"),rm=Symbol.for("react.memo"),nm=Symbol.for("react.lazy"),vu=Symbol.iterator;function im(e){return e===null||typeof e!="object"?null:(e=vu&&e[vu]||e["@@iterator"],typeof e=="function"?e:null)}var td={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rd=Object.assign,nd={};function Vn(e,t,r){this.props=e,this.context=t,this.refs=nd,this.updater=r||td}Vn.prototype.isReactComponent={};Vn.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Vn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function id(){}id.prototype=Vn.prototype;function yl(e,t,r){this.props=e,this.context=t,this.refs=nd,this.updater=r||td}var wl=yl.prototype=new id;wl.constructor=yl;rd(wl,Vn.prototype);wl.isPureReactComponent=!0;var xu=Array.isArray,sd=Object.prototype.hasOwnProperty,vl={current:null},od={key:!0,ref:!0,__self:!0,__source:!0};function ad(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)sd.call(t,n)&&!od.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:Ui,type:e,key:s,ref:o,props:i,_owner:vl.current}}function sm(e,t){return{$$typeof:Ui,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xl(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ui}function om(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var ku=/\/+/g;function Po(e,t){return typeof e=="object"&&e!==null&&e.key!=null?om(""+e.key):t.toString(36)}function ms(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Ui:case Xh:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+Po(o,0):n,xu(i)?(r="",e!=null&&(r=e.replace(ku,"$&/")+"/"),ms(i,t,r,"",function(c){return c})):i!=null&&(xl(i)&&(i=sm(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(ku,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",xu(e))for(var a=0;a<e.length;a++){s=e[a];var l=n+Po(s,a);o+=ms(s,t,r,l,i)}else if(l=im(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=n+Po(s,a++),o+=ms(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function qi(e,t,r){if(e==null)return e;var n=[],i=0;return ms(e,n,"","",function(s){return t.call(r,s,i++)}),n}function am(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ge={current:null},ps={transition:null},lm={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:ps,ReactCurrentOwner:vl};function ld(){throw Error("act(...) is not supported in production builds of React.")}q.Children={map:qi,forEach:function(e,t,r){qi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return qi(e,function(){t++}),t},toArray:function(e){return qi(e,function(t){return t})||[]},only:function(e){if(!xl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};q.Component=Vn;q.Fragment=Kh;q.Profiler=qh;q.PureComponent=yl;q.StrictMode=Yh;q.Suspense=tm;q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lm;q.act=ld;q.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=rd({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=vl.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)sd.call(t,l)&&!od.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:Ui,type:e.type,key:i,ref:s,props:n,_owner:o}};q.createContext=function(e){return e={$$typeof:Jh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Zh,_context:e},e.Consumer=e};q.createElement=ad;q.createFactory=function(e){var t=ad.bind(null,e);return t.type=e,t};q.createRef=function(){return{current:null}};q.forwardRef=function(e){return{$$typeof:em,render:e}};q.isValidElement=xl;q.lazy=function(e){return{$$typeof:nm,_payload:{_status:-1,_result:e},_init:am}};q.memo=function(e,t){return{$$typeof:rm,type:e,compare:t===void 0?null:t}};q.startTransition=function(e){var t=ps.transition;ps.transition={};try{e()}finally{ps.transition=t}};q.unstable_act=ld;q.useCallback=function(e,t){return Ge.current.useCallback(e,t)};q.useContext=function(e){return Ge.current.useContext(e)};q.useDebugValue=function(){};q.useDeferredValue=function(e){return Ge.current.useDeferredValue(e)};q.useEffect=function(e,t){return Ge.current.useEffect(e,t)};q.useId=function(){return Ge.current.useId()};q.useImperativeHandle=function(e,t,r){return Ge.current.useImperativeHandle(e,t,r)};q.useInsertionEffect=function(e,t){return Ge.current.useInsertionEffect(e,t)};q.useLayoutEffect=function(e,t){return Ge.current.useLayoutEffect(e,t)};q.useMemo=function(e,t){return Ge.current.useMemo(e,t)};q.useReducer=function(e,t,r){return Ge.current.useReducer(e,t,r)};q.useRef=function(e){return Ge.current.useRef(e)};q.useState=function(e){return Ge.current.useState(e)};q.useSyncExternalStore=function(e,t,r){return Ge.current.useSyncExternalStore(e,t,r)};q.useTransition=function(){return Ge.current.useTransition()};q.version="18.3.1";ed.exports=q;var g=ed.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var um=g,cm=Symbol.for("react.element"),dm=Symbol.for("react.fragment"),fm=Object.prototype.hasOwnProperty,hm=um.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mm={key:!0,ref:!0,__self:!0,__source:!0};function ud(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)fm.call(t,n)&&!mm.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:cm,type:e,key:s,ref:o,props:i,_owner:hm.current}}eo.Fragment=dm;eo.jsx=ud;eo.jsxs=ud;Jc.exports=eo;var u=Jc.exports,cd={exports:{}},dt={},dd={exports:{}},fd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,Q){var X=F.length;F.push(Q);e:for(;0<X;){var re=X-1>>>1,Z=F[re];if(0<i(Z,Q))F[re]=Q,F[X]=Z,X=re;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var Q=F[0],X=F.pop();if(X!==Q){F[0]=X;e:for(var re=0,Z=F.length,Ke=Z>>>1;re<Ke;){var W=2*(re+1)-1,ae=F[W],ee=W+1,Y=F[ee];if(0>i(ae,X))ee<Z&&0>i(Y,ae)?(F[re]=Y,F[ee]=X,re=ee):(F[re]=ae,F[W]=X,re=W);else if(ee<Z&&0>i(Y,X))F[re]=Y,F[ee]=X,re=ee;else break e}}return Q}function i(F,Q){var X=F.sortIndex-Q.sortIndex;return X!==0?X:F.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,f=null,y=3,b=!1,k=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(F){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=F)n(c),Q.sortIndex=Q.expirationTime,t(l,Q);else break;Q=r(c)}}function x(F){if(v=!1,p(F),!k)if(r(l)!==null)k=!0,B(w);else{var Q=r(c);Q!==null&&ne(x,Q.startTime-F)}}function w(F,Q){k=!1,v&&(v=!1,m(_),_=-1),b=!0;var X=y;try{for(p(Q),f=r(l);f!==null&&(!(f.expirationTime>Q)||F&&!I());){var re=f.callback;if(typeof re=="function"){f.callback=null,y=f.priorityLevel;var Z=re(f.expirationTime<=Q);Q=e.unstable_now(),typeof Z=="function"?f.callback=Z:f===r(l)&&n(l),p(Q)}else n(l);f=r(l)}if(f!==null)var Ke=!0;else{var W=r(c);W!==null&&ne(x,W.startTime-Q),Ke=!1}return Ke}finally{f=null,y=X,b=!1}}var S=!1,T=null,_=-1,A=5,z=-1;function I(){return!(e.unstable_now()-z<A)}function j(){if(T!==null){var F=e.unstable_now();z=F;var Q=!0;try{Q=T(!0,F)}finally{Q?M():(S=!1,T=null)}}else S=!1}var M;if(typeof h=="function")M=function(){h(j)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,H=O.port2;O.port1.onmessage=j,M=function(){H.postMessage(null)}}else M=function(){E(j,0)};function B(F){T=F,S||(S=!0,M())}function ne(F,Q){_=E(function(){F(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){k||b||(k=!0,B(w))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(F){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var X=y;y=Q;try{return F()}finally{y=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,Q){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var X=y;y=F;try{return Q()}finally{y=X}},e.unstable_scheduleCallback=function(F,Q,X){var re=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,F){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=X+Z,F={id:d++,callback:Q,priorityLevel:F,startTime:X,expirationTime:Z,sortIndex:-1},X>re?(F.sortIndex=X,t(c,F),r(l)===null&&F===r(c)&&(v?(m(_),_=-1):v=!0,ne(x,X-re))):(F.sortIndex=Z,t(l,F),k||b||(k=!0,B(w))),F},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(F){var Q=y;return function(){var X=y;y=Q;try{return F.apply(this,arguments)}finally{y=X}}}})(fd);dd.exports=fd;var pm=dd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gm=g,ct=pm;function D(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hd=new Set,xi={};function sn(e,t){jn(e,t),jn(e+"Capture",t)}function jn(e,t){for(xi[e]=t,e=0;e<t.length;e++)hd.add(t[e])}var Kt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ma=Object.prototype.hasOwnProperty,ym=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bu={},Cu={};function wm(e){return ma.call(Cu,e)?!0:ma.call(bu,e)?!1:ym.test(e)?Cu[e]=!0:(bu[e]=!0,!1)}function vm(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xm(e,t,r,n){if(t===null||typeof t>"u"||vm(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xe(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var je={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){je[e]=new Xe(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];je[t]=new Xe(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){je[e]=new Xe(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){je[e]=new Xe(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){je[e]=new Xe(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){je[e]=new Xe(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){je[e]=new Xe(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){je[e]=new Xe(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){je[e]=new Xe(e,5,!1,e.toLowerCase(),null,!1,!1)});var kl=/[\-:]([a-z])/g;function bl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(kl,bl);je[t]=new Xe(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(kl,bl);je[t]=new Xe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(kl,bl);je[t]=new Xe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){je[e]=new Xe(e,1,!1,e.toLowerCase(),null,!1,!1)});je.xlinkHref=new Xe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){je[e]=new Xe(e,1,!1,e.toLowerCase(),null,!0,!0)});function Cl(e,t,r,n){var i=je.hasOwnProperty(t)?je[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(xm(t,r,i,n)&&(r=null),n||i===null?wm(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Jt=gm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zi=Symbol.for("react.element"),hn=Symbol.for("react.portal"),mn=Symbol.for("react.fragment"),El=Symbol.for("react.strict_mode"),pa=Symbol.for("react.profiler"),md=Symbol.for("react.provider"),pd=Symbol.for("react.context"),Sl=Symbol.for("react.forward_ref"),ga=Symbol.for("react.suspense"),ya=Symbol.for("react.suspense_list"),Tl=Symbol.for("react.memo"),sr=Symbol.for("react.lazy"),gd=Symbol.for("react.offscreen"),Eu=Symbol.iterator;function Yn(e){return e===null||typeof e!="object"?null:(e=Eu&&e[Eu]||e["@@iterator"],typeof e=="function"?e:null)}var ge=Object.assign,Ro;function si(e){if(Ro===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ro=t&&t[1]||""}return`
`+Ro+e}var Ao=!1;function jo(e,t){if(!e||Ao)return"";Ao=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ao=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?si(e):""}function km(e){switch(e.tag){case 5:return si(e.type);case 16:return si("Lazy");case 13:return si("Suspense");case 19:return si("SuspenseList");case 0:case 2:case 15:return e=jo(e.type,!1),e;case 11:return e=jo(e.type.render,!1),e;case 1:return e=jo(e.type,!0),e;default:return""}}function wa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mn:return"Fragment";case hn:return"Portal";case pa:return"Profiler";case El:return"StrictMode";case ga:return"Suspense";case ya:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case pd:return(e.displayName||"Context")+".Consumer";case md:return(e._context.displayName||"Context")+".Provider";case Sl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tl:return t=e.displayName||null,t!==null?t:wa(e.type)||"Memo";case sr:t=e._payload,e=e._init;try{return wa(e(t))}catch{}}return null}function bm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wa(t);case 8:return t===El?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Cm(e){var t=yd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ji(e){e._valueTracker||(e._valueTracker=Cm(e))}function wd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=yd(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function _s(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function va(e,t){var r=t.checked;return ge({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Su(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Sr(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function vd(e,t){t=t.checked,t!=null&&Cl(e,"checked",t,!1)}function xa(e,t){vd(e,t);var r=Sr(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ka(e,t.type,r):t.hasOwnProperty("defaultValue")&&ka(e,t.type,Sr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Tu(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ka(e,t,r){(t!=="number"||_s(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var oi=Array.isArray;function Tn(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Sr(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function ba(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(D(91));return ge({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _u(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(D(92));if(oi(r)){if(1<r.length)throw Error(D(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Sr(r)}}function xd(e,t){var r=Sr(t.value),n=Sr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Nu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ca(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kd(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var es,bd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(es=es||document.createElement("div"),es.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=es.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ki(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Em=["Webkit","ms","Moz","O"];Object.keys(di).forEach(function(e){Em.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),di[t]=di[e]})});function Cd(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||di.hasOwnProperty(e)&&di[e]?(""+t).trim():t+"px"}function Ed(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Cd(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Sm=ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ea(e,t){if(t){if(Sm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(D(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(D(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(D(61))}if(t.style!=null&&typeof t.style!="object")throw Error(D(62))}}function Sa(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ta=null;function _l(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _a=null,_n=null,Nn=null;function Pu(e){if(e=Wi(e)){if(typeof _a!="function")throw Error(D(280));var t=e.stateNode;t&&(t=so(t),_a(e.stateNode,e.type,t))}}function Sd(e){_n?Nn?Nn.push(e):Nn=[e]:_n=e}function Td(){if(_n){var e=_n,t=Nn;if(Nn=_n=null,Pu(e),t)for(e=0;e<t.length;e++)Pu(t[e])}}function _d(e,t){return e(t)}function Nd(){}var Do=!1;function Pd(e,t,r){if(Do)return e(t,r);Do=!0;try{return _d(e,t,r)}finally{Do=!1,(_n!==null||Nn!==null)&&(Nd(),Td())}}function bi(e,t){var r=e.stateNode;if(r===null)return null;var n=so(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(D(231,t,typeof r));return r}var Na=!1;if(Kt)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){Na=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{Na=!1}function Tm(e,t,r,n,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var fi=!1,Ns=null,Ps=!1,Pa=null,_m={onError:function(e){fi=!0,Ns=e}};function Nm(e,t,r,n,i,s,o,a,l){fi=!1,Ns=null,Tm.apply(_m,arguments)}function Pm(e,t,r,n,i,s,o,a,l){if(Nm.apply(this,arguments),fi){if(fi){var c=Ns;fi=!1,Ns=null}else throw Error(D(198));Ps||(Ps=!0,Pa=c)}}function on(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Rd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ru(e){if(on(e)!==e)throw Error(D(188))}function Rm(e){var t=e.alternate;if(!t){if(t=on(e),t===null)throw Error(D(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Ru(i),e;if(s===n)return Ru(i),t;s=s.sibling}throw Error(D(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(D(189))}}if(r.alternate!==n)throw Error(D(190))}if(r.tag!==3)throw Error(D(188));return r.stateNode.current===r?e:t}function Ad(e){return e=Rm(e),e!==null?jd(e):null}function jd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=jd(e);if(t!==null)return t;e=e.sibling}return null}var Dd=ct.unstable_scheduleCallback,Au=ct.unstable_cancelCallback,Am=ct.unstable_shouldYield,jm=ct.unstable_requestPaint,ve=ct.unstable_now,Dm=ct.unstable_getCurrentPriorityLevel,Nl=ct.unstable_ImmediatePriority,Id=ct.unstable_UserBlockingPriority,Rs=ct.unstable_NormalPriority,Im=ct.unstable_LowPriority,Od=ct.unstable_IdlePriority,to=null,Ut=null;function Om(e){if(Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(to,e,void 0,(e.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:zm,Mm=Math.log,Fm=Math.LN2;function zm(e){return e>>>=0,e===0?32:31-(Mm(e)/Fm|0)|0}var ts=64,rs=4194304;function ai(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function As(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=ai(a):(s&=o,s!==0&&(n=ai(s)))}else o=r&~i,o!==0?n=ai(o):s!==0&&(n=ai(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pt(t),i=1<<r,n|=e[r],t&=~i;return n}function Vm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Um(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Pt(s),a=1<<o,l=i[o];l===-1?(!(a&r)||a&n)&&(i[o]=Vm(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function Ra(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Md(){var e=ts;return ts<<=1,!(ts&4194240)&&(ts=64),e}function Io(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Li(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pt(t),e[t]=r}function Lm(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Pt(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Pl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pt(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var oe=0;function Fd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zd,Rl,Vd,Ud,Ld,Aa=!1,ns=[],pr=null,gr=null,yr=null,Ci=new Map,Ei=new Map,ar=[],Bm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ju(e,t){switch(e){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":yr=null;break;case"pointerover":case"pointerout":Ci.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ei.delete(t.pointerId)}}function Zn(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Wi(t),t!==null&&Rl(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Wm(e,t,r,n,i){switch(t){case"focusin":return pr=Zn(pr,e,t,r,n,i),!0;case"dragenter":return gr=Zn(gr,e,t,r,n,i),!0;case"mouseover":return yr=Zn(yr,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Ci.set(s,Zn(Ci.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Ei.set(s,Zn(Ei.get(s)||null,e,t,r,n,i)),!0}return!1}function Bd(e){var t=Br(e.target);if(t!==null){var r=on(t);if(r!==null){if(t=r.tag,t===13){if(t=Rd(r),t!==null){e.blockedOn=t,Ld(e.priority,function(){Vd(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ja(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ta=n,r.target.dispatchEvent(n),Ta=null}else return t=Wi(r),t!==null&&Rl(t),e.blockedOn=r,!1;t.shift()}return!0}function Du(e,t,r){gs(e)&&r.delete(t)}function $m(){Aa=!1,pr!==null&&gs(pr)&&(pr=null),gr!==null&&gs(gr)&&(gr=null),yr!==null&&gs(yr)&&(yr=null),Ci.forEach(Du),Ei.forEach(Du)}function Jn(e,t){e.blockedOn===t&&(e.blockedOn=null,Aa||(Aa=!0,ct.unstable_scheduleCallback(ct.unstable_NormalPriority,$m)))}function Si(e){function t(i){return Jn(i,e)}if(0<ns.length){Jn(ns[0],e);for(var r=1;r<ns.length;r++){var n=ns[r];n.blockedOn===e&&(n.blockedOn=null)}}for(pr!==null&&Jn(pr,e),gr!==null&&Jn(gr,e),yr!==null&&Jn(yr,e),Ci.forEach(t),Ei.forEach(t),r=0;r<ar.length;r++)n=ar[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ar.length&&(r=ar[0],r.blockedOn===null);)Bd(r),r.blockedOn===null&&ar.shift()}var Pn=Jt.ReactCurrentBatchConfig,js=!0;function Hm(e,t,r,n){var i=oe,s=Pn.transition;Pn.transition=null;try{oe=1,Al(e,t,r,n)}finally{oe=i,Pn.transition=s}}function Qm(e,t,r,n){var i=oe,s=Pn.transition;Pn.transition=null;try{oe=4,Al(e,t,r,n)}finally{oe=i,Pn.transition=s}}function Al(e,t,r,n){if(js){var i=ja(e,t,r,n);if(i===null)$o(e,t,n,Ds,r),ju(e,n);else if(Wm(i,e,t,r,n))n.stopPropagation();else if(ju(e,n),t&4&&-1<Bm.indexOf(e)){for(;i!==null;){var s=Wi(i);if(s!==null&&zd(s),s=ja(e,t,r,n),s===null&&$o(e,t,n,Ds,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else $o(e,t,n,null,r)}}var Ds=null;function ja(e,t,r,n){if(Ds=null,e=_l(n),e=Br(e),e!==null)if(t=on(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Rd(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ds=e,null}function Wd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dm()){case Nl:return 1;case Id:return 4;case Rs:case Im:return 16;case Od:return 536870912;default:return 16}default:return 16}}var cr=null,jl=null,ys=null;function $d(){if(ys)return ys;var e,t=jl,r=t.length,n,i="value"in cr?cr.value:cr.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return ys=i.slice(e,1<n?1-n:void 0)}function ws(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function is(){return!0}function Iu(){return!1}function ft(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?is:Iu,this.isPropagationStopped=Iu,this}return ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=is)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=is)},persist:function(){},isPersistent:is}),t}var Un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dl=ft(Un),Bi=ge({},Un,{view:0,detail:0}),Gm=ft(Bi),Oo,Mo,ei,ro=ge({},Bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Il,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ei&&(ei&&e.type==="mousemove"?(Oo=e.screenX-ei.screenX,Mo=e.screenY-ei.screenY):Mo=Oo=0,ei=e),Oo)},movementY:function(e){return"movementY"in e?e.movementY:Mo}}),Ou=ft(ro),Xm=ge({},ro,{dataTransfer:0}),Km=ft(Xm),Ym=ge({},Bi,{relatedTarget:0}),Fo=ft(Ym),qm=ge({},Un,{animationName:0,elapsedTime:0,pseudoElement:0}),Zm=ft(qm),Jm=ge({},Un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ep=ft(Jm),tp=ge({},Un,{data:0}),Mu=ft(tp),rp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},np={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ip={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ip[e])?!!t[e]:!1}function Il(){return sp}var op=ge({},Bi,{key:function(e){if(e.key){var t=rp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?np[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Il,charCode:function(e){return e.type==="keypress"?ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ap=ft(op),lp=ge({},ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fu=ft(lp),up=ge({},Bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Il}),cp=ft(up),dp=ge({},Un,{propertyName:0,elapsedTime:0,pseudoElement:0}),fp=ft(dp),hp=ge({},ro,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),mp=ft(hp),pp=[9,13,27,32],Ol=Kt&&"CompositionEvent"in window,hi=null;Kt&&"documentMode"in document&&(hi=document.documentMode);var gp=Kt&&"TextEvent"in window&&!hi,Hd=Kt&&(!Ol||hi&&8<hi&&11>=hi),zu=" ",Vu=!1;function Qd(e,t){switch(e){case"keyup":return pp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pn=!1;function yp(e,t){switch(e){case"compositionend":return Gd(t);case"keypress":return t.which!==32?null:(Vu=!0,zu);case"textInput":return e=t.data,e===zu&&Vu?null:e;default:return null}}function wp(e,t){if(pn)return e==="compositionend"||!Ol&&Qd(e,t)?(e=$d(),ys=jl=cr=null,pn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Hd&&t.locale!=="ko"?null:t.data;default:return null}}var vp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!vp[e.type]:t==="textarea"}function Xd(e,t,r,n){Sd(n),t=Is(t,"onChange"),0<t.length&&(r=new Dl("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var mi=null,Ti=null;function xp(e){of(e,0)}function no(e){var t=wn(e);if(wd(t))return e}function kp(e,t){if(e==="change")return t}var Kd=!1;if(Kt){var zo;if(Kt){var Vo="oninput"in document;if(!Vo){var Lu=document.createElement("div");Lu.setAttribute("oninput","return;"),Vo=typeof Lu.oninput=="function"}zo=Vo}else zo=!1;Kd=zo&&(!document.documentMode||9<document.documentMode)}function Bu(){mi&&(mi.detachEvent("onpropertychange",Yd),Ti=mi=null)}function Yd(e){if(e.propertyName==="value"&&no(Ti)){var t=[];Xd(t,Ti,e,_l(e)),Pd(xp,t)}}function bp(e,t,r){e==="focusin"?(Bu(),mi=t,Ti=r,mi.attachEvent("onpropertychange",Yd)):e==="focusout"&&Bu()}function Cp(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return no(Ti)}function Ep(e,t){if(e==="click")return no(t)}function Sp(e,t){if(e==="input"||e==="change")return no(t)}function Tp(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var At=typeof Object.is=="function"?Object.is:Tp;function _i(e,t){if(At(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ma.call(t,i)||!At(e[i],t[i]))return!1}return!0}function Wu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $u(e,t){var r=Wu(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Wu(r)}}function qd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?qd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zd(){for(var e=window,t=_s();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=_s(e.document)}return t}function Ml(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _p(e){var t=Zd(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&qd(r.ownerDocument.documentElement,r)){if(n!==null&&Ml(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=$u(r,s);var o=$u(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Np=Kt&&"documentMode"in document&&11>=document.documentMode,gn=null,Da=null,pi=null,Ia=!1;function Hu(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ia||gn==null||gn!==_s(n)||(n=gn,"selectionStart"in n&&Ml(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pi&&_i(pi,n)||(pi=n,n=Is(Da,"onSelect"),0<n.length&&(t=new Dl("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function ss(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var yn={animationend:ss("Animation","AnimationEnd"),animationiteration:ss("Animation","AnimationIteration"),animationstart:ss("Animation","AnimationStart"),transitionend:ss("Transition","TransitionEnd")},Uo={},Jd={};Kt&&(Jd=document.createElement("div").style,"AnimationEvent"in window||(delete yn.animationend.animation,delete yn.animationiteration.animation,delete yn.animationstart.animation),"TransitionEvent"in window||delete yn.transitionend.transition);function io(e){if(Uo[e])return Uo[e];if(!yn[e])return e;var t=yn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Jd)return Uo[e]=t[r];return e}var ef=io("animationend"),tf=io("animationiteration"),rf=io("animationstart"),nf=io("transitionend"),sf=new Map,Qu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){sf.set(e,t),sn(t,[e])}for(var Lo=0;Lo<Qu.length;Lo++){var Bo=Qu[Lo],Pp=Bo.toLowerCase(),Rp=Bo[0].toUpperCase()+Bo.slice(1);Nr(Pp,"on"+Rp)}Nr(ef,"onAnimationEnd");Nr(tf,"onAnimationIteration");Nr(rf,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(nf,"onTransitionEnd");jn("onMouseEnter",["mouseout","mouseover"]);jn("onMouseLeave",["mouseout","mouseover"]);jn("onPointerEnter",["pointerout","pointerover"]);jn("onPointerLeave",["pointerout","pointerover"]);sn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sn("onBeforeInput",["compositionend","keypress","textInput","paste"]);sn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ap=new Set("cancel close invalid load scroll toggle".split(" ").concat(li));function Gu(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Pm(n,t,void 0,e),e.currentTarget=null}function of(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Gu(i,a,c),s=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Gu(i,a,c),s=l}}}if(Ps)throw e=Pa,Ps=!1,Pa=null,e}function ue(e,t){var r=t[Va];r===void 0&&(r=t[Va]=new Set);var n=e+"__bubble";r.has(n)||(af(t,e,2,!1),r.add(n))}function Wo(e,t,r){var n=0;t&&(n|=4),af(r,e,n,t)}var os="_reactListening"+Math.random().toString(36).slice(2);function Ni(e){if(!e[os]){e[os]=!0,hd.forEach(function(r){r!=="selectionchange"&&(Ap.has(r)||Wo(r,!1,e),Wo(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[os]||(t[os]=!0,Wo("selectionchange",!1,t))}}function af(e,t,r,n){switch(Wd(t)){case 1:var i=Hm;break;case 4:i=Qm;break;default:i=Al}r=i.bind(null,t,r,e),i=void 0,!Na||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function $o(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Br(a),o===null)return;if(l=o.tag,l===5||l===6){n=s=o;continue e}a=a.parentNode}}n=n.return}Pd(function(){var c=s,d=_l(r),f=[];e:{var y=sf.get(e);if(y!==void 0){var b=Dl,k=e;switch(e){case"keypress":if(ws(r)===0)break e;case"keydown":case"keyup":b=ap;break;case"focusin":k="focus",b=Fo;break;case"focusout":k="blur",b=Fo;break;case"beforeblur":case"afterblur":b=Fo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=Ou;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=Km;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=cp;break;case ef:case tf:case rf:b=Zm;break;case nf:b=fp;break;case"scroll":b=Gm;break;case"wheel":b=mp;break;case"copy":case"cut":case"paste":b=ep;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=Fu}var v=(t&4)!==0,E=!v&&e==="scroll",m=v?y!==null?y+"Capture":null:y;v=[];for(var h=c,p;h!==null;){p=h;var x=p.stateNode;if(p.tag===5&&x!==null&&(p=x,m!==null&&(x=bi(h,m),x!=null&&v.push(Pi(h,x,p)))),E)break;h=h.return}0<v.length&&(y=new b(y,k,null,r,d),f.push({event:y,listeners:v}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",y&&r!==Ta&&(k=r.relatedTarget||r.fromElement)&&(Br(k)||k[Yt]))break e;if((b||y)&&(y=d.window===d?d:(y=d.ownerDocument)?y.defaultView||y.parentWindow:window,b?(k=r.relatedTarget||r.toElement,b=c,k=k?Br(k):null,k!==null&&(E=on(k),k!==E||k.tag!==5&&k.tag!==6)&&(k=null)):(b=null,k=c),b!==k)){if(v=Ou,x="onMouseLeave",m="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(v=Fu,x="onPointerLeave",m="onPointerEnter",h="pointer"),E=b==null?y:wn(b),p=k==null?y:wn(k),y=new v(x,h+"leave",b,r,d),y.target=E,y.relatedTarget=p,x=null,Br(d)===c&&(v=new v(m,h+"enter",k,r,d),v.target=p,v.relatedTarget=E,x=v),E=x,b&&k)t:{for(v=b,m=k,h=0,p=v;p;p=dn(p))h++;for(p=0,x=m;x;x=dn(x))p++;for(;0<h-p;)v=dn(v),h--;for(;0<p-h;)m=dn(m),p--;for(;h--;){if(v===m||m!==null&&v===m.alternate)break t;v=dn(v),m=dn(m)}v=null}else v=null;b!==null&&Xu(f,y,b,v,!1),k!==null&&E!==null&&Xu(f,E,k,v,!0)}}e:{if(y=c?wn(c):window,b=y.nodeName&&y.nodeName.toLowerCase(),b==="select"||b==="input"&&y.type==="file")var w=kp;else if(Uu(y))if(Kd)w=Sp;else{w=Cp;var S=bp}else(b=y.nodeName)&&b.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(w=Ep);if(w&&(w=w(e,c))){Xd(f,w,r,d);break e}S&&S(e,y,c),e==="focusout"&&(S=y._wrapperState)&&S.controlled&&y.type==="number"&&ka(y,"number",y.value)}switch(S=c?wn(c):window,e){case"focusin":(Uu(S)||S.contentEditable==="true")&&(gn=S,Da=c,pi=null);break;case"focusout":pi=Da=gn=null;break;case"mousedown":Ia=!0;break;case"contextmenu":case"mouseup":case"dragend":Ia=!1,Hu(f,r,d);break;case"selectionchange":if(Np)break;case"keydown":case"keyup":Hu(f,r,d)}var T;if(Ol)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else pn?Qd(e,r)&&(_="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(Hd&&r.locale!=="ko"&&(pn||_!=="onCompositionStart"?_==="onCompositionEnd"&&pn&&(T=$d()):(cr=d,jl="value"in cr?cr.value:cr.textContent,pn=!0)),S=Is(c,_),0<S.length&&(_=new Mu(_,e,null,r,d),f.push({event:_,listeners:S}),T?_.data=T:(T=Gd(r),T!==null&&(_.data=T)))),(T=gp?yp(e,r):wp(e,r))&&(c=Is(c,"onBeforeInput"),0<c.length&&(d=new Mu("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:c}),d.data=T))}of(f,t)})}function Pi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Is(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=bi(e,r),s!=null&&n.unshift(Pi(e,s,i)),s=bi(e,t),s!=null&&n.push(Pi(e,s,i))),e=e.return}return n}function dn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xu(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,i?(l=bi(r,s),l!=null&&o.unshift(Pi(r,l,a))):i||(l=bi(r,s),l!=null&&o.push(Pi(r,l,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var jp=/\r\n?/g,Dp=/\u0000|\uFFFD/g;function Ku(e){return(typeof e=="string"?e:""+e).replace(jp,`
`).replace(Dp,"")}function as(e,t,r){if(t=Ku(t),Ku(e)!==t&&r)throw Error(D(425))}function Os(){}var Oa=null,Ma=null;function Fa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var za=typeof setTimeout=="function"?setTimeout:void 0,Ip=typeof clearTimeout=="function"?clearTimeout:void 0,Yu=typeof Promise=="function"?Promise:void 0,Op=typeof queueMicrotask=="function"?queueMicrotask:typeof Yu<"u"?function(e){return Yu.resolve(null).then(e).catch(Mp)}:za;function Mp(e){setTimeout(function(){throw e})}function Ho(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Si(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Si(t)}function wr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ln=Math.random().toString(36).slice(2),Vt="__reactFiber$"+Ln,Ri="__reactProps$"+Ln,Yt="__reactContainer$"+Ln,Va="__reactEvents$"+Ln,Fp="__reactListeners$"+Ln,zp="__reactHandles$"+Ln;function Br(e){var t=e[Vt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Yt]||r[Vt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qu(e);e!==null;){if(r=e[Vt])return r;e=qu(e)}return t}e=r,r=e.parentNode}return null}function Wi(e){return e=e[Vt]||e[Yt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(D(33))}function so(e){return e[Ri]||null}var Ua=[],vn=-1;function Pr(e){return{current:e}}function ce(e){0>vn||(e.current=Ua[vn],Ua[vn]=null,vn--)}function le(e,t){vn++,Ua[vn]=e.current,e.current=t}var Tr={},Ve=Pr(Tr),et=Pr(!1),Zr=Tr;function Dn(e,t){var r=e.type.contextTypes;if(!r)return Tr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function tt(e){return e=e.childContextTypes,e!=null}function Ms(){ce(et),ce(Ve)}function Zu(e,t,r){if(Ve.current!==Tr)throw Error(D(168));le(Ve,t),le(et,r)}function lf(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(D(108,bm(e)||"Unknown",i));return ge({},r,n)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tr,Zr=Ve.current,le(Ve,e),le(et,et.current),!0}function Ju(e,t,r){var n=e.stateNode;if(!n)throw Error(D(169));r?(e=lf(e,t,Zr),n.__reactInternalMemoizedMergedChildContext=e,ce(et),ce(Ve),le(Ve,e)):ce(et),le(et,r)}var $t=null,oo=!1,Qo=!1;function uf(e){$t===null?$t=[e]:$t.push(e)}function Vp(e){oo=!0,uf(e)}function Rr(){if(!Qo&&$t!==null){Qo=!0;var e=0,t=oe;try{var r=$t;for(oe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}$t=null,oo=!1}catch(i){throw $t!==null&&($t=$t.slice(e+1)),Dd(Nl,Rr),i}finally{oe=t,Qo=!1}}return null}var xn=[],kn=0,zs=null,Vs=0,pt=[],gt=0,Jr=null,Qt=1,Gt="";function Vr(e,t){xn[kn++]=Vs,xn[kn++]=zs,zs=e,Vs=t}function cf(e,t,r){pt[gt++]=Qt,pt[gt++]=Gt,pt[gt++]=Jr,Jr=e;var n=Qt;e=Gt;var i=32-Pt(n)-1;n&=~(1<<i),r+=1;var s=32-Pt(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Qt=1<<32-Pt(t)+i|r<<i|n,Gt=s+e}else Qt=1<<s|r<<i|n,Gt=e}function Fl(e){e.return!==null&&(Vr(e,1),cf(e,1,0))}function zl(e){for(;e===zs;)zs=xn[--kn],xn[kn]=null,Vs=xn[--kn],xn[kn]=null;for(;e===Jr;)Jr=pt[--gt],pt[gt]=null,Gt=pt[--gt],pt[gt]=null,Qt=pt[--gt],pt[gt]=null}var ut=null,lt=null,he=!1,Nt=null;function df(e,t){var r=yt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ec(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ut=e,lt=wr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ut=e,lt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Jr!==null?{id:Qt,overflow:Gt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=yt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ut=e,lt=null,!0):!1;default:return!1}}function La(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ba(e){if(he){var t=lt;if(t){var r=t;if(!ec(e,t)){if(La(e))throw Error(D(418));t=wr(r.nextSibling);var n=ut;t&&ec(e,t)?df(n,r):(e.flags=e.flags&-4097|2,he=!1,ut=e)}}else{if(La(e))throw Error(D(418));e.flags=e.flags&-4097|2,he=!1,ut=e}}}function tc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ut=e}function ls(e){if(e!==ut)return!1;if(!he)return tc(e),he=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fa(e.type,e.memoizedProps)),t&&(t=lt)){if(La(e))throw ff(),Error(D(418));for(;t;)df(e,t),t=wr(t.nextSibling)}if(tc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(D(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){lt=wr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}lt=null}}else lt=ut?wr(e.stateNode.nextSibling):null;return!0}function ff(){for(var e=lt;e;)e=wr(e.nextSibling)}function In(){lt=ut=null,he=!1}function Vl(e){Nt===null?Nt=[e]:Nt.push(e)}var Up=Jt.ReactCurrentBatchConfig;function ti(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(D(309));var n=r.stateNode}if(!n)throw Error(D(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(D(284));if(!r._owner)throw Error(D(290,e))}return e}function us(e,t){throw e=Object.prototype.toString.call(t),Error(D(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rc(e){var t=e._init;return t(e._payload)}function hf(e){function t(m,h){if(e){var p=m.deletions;p===null?(m.deletions=[h],m.flags|=16):p.push(h)}}function r(m,h){if(!e)return null;for(;h!==null;)t(m,h),h=h.sibling;return null}function n(m,h){for(m=new Map;h!==null;)h.key!==null?m.set(h.key,h):m.set(h.index,h),h=h.sibling;return m}function i(m,h){return m=br(m,h),m.index=0,m.sibling=null,m}function s(m,h,p){return m.index=p,e?(p=m.alternate,p!==null?(p=p.index,p<h?(m.flags|=2,h):p):(m.flags|=2,h)):(m.flags|=1048576,h)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function a(m,h,p,x){return h===null||h.tag!==6?(h=Jo(p,m.mode,x),h.return=m,h):(h=i(h,p),h.return=m,h)}function l(m,h,p,x){var w=p.type;return w===mn?d(m,h,p.props.children,x,p.key):h!==null&&(h.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===sr&&rc(w)===h.type)?(x=i(h,p.props),x.ref=ti(m,h,p),x.return=m,x):(x=Ss(p.type,p.key,p.props,null,m.mode,x),x.ref=ti(m,h,p),x.return=m,x)}function c(m,h,p,x){return h===null||h.tag!==4||h.stateNode.containerInfo!==p.containerInfo||h.stateNode.implementation!==p.implementation?(h=ea(p,m.mode,x),h.return=m,h):(h=i(h,p.children||[]),h.return=m,h)}function d(m,h,p,x,w){return h===null||h.tag!==7?(h=Kr(p,m.mode,x,w),h.return=m,h):(h=i(h,p),h.return=m,h)}function f(m,h,p){if(typeof h=="string"&&h!==""||typeof h=="number")return h=Jo(""+h,m.mode,p),h.return=m,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case Zi:return p=Ss(h.type,h.key,h.props,null,m.mode,p),p.ref=ti(m,null,h),p.return=m,p;case hn:return h=ea(h,m.mode,p),h.return=m,h;case sr:var x=h._init;return f(m,x(h._payload),p)}if(oi(h)||Yn(h))return h=Kr(h,m.mode,p,null),h.return=m,h;us(m,h)}return null}function y(m,h,p,x){var w=h!==null?h.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return w!==null?null:a(m,h,""+p,x);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Zi:return p.key===w?l(m,h,p,x):null;case hn:return p.key===w?c(m,h,p,x):null;case sr:return w=p._init,y(m,h,w(p._payload),x)}if(oi(p)||Yn(p))return w!==null?null:d(m,h,p,x,null);us(m,p)}return null}function b(m,h,p,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(p)||null,a(h,m,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zi:return m=m.get(x.key===null?p:x.key)||null,l(h,m,x,w);case hn:return m=m.get(x.key===null?p:x.key)||null,c(h,m,x,w);case sr:var S=x._init;return b(m,h,p,S(x._payload),w)}if(oi(x)||Yn(x))return m=m.get(p)||null,d(h,m,x,w,null);us(h,x)}return null}function k(m,h,p,x){for(var w=null,S=null,T=h,_=h=0,A=null;T!==null&&_<p.length;_++){T.index>_?(A=T,T=null):A=T.sibling;var z=y(m,T,p[_],x);if(z===null){T===null&&(T=A);break}e&&T&&z.alternate===null&&t(m,T),h=s(z,h,_),S===null?w=z:S.sibling=z,S=z,T=A}if(_===p.length)return r(m,T),he&&Vr(m,_),w;if(T===null){for(;_<p.length;_++)T=f(m,p[_],x),T!==null&&(h=s(T,h,_),S===null?w=T:S.sibling=T,S=T);return he&&Vr(m,_),w}for(T=n(m,T);_<p.length;_++)A=b(T,m,_,p[_],x),A!==null&&(e&&A.alternate!==null&&T.delete(A.key===null?_:A.key),h=s(A,h,_),S===null?w=A:S.sibling=A,S=A);return e&&T.forEach(function(I){return t(m,I)}),he&&Vr(m,_),w}function v(m,h,p,x){var w=Yn(p);if(typeof w!="function")throw Error(D(150));if(p=w.call(p),p==null)throw Error(D(151));for(var S=w=null,T=h,_=h=0,A=null,z=p.next();T!==null&&!z.done;_++,z=p.next()){T.index>_?(A=T,T=null):A=T.sibling;var I=y(m,T,z.value,x);if(I===null){T===null&&(T=A);break}e&&T&&I.alternate===null&&t(m,T),h=s(I,h,_),S===null?w=I:S.sibling=I,S=I,T=A}if(z.done)return r(m,T),he&&Vr(m,_),w;if(T===null){for(;!z.done;_++,z=p.next())z=f(m,z.value,x),z!==null&&(h=s(z,h,_),S===null?w=z:S.sibling=z,S=z);return he&&Vr(m,_),w}for(T=n(m,T);!z.done;_++,z=p.next())z=b(T,m,_,z.value,x),z!==null&&(e&&z.alternate!==null&&T.delete(z.key===null?_:z.key),h=s(z,h,_),S===null?w=z:S.sibling=z,S=z);return e&&T.forEach(function(j){return t(m,j)}),he&&Vr(m,_),w}function E(m,h,p,x){if(typeof p=="object"&&p!==null&&p.type===mn&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Zi:e:{for(var w=p.key,S=h;S!==null;){if(S.key===w){if(w=p.type,w===mn){if(S.tag===7){r(m,S.sibling),h=i(S,p.props.children),h.return=m,m=h;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===sr&&rc(w)===S.type){r(m,S.sibling),h=i(S,p.props),h.ref=ti(m,S,p),h.return=m,m=h;break e}r(m,S);break}else t(m,S);S=S.sibling}p.type===mn?(h=Kr(p.props.children,m.mode,x,p.key),h.return=m,m=h):(x=Ss(p.type,p.key,p.props,null,m.mode,x),x.ref=ti(m,h,p),x.return=m,m=x)}return o(m);case hn:e:{for(S=p.key;h!==null;){if(h.key===S)if(h.tag===4&&h.stateNode.containerInfo===p.containerInfo&&h.stateNode.implementation===p.implementation){r(m,h.sibling),h=i(h,p.children||[]),h.return=m,m=h;break e}else{r(m,h);break}else t(m,h);h=h.sibling}h=ea(p,m.mode,x),h.return=m,m=h}return o(m);case sr:return S=p._init,E(m,h,S(p._payload),x)}if(oi(p))return k(m,h,p,x);if(Yn(p))return v(m,h,p,x);us(m,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,h!==null&&h.tag===6?(r(m,h.sibling),h=i(h,p),h.return=m,m=h):(r(m,h),h=Jo(p,m.mode,x),h.return=m,m=h),o(m)):r(m,h)}return E}var On=hf(!0),mf=hf(!1),Us=Pr(null),Ls=null,bn=null,Ul=null;function Ll(){Ul=bn=Ls=null}function Bl(e){var t=Us.current;ce(Us),e._currentValue=t}function Wa(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Rn(e,t){Ls=e,Ul=bn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Je=!0),e.firstContext=null)}function vt(e){var t=e._currentValue;if(Ul!==e)if(e={context:e,memoizedValue:t,next:null},bn===null){if(Ls===null)throw Error(D(308));bn=e,Ls.dependencies={lanes:0,firstContext:e}}else bn=bn.next=e;return t}var Wr=null;function Wl(e){Wr===null?Wr=[e]:Wr.push(e)}function pf(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Wl(t)):(r.next=i.next,i.next=r),t.interleaved=r,qt(e,n)}function qt(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var or=!1;function $l(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Xt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vr(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,te&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,qt(e,r)}return i=n.interleaved,i===null?(t.next=t,Wl(n)):(t.next=i.next,i.next=t),n.interleaved=t,qt(e,r)}function vs(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Pl(e,r)}}function nc(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Bs(e,t,r,n){var i=e.updateQueue;or=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,d=c=l=null,a=s;do{var y=a.lane,b=a.eventTime;if((n&y)===y){d!==null&&(d=d.next={eventTime:b,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var k=e,v=a;switch(y=t,b=r,v.tag){case 1:if(k=v.payload,typeof k=="function"){f=k.call(b,f,y);break e}f=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=v.payload,y=typeof k=="function"?k.call(b,f,y):k,y==null)break e;f=ge({},f,y);break e;case 2:or=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,y=i.effects,y===null?i.effects=[a]:y.push(a))}else b={eventTime:b,lane:y,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=b,l=f):d=d.next=b,o|=y;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;y=a,a=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);tn|=o,e.lanes=o,e.memoizedState=f}}function ic(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(D(191,i));i.call(n)}}}var $i={},Lt=Pr($i),Ai=Pr($i),ji=Pr($i);function $r(e){if(e===$i)throw Error(D(174));return e}function Hl(e,t){switch(le(ji,t),le(Ai,e),le(Lt,$i),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ca(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ca(t,e)}ce(Lt),le(Lt,t)}function Mn(){ce(Lt),ce(Ai),ce(ji)}function yf(e){$r(ji.current);var t=$r(Lt.current),r=Ca(t,e.type);t!==r&&(le(Ai,e),le(Lt,r))}function Ql(e){Ai.current===e&&(ce(Lt),ce(Ai))}var me=Pr(0);function Ws(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Go=[];function Gl(){for(var e=0;e<Go.length;e++)Go[e]._workInProgressVersionPrimary=null;Go.length=0}var xs=Jt.ReactCurrentDispatcher,Xo=Jt.ReactCurrentBatchConfig,en=0,pe=null,Ee=null,_e=null,$s=!1,gi=!1,Di=0,Lp=0;function Me(){throw Error(D(321))}function Xl(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!At(e[r],t[r]))return!1;return!0}function Kl(e,t,r,n,i,s){if(en=s,pe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xs.current=e===null||e.memoizedState===null?Hp:Qp,e=r(n,i),gi){s=0;do{if(gi=!1,Di=0,25<=s)throw Error(D(301));s+=1,_e=Ee=null,t.updateQueue=null,xs.current=Gp,e=r(n,i)}while(gi)}if(xs.current=Hs,t=Ee!==null&&Ee.next!==null,en=0,_e=Ee=pe=null,$s=!1,t)throw Error(D(300));return e}function Yl(){var e=Di!==0;return Di=0,e}function zt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _e===null?pe.memoizedState=_e=e:_e=_e.next=e,_e}function xt(){if(Ee===null){var e=pe.alternate;e=e!==null?e.memoizedState:null}else e=Ee.next;var t=_e===null?pe.memoizedState:_e.next;if(t!==null)_e=t,Ee=e;else{if(e===null)throw Error(D(310));Ee=e,e={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},_e===null?pe.memoizedState=_e=e:_e=_e.next=e}return _e}function Ii(e,t){return typeof t=="function"?t(e):t}function Ko(e){var t=xt(),r=t.queue;if(r===null)throw Error(D(311));r.lastRenderedReducer=e;var n=Ee,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((en&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=n):l=l.next=f,pe.lanes|=d,tn|=d}c=c.next}while(c!==null&&c!==s);l===null?o=n:l.next=a,At(n,t.memoizedState)||(Je=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,pe.lanes|=s,tn|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Yo(e){var t=xt(),r=t.queue;if(r===null)throw Error(D(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);At(s,t.memoizedState)||(Je=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function wf(){}function vf(e,t){var r=pe,n=xt(),i=t(),s=!At(n.memoizedState,i);if(s&&(n.memoizedState=i,Je=!0),n=n.queue,ql(bf.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||_e!==null&&_e.memoizedState.tag&1){if(r.flags|=2048,Oi(9,kf.bind(null,r,n,i,t),void 0,null),Ne===null)throw Error(D(349));en&30||xf(r,t,i)}return i}function xf(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=pe.updateQueue,t===null?(t={lastEffect:null,stores:null},pe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kf(e,t,r,n){t.value=r,t.getSnapshot=n,Cf(t)&&Ef(e)}function bf(e,t,r){return r(function(){Cf(t)&&Ef(e)})}function Cf(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!At(e,r)}catch{return!0}}function Ef(e){var t=qt(e,1);t!==null&&Rt(t,e,1,-1)}function sc(e){var t=zt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:e},t.queue=e,e=e.dispatch=$p.bind(null,pe,e),[t.memoizedState,e]}function Oi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=pe.updateQueue,t===null?(t={lastEffect:null,stores:null},pe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Sf(){return xt().memoizedState}function ks(e,t,r,n){var i=zt();pe.flags|=e,i.memoizedState=Oi(1|t,r,void 0,n===void 0?null:n)}function ao(e,t,r,n){var i=xt();n=n===void 0?null:n;var s=void 0;if(Ee!==null){var o=Ee.memoizedState;if(s=o.destroy,n!==null&&Xl(n,o.deps)){i.memoizedState=Oi(t,r,s,n);return}}pe.flags|=e,i.memoizedState=Oi(1|t,r,s,n)}function oc(e,t){return ks(8390656,8,e,t)}function ql(e,t){return ao(2048,8,e,t)}function Tf(e,t){return ao(4,2,e,t)}function _f(e,t){return ao(4,4,e,t)}function Nf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Pf(e,t,r){return r=r!=null?r.concat([e]):null,ao(4,4,Nf.bind(null,t,e),r)}function Zl(){}function Rf(e,t){var r=xt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xl(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Af(e,t){var r=xt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Xl(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function jf(e,t,r){return en&21?(At(r,t)||(r=Md(),pe.lanes|=r,tn|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Je=!0),e.memoizedState=r)}function Bp(e,t){var r=oe;oe=r!==0&&4>r?r:4,e(!0);var n=Xo.transition;Xo.transition={};try{e(!1),t()}finally{oe=r,Xo.transition=n}}function Df(){return xt().memoizedState}function Wp(e,t,r){var n=kr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},If(e))Of(t,r);else if(r=pf(e,t,r,n),r!==null){var i=Qe();Rt(r,e,n,i),Mf(r,t,n)}}function $p(e,t,r){var n=kr(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(If(e))Of(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,At(a,o)){var l=t.interleaved;l===null?(i.next=i,Wl(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=pf(e,t,i,n),r!==null&&(i=Qe(),Rt(r,e,n,i),Mf(r,t,n))}}function If(e){var t=e.alternate;return e===pe||t!==null&&t===pe}function Of(e,t){gi=$s=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Mf(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Pl(e,r)}}var Hs={readContext:vt,useCallback:Me,useContext:Me,useEffect:Me,useImperativeHandle:Me,useInsertionEffect:Me,useLayoutEffect:Me,useMemo:Me,useReducer:Me,useRef:Me,useState:Me,useDebugValue:Me,useDeferredValue:Me,useTransition:Me,useMutableSource:Me,useSyncExternalStore:Me,useId:Me,unstable_isNewReconciler:!1},Hp={readContext:vt,useCallback:function(e,t){return zt().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:oc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ks(4194308,4,Nf.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ks(4194308,4,e,t)},useInsertionEffect:function(e,t){return ks(4,2,e,t)},useMemo:function(e,t){var r=zt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=zt();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Wp.bind(null,pe,e),[n.memoizedState,e]},useRef:function(e){var t=zt();return e={current:e},t.memoizedState=e},useState:sc,useDebugValue:Zl,useDeferredValue:function(e){return zt().memoizedState=e},useTransition:function(){var e=sc(!1),t=e[0];return e=Bp.bind(null,e[1]),zt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=pe,i=zt();if(he){if(r===void 0)throw Error(D(407));r=r()}else{if(r=t(),Ne===null)throw Error(D(349));en&30||xf(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,oc(bf.bind(null,n,s,e),[e]),n.flags|=2048,Oi(9,kf.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=zt(),t=Ne.identifierPrefix;if(he){var r=Gt,n=Qt;r=(n&~(1<<32-Pt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Di++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Lp++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qp={readContext:vt,useCallback:Rf,useContext:vt,useEffect:ql,useImperativeHandle:Pf,useInsertionEffect:Tf,useLayoutEffect:_f,useMemo:Af,useReducer:Ko,useRef:Sf,useState:function(){return Ko(Ii)},useDebugValue:Zl,useDeferredValue:function(e){var t=xt();return jf(t,Ee.memoizedState,e)},useTransition:function(){var e=Ko(Ii)[0],t=xt().memoizedState;return[e,t]},useMutableSource:wf,useSyncExternalStore:vf,useId:Df,unstable_isNewReconciler:!1},Gp={readContext:vt,useCallback:Rf,useContext:vt,useEffect:ql,useImperativeHandle:Pf,useInsertionEffect:Tf,useLayoutEffect:_f,useMemo:Af,useReducer:Yo,useRef:Sf,useState:function(){return Yo(Ii)},useDebugValue:Zl,useDeferredValue:function(e){var t=xt();return Ee===null?t.memoizedState=e:jf(t,Ee.memoizedState,e)},useTransition:function(){var e=Yo(Ii)[0],t=xt().memoizedState;return[e,t]},useMutableSource:wf,useSyncExternalStore:vf,useId:Df,unstable_isNewReconciler:!1};function Tt(e,t){if(e&&e.defaultProps){t=ge({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function $a(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ge({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var lo={isMounted:function(e){return(e=e._reactInternals)?on(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Qe(),i=kr(e),s=Xt(n,i);s.payload=t,r!=null&&(s.callback=r),t=vr(e,s,i),t!==null&&(Rt(t,e,i,n),vs(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Qe(),i=kr(e),s=Xt(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=vr(e,s,i),t!==null&&(Rt(t,e,i,n),vs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Qe(),n=kr(e),i=Xt(r,n);i.tag=2,t!=null&&(i.callback=t),t=vr(e,i,n),t!==null&&(Rt(t,e,n,r),vs(t,e,n))}};function ac(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!_i(r,n)||!_i(i,s):!0}function Ff(e,t,r){var n=!1,i=Tr,s=t.contextType;return typeof s=="object"&&s!==null?s=vt(s):(i=tt(t)?Zr:Ve.current,n=t.contextTypes,s=(n=n!=null)?Dn(e,i):Tr),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=lo,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function lc(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&lo.enqueueReplaceState(t,t.state,null)}function Ha(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},$l(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=vt(s):(s=tt(t)?Zr:Ve.current,i.context=Dn(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&($a(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&lo.enqueueReplaceState(i,i.state,null),Bs(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Fn(e,t){try{var r="",n=t;do r+=km(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function qo(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Qa(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Xp=typeof WeakMap=="function"?WeakMap:Map;function zf(e,t,r){r=Xt(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gs||(Gs=!0,rl=n),Qa(e,t)},r}function Vf(e,t,r){r=Xt(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Qa(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Qa(e,t),typeof n!="function"&&(xr===null?xr=new Set([this]):xr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function uc(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Xp;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=l0.bind(null,e,t,r),t.then(e,e))}function cc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dc(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Xt(-1,1),t.tag=2,vr(r,t,1))),r.lanes|=1),e)}var Kp=Jt.ReactCurrentOwner,Je=!1;function He(e,t,r,n){t.child=e===null?mf(t,null,r,n):On(t,e.child,r,n)}function fc(e,t,r,n,i){r=r.render;var s=t.ref;return Rn(t,i),n=Kl(e,t,r,n,s,i),r=Yl(),e!==null&&!Je?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zt(e,t,i)):(he&&r&&Fl(t),t.flags|=1,He(e,t,n,i),t.child)}function hc(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!ou(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Uf(e,t,s,n,i)):(e=Ss(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:_i,r(o,n)&&e.ref===t.ref)return Zt(e,t,i)}return t.flags|=1,e=br(s,n),e.ref=t.ref,e.return=t,t.child=e}function Uf(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(_i(s,n)&&e.ref===t.ref)if(Je=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Je=!0);else return t.lanes=e.lanes,Zt(e,t,i)}return Ga(e,t,r,n,i)}function Lf(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},le(En,ot),ot|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,le(En,ot),ot|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,le(En,ot),ot|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,le(En,ot),ot|=n;return He(e,t,i,r),t.child}function Bf(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ga(e,t,r,n,i){var s=tt(r)?Zr:Ve.current;return s=Dn(t,s),Rn(t,i),r=Kl(e,t,r,n,s,i),n=Yl(),e!==null&&!Je?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zt(e,t,i)):(he&&n&&Fl(t),t.flags|=1,He(e,t,r,i),t.child)}function mc(e,t,r,n,i){if(tt(r)){var s=!0;Fs(t)}else s=!1;if(Rn(t,i),t.stateNode===null)bs(e,t),Ff(t,r,n),Ha(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=vt(c):(c=tt(r)?Zr:Ve.current,c=Dn(t,c));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&lc(t,o,n,c),or=!1;var y=t.memoizedState;o.state=y,Bs(t,n,o,i),l=t.memoizedState,a!==n||y!==l||et.current||or?(typeof d=="function"&&($a(t,r,d,n),l=t.memoizedState),(a=or||ac(t,r,a,n,y,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,gf(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Tt(t.type,a),o.props=c,f=t.pendingProps,y=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=vt(l):(l=tt(r)?Zr:Ve.current,l=Dn(t,l));var b=r.getDerivedStateFromProps;(d=typeof b=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||y!==l)&&lc(t,o,n,l),or=!1,y=t.memoizedState,o.state=y,Bs(t,n,o,i);var k=t.memoizedState;a!==f||y!==k||et.current||or?(typeof b=="function"&&($a(t,r,b,n),k=t.memoizedState),(c=or||ac(t,r,c,n,y,k,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,k,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,k,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=k),o.props=n,o.state=k,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),n=!1)}return Xa(e,t,r,n,s,i)}function Xa(e,t,r,n,i,s){Bf(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&Ju(t,r,!1),Zt(e,t,s);n=t.stateNode,Kp.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=On(t,e.child,null,s),t.child=On(t,null,a,s)):He(e,t,a,s),t.memoizedState=n.state,i&&Ju(t,r,!0),t.child}function Wf(e){var t=e.stateNode;t.pendingContext?Zu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Zu(e,t.context,!1),Hl(e,t.containerInfo)}function pc(e,t,r,n,i){return In(),Vl(i),t.flags|=256,He(e,t,r,n),t.child}var Ka={dehydrated:null,treeContext:null,retryLane:0};function Ya(e){return{baseLanes:e,cachePool:null,transitions:null}}function $f(e,t,r){var n=t.pendingProps,i=me.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),le(me,i&1),e===null)return Ba(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=fo(o,n,0,null),e=Kr(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ya(r),t.memoizedState=Ka,e):Jl(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Yp(e,t,o,n,a,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=br(i,l),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=br(a,s):(s=Kr(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?Ya(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Ka,n}return s=e.child,e=s.sibling,n=br(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Jl(e,t){return t=fo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cs(e,t,r,n){return n!==null&&Vl(n),On(t,e.child,null,r),e=Jl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Yp(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=qo(Error(D(422))),cs(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=fo({mode:"visible",children:n.children},i,0,null),s=Kr(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&On(t,e.child,null,o),t.child.memoizedState=Ya(o),t.memoizedState=Ka,s);if(!(t.mode&1))return cs(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(D(419)),n=qo(s,n,void 0),cs(e,t,o,n)}if(a=(o&e.childLanes)!==0,Je||a){if(n=Ne,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,qt(e,i),Rt(n,e,i,-1))}return su(),n=qo(Error(D(421))),cs(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=u0.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,lt=wr(i.nextSibling),ut=t,he=!0,Nt=null,e!==null&&(pt[gt++]=Qt,pt[gt++]=Gt,pt[gt++]=Jr,Qt=e.id,Gt=e.overflow,Jr=t),t=Jl(t,n.children),t.flags|=4096,t)}function gc(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Wa(e.return,t,r)}function Zo(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Hf(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(He(e,t,n.children,r),n=me.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gc(e,r,t);else if(e.tag===19)gc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(le(me,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Ws(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Zo(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ws(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Zo(t,!0,r,null,s);break;case"together":Zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bs(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),tn|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(D(153));if(t.child!==null){for(e=t.child,r=br(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=br(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function qp(e,t,r){switch(t.tag){case 3:Wf(t),In();break;case 5:yf(t);break;case 1:tt(t.type)&&Fs(t);break;case 4:Hl(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;le(Us,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(le(me,me.current&1),t.flags|=128,null):r&t.child.childLanes?$f(e,t,r):(le(me,me.current&1),e=Zt(e,t,r),e!==null?e.sibling:null);le(me,me.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Hf(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),le(me,me.current),n)break;return null;case 22:case 23:return t.lanes=0,Lf(e,t,r)}return Zt(e,t,r)}var Qf,qa,Gf,Xf;Qf=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};qa=function(){};Gf=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,$r(Lt.current);var s=null;switch(r){case"input":i=va(e,i),n=va(e,n),s=[];break;case"select":i=ge({},i,{value:void 0}),n=ge({},n,{value:void 0}),s=[];break;case"textarea":i=ba(e,i),n=ba(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Os)}Ea(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xi.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xi.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ue("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Xf=function(e,t,r,n){r!==n&&(t.flags|=4)};function ri(e,t){if(!he)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fe(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Zp(e,t,r){var n=t.pendingProps;switch(zl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fe(t),null;case 1:return tt(t.type)&&Ms(),Fe(t),null;case 3:return n=t.stateNode,Mn(),ce(et),ce(Ve),Gl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ls(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nt!==null&&(sl(Nt),Nt=null))),qa(e,t),Fe(t),null;case 5:Ql(t);var i=$r(ji.current);if(r=t.type,e!==null&&t.stateNode!=null)Gf(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(D(166));return Fe(t),null}if(e=$r(Lt.current),ls(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Vt]=t,n[Ri]=s,e=(t.mode&1)!==0,r){case"dialog":ue("cancel",n),ue("close",n);break;case"iframe":case"object":case"embed":ue("load",n);break;case"video":case"audio":for(i=0;i<li.length;i++)ue(li[i],n);break;case"source":ue("error",n);break;case"img":case"image":case"link":ue("error",n),ue("load",n);break;case"details":ue("toggle",n);break;case"input":Su(n,s),ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ue("invalid",n);break;case"textarea":_u(n,s),ue("invalid",n)}Ea(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&as(n.textContent,a,e),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&as(n.textContent,a,e),i=["children",""+a]):xi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ue("scroll",n)}switch(r){case"input":Ji(n),Tu(n,s,!0);break;case"textarea":Ji(n),Nu(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Os)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kd(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Vt]=t,e[Ri]=n,Qf(e,t,!1,!1),t.stateNode=e;e:{switch(o=Sa(r,n),r){case"dialog":ue("cancel",e),ue("close",e),i=n;break;case"iframe":case"object":case"embed":ue("load",e),i=n;break;case"video":case"audio":for(i=0;i<li.length;i++)ue(li[i],e);i=n;break;case"source":ue("error",e),i=n;break;case"img":case"image":case"link":ue("error",e),ue("load",e),i=n;break;case"details":ue("toggle",e),i=n;break;case"input":Su(e,n),i=va(e,n),ue("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=ge({},n,{value:void 0}),ue("invalid",e);break;case"textarea":_u(e,n),i=ba(e,n),ue("invalid",e);break;default:i=n}Ea(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Ed(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bd(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ki(e,l):typeof l=="number"&&ki(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xi.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ue("scroll",e):l!=null&&Cl(e,s,l,o))}switch(r){case"input":Ji(e),Tu(e,n,!1);break;case"textarea":Ji(e),Nu(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Sr(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Tn(e,!!n.multiple,s,!1):n.defaultValue!=null&&Tn(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Os)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fe(t),null;case 6:if(e&&t.stateNode!=null)Xf(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(D(166));if(r=$r(ji.current),$r(Lt.current),ls(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vt]=t,(s=n.nodeValue!==r)&&(e=ut,e!==null))switch(e.tag){case 3:as(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&as(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vt]=t,t.stateNode=n}return Fe(t),null;case 13:if(ce(me),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(he&&lt!==null&&t.mode&1&&!(t.flags&128))ff(),In(),t.flags|=98560,s=!1;else if(s=ls(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(D(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(D(317));s[Vt]=t}else In(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fe(t),s=!1}else Nt!==null&&(sl(Nt),Nt=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||me.current&1?Se===0&&(Se=3):su())),t.updateQueue!==null&&(t.flags|=4),Fe(t),null);case 4:return Mn(),qa(e,t),e===null&&Ni(t.stateNode.containerInfo),Fe(t),null;case 10:return Bl(t.type._context),Fe(t),null;case 17:return tt(t.type)&&Ms(),Fe(t),null;case 19:if(ce(me),s=t.memoizedState,s===null)return Fe(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)ri(s,!1);else{if(Se!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ws(e),o!==null){for(t.flags|=128,ri(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return le(me,me.current&1|2),t.child}e=e.sibling}s.tail!==null&&ve()>zn&&(t.flags|=128,n=!0,ri(s,!1),t.lanes=4194304)}else{if(!n)if(e=Ws(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ri(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!he)return Fe(t),null}else 2*ve()-s.renderingStartTime>zn&&r!==1073741824&&(t.flags|=128,n=!0,ri(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ve(),t.sibling=null,r=me.current,le(me,n?r&1|2:r&1),t):(Fe(t),null);case 22:case 23:return iu(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ot&1073741824&&(Fe(t),t.subtreeFlags&6&&(t.flags|=8192)):Fe(t),null;case 24:return null;case 25:return null}throw Error(D(156,t.tag))}function Jp(e,t){switch(zl(t),t.tag){case 1:return tt(t.type)&&Ms(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mn(),ce(et),ce(Ve),Gl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ql(t),null;case 13:if(ce(me),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(D(340));In()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ce(me),null;case 4:return Mn(),null;case 10:return Bl(t.type._context),null;case 22:case 23:return iu(),null;case 24:return null;default:return null}}var ds=!1,ze=!1,e0=typeof WeakSet=="function"?WeakSet:Set,L=null;function Cn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ye(e,t,n)}else r.current=null}function Za(e,t,r){try{r()}catch(n){ye(e,t,n)}}var yc=!1;function t0(e,t){if(Oa=js,e=Zd(),Ml(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,l=-1,c=0,d=0,f=e,y=null;t:for(;;){for(var b;f!==r||i!==0&&f.nodeType!==3||(a=o+i),f!==s||n!==0&&f.nodeType!==3||(l=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(b=f.firstChild)!==null;)y=f,f=b;for(;;){if(f===e)break t;if(y===r&&++c===i&&(a=o),y===s&&++d===n&&(l=o),(b=f.nextSibling)!==null)break;f=y,y=f.parentNode}f=b}r=a===-1||l===-1?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ma={focusedElem:e,selectionRange:r},js=!1,L=t;L!==null;)if(t=L,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,L=e;else for(;L!==null;){t=L;try{var k=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var v=k.memoizedProps,E=k.memoizedState,m=t.stateNode,h=m.getSnapshotBeforeUpdate(t.elementType===t.type?v:Tt(t.type,v),E);m.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(x){ye(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,L=e;break}L=t.return}return k=yc,yc=!1,k}function yi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Za(t,r,s)}i=i.next}while(i!==n)}}function uo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Ja(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Kf(e){var t=e.alternate;t!==null&&(e.alternate=null,Kf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vt],delete t[Ri],delete t[Va],delete t[Fp],delete t[zp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Yf(e){return e.tag===5||e.tag===3||e.tag===4}function wc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function el(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Os));else if(n!==4&&(e=e.child,e!==null))for(el(e,t,r),e=e.sibling;e!==null;)el(e,t,r),e=e.sibling}function tl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(tl(e,t,r),e=e.sibling;e!==null;)tl(e,t,r),e=e.sibling}var Re=null,_t=!1;function rr(e,t,r){for(r=r.child;r!==null;)qf(e,t,r),r=r.sibling}function qf(e,t,r){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(to,r)}catch{}switch(r.tag){case 5:ze||Cn(r,t);case 6:var n=Re,i=_t;Re=null,rr(e,t,r),Re=n,_t=i,Re!==null&&(_t?(e=Re,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Re.removeChild(r.stateNode));break;case 18:Re!==null&&(_t?(e=Re,r=r.stateNode,e.nodeType===8?Ho(e.parentNode,r):e.nodeType===1&&Ho(e,r),Si(e)):Ho(Re,r.stateNode));break;case 4:n=Re,i=_t,Re=r.stateNode.containerInfo,_t=!0,rr(e,t,r),Re=n,_t=i;break;case 0:case 11:case 14:case 15:if(!ze&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Za(r,t,o),i=i.next}while(i!==n)}rr(e,t,r);break;case 1:if(!ze&&(Cn(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){ye(r,t,a)}rr(e,t,r);break;case 21:rr(e,t,r);break;case 22:r.mode&1?(ze=(n=ze)||r.memoizedState!==null,rr(e,t,r),ze=n):rr(e,t,r);break;default:rr(e,t,r)}}function vc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new e0),t.forEach(function(n){var i=c0.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function St(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Re=a.stateNode,_t=!1;break e;case 3:Re=a.stateNode.containerInfo,_t=!0;break e;case 4:Re=a.stateNode.containerInfo,_t=!0;break e}a=a.return}if(Re===null)throw Error(D(160));qf(s,o,i),Re=null,_t=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ye(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Zf(t,e),t=t.sibling}function Zf(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(St(t,e),Ft(e),n&4){try{yi(3,e,e.return),uo(3,e)}catch(v){ye(e,e.return,v)}try{yi(5,e,e.return)}catch(v){ye(e,e.return,v)}}break;case 1:St(t,e),Ft(e),n&512&&r!==null&&Cn(r,r.return);break;case 5:if(St(t,e),Ft(e),n&512&&r!==null&&Cn(r,r.return),e.flags&32){var i=e.stateNode;try{ki(i,"")}catch(v){ye(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&vd(i,s),Sa(a,o);var c=Sa(a,s);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?Ed(i,f):d==="dangerouslySetInnerHTML"?bd(i,f):d==="children"?ki(i,f):Cl(i,d,f,c)}switch(a){case"input":xa(i,s);break;case"textarea":xd(i,s);break;case"select":var y=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var b=s.value;b!=null?Tn(i,!!s.multiple,b,!1):y!==!!s.multiple&&(s.defaultValue!=null?Tn(i,!!s.multiple,s.defaultValue,!0):Tn(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ri]=s}catch(v){ye(e,e.return,v)}}break;case 6:if(St(t,e),Ft(e),n&4){if(e.stateNode===null)throw Error(D(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(v){ye(e,e.return,v)}}break;case 3:if(St(t,e),Ft(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Si(t.containerInfo)}catch(v){ye(e,e.return,v)}break;case 4:St(t,e),Ft(e);break;case 13:St(t,e),Ft(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ru=ve())),n&4&&vc(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(ze=(c=ze)||d,St(t,e),ze=c):St(t,e),Ft(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&e.mode&1)for(L=e,d=e.child;d!==null;){for(f=L=d;L!==null;){switch(y=L,b=y.child,y.tag){case 0:case 11:case 14:case 15:yi(4,y,y.return);break;case 1:Cn(y,y.return);var k=y.stateNode;if(typeof k.componentWillUnmount=="function"){n=y,r=y.return;try{t=n,k.props=t.memoizedProps,k.state=t.memoizedState,k.componentWillUnmount()}catch(v){ye(n,r,v)}}break;case 5:Cn(y,y.return);break;case 22:if(y.memoizedState!==null){kc(f);continue}}b!==null?(b.return=y,L=b):kc(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Cd("display",o))}catch(v){ye(e,e.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(v){ye(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:St(t,e),Ft(e),n&4&&vc(e);break;case 21:break;default:St(t,e),Ft(e)}}function Ft(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Yf(r)){var n=r;break e}r=r.return}throw Error(D(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ki(i,""),n.flags&=-33);var s=wc(e);tl(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=wc(e);el(e,a,o);break;default:throw Error(D(161))}}catch(l){ye(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function r0(e,t,r){L=e,Jf(e)}function Jf(e,t,r){for(var n=(e.mode&1)!==0;L!==null;){var i=L,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||ds;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ze;a=ds;var c=ze;if(ds=o,(ze=l)&&!c)for(L=i;L!==null;)o=L,l=o.child,o.tag===22&&o.memoizedState!==null?bc(i):l!==null?(l.return=o,L=l):bc(i);for(;s!==null;)L=s,Jf(s),s=s.sibling;L=i,ds=a,ze=c}xc(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,L=s):xc(e)}}function xc(e){for(;L!==null;){var t=L;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ze||uo(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ze)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Tt(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ic(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ic(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Si(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}ze||t.flags&512&&Ja(t)}catch(y){ye(t,t.return,y)}}if(t===e){L=null;break}if(r=t.sibling,r!==null){r.return=t.return,L=r;break}L=t.return}}function kc(e){for(;L!==null;){var t=L;if(t===e){L=null;break}var r=t.sibling;if(r!==null){r.return=t.return,L=r;break}L=t.return}}function bc(e){for(;L!==null;){var t=L;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{uo(4,t)}catch(l){ye(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){ye(t,i,l)}}var s=t.return;try{Ja(t)}catch(l){ye(t,s,l)}break;case 5:var o=t.return;try{Ja(t)}catch(l){ye(t,o,l)}}}catch(l){ye(t,t.return,l)}if(t===e){L=null;break}var a=t.sibling;if(a!==null){a.return=t.return,L=a;break}L=t.return}}var n0=Math.ceil,Qs=Jt.ReactCurrentDispatcher,eu=Jt.ReactCurrentOwner,wt=Jt.ReactCurrentBatchConfig,te=0,Ne=null,be=null,Ae=0,ot=0,En=Pr(0),Se=0,Mi=null,tn=0,co=0,tu=0,wi=null,Ze=null,ru=0,zn=1/0,Wt=null,Gs=!1,rl=null,xr=null,fs=!1,dr=null,Xs=0,vi=0,nl=null,Cs=-1,Es=0;function Qe(){return te&6?ve():Cs!==-1?Cs:Cs=ve()}function kr(e){return e.mode&1?te&2&&Ae!==0?Ae&-Ae:Up.transition!==null?(Es===0&&(Es=Md()),Es):(e=oe,e!==0||(e=window.event,e=e===void 0?16:Wd(e.type)),e):1}function Rt(e,t,r,n){if(50<vi)throw vi=0,nl=null,Error(D(185));Li(e,r,n),(!(te&2)||e!==Ne)&&(e===Ne&&(!(te&2)&&(co|=r),Se===4&&lr(e,Ae)),rt(e,n),r===1&&te===0&&!(t.mode&1)&&(zn=ve()+500,oo&&Rr()))}function rt(e,t){var r=e.callbackNode;Um(e,t);var n=As(e,e===Ne?Ae:0);if(n===0)r!==null&&Au(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Au(r),t===1)e.tag===0?Vp(Cc.bind(null,e)):uf(Cc.bind(null,e)),Op(function(){!(te&6)&&Rr()}),r=null;else{switch(Fd(n)){case 1:r=Nl;break;case 4:r=Id;break;case 16:r=Rs;break;case 536870912:r=Od;break;default:r=Rs}r=ah(r,eh.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eh(e,t){if(Cs=-1,Es=0,te&6)throw Error(D(327));var r=e.callbackNode;if(An()&&e.callbackNode!==r)return null;var n=As(e,e===Ne?Ae:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ks(e,n);else{t=n;var i=te;te|=2;var s=rh();(Ne!==e||Ae!==t)&&(Wt=null,zn=ve()+500,Xr(e,t));do try{o0();break}catch(a){th(e,a)}while(!0);Ll(),Qs.current=s,te=i,be!==null?t=0:(Ne=null,Ae=0,t=Se)}if(t!==0){if(t===2&&(i=Ra(e),i!==0&&(n=i,t=il(e,i))),t===1)throw r=Mi,Xr(e,0),lr(e,n),rt(e,ve()),r;if(t===6)lr(e,n);else{if(i=e.current.alternate,!(n&30)&&!i0(i)&&(t=Ks(e,n),t===2&&(s=Ra(e),s!==0&&(n=s,t=il(e,s))),t===1))throw r=Mi,Xr(e,0),lr(e,n),rt(e,ve()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(D(345));case 2:Ur(e,Ze,Wt);break;case 3:if(lr(e,n),(n&130023424)===n&&(t=ru+500-ve(),10<t)){if(As(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Qe(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=za(Ur.bind(null,e,Ze,Wt),t);break}Ur(e,Ze,Wt);break;case 4:if(lr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Pt(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ve()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*n0(n/1960))-n,10<n){e.timeoutHandle=za(Ur.bind(null,e,Ze,Wt),n);break}Ur(e,Ze,Wt);break;case 5:Ur(e,Ze,Wt);break;default:throw Error(D(329))}}}return rt(e,ve()),e.callbackNode===r?eh.bind(null,e):null}function il(e,t){var r=wi;return e.current.memoizedState.isDehydrated&&(Xr(e,t).flags|=256),e=Ks(e,t),e!==2&&(t=Ze,Ze=r,t!==null&&sl(t)),e}function sl(e){Ze===null?Ze=e:Ze.push.apply(Ze,e)}function i0(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!At(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function lr(e,t){for(t&=~tu,t&=~co,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pt(t),n=1<<r;e[r]=-1,t&=~n}}function Cc(e){if(te&6)throw Error(D(327));An();var t=As(e,0);if(!(t&1))return rt(e,ve()),null;var r=Ks(e,t);if(e.tag!==0&&r===2){var n=Ra(e);n!==0&&(t=n,r=il(e,n))}if(r===1)throw r=Mi,Xr(e,0),lr(e,t),rt(e,ve()),r;if(r===6)throw Error(D(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ur(e,Ze,Wt),rt(e,ve()),null}function nu(e,t){var r=te;te|=1;try{return e(t)}finally{te=r,te===0&&(zn=ve()+500,oo&&Rr())}}function rn(e){dr!==null&&dr.tag===0&&!(te&6)&&An();var t=te;te|=1;var r=wt.transition,n=oe;try{if(wt.transition=null,oe=1,e)return e()}finally{oe=n,wt.transition=r,te=t,!(te&6)&&Rr()}}function iu(){ot=En.current,ce(En)}function Xr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Ip(r)),be!==null)for(r=be.return;r!==null;){var n=r;switch(zl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ms();break;case 3:Mn(),ce(et),ce(Ve),Gl();break;case 5:Ql(n);break;case 4:Mn();break;case 13:ce(me);break;case 19:ce(me);break;case 10:Bl(n.type._context);break;case 22:case 23:iu()}r=r.return}if(Ne=e,be=e=br(e.current,null),Ae=ot=t,Se=0,Mi=null,tu=co=tn=0,Ze=wi=null,Wr!==null){for(t=0;t<Wr.length;t++)if(r=Wr[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Wr=null}return e}function th(e,t){do{var r=be;try{if(Ll(),xs.current=Hs,$s){for(var n=pe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}$s=!1}if(en=0,_e=Ee=pe=null,gi=!1,Di=0,eu.current=null,r===null||r.return===null){Se=1,Mi=t,be=null;break}e:{var s=e,o=r.return,a=r,l=t;if(t=Ae,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var y=d.alternate;y?(d.updateQueue=y.updateQueue,d.memoizedState=y.memoizedState,d.lanes=y.lanes):(d.updateQueue=null,d.memoizedState=null)}var b=cc(o);if(b!==null){b.flags&=-257,dc(b,o,a,s,t),b.mode&1&&uc(s,c,t),t=b,l=c;var k=t.updateQueue;if(k===null){var v=new Set;v.add(l),t.updateQueue=v}else k.add(l);break e}else{if(!(t&1)){uc(s,c,t),su();break e}l=Error(D(426))}}else if(he&&a.mode&1){var E=cc(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),dc(E,o,a,s,t),Vl(Fn(l,a));break e}}s=l=Fn(l,a),Se!==4&&(Se=2),wi===null?wi=[s]:wi.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var m=zf(s,l,t);nc(s,m);break e;case 1:a=l;var h=s.type,p=s.stateNode;if(!(s.flags&128)&&(typeof h.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(xr===null||!xr.has(p)))){s.flags|=65536,t&=-t,s.lanes|=t;var x=Vf(s,a,t);nc(s,x);break e}}s=s.return}while(s!==null)}ih(r)}catch(w){t=w,be===r&&r!==null&&(be=r=r.return);continue}break}while(!0)}function rh(){var e=Qs.current;return Qs.current=Hs,e===null?Hs:e}function su(){(Se===0||Se===3||Se===2)&&(Se=4),Ne===null||!(tn&268435455)&&!(co&268435455)||lr(Ne,Ae)}function Ks(e,t){var r=te;te|=2;var n=rh();(Ne!==e||Ae!==t)&&(Wt=null,Xr(e,t));do try{s0();break}catch(i){th(e,i)}while(!0);if(Ll(),te=r,Qs.current=n,be!==null)throw Error(D(261));return Ne=null,Ae=0,Se}function s0(){for(;be!==null;)nh(be)}function o0(){for(;be!==null&&!Am();)nh(be)}function nh(e){var t=oh(e.alternate,e,ot);e.memoizedProps=e.pendingProps,t===null?ih(e):be=t,eu.current=null}function ih(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Jp(r,t),r!==null){r.flags&=32767,be=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Se=6,be=null;return}}else if(r=Zp(r,t,ot),r!==null){be=r;return}if(t=t.sibling,t!==null){be=t;return}be=t=e}while(t!==null);Se===0&&(Se=5)}function Ur(e,t,r){var n=oe,i=wt.transition;try{wt.transition=null,oe=1,a0(e,t,r,n)}finally{wt.transition=i,oe=n}return null}function a0(e,t,r,n){do An();while(dr!==null);if(te&6)throw Error(D(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(D(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Lm(e,s),e===Ne&&(be=Ne=null,Ae=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fs||(fs=!0,ah(Rs,function(){return An(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=wt.transition,wt.transition=null;var o=oe;oe=1;var a=te;te|=4,eu.current=null,t0(e,r),Zf(r,e),_p(Ma),js=!!Oa,Ma=Oa=null,e.current=r,r0(r),jm(),te=a,oe=o,wt.transition=s}else e.current=r;if(fs&&(fs=!1,dr=e,Xs=i),s=e.pendingLanes,s===0&&(xr=null),Om(r.stateNode),rt(e,ve()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Gs)throw Gs=!1,e=rl,rl=null,e;return Xs&1&&e.tag!==0&&An(),s=e.pendingLanes,s&1?e===nl?vi++:(vi=0,nl=e):vi=0,Rr(),null}function An(){if(dr!==null){var e=Fd(Xs),t=wt.transition,r=oe;try{if(wt.transition=null,oe=16>e?16:e,dr===null)var n=!1;else{if(e=dr,dr=null,Xs=0,te&6)throw Error(D(331));var i=te;for(te|=4,L=e.current;L!==null;){var s=L,o=s.child;if(L.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(L=c;L!==null;){var d=L;switch(d.tag){case 0:case 11:case 15:yi(8,d,s)}var f=d.child;if(f!==null)f.return=d,L=f;else for(;L!==null;){d=L;var y=d.sibling,b=d.return;if(Kf(d),d===c){L=null;break}if(y!==null){y.return=b,L=y;break}L=b}}}var k=s.alternate;if(k!==null){var v=k.child;if(v!==null){k.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}L=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,L=o;else e:for(;L!==null;){if(s=L,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yi(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,L=m;break e}L=s.return}}var h=e.current;for(L=h;L!==null;){o=L;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,L=p;else e:for(o=h;L!==null;){if(a=L,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:uo(9,a)}}catch(w){ye(a,a.return,w)}if(a===o){L=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,L=x;break e}L=a.return}}if(te=i,Rr(),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(to,e)}catch{}n=!0}return n}finally{oe=r,wt.transition=t}}return!1}function Ec(e,t,r){t=Fn(r,t),t=zf(e,t,1),e=vr(e,t,1),t=Qe(),e!==null&&(Li(e,1,t),rt(e,t))}function ye(e,t,r){if(e.tag===3)Ec(e,e,r);else for(;t!==null;){if(t.tag===3){Ec(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(xr===null||!xr.has(n))){e=Fn(r,e),e=Vf(t,e,1),t=vr(t,e,1),e=Qe(),t!==null&&(Li(t,1,e),rt(t,e));break}}t=t.return}}function l0(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Qe(),e.pingedLanes|=e.suspendedLanes&r,Ne===e&&(Ae&r)===r&&(Se===4||Se===3&&(Ae&130023424)===Ae&&500>ve()-ru?Xr(e,0):tu|=r),rt(e,t)}function sh(e,t){t===0&&(e.mode&1?(t=rs,rs<<=1,!(rs&130023424)&&(rs=4194304)):t=1);var r=Qe();e=qt(e,t),e!==null&&(Li(e,t,r),rt(e,r))}function u0(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sh(e,r)}function c0(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(D(314))}n!==null&&n.delete(t),sh(e,r)}var oh;oh=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||et.current)Je=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Je=!1,qp(e,t,r);Je=!!(e.flags&131072)}else Je=!1,he&&t.flags&1048576&&cf(t,Vs,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;bs(e,t),e=t.pendingProps;var i=Dn(t,Ve.current);Rn(t,r),i=Kl(null,t,n,e,i,r);var s=Yl();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,tt(n)?(s=!0,Fs(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$l(t),i.updater=lo,t.stateNode=i,i._reactInternals=t,Ha(t,n,e,r),t=Xa(null,t,n,!0,s,r)):(t.tag=0,he&&s&&Fl(t),He(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(bs(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=f0(n),e=Tt(n,e),i){case 0:t=Ga(null,t,n,e,r);break e;case 1:t=mc(null,t,n,e,r);break e;case 11:t=fc(null,t,n,e,r);break e;case 14:t=hc(null,t,n,Tt(n.type,e),r);break e}throw Error(D(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Tt(n,i),Ga(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Tt(n,i),mc(e,t,n,i,r);case 3:e:{if(Wf(t),e===null)throw Error(D(387));n=t.pendingProps,s=t.memoizedState,i=s.element,gf(e,t),Bs(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Fn(Error(D(423)),t),t=pc(e,t,n,r,i);break e}else if(n!==i){i=Fn(Error(D(424)),t),t=pc(e,t,n,r,i);break e}else for(lt=wr(t.stateNode.containerInfo.firstChild),ut=t,he=!0,Nt=null,r=mf(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(In(),n===i){t=Zt(e,t,r);break e}He(e,t,n,r)}t=t.child}return t;case 5:return yf(t),e===null&&Ba(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Fa(n,i)?o=null:s!==null&&Fa(n,s)&&(t.flags|=32),Bf(e,t),He(e,t,o,r),t.child;case 6:return e===null&&Ba(t),null;case 13:return $f(e,t,r);case 4:return Hl(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=On(t,null,n,r):He(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Tt(n,i),fc(e,t,n,i,r);case 7:return He(e,t,t.pendingProps,r),t.child;case 8:return He(e,t,t.pendingProps.children,r),t.child;case 12:return He(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,le(Us,n._currentValue),n._currentValue=o,s!==null)if(At(s.value,o)){if(s.children===i.children&&!et.current){t=Zt(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Xt(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Wa(s.return,r,t),a.lanes|=r;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(D(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Wa(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}He(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Rn(t,r),i=vt(i),n=n(i),t.flags|=1,He(e,t,n,r),t.child;case 14:return n=t.type,i=Tt(n,t.pendingProps),i=Tt(n.type,i),hc(e,t,n,i,r);case 15:return Uf(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Tt(n,i),bs(e,t),t.tag=1,tt(n)?(e=!0,Fs(t)):e=!1,Rn(t,r),Ff(t,n,i),Ha(t,n,i,r),Xa(null,t,n,!0,e,r);case 19:return Hf(e,t,r);case 22:return Lf(e,t,r)}throw Error(D(156,t.tag))};function ah(e,t){return Dd(e,t)}function d0(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yt(e,t,r,n){return new d0(e,t,r,n)}function ou(e){return e=e.prototype,!(!e||!e.isReactComponent)}function f0(e){if(typeof e=="function")return ou(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sl)return 11;if(e===Tl)return 14}return 2}function br(e,t){var r=e.alternate;return r===null?(r=yt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ss(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")ou(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case mn:return Kr(r.children,i,s,t);case El:o=8,i|=8;break;case pa:return e=yt(12,r,t,i|2),e.elementType=pa,e.lanes=s,e;case ga:return e=yt(13,r,t,i),e.elementType=ga,e.lanes=s,e;case ya:return e=yt(19,r,t,i),e.elementType=ya,e.lanes=s,e;case gd:return fo(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case md:o=10;break e;case pd:o=9;break e;case Sl:o=11;break e;case Tl:o=14;break e;case sr:o=16,n=null;break e}throw Error(D(130,e==null?e:typeof e,""))}return t=yt(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Kr(e,t,r,n){return e=yt(7,e,n,t),e.lanes=r,e}function fo(e,t,r,n){return e=yt(22,e,n,t),e.elementType=gd,e.lanes=r,e.stateNode={isHidden:!1},e}function Jo(e,t,r){return e=yt(6,e,null,t),e.lanes=r,e}function ea(e,t,r){return t=yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function h0(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Io(0),this.expirationTimes=Io(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Io(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function au(e,t,r,n,i,s,o,a,l){return e=new h0(e,t,r,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=yt(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$l(s),e}function m0(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hn,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lh(e){if(!e)return Tr;e=e._reactInternals;e:{if(on(e)!==e||e.tag!==1)throw Error(D(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(tt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(D(171))}if(e.tag===1){var r=e.type;if(tt(r))return lf(e,r,t)}return t}function uh(e,t,r,n,i,s,o,a,l){return e=au(r,n,!0,e,i,s,o,a,l),e.context=lh(null),r=e.current,n=Qe(),i=kr(r),s=Xt(n,i),s.callback=t??null,vr(r,s,i),e.current.lanes=i,Li(e,i,n),rt(e,n),e}function ho(e,t,r,n){var i=t.current,s=Qe(),o=kr(i);return r=lh(r),t.context===null?t.context=r:t.pendingContext=r,t=Xt(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=vr(i,t,o),e!==null&&(Rt(e,i,o,s),vs(e,i,o)),o}function Ys(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function lu(e,t){Sc(e,t),(e=e.alternate)&&Sc(e,t)}function p0(){return null}var ch=typeof reportError=="function"?reportError:function(e){console.error(e)};function uu(e){this._internalRoot=e}mo.prototype.render=uu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(D(409));ho(e,t,null,null)};mo.prototype.unmount=uu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rn(function(){ho(null,e,null,null)}),t[Yt]=null}};function mo(e){this._internalRoot=e}mo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ud();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ar.length&&t!==0&&t<ar[r].priority;r++);ar.splice(r,0,e),r===0&&Bd(e)}};function cu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function po(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tc(){}function g0(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Ys(o);s.call(c)}}var o=uh(t,n,e,0,null,!1,!1,"",Tc);return e._reactRootContainer=o,e[Yt]=o.current,Ni(e.nodeType===8?e.parentNode:e),rn(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var c=Ys(l);a.call(c)}}var l=au(e,0,!1,null,null,!1,!1,"",Tc);return e._reactRootContainer=l,e[Yt]=l.current,Ni(e.nodeType===8?e.parentNode:e),rn(function(){ho(t,l,r,n)}),l}function go(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ys(o);a.call(l)}}ho(t,o,e,i)}else o=g0(r,t,e,i,n);return Ys(o)}zd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ai(t.pendingLanes);r!==0&&(Pl(t,r|1),rt(t,ve()),!(te&6)&&(zn=ve()+500,Rr()))}break;case 13:rn(function(){var n=qt(e,1);if(n!==null){var i=Qe();Rt(n,e,1,i)}}),lu(e,1)}};Rl=function(e){if(e.tag===13){var t=qt(e,134217728);if(t!==null){var r=Qe();Rt(t,e,134217728,r)}lu(e,134217728)}};Vd=function(e){if(e.tag===13){var t=kr(e),r=qt(e,t);if(r!==null){var n=Qe();Rt(r,e,t,n)}lu(e,t)}};Ud=function(){return oe};Ld=function(e,t){var r=oe;try{return oe=e,t()}finally{oe=r}};_a=function(e,t,r){switch(t){case"input":if(xa(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=so(n);if(!i)throw Error(D(90));wd(n),xa(n,i)}}}break;case"textarea":xd(e,r);break;case"select":t=r.value,t!=null&&Tn(e,!!r.multiple,t,!1)}};_d=nu;Nd=rn;var y0={usingClientEntryPoint:!1,Events:[Wi,wn,so,Sd,Td,nu]},ni={findFiberByHostInstance:Br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w0={bundleType:ni.bundleType,version:ni.version,rendererPackageName:ni.rendererPackageName,rendererConfig:ni.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ad(e),e===null?null:e.stateNode},findFiberByHostInstance:ni.findFiberByHostInstance||p0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hs.isDisabled&&hs.supportsFiber)try{to=hs.inject(w0),Ut=hs}catch{}}dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y0;dt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cu(t))throw Error(D(200));return m0(e,t,null,r)};dt.createRoot=function(e,t){if(!cu(e))throw Error(D(299));var r=!1,n="",i=ch;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=au(e,1,!1,null,null,r,!1,n,i),e[Yt]=t.current,Ni(e.nodeType===8?e.parentNode:e),new uu(t)};dt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(D(188)):(e=Object.keys(e).join(","),Error(D(268,e)));return e=Ad(t),e=e===null?null:e.stateNode,e};dt.flushSync=function(e){return rn(e)};dt.hydrate=function(e,t,r){if(!po(t))throw Error(D(200));return go(null,e,t,!0,r)};dt.hydrateRoot=function(e,t,r){if(!cu(e))throw Error(D(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=ch;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=uh(t,null,e,1,r??null,i,!1,s,o),e[Yt]=t.current,Ni(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new mo(t)};dt.render=function(e,t,r){if(!po(t))throw Error(D(200));return go(null,e,t,!1,r)};dt.unmountComponentAtNode=function(e){if(!po(e))throw Error(D(40));return e._reactRootContainer?(rn(function(){go(null,null,e,!1,function(){e._reactRootContainer=null,e[Yt]=null})}),!0):!1};dt.unstable_batchedUpdates=nu;dt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!po(r))throw Error(D(200));if(e==null||e._reactInternals===void 0)throw Error(D(38));return go(e,t,r,!1,n)};dt.version="18.3.1-next-f1338f8080-20240426";function dh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dh)}catch(e){console.error(e)}}dh(),cd.exports=dt;var v0=cd.exports,fh,_c=v0;fh=_c.createRoot,_c.hydrateRoot;function ol(e){const t=[/(?:youtube\.com\/watch\?v=)([^&\s]+)/,/(?:youtu\.be\/)([^?\s]+)/,/(?:youtube\.com\/embed\/)([^?\s]+)/];for(const r of t){const n=e.match(r);if(n)return n[1]}return null}const hh="boxing-recent-video-urls",mh=5;function al(){try{const e=localStorage.getItem(hh);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t.slice(0,mh):[]}catch{return[]}}function x0(e){const t=e.trim();if(!t)return;const n=al().filter(s=>s!==t),i=[t,...n].slice(0,mh);try{localStorage.setItem(hh,JSON.stringify(i))}catch{}}const Fi="boxing-saved-videos";function Nc(e){const t=ol(e);return t?`https://www.youtube.com/watch?v=${t}`:e}function k0(e){return Array.isArray(e)?e.map(t=>{const r=t;return r.versions&&Array.isArray(r.versions)?t:{id:r.id??crypto.randomUUID(),youtubeUrl:r.youtubeUrl??"",versions:[{id:crypto.randomUUID(),name:r.name??"Untitled",annotations:r.annotations??[],savedAt:Date.now()}]}}):[]}function Cr(){try{const e=localStorage.getItem(Fi);if(!e)return[];const t=JSON.parse(e),r=Array.isArray(t)?t:[];return k0(r)}catch{return[]}}function ph(e){return[...e.versions].sort((r,n)=>n.savedAt-r.savedAt)[0]}function ta(e){const t=ph(e),r=t.name.replace(/\.\d+$/,"").trim()||t.name,n=e.versions;let i=0;for(const o of n){const a=o.name.match(/\.(\d+)$/);a&&(i=Math.max(i,parseInt(a[1],10)))}const s=i+1;return{baseName:r,nextName:`${r}.${s}`}}function b0(e){const t=Nc(e.youtubeUrl),r=Cr(),n=r.find(o=>Nc(o.youtubeUrl)===t),i={id:crypto.randomUUID(),name:e.name,annotations:e.annotations,savedAt:Date.now()};if(n){n.versions.unshift(i),n.youtubeUrl=e.youtubeUrl;try{localStorage.setItem(Fi,JSON.stringify(r))}catch{throw new Error("Failed to save video")}return n}const s={id:crypto.randomUUID(),youtubeUrl:e.youtubeUrl,versions:[i]};r.unshift(s);try{localStorage.setItem(Fi,JSON.stringify(r))}catch{throw new Error("Failed to save video")}return s}function gh(e){const t=Cr().filter(r=>r.id!==e);try{localStorage.setItem(Fi,JSON.stringify(t))}catch{}}function C0(e,t){const r=Cr(),n=r.find(i=>i.id===e);if(n)if(n.versions=n.versions.filter(i=>i.id!==t),n.versions.length===0)gh(e);else try{localStorage.setItem(Fi,JSON.stringify(r))}catch{}}function E0({onVideoLoaded:e}){const[t,r]=g.useState("file"),[n,i]=g.useState(""),[s,o]=g.useState(""),[a,l]=g.useState([]),[c,d]=g.useState(Cr()),[f,y]=g.useState(null),b=g.useRef(null);g.useEffect(()=>{l(al())},[]);const k=()=>d(Cr()),v=(w,S)=>{const T=ol(w.youtubeUrl);T&&e({type:"youtube",videoId:T,url:w.youtubeUrl},{annotations:S.annotations,autoPlay:!0,savedVideoId:w.id})},E=(w,S)=>{w.stopPropagation(),gh(S),k()},m=(w,S,T)=>{w.stopPropagation(),C0(S,T),k()},h=w=>{const S=new Date(w),T=new Date;return S.toDateString()===T.toDateString()?S.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):S.toLocaleDateString()},p=w=>{var _;const S=(_=w.target.files)==null?void 0:_[0];if(!S)return;if(!S.type.startsWith("video/")){o("Please select a video file (mp4, webm, etc.)");return}o("");const T=URL.createObjectURL(S);e({type:"file",url:T,file:S})},x=w=>{w.preventDefault();const S=n.trim(),T=ol(S);if(!T){o("Invalid YouTube URL. Use formats like: youtube.com/watch?v=... or youtu.be/...");return}o(""),x0(S),l(al()),e({type:"youtube",videoId:T,url:S},{autoPlay:!0})};return u.jsxs("div",{className:"max-w-2xl mx-auto p-8",children:[u.jsx("h2",{className:"font-display text-4xl text-center mb-2 tracking-wider text-white",children:"LOAD VIDEO"}),u.jsx("p",{className:"text-slate-400 text-center mb-8",children:"Import a video file or paste a YouTube link to get started"}),u.jsxs("div",{className:"flex gap-2 mb-6",children:[u.jsx("button",{type:"button",onClick:()=>{r("file"),o("")},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all ${t==="file"?"bg-ring text-white":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:"Upload File"}),u.jsx("button",{type:"button",onClick:()=>{r("url"),o("")},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all ${t==="url"?"bg-ring text-white":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:"YouTube URL"})]}),t==="file"?u.jsxs("div",{onClick:()=>{var w;return(w=b.current)==null?void 0:w.click()},className:"border-2 border-dashed border-slate-500 rounded-xl p-12 text-center cursor-pointer hover:border-accent hover:bg-slate-800/30 transition-all",children:[u.jsx("input",{ref:b,type:"file",accept:"video/*",onChange:p,className:"hidden"}),u.jsx("div",{className:"text-5xl mb-4",children:""}),u.jsx("p",{className:"text-slate-300 mb-1",children:"Click to select a video file"}),u.jsx("p",{className:"text-slate-500 text-sm",children:"MP4, WebM, MOV supported"})]}):u.jsxs("form",{onSubmit:x,className:"space-y-4",children:[u.jsx("input",{type:"url",value:n,onChange:w=>i(w.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"w-full px-4 py-3 rounded-lg bg-slate-800 border border-slate-600 text-white placeholder-slate-500 focus:outline-none focus:border-accent"}),u.jsx("button",{type:"submit",className:"w-full py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Load Video"})]}),t==="url"&&a.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-slate-500 text-sm mb-2",children:"Recent videos"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(w=>u.jsx("button",{type:"button",onClick:()=>{i(w),o("")},className:"px-3 py-1.5 rounded-lg bg-slate-700/80 text-slate-300 hover:bg-slate-600 hover:text-white text-sm truncate max-w-[320px]",title:w,children:w.length>50?`${w.slice(0,47)}...`:w},w))})]}),s&&u.jsx("p",{className:"mt-4 text-red-400 text-sm text-center",children:s}),c.length>0&&u.jsxs("div",{className:"mt-10 pt-8 border-t border-slate-700",children:[u.jsx("h3",{className:"font-display text-xl text-slate-300 mb-3 tracking-wider",children:"SAVED VIDEOS"}),u.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:c.map(w=>{const S=ph(w),T=f===w.id,_=w.versions.length>1;return u.jsxs("div",{className:"rounded-lg bg-slate-800/80 border border-slate-600 overflow-hidden",children:[u.jsxs("div",{role:"button",tabIndex:0,onClick:()=>v(w,S),onKeyDown:A=>A.key==="Enter"&&v(w,S),className:"flex items-center justify-between gap-3 p-3 hover:bg-slate-700/80 cursor-pointer transition-all group",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-slate-200 font-medium truncate",children:S.name}),u.jsx("p",{className:"text-slate-500 text-xs truncate mt-0.5",children:w.youtubeUrl}),u.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:[S.annotations.length," annotation",S.annotations.length!==1?"s":"",_&&u.jsxs("span",{className:"ml-2",children:[" ",w.versions.length," version",w.versions.length!==1?"s":""]})]})]}),w.versions.length>0&&u.jsx("button",{type:"button",onClick:A=>{A.stopPropagation(),y(T?null:w.id)},className:"p-1.5 rounded text-slate-400 hover:text-slate-200 hover:bg-slate-600",title:T?"Collapse versions":"Show versions",children:u.jsx("svg",{className:`w-5 h-5 transition-transform ${T?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),u.jsx("button",{type:"button",onClick:A=>E(A,w.id),className:"p-1.5 rounded text-slate-400 hover:text-red-400 hover:bg-slate-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete saved video",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),T&&u.jsx("div",{className:"border-t border-slate-600 bg-slate-900/50",children:w.versions.map(A=>u.jsxs("div",{role:"button",tabIndex:0,onClick:()=>v(w,A),onKeyDown:z=>z.key==="Enter"&&v(w,A),className:"flex items-center justify-between gap-3 px-3 py-2 hover:bg-slate-700/50 cursor-pointer border-b border-slate-700/50 last:border-b-0 group/version",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-slate-300 text-sm truncate",children:A.name}),u.jsxs("p",{className:"text-slate-500 text-xs mt-0.5",children:[A.annotations.length," annotations  ",h(A.savedAt)]})]}),u.jsx("button",{type:"button",onClick:z=>m(z,w.id,A.id),className:"p-1.5 rounded text-slate-400 hover:text-red-400 hover:bg-slate-600 opacity-0 group-hover/version:opacity-100 transition-opacity flex-shrink-0",title:"Delete this version",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},A.id))})]},w.id)})})]})]})}function Pc(e){if(!isFinite(e)||isNaN(e))return"0:00";const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`}function S0({currentTime:e,duration:t,isPlaying:r,onPlayPause:n,onSeek:i,isYouTube:s,isMuted:o,onUnmute:a,playbackRate:l=1,onPlaybackRateChange:c}){const[d,f]=g.useState(String(l)),[y,b]=g.useState(!1);g.useEffect(()=>{y||f(String(l))},[l,y]);const k=p=>Math.max(.25,Math.min(4,Math.round(p*100)/100)),v=p=>{const x=k(p);c==null||c(x),f(String(x))},E=p=>{f(p.target.value)},m=()=>{b(!1);const p=parseFloat(d);Number.isNaN(p)?f(String(l)):v(p)},h=p=>{p.key==="Enter"&&p.target.blur()};return u.jsxs("div",{className:"flex flex-col gap-3 p-3 bg-slate-900/95 rounded-b-lg",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{type:"button",onClick:n,className:"w-10 h-10 rounded-full bg-ring flex items-center justify-center hover:bg-red-600 transition-colors",children:r?u.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),u.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):u.jsx("svg",{className:"w-5 h-5 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}),s&&o&&a&&u.jsx("button",{type:"button",onClick:a,className:"p-2 rounded-lg bg-slate-700/80 text-slate-400 hover:text-white hover:bg-slate-600 transition-colors",title:"Unmute",children:u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})})}),u.jsx("span",{className:"text-slate-400 text-sm tabular-nums",children:Pc(e)}),u.jsx("div",{className:"flex-1 relative group",children:u.jsx("input",{type:"range",min:0,max:t||100,step:.1,value:e,onChange:p=>i(Number(p.target.value)),className:"w-full h-2 rounded-full appearance-none bg-slate-700 cursor-pointer accent-ring"})}),u.jsx("span",{className:"text-slate-400 text-sm tabular-nums",children:Pc(t)})]}),c&&u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-slate-400 text-sm shrink-0",children:"Speed"}),u.jsx("input",{type:"range",min:.25,max:4,step:.05,value:l,onChange:p=>v(Number(p.target.value)),className:"flex-1 min-w-0 h-2 rounded-full appearance-none bg-slate-700 cursor-pointer accent-ring"}),u.jsx("input",{type:"number",min:.25,max:4,step:.05,value:d,onChange:E,onFocus:()=>b(!0),onBlur:m,onKeyDown:h,className:"w-16 px-2 py-1 text-sm rounded bg-slate-700 text-slate-200 border border-slate-600 focus:border-ring focus:outline-none focus:ring-1 focus:ring-ring tabular-nums"}),u.jsx("span",{className:"text-slate-500 text-sm shrink-0",children:""})]})]})}const T0=15;function yh(e,t,r,n,i,s){const o=i-r,a=s-n,l=Math.hypot(o,a);if(l===0)return Math.hypot(e-r,t-n);const c=Math.max(0,Math.min(1,((e-r)*o+(t-n)*a)/(l*l))),d=r+c*o,f=n+c*a;return Math.hypot(e-d,t-f)}function _0(e,t,r){let n=1/0;for(let i=0;i<r.length-1;i++){const s=yh(e,t,r[i].x,r[i].y,r[i+1].x,r[i+1].y);n=Math.min(n,s)}return n}function N0(e,t,r,n,i){var c;if(t.type==="clear"||r<t.startTime||r>t.endTime)return!1;const{x:s,y:o}=e,a=Math.min(n,i)||1,l=(T0+t.strokeWidth)/a;if(t.type==="arrow"&&t.points.length>=2){const[d,f]=t.points;return yh(s,o,d.x,d.y,f.x,f.y)<=l}if(t.type==="circle"&&t.points.length>=2){const[d,f]=t.points,y=Math.hypot(f.x-d.x,f.y-d.y),b=Math.hypot(s-d.x,o-d.y);return Math.abs(b-y)<=l||b<=y+l}if(t.type==="rectangle"&&t.points.length>=2){const[d,f]=t.points,y=Math.min(d.x,f.x)-l,b=Math.max(d.x,f.x)+l,k=Math.min(d.y,f.y)-l,v=Math.max(d.y,f.y)+l;return s>=y&&s<=b&&o>=k&&o<=v}if(t.type==="draw"&&t.points.length>=2)return _0(s,o,t.points)<=l;if(t.type==="text"&&t.points.length>=1){const d=t.points[0],f=(((c=t.text)==null?void 0:c.length)??0)*(t.strokeWidth*3)/n,y=t.strokeWidth*5/i;return s>=d.x-l&&s<=d.x+f+l&&o>=d.y-y&&o<=d.y+l}return!1}function P0(e,t,r,n,i){const s={x:e.x/(n||1),y:e.y/(i||1)};for(let o=t.length-1;o>=0;o--)if(N0(s,t[o],r,n,i))return t[o];return null}function wh(e,t){let r=-1;for(let n=0;n<e.length;n++){const i=e[n];i.type==="clear"&&t>=i.startTime&&(r=n)}return e.filter((n,i)=>n.type==="clear"||i<=r?!1:t>=n.startTime&&t<=n.endTime)}function vh(e,t,r){return t<=0||r<=0?e:{x:e.x/t,y:e.y/r}}function R0(e,t,r){return{x:e.x*t,y:e.y*r}}function A0(e){for(const t of e.points)if(t.x>1||t.y>1)return!0;return!1}const j0=640,D0=360;function I0(e,t,r){if(e.type==="clear"||e.points.length===0)return e;const n=j0,i=D0,s=A0(e);return{...e,points:e.points.map(o=>s?vh(o,n,i):o)}}function O0(e,t,r){return e.map(n=>I0(n))}function M0({width:e,height:t,annotations:r,currentTime:n,activeTool:i,color:s,strokeWidth:o,onAnnotationAdd:a,onAnnotationDelete:l,isDrawing:c,onDrawingChange:d,className:f=""}){const y=g.useRef(null),[b,k]=g.useState(null),[v,E]=g.useState([]),[m,h]=g.useState(null),p=g.useCallback(I=>{const j=y.current;if(!j)return{x:0,y:0};const M=j.getBoundingClientRect(),O=j.width/j.height,H=M.width/M.height;let B,ne,F,Q;H>O?(Q=M.height,F=M.height*O,B=M.left+(M.width-F)/2,ne=M.top):(F=M.width,Q=M.width/O,B=M.left,ne=M.top+(M.height-Q)/2);const X=j.width/F,re=j.height/Q;return{x:(I.clientX-B)*X,y:(I.clientY-ne)*re}},[]),x=g.useMemo(()=>wh(r,n),[r,n]),w=g.useCallback((I,j,M=1)=>{if(j.type==="clear"||n<j.startTime||n>j.endTime)return;I.strokeStyle=j.color,I.fillStyle=j.color,I.lineWidth=j.strokeWidth,I.globalAlpha=M;const O=H=>R0(H,e,t);if(j.type==="arrow"){if(j.points.length>=2){const[H,B]=j.points.map(O);I.beginPath(),I.moveTo(H.x,H.y),I.lineTo(B.x,B.y);const ne=Math.atan2(B.y-H.y,B.x-H.x),F=15;I.moveTo(B.x,B.y),I.lineTo(B.x-F*Math.cos(ne-.4),B.y-F*Math.sin(ne-.4)),I.moveTo(B.x,B.y),I.lineTo(B.x-F*Math.cos(ne+.4),B.y-F*Math.sin(ne+.4)),I.stroke()}}else if(j.type==="circle"){if(j.points.length>=2){const[H,B]=j.points.map(O),ne=Math.hypot(B.x-H.x,B.y-H.y);I.beginPath(),I.arc(H.x,H.y,ne,0,Math.PI*2),I.stroke()}}else if(j.type==="rectangle"){if(j.points.length>=2){const[H,B]=j.points.map(O);I.strokeRect(Math.min(H.x,B.x),Math.min(H.y,B.y),Math.abs(B.x-H.x),Math.abs(B.y-H.y))}}else if(j.type==="draw"&&j.points.length>=2){const H=j.points.map(O);I.beginPath(),I.moveTo(H[0].x,H[0].y);for(let B=1;B<H.length;B++)I.lineTo(H[B].x,H[B].y);I.stroke()}else if(j.type==="text"&&j.text){I.font=`${j.strokeWidth*4}px sans-serif`;const H=O(j.points[0]);I.fillText(j.text,H.x,H.y)}I.globalAlpha=1},[n,e,t]);g.useEffect(()=>{const I=y.current;if(!I||e<=0||t<=0)return;const j=I.getContext("2d");if(j&&(j.clearRect(0,0,e,t),x.forEach(M=>w(j,M)),c&&v.length>0)){if(j.strokeStyle=s,j.lineWidth=o,i==="arrow"&&v.length>=2){const[M,O]=v;j.beginPath(),j.moveTo(M.x,M.y),j.lineTo(O.x,O.y);const H=Math.atan2(O.y-M.y,O.x-M.x),B=15;j.moveTo(O.x,O.y),j.lineTo(O.x-B*Math.cos(H-.4),O.y-B*Math.sin(H-.4)),j.moveTo(O.x,O.y),j.lineTo(O.x-B*Math.cos(H+.4),O.y-B*Math.sin(H+.4)),j.stroke()}else if(i==="circle"&&v.length>=2){const[M,O]=v,H=Math.hypot(O.x-M.x,O.y-M.y);j.beginPath(),j.arc(M.x,M.y,H,0,Math.PI*2),j.stroke()}else if(i==="rectangle"&&v.length>=2){const[M,O]=v;j.strokeRect(Math.min(M.x,O.x),Math.min(M.y,O.y),Math.abs(O.x-M.x),Math.abs(O.y-M.y))}else if(i==="draw"&&v.length>=2){j.beginPath(),j.moveTo(v[0].x,v[0].y);for(let M=1;M<v.length;M++)j.lineTo(v[M].x,v[M].y);j.stroke()}}},[x,n,c,v,i,s,o,e,t,w]);const S=g.useCallback((I,j)=>{if(I.length===0)return;const M=60,O=I.map(B=>vh(B,e,t)),H={id:crypto.randomUUID(),type:i,points:O,startTime:n,endTime:n+M,color:s,strokeWidth:o,text:j};a(H),k(null),E([]),h(null),d(!1)},[i,s,o,n,a,d,e,t]),T=I=>{const j=p(I);if(i==="eraser"){const M=P0(j,x,n,e,t);M&&l(M.id);return}if(i==="text"){h({point:j,visible:!0});return}I.target.setPointerCapture(I.pointerId),k(j),E([j]),d(!0)},_=I=>{if(!c||!b)return;const j=p(I);E(i==="draw"?M=>[...M,j]:[b,j])},A=I=>{try{I.target.releasePointerCapture(I.pointerId)}catch{}i!=="text"&&b&&v.length>0&&S(v)},z=I=>{m&&I.trim()&&S([m.point],I.trim()),h(null)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`absolute inset-0 z-[100] ${f}`,style:{pointerEvents:"auto",touchAction:"none"},children:u.jsx("canvas",{ref:y,width:e,height:t,onPointerDown:T,onPointerMove:_,onPointerUp:A,onPointerCancel:A,className:`absolute inset-0 w-full h-full block ${i==="eraser"?"cursor-cell":"cursor-crosshair"}`,style:{pointerEvents:"auto",touchAction:"none"}})}),(m==null?void 0:m.visible)&&u.jsx("div",{className:"absolute z-[110] bg-slate-800 border border-slate-600 rounded p-2 shadow-xl",style:{left:m.point.x+10,top:m.point.y},children:u.jsx("input",{type:"text",autoFocus:!0,placeholder:"Enter text...",className:"bg-transparent text-white outline-none w-48",onKeyDown:I=>{I.key==="Enter"&&z(I.target.value),I.key==="Escape"&&h(null)},onBlur:I=>{const j=I.target.value;j?z(j):h(null)}})})]})}const F0=[{type:"arrow",label:"Arrow",icon:""},{type:"circle",label:"Circle",icon:""},{type:"rectangle",label:"Rectangle",icon:""},{type:"draw",label:"Draw",icon:""},{type:"text",label:"Text",icon:"T"},{type:"eraser",label:"Eraser",icon:""}],z0=["#e63946","#f4a261","#2a9d8f","#264653","#e9c46a","#ffffff"];function V0({activeTool:e,onToolChange:t,color:r,onColorChange:n,strokeWidth:i,onStrokeWidthChange:s,onClearAll:o,onUndo:a,onRedo:l,canUndo:c,canRedo:d}){return u.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-3 bg-slate-900/90 rounded-lg border border-slate-700",children:[u.jsxs("div",{className:"flex gap-1 items-center",children:[u.jsx("button",{type:"button",onClick:a,disabled:!c,title:"Undo (Ctrl+Z)",className:"w-10 h-10 rounded flex items-center justify-center text-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white",children:""}),u.jsx("button",{type:"button",onClick:l,disabled:!d,title:"Redo (Ctrl+Shift+Z)",className:"w-10 h-10 rounded flex items-center justify-center text-lg transition-all disabled:opacity-40 disabled:cursor-not-allowed bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white",children:""}),u.jsx("span",{className:"w-px h-6 bg-slate-600 mx-1"}),F0.map(f=>u.jsx("button",{type:"button",onClick:()=>t(f.type),title:f.label,className:`w-10 h-10 rounded flex items-center justify-center text-lg transition-all ${e===f.type?"bg-ring text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600 hover:text-white"}`,children:f.icon},f.type))]}),e!=="eraser"&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Color:"}),z0.map(f=>u.jsx("button",{type:"button",onClick:()=>n(f),className:`w-6 h-6 rounded-full border-2 transition-transform ${r===f?"border-white scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:f}},f))]}),e!=="eraser"&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Size:"}),u.jsx("input",{type:"range",min:1,max:8,value:i,onChange:f=>s(Number(f.target.value)),className:"w-24 accent-ring"}),u.jsxs("span",{className:"text-slate-400 text-xs",children:[i,"px"]})]}),u.jsx("button",{type:"button",onClick:o,className:"px-3 py-1.5 rounded bg-slate-700 text-slate-400 hover:bg-red-900/50 hover:text-red-400 text-sm",children:"Clear All"})]})}function ra(e){const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`}function U0({annotations:e,onUpdate:t,onDelete:r}){return u.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.length===0?u.jsx("p",{className:"text-slate-500 text-sm py-4",children:"No annotations yet. Use the tools above to add some."}):e.map(n=>n.type==="clear"?u.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-slate-800/80 border border-slate-600 border-dashed",children:[u.jsx("div",{className:"w-4 h-4 rounded flex-shrink-0 bg-slate-600 flex items-center justify-center text-slate-400 text-xs",children:""}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-slate-400 text-sm",children:"Clear screen"}),u.jsx("div",{className:"text-slate-500 text-xs mt-1",children:ra(n.startTime)})]}),u.jsx("button",{type:"button",onClick:()=>r(n.id),className:"text-red-400 hover:text-red-300 text-sm",children:""})]},n.id):u.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-slate-800/80 border border-slate-700",children:[u.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:n.color}}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"text-slate-300 text-sm capitalize",children:n.type}),u.jsxs("div",{className:"flex gap-2 items-center mt-1",children:[u.jsxs("span",{className:"text-slate-500 text-xs",children:[ra(n.startTime),"  ",ra(n.endTime)]}),u.jsx("input",{type:"number",min:1,max:600,value:Math.round(n.endTime-n.startTime),onChange:i=>{const s=Number(i.target.value);s>0&&t(n.id,{endTime:n.startTime+s})},className:"w-14 px-1 py-0.5 text-xs bg-slate-700 rounded text-white"}),u.jsx("span",{className:"text-slate-500 text-xs",children:"sec"})]})]}),u.jsx("button",{type:"button",onClick:()=>r(n.id),className:"text-red-400 hover:text-red-300 text-sm",children:""})]},n.id))})}const L0=g.forwardRef(function({videoId:t,onTimeUpdate:r,onStateChange:n,isPaused:i,seekTo:s,playbackRate:o=1,className:a=""},l){const c=g.useRef(null),d=g.useRef(null),f=g.useRef(null),[y,b]=g.useState(!1),k=g.useRef(null),v=g.useRef(!1),E=g.useRef(0),m=g.useRef(r),h=g.useRef(n);m.current=r,h.current=n??(()=>{}),g.useEffect(()=>{b(!1),k.current=null,v.current=!1,E.current=0},[t]);const p=g.useCallback(()=>{var x,w;!c.current||!((x=window.YT)!=null&&x.Player)||(b(!1),(w=d.current)!=null&&w.destroy&&d.current.destroy(),d.current=null,f.current&&clearInterval(f.current),new window.YT.Player(c.current,{height:"100%",width:"100%",videoId:t,playerVars:{autoplay:1,controls:0,disablekb:0,fs:1,modestbranding:1,rel:0,enablejsapi:1,iv_load_policy:3,playsinline:1,mute:1},events:{onReady:S=>{d.current=S.target,f.current=window.setInterval(()=>{if(d.current){const T=d.current.getCurrentTime(),_=d.current.getDuration();m.current(T,_)}},50),b(!0)},onStateChange:S=>{const T=S.data,_=T===1||T===3,A=h.current;A&&A(_),_?(v.current=!1,E.current=0):v.current&&(T===-1||T===2)&&E.current<5&&(E.current+=1,setTimeout(()=>{d.current&&v.current&&d.current.playVideo()},100*E.current))}}}))},[t]);return g.useEffect(()=>{var x;return(x=window.YT)!=null&&x.Player?p():window.onYouTubeIframeAPIReady=p,()=>{f.current&&clearInterval(f.current),d.current=null}},[t,p]),g.useEffect(()=>{!y&&i!==void 0&&(k.current=!i)},[i,y]),g.useEffect(()=>{if(!y)return;const x=d.current;if(!x)return;const w=k.current??(i!==void 0&&!i);k.current!==null&&(k.current=null),w?(v.current=!0,E.current=0,x.playVideo()):i&&x.pauseVideo()},[y]),g.useEffect(()=>{if(!y)return;const x=d.current;!x||i===void 0||(i?(v.current=!1,E.current=0,x.pauseVideo()):(v.current=!0,E.current=0,x.playVideo()))},[i,y]),g.useEffect(()=>{const x=d.current;!x||s==null||x.seekTo(s)},[s]),g.useEffect(()=>{var w;const x=d.current;!x||!y||(w=x.setPlaybackRate)==null||w.call(x,o)},[y,o]),g.useImperativeHandle(l,()=>({play:()=>{v.current=!0,E.current=0;const x=d.current;x?x.playVideo():k.current=!0},pause:()=>{v.current=!1,E.current=0;const x=d.current;x?x.pauseVideo():k.current=!1},isReady:()=>y,unMute:()=>{const x=d.current;x!=null&&x.unMute&&x.unMute()},isMuted:()=>{const x=d.current;return x!=null&&x.isMuted?x.isMuted():!0},setPlaybackRate:x=>{var w,S;return(S=(w=d.current)==null?void 0:w.setPlaybackRate)==null?void 0:S.call(w,x)}}),[y]),u.jsxs("div",{className:`relative w-full h-full ${a}`,style:{pointerEvents:"none"},children:[u.jsx("div",{ref:c,className:"w-full h-full min-h-[200px]",style:{pointerEvents:"none"}}),!y&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/90 z-[1]",style:{pointerEvents:"none"},children:u.jsxs("div",{className:"flex flex-col items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 border-2 border-ring border-t-transparent rounded-full animate-spin"}),u.jsx("span",{className:"text-slate-400 text-sm",children:"Loading YouTube player..."})]})})]})});function B0(e,t,r,n){if(t.type==="clear")return;const i=Math.min(r,n)/400;e.strokeStyle=t.color,e.fillStyle=t.color,e.lineWidth=t.strokeWidth*i;const s=o=>({x:o.x*r,y:o.y*n});if(t.type==="arrow"&&t.points.length>=2){const[o,a]=t.points.map(s);e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(a.x,a.y);const l=Math.atan2(a.y-o.y,a.x-o.x),c=15*i;e.moveTo(a.x,a.y),e.lineTo(a.x-c*Math.cos(l-.4),a.y-c*Math.sin(l-.4)),e.moveTo(a.x,a.y),e.lineTo(a.x-c*Math.cos(l+.4),a.y-c*Math.sin(l+.4)),e.stroke()}else if(t.type==="circle"&&t.points.length>=2){const[o,a]=t.points.map(s),l=Math.hypot(a.x-o.x,a.y-o.y);e.beginPath(),e.arc(o.x,o.y,l,0,Math.PI*2),e.stroke()}else if(t.type==="rectangle"&&t.points.length>=2){const[o,a]=t.points.map(s);e.strokeRect(Math.min(o.x,a.x),Math.min(o.y,a.y),Math.abs(a.x-o.x),Math.abs(a.y-o.y))}else if(t.type==="draw"&&t.points.length>=2){const o=t.points.map(s);e.beginPath(),e.moveTo(o[0].x,o[0].y);for(let a=1;a<o.length;a++)e.lineTo(o[a].x,o[a].y);e.stroke()}else if(t.type==="text"&&t.text){e.font=`${t.strokeWidth*4*i}px sans-serif`;const o=s(t.points[0]);e.fillText(t.text,o.x,o.y)}}const na=50;function W0(e=[]){const[t,r]=g.useState([e]),[n,i]=g.useState(0),s=t[n]??[],o=g.useCallback(b=>{r(k=>{const E=[...k.slice(0,n+1),b];return E.length>na?E.slice(-na):E}),i(k=>Math.min(k+1,na-1))},[n]),a=g.useCallback(b=>{const k=typeof b=="function"?b(s):b;o(k)},[s,o]),l=g.useCallback(()=>{i(b=>b>0?b-1:b)},[]),c=g.useCallback(()=>{i(b=>b<t.length-1?b+1:b)},[t.length]),d=n>0,f=n<t.length-1,y=g.useCallback((b=[])=>{r([b]),i(0)},[]);return{annotations:s,setAnnotations:a,undo:l,redo:c,canUndo:d,canRedo:f,pushState:o,reset:y}}function $0(e){const[t,r]=g.useState({width:640,height:360});return g.useEffect(()=>{const n=e.current;if(!n)return;const i=new ResizeObserver(s=>{for(const o of s){const{width:a,height:l}=o.contentRect;a>0&&l>0&&r({width:a,height:l})}});return i.observe(n),r({width:n.clientWidth,height:n.clientHeight}),()=>i.disconnect()},[e]),t}const H0=g.forwardRef(function({initialRecordingBlob:t,onRecordingConsumed:r},n){const[i,s]=g.useState(null),[o,a]=g.useState(0),[l,c]=g.useState(0),[d,f]=g.useState(!1),[y,b]=g.useState(null),[k,v]=g.useState(1),{annotations:E,setAnnotations:m,undo:h,redo:p,canUndo:x,canRedo:w,reset:S}=W0([]),[T,_]=g.useState("arrow"),[A,z]=g.useState("#e63946"),[I,j]=g.useState(3),[M,O]=g.useState(!1),[H,B]=g.useState(!1),[,ne]=g.useState(!1),[F,Q]=g.useState(!0),[X,re]=g.useState(!1),[Z,Ke]=g.useState(!1),[W,ae]=g.useState(!1),[ee,Y]=g.useState(""),[xe,we]=g.useState(!1),[Ue,kt]=g.useState(!1),Pe=g.useRef(null),Dt=g.useRef(null),Ar=g.useRef(null),er=g.useRef(null),Wn=g.useRef(null),De=g.useRef(null),jr=g.useRef(null),Dr=g.useRef(null),$n=g.useRef(null),Hn=$0(Dr),de=g.useRef(!1),It=g.useRef(null),Le=g.useRef(null),Ce=g.useRef(null);It.current=(i==null?void 0:i.type)??null,g.useEffect(()=>{if(!t||t.size===0)return;const C=URL.createObjectURL(t);Ce.current=C,s({type:"file",url:C}),r==null||r()},[t]),g.useEffect(()=>{i===null&&Ce.current&&(URL.revokeObjectURL(Ce.current),Ce.current=null)},[i]);const Ir=g.useCallback(()=>{var R,U;const C=$n.current;C&&(de.current=It.current==="file"?!!(De.current&&!De.current.paused):It.current==="youtube"?d:!1,(U=(R=C.requestFullscreen)==null?void 0:R.call(C))==null||U.catch(()=>{}))},[d]),Ot=g.useCallback(()=>{var C,R;document.fullscreenElement&&(de.current=It.current==="file"?!!(De.current&&!De.current.paused):It.current==="youtube"?d:!1,(R=(C=document.exitFullscreen)==null?void 0:C.call(document))==null||R.catch(()=>{}))},[d]),Qn=g.useCallback(()=>{var R;if(!de.current)return;const C=It.current;if(C==="file"){const U=De.current;if(U!=null&&U.paused){const $=U.play();$!=null&&$.catch&&$.catch(()=>{requestAnimationFrame(()=>{U.paused&&de.current&&U.play()})})}}else C==="youtube"&&((R=jr.current)==null||R.play())},[]);g.useEffect(()=>{const C=()=>{const R=!!document.fullscreenElement;re(R),Le.current&&(clearTimeout(Le.current),Le.current=null),setTimeout(Qn,50)};return document.addEventListener("fullscreenchange",C),()=>document.removeEventListener("fullscreenchange",C)},[Qn]);const Mt=g.useCallback(()=>{if((i==null?void 0:i.type)==="youtube"){const C=jr.current;if(C)d?(C.pause(),f(!1),de.current=!1):(C.play(),f(!0),de.current=!0);else{const R=!d;f(R),de.current=R}}else{const C=De.current;if(!C)return;C.paused?(C.play(),de.current=!0):(C.pause(),de.current=!1)}},[i==null?void 0:i.type,d]),ln=g.useCallback(C=>{var R,U;if(v(C),(i==null?void 0:i.type)==="file"){const $=De.current;$&&($.playbackRate=C)}else(i==null?void 0:i.type)==="youtube"&&((U=(R=jr.current)==null?void 0:R.setPlaybackRate)==null||U.call(R,C))},[i==null?void 0:i.type]),xo=g.useCallback(C=>{if((i==null?void 0:i.type)==="youtube")b(C);else{const R=De.current;R&&(R.currentTime=C)}a(C)},[i==null?void 0:i.type]);g.useEffect(()=>{const C=De.current;!C||(i==null?void 0:i.type)!=="file"||(C.playbackRate=k)},[i==null?void 0:i.type,k]),g.useEffect(()=>{const C=De.current;if(!C||(i==null?void 0:i.type)!=="file")return;const R=()=>a(C.currentTime),U=()=>c(C.duration),$=()=>{f(!0),de.current=!0,Le.current&&(clearTimeout(Le.current),Le.current=null)},ke=()=>{f(!1),Le.current=window.setTimeout(()=>{Le.current=null,de.current=!1},150)};return C.addEventListener("timeupdate",R),C.addEventListener("durationchange",U),C.addEventListener("play",$),C.addEventListener("pause",ke),()=>{C.removeEventListener("timeupdate",R),C.removeEventListener("durationchange",U),C.removeEventListener("play",$),C.removeEventListener("pause",ke),Le.current&&clearTimeout(Le.current)}},[i==null?void 0:i.type]);const ko=g.useCallback(C=>{m(R=>[...R,C])},[m]),bo=g.useCallback((C,R)=>{m(U=>U.map($=>$.id===C?{...$,...R}:$))},[m]),Hi=g.useCallback(C=>{m(R=>R.filter(U=>U.id!==C))},[m]),Co=g.useCallback(()=>{const C={id:crypto.randomUUID(),type:"clear",points:[],startTime:o,endTime:o,color:"#000000",strokeWidth:1};m(R=>[...R,C])},[m,o]);g.useEffect(()=>{const C=R=>{(R.ctrlKey||R.metaKey)&&(R.key==="z"?(R.preventDefault(),R.shiftKey?p():h()):R.key==="y"&&(R.preventDefault(),p()))};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[h,p]),g.useEffect(()=>{i||S([]),ne(!1),Q(!0)},[i,S]),g.useEffect(()=>{Z&&(f(!0),de.current=!0,Ke(!1))},[Z]);const Eo=g.useCallback((C,R)=>{var U;if(Ce.current&&(URL.revokeObjectURL(Ce.current),Ce.current=null),s(C),(U=R==null?void 0:R.annotations)!=null&&U.length){const $=O0(R.annotations);S($),Ar.current=R.annotations}else Ar.current=null;er.current=(R==null?void 0:R.savedVideoId)??null,Ke(!!(R!=null&&R.autoPlay))},[S]),un=g.useCallback(()=>{const C=Ar.current;if(C===null||E.length!==C.length)return!1;const R=$=>`${$.startTime}-${$.id}`,U=$=>[...$].sort((ke,Te)=>R(ke).localeCompare(R(Te)));return JSON.stringify(U(E))===JSON.stringify(U(C))},[E]),ht=E.length>0&&((i==null?void 0:i.type)==="youtube"||(i==null?void 0:i.type)==="file"&&i.youtubeUrl),Qi=g.useCallback(()=>{if(!ht)return;const C=er.current;if(C){const U=Cr().find($=>$.id===C);if(U){const{baseName:$}=ta(U);Y($)}else Y("My Annotated Video")}else Y("My Annotated Video");ae(!0)},[ht]);g.useEffect(()=>{if(W){const C=setTimeout(()=>{const R=Wn.current;R&&(R.focus(),R.select())},0);return()=>clearTimeout(C)}},[W]);const bt=g.useCallback(()=>{ae(!1),Y(""),kt(!1)},[]),Or=g.useCallback(()=>{var C,R;we(!1),(C=Dt.current)==null||C.call(Dt),Dt.current=null,(R=Pe.current)==null||R.call(Pe,!0),Pe.current=null},[]),Gi=g.useCallback(()=>{var C;we(!1),Dt.current=null,(C=Pe.current)==null||C.call(Pe,!1),Pe.current=null},[]),Gn=g.useCallback(()=>{if(!ht){s(null);return}Dt.current=()=>s(null),Pe.current=null,we(!0)},[ht]);g.useImperativeHandle(n,()=>({confirmLeave:()=>ht?new Promise(C=>{Pe.current=C,Dt.current=null,we(!0)}):Promise.resolve(!0)}),[ht]);const So=g.useCallback(()=>{const C=er.current;if(C){const U=Cr().find($=>$.id===C);if(U){const{baseName:$}=ta(U);Y($)}else Y("My Annotated Video")}else Y("My Annotated Video");ae(!0),kt(!0),we(!1)},[]),Xi=g.useCallback(()=>{Or()},[Or]),P=g.useCallback(()=>{if(!ht||!i)return;if(un()){bt(),Ue&&Or();return}const C=i.type==="youtube"?i.url:i.youtubeUrl;if(!C)return;let R;const U=er.current;if(U){const ke=Cr().find(Te=>Te.id===U);if(ke){const{nextName:Te}=ta(ke);R=Te}else R=ee.trim()||"My Annotated Video"}else R=ee.trim();if(R)try{const $=b0({name:R,youtubeUrl:C,annotations:E});Ar.current=E,er.current=$.id,bt(),Ue&&Or()}catch{window.alert("Failed to save video.")}},[ht,i,E,ee,bt,Ue,Or,un]),V=g.useCallback(async()=>{if(!(!Dr.current||(i==null?void 0:i.type)!=="file")){B(!0);try{const C=De.current;if(!C)throw new Error("No video");const R=document.createElement("canvas");R.width=C.videoWidth,R.height=C.videoHeight;const U=R.getContext("2d");if(!U)throw new Error("No canvas context");const $=R.captureStream(30),ke=new MediaRecorder($,{mimeType:"video/webm;codecs=vp9"}),Te=[];ke.ondataavailable=nt=>nt.data.size&&Te.push(nt.data),ke.onstop=()=>{const nt=new Blob(Te,{type:"video/webm"}),Ie=URL.createObjectURL(nt),mt=document.createElement("a");mt.href=Ie,mt.download=`boxing-annotated-${Date.now()}.webm`,mt.click(),URL.revokeObjectURL(Ie),B(!1)},ke.start(100),C.currentTime=0,await C.play();const Ct=()=>{if(C.ended||C.paused){ke.stop();return}U.drawImage(C,0,0);const nt=C.videoWidth,Ie=C.videoHeight;wh(E,C.currentTime).forEach(Bt=>{B0(U,Bt,nt,Ie)}),requestAnimationFrame(Ct)};Ct()}catch(C){console.error(C),B(!1)}}},[i==null?void 0:i.type,E]);return i?u.jsx("div",{className:"min-h-screen p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"BOXING VIDEO ANALYZER"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{type:"button",onClick:Gn,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Back to home",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Home"]}),u.jsxs("button",{type:"button",onClick:Ir,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Fullscreen annotation mode",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),"Fullscreen"]}),u.jsx("button",{type:"button",onClick:Gn,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"New Video"}),ht&&u.jsxs("button",{type:"button",onClick:Qi,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 flex items-center gap-2",title:"Save video with annotations",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save"]}),i.type==="file"&&u.jsx("button",{type:"button",onClick:V,disabled:H,className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 disabled:opacity-50",children:H?"Exporting...":"Download Annotated Video"})]})]}),u.jsxs("div",{ref:$n,className:"fullscreen-annotator grid grid-cols-1 lg:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"fullscreen-video-area lg:col-span-3 space-y-4",children:[u.jsxs("div",{ref:Dr,className:"relative aspect-video bg-black rounded-t-lg overflow-hidden fullscreen-video-container",children:[i.type==="file"?u.jsx(u.Fragment,{children:u.jsx("video",{ref:De,src:i.url,className:"w-full h-full object-contain pointer-events-none",playsInline:!0,preload:"auto",onError:()=>ne(!0),onLoadedData:()=>ne(!1)})}):u.jsx("div",{className:"absolute inset-0 pointer-events-none youtube-embed-root",children:u.jsx(L0,{ref:jr,videoId:i.videoId,onTimeUpdate:(C,R)=>{a(C),c(R)},onStateChange:f,isPaused:!d,seekTo:y,className:"absolute inset-0"},i.videoId)}),u.jsx(M0,{width:Hn.width,height:Hn.height,annotations:E,currentTime:o,activeTool:T,color:A,strokeWidth:I,onAnnotationAdd:ko,onAnnotationDelete:Hi,isDrawing:M,onDrawingChange:O})]}),u.jsxs("div",{className:"fullscreen-controls-overlay flex flex-col gap-0 rounded-b-lg",children:[u.jsx(S0,{currentTime:o,duration:l,isPlaying:d,onPlayPause:Mt,onSeek:xo,playbackRate:k,onPlaybackRateChange:ln,isYouTube:i.type==="youtube",isMuted:i.type==="youtube"&&F,onUnmute:i.type==="youtube"?()=>{var C,R;(R=(C=jr.current)==null?void 0:C.unMute)==null||R.call(C),Q(!1)}:void 0}),u.jsx(V0,{activeTool:T,onToolChange:_,color:A,onColorChange:z,strokeWidth:I,onStrokeWidthChange:j,onClearAll:Co,onUndo:h,onRedo:p,canUndo:x,canRedo:w})]})]}),u.jsxs("div",{className:"fullscreen-annotations-panel space-y-2",children:[u.jsx("h3",{className:"font-display text-xl text-slate-300",children:"Annotations"}),u.jsx(U0,{annotations:E,onUpdate:bo,onDelete:Hi})]}),X&&u.jsx("div",{className:"fixed top-4 left-4 z-[200] flex gap-2",children:u.jsx("button",{type:"button",onClick:Ot,className:"p-2 rounded-lg bg-slate-800/95 border border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white transition-colors",title:"Exit fullscreen (Esc)",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),xe&&u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60",onClick:Gi,children:u.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-xl p-6 w-full max-w-md shadow-xl",onClick:C=>C.stopPropagation(),children:[u.jsx("h3",{className:"font-display text-xl text-white mb-2",children:"Save before leaving?"}),u.jsx("p",{className:"text-slate-400 text-sm mb-6",children:"You have unsaved annotations. Would you like to save this video before leaving?"}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{type:"button",onClick:Gi,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Cancel"}),u.jsx("button",{type:"button",onClick:Xi,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Don't Save"}),u.jsx("button",{type:"button",onClick:So,className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400",children:"Save"})]})]})}),W&&u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60",onClick:bt,children:u.jsxs("div",{className:"bg-slate-800 border border-slate-600 rounded-xl p-6 w-full max-w-md shadow-xl",onClick:C=>C.stopPropagation(),children:[u.jsx("h3",{className:"font-display text-xl text-white mb-4",children:"Save Video"}),u.jsx("label",{className:"block text-slate-400 text-sm mb-2",children:"Name"}),u.jsx("input",{ref:Wn,type:"text",value:ee,onChange:C=>Y(C.target.value),onKeyDown:C=>{C.key==="Enter"&&P(),C.key==="Escape"&&bt()},placeholder:"My Annotated Video",className:"w-full px-4 py-3 rounded-lg bg-slate-900 border border-slate-600 text-white placeholder-slate-500 focus:outline-none focus:border-accent mb-4"}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx("button",{type:"button",onClick:bt,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:"Cancel"}),u.jsx("button",{type:"button",onClick:P,disabled:!ee.trim(),className:"px-4 py-2 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]})]})})]})]})}):u.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-8",children:[u.jsx("h1",{className:"font-display text-6xl tracking-widest text-white mb-4",children:"BOXING VIDEO ANALYZER"}),u.jsx(E0,{onVideoLoaded:Eo})]})});/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */function G(e){if(!e)throw new Error("Assertion failed.")}const Q0=e=>{const t=(e%360+360)%360;if(t===0||t===90||t===180||t===270)return t;throw new Error(`Invalid rotation ${e}.`)},ui=e=>e&&e[e.length-1];class Bn{constructor(t){this.bytes=t,this.pos=0}seekToByte(t){this.pos=8*t}readBit(){const t=Math.floor(this.pos/8),r=this.bytes[t]??0,n=7-(this.pos&7),i=(r&1<<n)>>n;return this.pos++,i}readBits(t){if(t===1)return this.readBit();let r=0;for(let n=0;n<t;n++)r<<=1,r|=this.readBit();return r}writeBits(t,r){const n=this.pos+t;for(let i=this.pos;i<n;i++){const s=Math.floor(i/8);let o=this.bytes[s];const a=7-(i&7);o&=~(1<<a),o|=(r&1<<n-i-1)>>n-i-1<<a,this.bytes[s]=o}this.pos=n}readAlignedByte(){if(this.pos%8!==0)throw new Error("Bitstream is not byte-aligned.");const t=this.pos/8,r=this.bytes[t]??0;return this.pos+=8,r}skipBits(t){this.pos+=t}getBitsLeft(){return this.bytes.length*8-this.pos}clone(){const t=new Bn(this.bytes);return t.pos=this.pos,t}}const G0=(e,t,r,n)=>{for(let i=t;i<r;i++){const s=Math.floor(i/8);let o=e[s];const a=7-(i&7);o&=~(1<<a),o|=(n&1<<r-i-1)>>r-i-1<<a,e[s]=o}},Yr=e=>e.constructor===Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),fr=e=>e.constructor===DataView?e:ArrayBuffer.isView(e)?new DataView(e.buffer,e.byteOffset,e.byteLength):new DataView(e),Ts=new TextEncoder,xh={bt709:1,bt470bg:5,smpte170m:6,bt2020:9,smpte432:12},kh={bt709:1,smpte170m:6,linear:8,"iec61966-2-1":13,pq:16,hlg:18},bh={rgb:0,bt709:1,bt470bg:5,smpte170m:6,"bt2020-ncl":9},X0=e=>!!e&&!!e.primaries&&!!e.transfer&&!!e.matrix&&e.fullRange!==void 0,yo=e=>e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer||ArrayBuffer.isView(e);class Ch{constructor(){this.currentPromise=Promise.resolve(),this.pending=0}async acquire(){let t;const r=new Promise(i=>{let s=!1;t=()=>{s||(i(),this.pending--,s=!0)}}),n=this.currentPromise;return this.currentPromise=r,this.pending++,await n,t}}const Eh=()=>{let e,t;return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}},wo=e=>{throw new Error(`Unexpected value: ${e}`)},Sh=(e,t,r,n)=>{r=r>>>0,r=r&16777215,n?(e.setUint8(t,r&255),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,r>>>16&255)):(e.setUint8(t,r>>>16&255),e.setUint8(t+1,r>>>8&255),e.setUint8(t+2,r&255))},K0=(e,t,r,n)=>{r=qe(r,-8388608,8388607),r<0&&(r=r+16777216&16777215),Sh(e,t,r,n)},qe=(e,t,r)=>Math.max(t,Math.min(r,e)),Y0="und",Rc=(e,t)=>Math.round(e/t)*t,q0=/^[a-z]{3}$/,Z0=e=>q0.test(e),hr=1e6*(1+Number.EPSILON);class Th{constructor(){this.currentPromise=Promise.resolve()}call(t){return this.currentPromise=this.currentPromise.then(t)}}let ia=null;const J0=()=>{var e;return ia!==null?ia:ia=!!(typeof navigator<"u"&&((e=navigator.vendor)!=null&&e.match(/apple/i)||/AppleWebKit/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)||/\b(iPad|iPhone|iPod)\b/.test(navigator.userAgent)))};let sa=null;const qs=()=>{var e;return sa!==null?sa:sa=typeof navigator<"u"&&((e=navigator.userAgent)==null?void 0:e.includes("Firefox"))},eg=function*(e){for(const t in e){const r=e[t];r!==void 0&&(yield{key:t,value:r})}},tg=e=>{switch(e.toLowerCase()){case"image/jpeg":case"image/jpg":return".jpg";case"image/png":return".png";case"image/gif":return".gif";case"image/webp":return".webp";case"image/bmp":return".bmp";case"image/svg+xml":return".svg";case"image/tiff":return".tiff";case"image/avif":return".avif";case"image/x-icon":case"image/vnd.microsoft.icon":return".ico";default:return null}},rg=(e,t)=>{if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},ng=()=>{Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose"))};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class ig{constructor(t,r){if(this.data=t,this.mimeType=r,!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(typeof r!="string")throw new TypeError("mimeType must be a string.")}}class _h{constructor(t,r,n,i){if(this.data=t,this.mimeType=r,this.name=n,this.description=i,!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(r!==void 0&&typeof r!="string")throw new TypeError("mimeType, when provided, must be a string.");if(n!==void 0&&typeof n!="string")throw new TypeError("name, when provided, must be a string.");if(i!==void 0&&typeof i!="string")throw new TypeError("description, when provided, must be a string.")}}const sg=e=>{if(!e||typeof e!="object")throw new TypeError("tags must be an object.");if(e.title!==void 0&&typeof e.title!="string")throw new TypeError("tags.title, when provided, must be a string.");if(e.description!==void 0&&typeof e.description!="string")throw new TypeError("tags.description, when provided, must be a string.");if(e.artist!==void 0&&typeof e.artist!="string")throw new TypeError("tags.artist, when provided, must be a string.");if(e.album!==void 0&&typeof e.album!="string")throw new TypeError("tags.album, when provided, must be a string.");if(e.albumArtist!==void 0&&typeof e.albumArtist!="string")throw new TypeError("tags.albumArtist, when provided, must be a string.");if(e.trackNumber!==void 0&&(!Number.isInteger(e.trackNumber)||e.trackNumber<=0))throw new TypeError("tags.trackNumber, when provided, must be a positive integer.");if(e.tracksTotal!==void 0&&(!Number.isInteger(e.tracksTotal)||e.tracksTotal<=0))throw new TypeError("tags.tracksTotal, when provided, must be a positive integer.");if(e.discNumber!==void 0&&(!Number.isInteger(e.discNumber)||e.discNumber<=0))throw new TypeError("tags.discNumber, when provided, must be a positive integer.");if(e.discsTotal!==void 0&&(!Number.isInteger(e.discsTotal)||e.discsTotal<=0))throw new TypeError("tags.discsTotal, when provided, must be a positive integer.");if(e.genre!==void 0&&typeof e.genre!="string")throw new TypeError("tags.genre, when provided, must be a string.");if(e.date!==void 0&&(!(e.date instanceof Date)||Number.isNaN(e.date.getTime())))throw new TypeError("tags.date, when provided, must be a valid Date.");if(e.lyrics!==void 0&&typeof e.lyrics!="string")throw new TypeError("tags.lyrics, when provided, must be a string.");if(e.images!==void 0){if(!Array.isArray(e.images))throw new TypeError("tags.images, when provided, must be an array.");for(const t of e.images){if(!t||typeof t!="object")throw new TypeError("Each image in tags.images must be an object.");if(!(t.data instanceof Uint8Array))throw new TypeError("Each image.data must be a Uint8Array.");if(typeof t.mimeType!="string")throw new TypeError("Each image.mimeType must be a string.");if(!["coverFront","coverBack","unknown"].includes(t.kind))throw new TypeError("Each image.kind must be 'coverFront', 'coverBack', or 'unknown'.")}}if(e.comment!==void 0&&typeof e.comment!="string")throw new TypeError("tags.comment, when provided, must be a string.");if(e.raw!==void 0){if(!e.raw||typeof e.raw!="object")throw new TypeError("tags.raw, when provided, must be an object.");for(const t of Object.values(e.raw))if(t!==null&&typeof t!="string"&&!(t instanceof Uint8Array)&&!(t instanceof ig)&&!(t instanceof _h))throw new TypeError("Each value in tags.raw must be a string, Uint8Array, RichImageData, AttachedFile, or null.")}},og=e=>{if(!e||typeof e!="object")throw new TypeError("disposition must be an object.");if(e.default!==void 0&&typeof e.default!="boolean")throw new TypeError("disposition.default must be a boolean.");if(e.forced!==void 0&&typeof e.forced!="boolean")throw new TypeError("disposition.forced must be a boolean.");if(e.original!==void 0&&typeof e.original!="boolean")throw new TypeError("disposition.original must be a boolean.");if(e.commentary!==void 0&&typeof e.commentary!="boolean")throw new TypeError("disposition.commentary must be a boolean.");if(e.hearingImpaired!==void 0&&typeof e.hearingImpaired!="boolean")throw new TypeError("disposition.hearingImpaired must be a boolean.");if(e.visuallyImpaired!==void 0&&typeof e.visuallyImpaired!="boolean")throw new TypeError("disposition.visuallyImpaired must be a boolean.")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const _r=["avc","hevc","vp9","av1","vp8"],jt=["pcm-s16","pcm-s16be","pcm-s24","pcm-s24be","pcm-s32","pcm-s32be","pcm-f32","pcm-f32be","pcm-f64","pcm-f64be","pcm-u8","pcm-s8","ulaw","alaw"],Nh=["aac","opus","mp3","vorbis","flac","ac3","eac3"],nn=[...Nh,...jt],zi=["webvtt"],Ac=[{maxMacroblocks:99,maxBitrate:64e3,maxDpbMbs:396,level:10},{maxMacroblocks:396,maxBitrate:192e3,maxDpbMbs:900,level:11},{maxMacroblocks:396,maxBitrate:384e3,maxDpbMbs:2376,level:12},{maxMacroblocks:396,maxBitrate:768e3,maxDpbMbs:2376,level:13},{maxMacroblocks:396,maxBitrate:2e6,maxDpbMbs:2376,level:20},{maxMacroblocks:792,maxBitrate:4e6,maxDpbMbs:4752,level:21},{maxMacroblocks:1620,maxBitrate:4e6,maxDpbMbs:8100,level:22},{maxMacroblocks:1620,maxBitrate:1e7,maxDpbMbs:8100,level:30},{maxMacroblocks:3600,maxBitrate:14e6,maxDpbMbs:18e3,level:31},{maxMacroblocks:5120,maxBitrate:2e7,maxDpbMbs:20480,level:32},{maxMacroblocks:8192,maxBitrate:2e7,maxDpbMbs:32768,level:40},{maxMacroblocks:8192,maxBitrate:5e7,maxDpbMbs:32768,level:41},{maxMacroblocks:8704,maxBitrate:5e7,maxDpbMbs:34816,level:42},{maxMacroblocks:22080,maxBitrate:135e6,maxDpbMbs:110400,level:50},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:51},{maxMacroblocks:36864,maxBitrate:24e7,maxDpbMbs:184320,level:52},{maxMacroblocks:139264,maxBitrate:24e7,maxDpbMbs:696320,level:60},{maxMacroblocks:139264,maxBitrate:48e7,maxDpbMbs:696320,level:61},{maxMacroblocks:139264,maxBitrate:8e8,maxDpbMbs:696320,level:62}],jc=[{maxPictureSize:36864,maxBitrate:128e3,tier:"L",level:30},{maxPictureSize:122880,maxBitrate:15e5,tier:"L",level:60},{maxPictureSize:245760,maxBitrate:3e6,tier:"L",level:63},{maxPictureSize:552960,maxBitrate:6e6,tier:"L",level:90},{maxPictureSize:983040,maxBitrate:1e7,tier:"L",level:93},{maxPictureSize:2228224,maxBitrate:12e6,tier:"L",level:120},{maxPictureSize:2228224,maxBitrate:3e7,tier:"H",level:120},{maxPictureSize:2228224,maxBitrate:2e7,tier:"L",level:123},{maxPictureSize:2228224,maxBitrate:5e7,tier:"H",level:123},{maxPictureSize:8912896,maxBitrate:25e6,tier:"L",level:150},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:150},{maxPictureSize:8912896,maxBitrate:4e7,tier:"L",level:153},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:153},{maxPictureSize:8912896,maxBitrate:6e7,tier:"L",level:156},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:156},{maxPictureSize:35651584,maxBitrate:6e7,tier:"L",level:180},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:180},{maxPictureSize:35651584,maxBitrate:12e7,tier:"L",level:183},{maxPictureSize:35651584,maxBitrate:48e7,tier:"H",level:183},{maxPictureSize:35651584,maxBitrate:24e7,tier:"L",level:186},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:186}],Dc=[{maxPictureSize:36864,maxBitrate:2e5,level:10},{maxPictureSize:73728,maxBitrate:8e5,level:11},{maxPictureSize:122880,maxBitrate:18e5,level:20},{maxPictureSize:245760,maxBitrate:36e5,level:21},{maxPictureSize:552960,maxBitrate:72e5,level:30},{maxPictureSize:983040,maxBitrate:12e6,level:31},{maxPictureSize:2228224,maxBitrate:18e6,level:40},{maxPictureSize:2228224,maxBitrate:3e7,level:41},{maxPictureSize:8912896,maxBitrate:6e7,level:50},{maxPictureSize:8912896,maxBitrate:12e7,level:51},{maxPictureSize:8912896,maxBitrate:18e7,level:52},{maxPictureSize:35651584,maxBitrate:18e7,level:60},{maxPictureSize:35651584,maxBitrate:24e7,level:61},{maxPictureSize:35651584,maxBitrate:48e7,level:62}],Ic=[{maxPictureSize:147456,maxBitrate:15e5,tier:"M",level:0},{maxPictureSize:278784,maxBitrate:3e6,tier:"M",level:1},{maxPictureSize:665856,maxBitrate:6e6,tier:"M",level:4},{maxPictureSize:1065024,maxBitrate:1e7,tier:"M",level:5},{maxPictureSize:2359296,maxBitrate:12e6,tier:"M",level:8},{maxPictureSize:2359296,maxBitrate:3e7,tier:"H",level:8},{maxPictureSize:2359296,maxBitrate:2e7,tier:"M",level:9},{maxPictureSize:2359296,maxBitrate:5e7,tier:"H",level:9},{maxPictureSize:8912896,maxBitrate:3e7,tier:"M",level:12},{maxPictureSize:8912896,maxBitrate:1e8,tier:"H",level:12},{maxPictureSize:8912896,maxBitrate:4e7,tier:"M",level:13},{maxPictureSize:8912896,maxBitrate:16e7,tier:"H",level:13},{maxPictureSize:8912896,maxBitrate:6e7,tier:"M",level:14},{maxPictureSize:8912896,maxBitrate:24e7,tier:"H",level:14},{maxPictureSize:35651584,maxBitrate:6e7,tier:"M",level:15},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:15},{maxPictureSize:35651584,maxBitrate:6e7,tier:"M",level:16},{maxPictureSize:35651584,maxBitrate:24e7,tier:"H",level:16},{maxPictureSize:35651584,maxBitrate:1e8,tier:"M",level:17},{maxPictureSize:35651584,maxBitrate:48e7,tier:"H",level:17},{maxPictureSize:35651584,maxBitrate:16e7,tier:"M",level:18},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:18},{maxPictureSize:35651584,maxBitrate:16e7,tier:"M",level:19},{maxPictureSize:35651584,maxBitrate:8e8,tier:"H",level:19}],ag=(e,t,r,n)=>{if(e==="avc"){const s=Math.ceil(t/16)*Math.ceil(r/16),o=Ac.find(f=>s<=f.maxMacroblocks&&n<=f.maxBitrate)??ui(Ac),a=o?o.level:0,l="64".padStart(2,"0"),c="00",d=a.toString(16).padStart(2,"0");return`avc1.${l}${c}${d}`}else if(e==="hevc"){const i="",o="6",a=t*r,l=jc.find(d=>a<=d.maxPictureSize&&n<=d.maxBitrate)??ui(jc);return`hev1.${i}1.${o}.${l.tier}${l.level}.B0`}else{if(e==="vp8")return"vp8";if(e==="vp9"){const i="00",s=t*r,o=Dc.find(l=>s<=l.maxPictureSize&&n<=l.maxBitrate)??ui(Dc);return`vp09.${i}.${o.level.toString().padStart(2,"0")}.08`}else if(e==="av1"){const s=t*r,o=Ic.find(c=>s<=c.maxPictureSize&&n<=c.maxBitrate)??ui(Ic);return`av01.0.${o.level.toString().padStart(2,"0")}${o.tier}.08`}}throw new TypeError(`Unhandled codec '${e}'.`)},lg=e=>{const t=e.split("."),r=Number(t[1]),n=Number(t[2]),i=Number(t[3]),s=t[4]?Number(t[4]):1;return[1,1,r,2,1,n,3,1,i,4,1,s]},ug=e=>{const t=e.split("."),i=(1<<7)+1,s=Number(t[1]),o=t[2],a=Number(o.slice(0,-1)),l=(s<<5)+a,c=o.slice(-1)==="H"?1:0,f=Number(t[3])===8?0:1,y=0,b=t[4]?Number(t[4]):0,k=t[5]?Number(t[5][0]):1,v=t[5]?Number(t[5][1]):1,E=t[5]?Number(t[5][2]):0,m=(c<<7)+(f<<6)+(y<<5)+(b<<4)+(k<<3)+(v<<2)+E;return[i,l,m,0]},cg=(e,t,r)=>{if(e==="aac")return t>=2&&r<=24e3?"mp4a.40.29":r<=24e3?"mp4a.40.5":"mp4a.40.2";if(e==="mp3")return"mp3";if(e==="opus")return"opus";if(e==="vorbis")return"vorbis";if(e==="flac")return"flac";if(e==="ac3")return"ac-3";if(e==="eac3")return"ec-3";if(jt.includes(e))return e;throw new TypeError(`Unhandled codec '${e}'.`)},Zs=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],du=[-1,1,2,3,4,5,6,8],dg=e=>{if(!e||e.byteLength<2)throw new TypeError("AAC description must be at least 2 bytes long.");const t=new Bn(e);let r=t.readBits(5);r===31&&(r=32+t.readBits(6));const n=t.readBits(4);let i=null;n===15?i=t.readBits(24):n<Zs.length&&(i=Zs[n]);const s=t.readBits(4);let o=null;return s>=1&&s<=7&&(o=du[s]),{objectType:r,frequencyIndex:n,sampleRate:i,channelConfiguration:s,numberOfChannels:o}},Ph=e=>{let t=Zs.indexOf(e.sampleRate),r=null;t===-1&&(t=15,r=e.sampleRate);const n=du.indexOf(e.numberOfChannels);if(n===-1)throw new TypeError(`Unsupported number of channels: ${e.numberOfChannels}`);let i=13;e.objectType>=32&&(i+=6),t===15&&(i+=24);const s=Math.ceil(i/8),o=new Uint8Array(s),a=new Bn(o);return e.objectType<32?a.writeBits(5,e.objectType):(a.writeBits(5,31),a.writeBits(6,e.objectType-32)),a.writeBits(4,t),t===15&&a.writeBits(24,r),a.writeBits(4,n),o},fg=48e3,Rh=/^pcm-([usf])(\d+)+(be)?$/,Ah=e=>{if(G(jt.includes(e)),e==="ulaw")return{dataType:"ulaw",sampleSize:1,littleEndian:!0,silentValue:255};if(e==="alaw")return{dataType:"alaw",sampleSize:1,littleEndian:!0,silentValue:213};const t=Rh.exec(e);G(t);let r;t[1]==="u"?r="unsigned":t[1]==="s"?r="signed":r="float";const n=Number(t[2])/8,i=t[3]!=="be",s=e==="pcm-u8"?2**7:0;return{dataType:r,sampleSize:n,littleEndian:i,silentValue:s}},jh=e=>e.startsWith("avc1")||e.startsWith("avc3")?"avc":e.startsWith("hev1")||e.startsWith("hvc1")?"hevc":e==="vp8"?"vp8":e.startsWith("vp09")?"vp9":e.startsWith("av01")?"av1":e.startsWith("mp4a.40")||e==="mp4a.67"?"aac":e==="mp3"||e==="mp4a.69"||e==="mp4a.6B"||e==="mp4a.6b"?"mp3":e==="opus"?"opus":e==="vorbis"?"vorbis":e==="flac"?"flac":e==="ac-3"||e==="ac3"?"ac3":e==="ec-3"||e==="eac3"?"eac3":e==="ulaw"?"ulaw":e==="alaw"?"alaw":Rh.test(e)?e:e==="webvtt"?"webvtt":null,hg=e=>e==="avc"?{avc:{format:"avc"}}:e==="hevc"?{hevc:{format:"hevc"}}:{},mg=e=>e==="aac"?{aac:{format:"aac"}}:e==="opus"?{opus:{format:"opus"}}:{},pg=["avc1","avc3","hev1","hvc1","vp8","vp09","av01"],gg=/^(avc1|avc3)\.[0-9a-fA-F]{6}$/,yg=/^(hev1|hvc1)\.(?:[ABC]?\d+)\.[0-9a-fA-F]{1,8}\.[LH]\d+(?:\.[0-9a-fA-F]{1,2}){0,6}$/,wg=/^vp09(?:\.\d{2}){3}(?:(?:\.\d{2}){5})?$/,vg=/^av01\.\d\.\d{2}[MH]\.\d{2}(?:\.\d\.\d{3}\.\d{2}\.\d{2}\.\d{2}\.\d)?$/,xg=e=>{if(!e)throw new TypeError("Video chunk metadata must be provided.");if(typeof e!="object")throw new TypeError("Video chunk metadata must be an object.");if(!e.decoderConfig)throw new TypeError("Video chunk metadata must include a decoder configuration.");if(typeof e.decoderConfig!="object")throw new TypeError("Video chunk metadata decoder configuration must be an object.");if(typeof e.decoderConfig.codec!="string")throw new TypeError("Video chunk metadata decoder configuration must specify a codec string.");if(!pg.some(t=>e.decoderConfig.codec.startsWith(t)))throw new TypeError("Video chunk metadata decoder configuration codec string must be a valid video codec string as specified in the Mediabunny Codec Registry.");if(!Number.isInteger(e.decoderConfig.codedWidth)||e.decoderConfig.codedWidth<=0)throw new TypeError("Video chunk metadata decoder configuration must specify a valid codedWidth (positive integer).");if(!Number.isInteger(e.decoderConfig.codedHeight)||e.decoderConfig.codedHeight<=0)throw new TypeError("Video chunk metadata decoder configuration must specify a valid codedHeight (positive integer).");if(e.decoderConfig.description!==void 0&&!yo(e.decoderConfig.description))throw new TypeError("Video chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(e.decoderConfig.colorSpace!==void 0){const{colorSpace:t}=e.decoderConfig;if(typeof t!="object")throw new TypeError("Video chunk metadata decoder configuration colorSpace, when provided, must be an object.");const r=Object.keys(xh);if(t.primaries!=null&&!r.includes(t.primaries))throw new TypeError(`Video chunk metadata decoder configuration colorSpace primaries, when defined, must be one of ${r.join(", ")}.`);const n=Object.keys(kh);if(t.transfer!=null&&!n.includes(t.transfer))throw new TypeError(`Video chunk metadata decoder configuration colorSpace transfer, when defined, must be one of ${n.join(", ")}.`);const i=Object.keys(bh);if(t.matrix!=null&&!i.includes(t.matrix))throw new TypeError(`Video chunk metadata decoder configuration colorSpace matrix, when defined, must be one of ${i.join(", ")}.`);if(t.fullRange!=null&&typeof t.fullRange!="boolean")throw new TypeError("Video chunk metadata decoder configuration colorSpace fullRange, when defined, must be a boolean.")}if(e.decoderConfig.codec.startsWith("avc1")||e.decoderConfig.codec.startsWith("avc3")){if(!gg.test(e.decoderConfig.codec))throw new TypeError("Video chunk metadata decoder configuration codec string for AVC must be a valid AVC codec string as specified in Section 3.4 of RFC 6381.")}else if(e.decoderConfig.codec.startsWith("hev1")||e.decoderConfig.codec.startsWith("hvc1")){if(!yg.test(e.decoderConfig.codec))throw new TypeError("Video chunk metadata decoder configuration codec string for HEVC must be a valid HEVC codec string as specified in Section E.3 of ISO 14496-15.")}else if(e.decoderConfig.codec.startsWith("vp8")){if(e.decoderConfig.codec!=="vp8")throw new TypeError('Video chunk metadata decoder configuration codec string for VP8 must be "vp8".')}else if(e.decoderConfig.codec.startsWith("vp09")){if(!wg.test(e.decoderConfig.codec))throw new TypeError('Video chunk metadata decoder configuration codec string for VP9 must be a valid VP9 codec string as specified in Section "Codecs Parameter String" of https://www.webmproject.org/vp9/mp4/.')}else if(e.decoderConfig.codec.startsWith("av01")&&!vg.test(e.decoderConfig.codec))throw new TypeError('Video chunk metadata decoder configuration codec string for AV1 must be a valid AV1 codec string as specified in Section "Codecs Parameter String" of https://aomediacodec.github.io/av1-isobmff/.')},kg=["mp4a","mp3","opus","vorbis","flac","ulaw","alaw","pcm","ac-3","ec-3"],bg=e=>{if(!e)throw new TypeError("Audio chunk metadata must be provided.");if(typeof e!="object")throw new TypeError("Audio chunk metadata must be an object.");if(!e.decoderConfig)throw new TypeError("Audio chunk metadata must include a decoder configuration.");if(typeof e.decoderConfig!="object")throw new TypeError("Audio chunk metadata decoder configuration must be an object.");if(typeof e.decoderConfig.codec!="string")throw new TypeError("Audio chunk metadata decoder configuration must specify a codec string.");if(!kg.some(t=>e.decoderConfig.codec.startsWith(t)))throw new TypeError("Audio chunk metadata decoder configuration codec string must be a valid audio codec string as specified in the Mediabunny Codec Registry.");if(!Number.isInteger(e.decoderConfig.sampleRate)||e.decoderConfig.sampleRate<=0)throw new TypeError("Audio chunk metadata decoder configuration must specify a valid sampleRate (positive integer).");if(!Number.isInteger(e.decoderConfig.numberOfChannels)||e.decoderConfig.numberOfChannels<=0)throw new TypeError("Audio chunk metadata decoder configuration must specify a valid numberOfChannels (positive integer).");if(e.decoderConfig.description!==void 0&&!yo(e.decoderConfig.description))throw new TypeError("Audio chunk metadata decoder configuration description, when defined, must be an ArrayBuffer or an ArrayBuffer view.");if(e.decoderConfig.codec.startsWith("mp4a")&&e.decoderConfig.codec!=="mp4a.69"&&e.decoderConfig.codec!=="mp4a.6B"&&e.decoderConfig.codec!=="mp4a.6b"){if(!["mp4a.40.2","mp4a.40.02","mp4a.40.5","mp4a.40.05","mp4a.40.29","mp4a.67"].includes(e.decoderConfig.codec))throw new TypeError("Audio chunk metadata decoder configuration codec string for AAC must be a valid AAC codec string as specified in https://www.w3.org/TR/webcodecs-aac-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("mp3")||e.decoderConfig.codec.startsWith("mp4a")){if(e.decoderConfig.codec!=="mp3"&&e.decoderConfig.codec!=="mp4a.69"&&e.decoderConfig.codec!=="mp4a.6B"&&e.decoderConfig.codec!=="mp4a.6b")throw new TypeError('Audio chunk metadata decoder configuration codec string for MP3 must be "mp3", "mp4a.69" or "mp4a.6B".')}else if(e.decoderConfig.codec.startsWith("opus")){if(e.decoderConfig.codec!=="opus")throw new TypeError('Audio chunk metadata decoder configuration codec string for Opus must be "opus".');if(e.decoderConfig.description&&e.decoderConfig.description.byteLength<18)throw new TypeError("Audio chunk metadata decoder configuration description, when specified, is expected to be an Identification Header as specified in Section 5.1 of RFC 7845.")}else if(e.decoderConfig.codec.startsWith("vorbis")){if(e.decoderConfig.codec!=="vorbis")throw new TypeError('Audio chunk metadata decoder configuration codec string for Vorbis must be "vorbis".');if(!e.decoderConfig.description)throw new TypeError("Audio chunk metadata decoder configuration for Vorbis must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-vorbis-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("flac")){if(e.decoderConfig.codec!=="flac")throw new TypeError('Audio chunk metadata decoder configuration codec string for FLAC must be "flac".');if(!e.decoderConfig.description||e.decoderConfig.description.byteLength<42)throw new TypeError("Audio chunk metadata decoder configuration for FLAC must include a description, which is expected to adhere to the format described in https://www.w3.org/TR/webcodecs-flac-codec-registration/.")}else if(e.decoderConfig.codec.startsWith("ac-3")||e.decoderConfig.codec.startsWith("ac3")){if(e.decoderConfig.codec!=="ac-3")throw new TypeError('Audio chunk metadata decoder configuration codec string for AC-3 must be "ac-3".')}else if(e.decoderConfig.codec.startsWith("ec-3")||e.decoderConfig.codec.startsWith("eac3")){if(e.decoderConfig.codec!=="ec-3")throw new TypeError('Audio chunk metadata decoder configuration codec string for EC-3 must be "ec-3".')}else if((e.decoderConfig.codec.startsWith("pcm")||e.decoderConfig.codec.startsWith("ulaw")||e.decoderConfig.codec.startsWith("alaw"))&&!jt.includes(e.decoderConfig.codec))throw new TypeError(`Audio chunk metadata decoder configuration codec string for PCM must be one of the supported PCM codecs (${jt.join(", ")}).`)},Cg=e=>{if(!e)throw new TypeError("Subtitle metadata must be provided.");if(typeof e!="object")throw new TypeError("Subtitle metadata must be an object.");if(!e.config)throw new TypeError("Subtitle metadata must include a config object.");if(typeof e.config!="object")throw new TypeError("Subtitle metadata config must be an object.");if(typeof e.config.description!="string")throw new TypeError("Subtitle metadata config description must be a string.")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */var Oc;(function(e){e[e.NON_IDR_SLICE=1]="NON_IDR_SLICE",e[e.SLICE_DPA=2]="SLICE_DPA",e[e.SLICE_DPB=3]="SLICE_DPB",e[e.SLICE_DPC=4]="SLICE_DPC",e[e.IDR=5]="IDR",e[e.SEI=6]="SEI",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.AUD=9]="AUD",e[e.SPS_EXT=13]="SPS_EXT"})(Oc||(Oc={}));var Mc;(function(e){e[e.RASL_N=8]="RASL_N",e[e.RASL_R=9]="RASL_R",e[e.BLA_W_LP=16]="BLA_W_LP",e[e.RSV_IRAP_VCL23=23]="RSV_IRAP_VCL23",e[e.VPS_NUT=32]="VPS_NUT",e[e.SPS_NUT=33]="SPS_NUT",e[e.PPS_NUT=34]="PPS_NUT",e[e.AUD_NUT=35]="AUD_NUT",e[e.PREFIX_SEI_NUT=39]="PREFIX_SEI_NUT",e[e.SUFFIX_SEI_NUT=40]="SUFFIX_SEI_NUT"})(Mc||(Mc={}));const Eg=e=>{const t=fr(e),r=t.getUint8(9),n=t.getUint16(10,!0),i=t.getUint32(12,!0),s=t.getInt16(16,!0),o=t.getUint8(18);let a=null;return o&&(a=e.subarray(19,21+r)),{outputChannelCount:r,preSkip:n,inputSampleRate:i,outputGain:s,channelMappingFamily:o,channelMappingTable:a}};var Fc;(function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.PICTURE=6]="PICTURE"})(Fc||(Fc={}));/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const ll=[],ul=[];/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const zc=new Uint8Array(0);class Er{constructor(t,r,n,i,s=-1,o,a){if(this.data=t,this.type=r,this.timestamp=n,this.duration=i,this.sequenceNumber=s,t===zc&&o===void 0)throw new Error("Internal error: byteLength must be explicitly provided when constructing metadata-only packets.");if(o===void 0&&(o=t.byteLength),!(t instanceof Uint8Array))throw new TypeError("data must be a Uint8Array.");if(r!=="key"&&r!=="delta")throw new TypeError('type must be either "key" or "delta".');if(!Number.isFinite(n))throw new TypeError("timestamp must be a number.");if(!Number.isFinite(i)||i<0)throw new TypeError("duration must be a non-negative number.");if(!Number.isFinite(s))throw new TypeError("sequenceNumber must be a number.");if(!Number.isInteger(o)||o<0)throw new TypeError("byteLength must be a non-negative integer.");if(a!==void 0&&(typeof a!="object"||!a))throw new TypeError("sideData, when provided, must be an object.");if((a==null?void 0:a.alpha)!==void 0&&!(a.alpha instanceof Uint8Array))throw new TypeError("sideData.alpha, when provided, must be a Uint8Array.");if((a==null?void 0:a.alphaByteLength)!==void 0&&(!Number.isInteger(a.alphaByteLength)||a.alphaByteLength<0))throw new TypeError("sideData.alphaByteLength, when provided, must be a non-negative integer.");this.byteLength=o,this.sideData=a??{},this.sideData.alpha&&this.sideData.alphaByteLength===void 0&&(this.sideData.alphaByteLength=this.sideData.alpha.byteLength)}get isMetadataOnly(){return this.data===zc}get microsecondTimestamp(){return Math.trunc(hr*this.timestamp)}get microsecondDuration(){return Math.trunc(hr*this.duration)}toEncodedVideoChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if(typeof EncodedVideoChunk>"u")throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}alphaToEncodedVideoChunk(t=this.type){if(!this.sideData.alpha)throw new TypeError("This packet does not contain alpha side data.");if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to a video chunk.");if(typeof EncodedVideoChunk>"u")throw new Error("Your browser does not support EncodedVideoChunk.");return new EncodedVideoChunk({data:this.sideData.alpha,type:t,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}toEncodedAudioChunk(){if(this.isMetadataOnly)throw new TypeError("Metadata-only packets cannot be converted to an audio chunk.");if(typeof EncodedAudioChunk>"u")throw new Error("Your browser does not support EncodedAudioChunk.");return new EncodedAudioChunk({data:this.data,type:this.type,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration})}static fromEncodedChunk(t,r){if(!(t instanceof EncodedVideoChunk||t instanceof EncodedAudioChunk))throw new TypeError("chunk must be an EncodedVideoChunk or EncodedAudioChunk.");const n=new Uint8Array(t.byteLength);return t.copyTo(n),new Er(n,t.type,t.timestamp/1e6,(t.duration??0)/1e6,void 0,void 0,r)}clone(t){if(t!==void 0&&(typeof t!="object"||t===null))throw new TypeError("options, when provided, must be an object.");if((t==null?void 0:t.data)!==void 0&&!(t.data instanceof Uint8Array))throw new TypeError("options.data, when provided, must be a Uint8Array.");if((t==null?void 0:t.type)!==void 0&&t.type!=="key"&&t.type!=="delta")throw new TypeError('options.type, when provided, must be either "key" or "delta".');if((t==null?void 0:t.timestamp)!==void 0&&!Number.isFinite(t.timestamp))throw new TypeError("options.timestamp, when provided, must be a number.");if((t==null?void 0:t.duration)!==void 0&&!Number.isFinite(t.duration))throw new TypeError("options.duration, when provided, must be a number.");if((t==null?void 0:t.sequenceNumber)!==void 0&&!Number.isFinite(t.sequenceNumber))throw new TypeError("options.sequenceNumber, when provided, must be a number.");if((t==null?void 0:t.sideData)!==void 0&&(typeof t.sideData!="object"||t.sideData===null))throw new TypeError("options.sideData, when provided, must be an object.");return new Er((t==null?void 0:t.data)??this.data,(t==null?void 0:t.type)??this.type,(t==null?void 0:t.timestamp)??this.timestamp,(t==null?void 0:t.duration)??this.duration,(t==null?void 0:t.sequenceNumber)??this.sequenceNumber,this.byteLength,(t==null?void 0:t.sideData)??this.sideData)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Sg=e=>{let n=e,i=4096,s=0,o=12,a=0;for(n<0&&(n=-n,s=128),n+=33,n>8191&&(n=8191);(n&i)!==i&&o>=5;)i>>=1,o--;return a=n>>o-4&15,~(s|o-5<<4|a)&255},Tg=e=>{let r=2048,n=0,i=11,s=0,o=e;for(o<0&&(o=-o,n=128),o>4095&&(o=4095);(o&r)!==r&&i>=5;)r>>=1,i--;return s=o>>(i===4?1:i-4)&15,(n|i-4<<4|s)^85};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */ng();let Vc=-1/0,Uc=-1/0,at=null;typeof FinalizationRegistry<"u"&&(at=new FinalizationRegistry(e=>{const t=Date.now();e.type==="video"?(t-Vc>=1e3&&(console.error("A VideoSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your VideoSamples as soon as you're done using them."),Vc=t),typeof VideoFrame<"u"&&e.data instanceof VideoFrame&&e.data.close()):(t-Uc>=1e3&&(console.error("An AudioSample was garbage collected without first being closed. For proper resource management, make sure to call close() on all your AudioSamples as soon as you're done using them."),Uc=t),typeof AudioData<"u"&&e.data instanceof AudioData&&e.data.close())}));const Dh=["I420","I420P10","I420P12","I420A","I420AP10","I420AP12","I422","I422P10","I422P12","I422A","I422AP10","I422AP12","I444","I444P10","I444P12","I444A","I444AP10","I444AP12","NV12","RGBA","RGBX","BGRA","BGRX"],_g=new Set(Dh);class Hr{get displayWidth(){return this.rotation%180===0?this.codedWidth:this.codedHeight}get displayHeight(){return this.rotation%180===0?this.codedHeight:this.codedWidth}get microsecondTimestamp(){return Math.trunc(hr*this.timestamp)}get microsecondDuration(){return Math.trunc(hr*this.duration)}get hasAlpha(){return this.format&&this.format.includes("A")}constructor(t,r){if(this._closed=!1,t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer||ArrayBuffer.isView(t)){if(!r||typeof r!="object")throw new TypeError("init must be an object.");if(r.format===void 0||!_g.has(r.format))throw new TypeError("init.format must be one of: "+Dh.join(", "));if(!Number.isInteger(r.codedWidth)||r.codedWidth<=0)throw new TypeError("init.codedWidth must be a positive integer.");if(!Number.isInteger(r.codedHeight)||r.codedHeight<=0)throw new TypeError("init.codedHeight must be a positive integer.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(r.timestamp))throw new TypeError("init.timestamp must be a number.");if(r.duration!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");this._data=Yr(t).slice(),this._layout=r.layout??Rg(r.format,r.codedWidth,r.codedHeight),this.format=r.format,this.codedWidth=r.codedWidth,this.codedHeight=r.codedHeight,this.rotation=r.rotation??0,this.timestamp=r.timestamp,this.duration=r.duration??0,this.colorSpace=new oa(r.colorSpace)}else if(typeof VideoFrame<"u"&&t instanceof VideoFrame){if((r==null?void 0:r.rotation)!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if((r==null?void 0:r.timestamp)!==void 0&&!Number.isFinite(r==null?void 0:r.timestamp))throw new TypeError("init.timestamp, when provided, must be a number.");if((r==null?void 0:r.duration)!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");this._data=t,this._layout=null,this.format=t.format,this.codedWidth=t.displayWidth,this.codedHeight=t.displayHeight,this.rotation=(r==null?void 0:r.rotation)??0,this.timestamp=(r==null?void 0:r.timestamp)??t.timestamp/1e6,this.duration=(r==null?void 0:r.duration)??(t.duration??0)/1e6,this.colorSpace=new oa(t.colorSpace)}else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof SVGImageElement<"u"&&t instanceof SVGImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){if(!r||typeof r!="object")throw new TypeError("init must be an object.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("init.rotation, when provided, must be 0, 90, 180, or 270.");if(!Number.isFinite(r.timestamp))throw new TypeError("init.timestamp must be a number.");if(r.duration!==void 0&&(!Number.isFinite(r.duration)||r.duration<0))throw new TypeError("init.duration, when provided, must be a non-negative number.");if(typeof VideoFrame<"u")return new Hr(new VideoFrame(t,{timestamp:Math.trunc(r.timestamp*hr),duration:Math.trunc((r.duration??0)*hr)||void 0}),r);let n=0,i=0;if("naturalWidth"in t?(n=t.naturalWidth,i=t.naturalHeight):"videoWidth"in t?(n=t.videoWidth,i=t.videoHeight):"width"in t&&(n=Number(t.width),i=Number(t.height)),!n||!i)throw new TypeError("Could not determine dimensions.");const s=new OffscreenCanvas(n,i),o=s.getContext("2d",{alpha:qs(),willReadFrequently:!0});G(o),o.drawImage(t,0,0),this._data=s,this._layout=null,this.format="RGBX",this.codedWidth=n,this.codedHeight=i,this.rotation=r.rotation??0,this.timestamp=r.timestamp,this.duration=r.duration??0,this.colorSpace=new oa({matrix:"rgb",primaries:"bt709",transfer:"iec61966-2-1",fullRange:!0})}else throw new TypeError("Invalid data type: Must be a BufferSource or CanvasImageSource.");at==null||at.register(this,{type:"video",data:this._data},this)}clone(){if(this._closed)throw new Error("VideoSample is closed.");return G(this._data!==null),zr(this._data)?new Hr(this._data.clone(),{timestamp:this.timestamp,duration:this.duration,rotation:this.rotation}):this._data instanceof Uint8Array?(G(this._layout),new Hr(this._data,{format:this.format,layout:this._layout,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})):new Hr(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.timestamp,duration:this.duration,colorSpace:this.colorSpace,rotation:this.rotation})}close(){this._closed||(at==null||at.unregister(this),zr(this._data)?this._data.close():this._data=null,this._closed=!0)}allocationSize(t={}){if(Lc(t),this._closed)throw new Error("VideoSample is closed.");if(this.format===null)throw new Error("Cannot get allocation size when format is null. Sorry!");if(G(this._data!==null),!zr(this._data)&&(t.colorSpace||t.format&&t.format!==this.format||t.layout||t.rect)){const r=this.toVideoFrame(),n=r.allocationSize(t);return r.close(),n}return zr(this._data)?this._data.allocationSize(t):this._data instanceof Uint8Array?this._data.byteLength:this.codedWidth*this.codedHeight*4}async copyTo(t,r={}){if(!yo(t))throw new TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(Lc(r),this._closed)throw new Error("VideoSample is closed.");if(this.format===null)throw new Error("Cannot copy video sample data when format is null. Sorry!");if(G(this._data!==null),!zr(this._data)&&(r.colorSpace||r.format&&r.format!==this.format||r.layout||r.rect)){const n=this.toVideoFrame(),i=await n.copyTo(t,r);return n.close(),i}if(zr(this._data))return this._data.copyTo(t,r);if(this._data instanceof Uint8Array)return G(this._layout),Yr(t).set(this._data),this._layout;{const i=this._data.getContext("2d");G(i);const s=i.getImageData(0,0,this.codedWidth,this.codedHeight);return Yr(t).set(s.data),[{offset:0,stride:4*this.codedWidth}]}}toVideoFrame(){if(this._closed)throw new Error("VideoSample is closed.");return G(this._data!==null),zr(this._data)?new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0}):this._data instanceof Uint8Array?new VideoFrame(this._data,{format:this.format,codedWidth:this.codedWidth,codedHeight:this.codedHeight,timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0,colorSpace:this.colorSpace}):new VideoFrame(this._data,{timestamp:this.microsecondTimestamp,duration:this.microsecondDuration||void 0})}draw(t,r,n,i,s,o,a,l,c){let d=0,f=0,y=this.displayWidth,b=this.displayHeight,k=0,v=0,E=this.displayWidth,m=this.displayHeight;if(o!==void 0?(d=r,f=n,y=i,b=s,k=o,v=a,l!==void 0?(E=l,m=c):(E=y,m=b)):(k=r,v=n,i!==void 0&&(E=i,m=s)),!(typeof CanvasRenderingContext2D<"u"&&t instanceof CanvasRenderingContext2D||typeof OffscreenCanvasRenderingContext2D<"u"&&t instanceof OffscreenCanvasRenderingContext2D))throw new TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!Number.isFinite(d))throw new TypeError("sx must be a number.");if(!Number.isFinite(f))throw new TypeError("sy must be a number.");if(!Number.isFinite(y)||y<0)throw new TypeError("sWidth must be a non-negative number.");if(!Number.isFinite(b)||b<0)throw new TypeError("sHeight must be a non-negative number.");if(!Number.isFinite(k))throw new TypeError("dx must be a number.");if(!Number.isFinite(v))throw new TypeError("dy must be a number.");if(!Number.isFinite(E)||E<0)throw new TypeError("dWidth must be a non-negative number.");if(!Number.isFinite(m)||m<0)throw new TypeError("dHeight must be a non-negative number.");if(this._closed)throw new Error("VideoSample is closed.");({sx:d,sy:f,sWidth:y,sHeight:b}=this._rotateSourceRegion(d,f,y,b,this.rotation));const h=this.toCanvasImageSource();t.save();const p=k+E/2,x=v+m/2;t.translate(p,x),t.rotate(this.rotation*Math.PI/180);const w=this.rotation%180===0?1:E/m;t.scale(1/w,w),t.drawImage(h,d,f,y,b,-E/2,-m/2,E,m),t.restore()}drawWithFit(t,r){var m,h,p,x;if(!(typeof CanvasRenderingContext2D<"u"&&t instanceof CanvasRenderingContext2D||typeof OffscreenCanvasRenderingContext2D<"u"&&t instanceof OffscreenCanvasRenderingContext2D))throw new TypeError("context must be a CanvasRenderingContext2D or OffscreenCanvasRenderingContext2D.");if(!r||typeof r!="object")throw new TypeError("options must be an object.");if(!["fill","contain","cover"].includes(r.fit))throw new TypeError("options.fit must be 'fill', 'contain', or 'cover'.");if(r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError("options.rotation, when provided, must be 0, 90, 180, or 270.");r.crop!==void 0&&Pg(r.crop,"options.");const n=t.canvas.width,i=t.canvas.height,s=r.rotation??this.rotation,[o,a]=s%180===0?[this.codedWidth,this.codedHeight]:[this.codedHeight,this.codedWidth];r.crop&&Ng(r.crop,o,a);let l,c,d,f;const{sx:y,sy:b,sWidth:k,sHeight:v}=this._rotateSourceRegion(((m=r.crop)==null?void 0:m.left)??0,((h=r.crop)==null?void 0:h.top)??0,((p=r.crop)==null?void 0:p.width)??o,((x=r.crop)==null?void 0:x.height)??a,s);if(r.fit==="fill")l=0,c=0,d=n,f=i;else{const[w,S]=r.crop?[r.crop.width,r.crop.height]:[o,a],T=r.fit==="contain"?Math.min(n/w,i/S):Math.max(n/w,i/S);d=w*T,f=S*T,l=(n-d)/2,c=(i-f)/2}t.save();const E=s%180===0?1:d/f;t.translate(n/2,i/2),t.rotate(s*Math.PI/180),t.scale(1/E,E),t.translate(-n/2,-i/2),t.drawImage(this.toCanvasImageSource(),y,b,k,v,l,c,d,f),t.restore()}_rotateSourceRegion(t,r,n,i,s){return s===90?[t,r,n,i]=[r,this.codedHeight-t-n,i,n]:s===180?[t,r]=[this.codedWidth-t-n,this.codedHeight-r-i]:s===270&&([t,r,n,i]=[this.codedWidth-r-i,t,i,n]),{sx:t,sy:r,sWidth:n,sHeight:i}}toCanvasImageSource(){if(this._closed)throw new Error("VideoSample is closed.");if(G(this._data!==null),this._data instanceof Uint8Array){const t=this.toVideoFrame();return queueMicrotask(()=>t.close()),t}else return this._data}setRotation(t){if(![0,90,180,270].includes(t))throw new TypeError("newRotation must be 0, 90, 180, or 270.");this.rotation=t}setTimestamp(t){if(!Number.isFinite(t))throw new TypeError("newTimestamp must be a number.");this.timestamp=t}setDuration(t){if(!Number.isFinite(t)||t<0)throw new TypeError("newDuration must be a non-negative number.");this.duration=t}[Symbol.dispose](){this.close()}}class oa{constructor(t){this.primaries=(t==null?void 0:t.primaries)??null,this.transfer=(t==null?void 0:t.transfer)??null,this.matrix=(t==null?void 0:t.matrix)??null,this.fullRange=(t==null?void 0:t.fullRange)??null}toJSON(){return{primaries:this.primaries,transfer:this.transfer,matrix:this.matrix,fullRange:this.fullRange}}}const zr=e=>typeof VideoFrame<"u"&&e instanceof VideoFrame,Ng=(e,t,r)=>{e.left=Math.min(e.left,t),e.top=Math.min(e.top,r),e.width=Math.min(e.width,t-e.left),e.height=Math.min(e.height,r-e.top),G(e.width>=0),G(e.height>=0)},Pg=(e,t)=>{if(!e||typeof e!="object")throw new TypeError(t+"crop, when provided, must be an object.");if(!Number.isInteger(e.left)||e.left<0)throw new TypeError(t+"crop.left must be a non-negative integer.");if(!Number.isInteger(e.top)||e.top<0)throw new TypeError(t+"crop.top must be a non-negative integer.");if(!Number.isInteger(e.width)||e.width<0)throw new TypeError(t+"crop.width must be a non-negative integer.");if(!Number.isInteger(e.height)||e.height<0)throw new TypeError(t+"crop.height must be a non-negative integer.")},Lc=e=>{if(!e||typeof e!="object")throw new TypeError("options must be an object.");if(e.colorSpace!==void 0&&!["display-p3","srgb"].includes(e.colorSpace))throw new TypeError("options.colorSpace, when provided, must be 'display-p3' or 'srgb'.");if(e.format!==void 0&&typeof e.format!="string")throw new TypeError("options.format, when provided, must be a string.");if(e.layout!==void 0){if(!Array.isArray(e.layout))throw new TypeError("options.layout, when provided, must be an array.");for(const t of e.layout){if(!t||typeof t!="object")throw new TypeError("Each entry in options.layout must be an object.");if(!Number.isInteger(t.offset)||t.offset<0)throw new TypeError("plane.offset must be a non-negative integer.");if(!Number.isInteger(t.stride)||t.stride<0)throw new TypeError("plane.stride must be a non-negative integer.")}}if(e.rect!==void 0){if(!e.rect||typeof e.rect!="object")throw new TypeError("options.rect, when provided, must be an object.");if(e.rect.x!==void 0&&(!Number.isInteger(e.rect.x)||e.rect.x<0))throw new TypeError("options.rect.x, when provided, must be a non-negative integer.");if(e.rect.y!==void 0&&(!Number.isInteger(e.rect.y)||e.rect.y<0))throw new TypeError("options.rect.y, when provided, must be a non-negative integer.");if(e.rect.width!==void 0&&(!Number.isInteger(e.rect.width)||e.rect.width<0))throw new TypeError("options.rect.width, when provided, must be a non-negative integer.");if(e.rect.height!==void 0&&(!Number.isInteger(e.rect.height)||e.rect.height<0))throw new TypeError("options.rect.height, when provided, must be a non-negative integer.")}},Rg=(e,t,r)=>{const n=Ag(e),i=[];let s=0;for(const o of n){const a=Math.ceil(t/o.widthDivisor),l=Math.ceil(r/o.heightDivisor),c=a*o.sampleBytes,d=c*l;i.push({offset:s,stride:c}),s+=d}return i},Ag=e=>{const t=(r,n,i,s,o)=>{const a=[{sampleBytes:r,widthDivisor:1,heightDivisor:1},{sampleBytes:n,widthDivisor:i,heightDivisor:s},{sampleBytes:n,widthDivisor:i,heightDivisor:s}];return o&&a.push({sampleBytes:r,widthDivisor:1,heightDivisor:1}),a};switch(e){case"I420":return t(1,1,2,2,!1);case"I420P10":case"I420P12":return t(2,2,2,2,!1);case"I420A":return t(1,1,2,2,!0);case"I420AP10":case"I420AP12":return t(2,2,2,2,!0);case"I422":return t(1,1,2,1,!1);case"I422P10":case"I422P12":return t(2,2,2,1,!1);case"I422A":return t(1,1,2,1,!0);case"I422AP10":case"I422AP12":return t(2,2,2,1,!0);case"I444":return t(1,1,1,1,!1);case"I444P10":case"I444P12":return t(2,2,1,1,!1);case"I444A":return t(1,1,1,1,!0);case"I444AP10":case"I444AP12":return t(2,2,1,1,!0);case"NV12":return[{sampleBytes:1,widthDivisor:1,heightDivisor:1},{sampleBytes:2,widthDivisor:2,heightDivisor:2}];case"RGBA":case"RGBX":case"BGRA":case"BGRX":return[{sampleBytes:4,widthDivisor:1,heightDivisor:1}];default:wo(e),G(!1)}},aa=new Set(["f32","f32-planar","s16","s16-planar","s32","s32-planar","u8","u8-planar"]);class mr{get microsecondTimestamp(){return Math.trunc(hr*this.timestamp)}get microsecondDuration(){return Math.trunc(hr*this.duration)}constructor(t){if(this._closed=!1,ii(t)){if(t.format===null)throw new TypeError("AudioData with null format is not supported.");this._data=t,this.format=t.format,this.sampleRate=t.sampleRate,this.numberOfFrames=t.numberOfFrames,this.numberOfChannels=t.numberOfChannels,this.timestamp=t.timestamp/1e6,this.duration=t.numberOfFrames/t.sampleRate}else{if(!t||typeof t!="object")throw new TypeError("Invalid AudioDataInit: must be an object.");if(!aa.has(t.format))throw new TypeError("Invalid AudioDataInit: invalid format.");if(!Number.isFinite(t.sampleRate)||t.sampleRate<=0)throw new TypeError("Invalid AudioDataInit: sampleRate must be > 0.");if(!Number.isInteger(t.numberOfChannels)||t.numberOfChannels===0)throw new TypeError("Invalid AudioDataInit: numberOfChannels must be an integer > 0.");if(!Number.isFinite(t==null?void 0:t.timestamp))throw new TypeError("init.timestamp must be a number.");const r=t.data.byteLength/(Lr(t.format)*t.numberOfChannels);if(!Number.isInteger(r))throw new TypeError("Invalid AudioDataInit: data size is not a multiple of frame size.");this.format=t.format,this.sampleRate=t.sampleRate,this.numberOfFrames=r,this.numberOfChannels=t.numberOfChannels,this.timestamp=t.timestamp,this.duration=r/t.sampleRate;let n;if(t.data instanceof ArrayBuffer)n=new Uint8Array(t.data);else if(ArrayBuffer.isView(t.data))n=new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength);else throw new TypeError("Invalid AudioDataInit: data is not a BufferSource.");const i=this.numberOfFrames*this.numberOfChannels*Lr(this.format);if(n.byteLength<i)throw new TypeError("Invalid AudioDataInit: insufficient data size.");this._data=n}at==null||at.register(this,{type:"audio",data:this._data},this)}allocationSize(t){if(!t||typeof t!="object")throw new TypeError("options must be an object.");if(!Number.isInteger(t.planeIndex)||t.planeIndex<0)throw new TypeError("planeIndex must be a non-negative integer.");if(t.format!==void 0&&!aa.has(t.format))throw new TypeError("Invalid format.");if(t.frameOffset!==void 0&&(!Number.isInteger(t.frameOffset)||t.frameOffset<0))throw new TypeError("frameOffset must be a non-negative integer.");if(t.frameCount!==void 0&&(!Number.isInteger(t.frameCount)||t.frameCount<0))throw new TypeError("frameCount must be a non-negative integer.");if(this._closed)throw new Error("AudioSample is closed.");const r=t.format??this.format,n=t.frameOffset??0;if(n>=this.numberOfFrames)throw new RangeError("frameOffset out of range");const i=t.frameCount!==void 0?t.frameCount:this.numberOfFrames-n;if(i>this.numberOfFrames-n)throw new RangeError("frameCount out of range");const s=Lr(r),o=Sn(r);if(o&&t.planeIndex>=this.numberOfChannels)throw new RangeError("planeIndex out of range");if(!o&&t.planeIndex!==0)throw new RangeError("planeIndex out of range");return(o?i:i*this.numberOfChannels)*s}copyTo(t,r){if(!yo(t))throw new TypeError("destination must be an ArrayBuffer or an ArrayBuffer view.");if(!r||typeof r!="object")throw new TypeError("options must be an object.");if(!Number.isInteger(r.planeIndex)||r.planeIndex<0)throw new TypeError("planeIndex must be a non-negative integer.");if(r.format!==void 0&&!aa.has(r.format))throw new TypeError("Invalid format.");if(r.frameOffset!==void 0&&(!Number.isInteger(r.frameOffset)||r.frameOffset<0))throw new TypeError("frameOffset must be a non-negative integer.");if(r.frameCount!==void 0&&(!Number.isInteger(r.frameCount)||r.frameCount<0))throw new TypeError("frameCount must be a non-negative integer.");if(this._closed)throw new Error("AudioSample is closed.");const{planeIndex:n,format:i,frameCount:s,frameOffset:o}=r,a=this.format,l=i??this.format;if(!l)throw new Error("Destination format not determined");const c=this.numberOfFrames,d=this.numberOfChannels,f=o??0;if(f>=c)throw new RangeError("frameOffset out of range");const y=s!==void 0?s:c-f;if(y>c-f)throw new RangeError("frameCount out of range");const b=Lr(l),k=Sn(l);if(k&&n>=d)throw new RangeError("planeIndex out of range");if(!k&&n!==0)throw new RangeError("planeIndex out of range");const E=(k?y:y*d)*b;if(t.byteLength<E)throw new RangeError("Destination buffer is too small");const m=fr(t),h=Oh(l);if(ii(this._data))J0()&&d>2&&l!==a?jg(this._data,m,a,l,d,n,f,y):this._data.copyTo(t,{planeIndex:n,frameOffset:f,frameCount:y,format:l});else{const p=this._data,x=fr(p),w=Ih(a),S=Lr(a),T=Sn(a);for(let _=0;_<y;_++)if(k){const A=_*b;let z;T?z=(n*c+(_+f))*S:z=((_+f)*d+n)*S;const I=w(x,z);h(m,A,I)}else for(let A=0;A<d;A++){const I=(_*d+A)*b;let j;T?j=(A*c+(_+f))*S:j=((_+f)*d+A)*S;const M=w(x,j);h(m,I,M)}}}clone(){if(this._closed)throw new Error("AudioSample is closed.");if(ii(this._data)){const t=new mr(this._data.clone());return t.setTimestamp(this.timestamp),t}else return new mr({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.timestamp,data:this._data})}close(){this._closed||(at==null||at.unregister(this),ii(this._data)?this._data.close():this._data=new Uint8Array(0),this._closed=!0)}toAudioData(){if(this._closed)throw new Error("AudioSample is closed.");if(ii(this._data)){if(this._data.timestamp===this.microsecondTimestamp)return this._data.clone();if(Sn(this.format)){const t=this.allocationSize({planeIndex:0,format:this.format}),r=new ArrayBuffer(t*this.numberOfChannels);for(let n=0;n<this.numberOfChannels;n++)this.copyTo(new Uint8Array(r,n*t,t),{planeIndex:n,format:this.format});return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:r})}else{const t=new ArrayBuffer(this.allocationSize({planeIndex:0,format:this.format}));return this.copyTo(t,{planeIndex:0,format:this.format}),new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:t})}}else return new AudioData({format:this.format,sampleRate:this.sampleRate,numberOfFrames:this.numberOfFrames,numberOfChannels:this.numberOfChannels,timestamp:this.microsecondTimestamp,data:this._data.buffer instanceof ArrayBuffer?this._data.buffer:this._data.slice()})}toAudioBuffer(){if(this._closed)throw new Error("AudioSample is closed.");const t=new AudioBuffer({numberOfChannels:this.numberOfChannels,length:this.numberOfFrames,sampleRate:this.sampleRate}),r=new Float32Array(this.allocationSize({planeIndex:0,format:"f32-planar"})/4);for(let n=0;n<this.numberOfChannels;n++)this.copyTo(r,{planeIndex:n,format:"f32-planar"}),t.copyToChannel(r,n);return t}setTimestamp(t){if(!Number.isFinite(t))throw new TypeError("newTimestamp must be a number.");this.timestamp=t}[Symbol.dispose](){this.close()}static*_fromAudioBuffer(t,r){if(!(t instanceof AudioBuffer))throw new TypeError("audioBuffer must be an AudioBuffer.");const n=48e3*5,i=t.numberOfChannels,s=t.sampleRate,o=t.length,a=Math.floor(n/i);let l=0,c=o;for(;c>0;){const d=Math.min(a,c),f=new Float32Array(i*d);for(let y=0;y<i;y++)t.copyFromChannel(f.subarray(y*d,(y+1)*d),y,l);yield new mr({format:"f32-planar",sampleRate:s,numberOfFrames:d,numberOfChannels:i,timestamp:r+l/s,data:f}),l+=d,c-=d}}static fromAudioBuffer(t,r){if(!(t instanceof AudioBuffer))throw new TypeError("audioBuffer must be an AudioBuffer.");const n=48e3*5,i=t.numberOfChannels,s=t.sampleRate,o=t.length,a=Math.floor(n/i);let l=0,c=o;const d=[];for(;c>0;){const f=Math.min(a,c),y=new Float32Array(i*f);for(let k=0;k<i;k++)t.copyFromChannel(y.subarray(k*f,(k+1)*f),k,l);const b=new mr({format:"f32-planar",sampleRate:s,numberOfFrames:f,numberOfChannels:i,timestamp:r+l/s,data:y});d.push(b),l+=f,c-=f}return d}}const Lr=e=>{switch(e){case"u8":case"u8-planar":return 1;case"s16":case"s16-planar":return 2;case"s32":case"s32-planar":return 4;case"f32":case"f32-planar":return 4;default:throw new Error("Unknown AudioSampleFormat")}},Sn=e=>{switch(e){case"u8-planar":case"s16-planar":case"s32-planar":case"f32-planar":return!0;default:return!1}},Ih=e=>{switch(e){case"u8":case"u8-planar":return(t,r)=>(t.getUint8(r)-128)/128;case"s16":case"s16-planar":return(t,r)=>t.getInt16(r,!0)/32768;case"s32":case"s32-planar":return(t,r)=>t.getInt32(r,!0)/2147483648;case"f32":case"f32-planar":return(t,r)=>t.getFloat32(r,!0)}},Oh=e=>{switch(e){case"u8":case"u8-planar":return(t,r,n)=>t.setUint8(r,qe((n+1)*127.5,0,255));case"s16":case"s16-planar":return(t,r,n)=>t.setInt16(r,qe(Math.round(n*32767),-32768,32767),!0);case"s32":case"s32-planar":return(t,r,n)=>t.setInt32(r,qe(Math.round(n*2147483647),-2147483648,2147483647),!0);case"f32":case"f32-planar":return(t,r,n)=>t.setFloat32(r,n,!0)}},ii=e=>typeof AudioData<"u"&&e instanceof AudioData,jg=(e,t,r,n,i,s,o,a)=>{const l=Ih(r),c=Oh(n),d=Lr(r),f=Lr(n),y=Sn(r);if(Sn(n))if(y){const k=new ArrayBuffer(a*d),v=fr(k);e.copyTo(k,{planeIndex:s,frameOffset:o,frameCount:a,format:r});for(let E=0;E<a;E++){const m=E*d,h=E*f,p=l(v,m);c(t,h,p)}}else{const k=new ArrayBuffer(a*i*d),v=fr(k);e.copyTo(k,{planeIndex:0,frameOffset:o,frameCount:a,format:r});for(let E=0;E<a;E++){const m=(E*i+s)*d,h=E*f,p=l(v,m);c(t,h,p)}}else if(y){const k=a*d,v=new ArrayBuffer(k),E=fr(v);for(let m=0;m<i;m++){e.copyTo(v,{planeIndex:m,frameOffset:o,frameCount:a,format:r});for(let h=0;h<a;h++){const p=h*d,x=(h*i+m)*f,w=l(E,p);c(t,x,w)}}}else{const k=new ArrayBuffer(a*i*d),v=fr(k);e.copyTo(k,{planeIndex:0,frameOffset:o,frameCount:a,format:r});for(let E=0;E<a;E++)for(let m=0;m<i;m++){const h=E*i+m,p=h*d,x=h*f,w=l(v,p);c(t,x,w)}}};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class cl{constructor(t){this.value=t}}class dl{constructor(t){this.value=t}}class Mh{constructor(t){this.value=t}}class ir{constructor(t){this.value=t}}var N;(function(e){e[e.EBML=440786851]="EBML",e[e.EBMLVersion=17030]="EBMLVersion",e[e.EBMLReadVersion=17143]="EBMLReadVersion",e[e.EBMLMaxIDLength=17138]="EBMLMaxIDLength",e[e.EBMLMaxSizeLength=17139]="EBMLMaxSizeLength",e[e.DocType=17026]="DocType",e[e.DocTypeVersion=17031]="DocTypeVersion",e[e.DocTypeReadVersion=17029]="DocTypeReadVersion",e[e.Void=236]="Void",e[e.Segment=408125543]="Segment",e[e.SeekHead=290298740]="SeekHead",e[e.Seek=19899]="Seek",e[e.SeekID=21419]="SeekID",e[e.SeekPosition=21420]="SeekPosition",e[e.Duration=17545]="Duration",e[e.Info=357149030]="Info",e[e.TimestampScale=2807729]="TimestampScale",e[e.MuxingApp=19840]="MuxingApp",e[e.WritingApp=22337]="WritingApp",e[e.Tracks=374648427]="Tracks",e[e.TrackEntry=174]="TrackEntry",e[e.TrackNumber=215]="TrackNumber",e[e.TrackUID=29637]="TrackUID",e[e.TrackType=131]="TrackType",e[e.FlagEnabled=185]="FlagEnabled",e[e.FlagDefault=136]="FlagDefault",e[e.FlagForced=21930]="FlagForced",e[e.FlagOriginal=21934]="FlagOriginal",e[e.FlagHearingImpaired=21931]="FlagHearingImpaired",e[e.FlagVisualImpaired=21932]="FlagVisualImpaired",e[e.FlagCommentary=21935]="FlagCommentary",e[e.FlagLacing=156]="FlagLacing",e[e.Name=21358]="Name",e[e.Language=2274716]="Language",e[e.LanguageBCP47=2274717]="LanguageBCP47",e[e.CodecID=134]="CodecID",e[e.CodecPrivate=25506]="CodecPrivate",e[e.CodecDelay=22186]="CodecDelay",e[e.SeekPreRoll=22203]="SeekPreRoll",e[e.DefaultDuration=2352003]="DefaultDuration",e[e.Video=224]="Video",e[e.PixelWidth=176]="PixelWidth",e[e.PixelHeight=186]="PixelHeight",e[e.AlphaMode=21440]="AlphaMode",e[e.Audio=225]="Audio",e[e.SamplingFrequency=181]="SamplingFrequency",e[e.Channels=159]="Channels",e[e.BitDepth=25188]="BitDepth",e[e.SimpleBlock=163]="SimpleBlock",e[e.BlockGroup=160]="BlockGroup",e[e.Block=161]="Block",e[e.BlockAdditions=30113]="BlockAdditions",e[e.BlockMore=166]="BlockMore",e[e.BlockAdditional=165]="BlockAdditional",e[e.BlockAddID=238]="BlockAddID",e[e.BlockDuration=155]="BlockDuration",e[e.ReferenceBlock=251]="ReferenceBlock",e[e.Cluster=524531317]="Cluster",e[e.Timestamp=231]="Timestamp",e[e.Cues=475249515]="Cues",e[e.CuePoint=187]="CuePoint",e[e.CueTime=179]="CueTime",e[e.CueTrackPositions=183]="CueTrackPositions",e[e.CueTrack=247]="CueTrack",e[e.CueClusterPosition=241]="CueClusterPosition",e[e.Colour=21936]="Colour",e[e.MatrixCoefficients=21937]="MatrixCoefficients",e[e.TransferCharacteristics=21946]="TransferCharacteristics",e[e.Primaries=21947]="Primaries",e[e.Range=21945]="Range",e[e.Projection=30320]="Projection",e[e.ProjectionType=30321]="ProjectionType",e[e.ProjectionPoseRoll=30325]="ProjectionPoseRoll",e[e.Attachments=423732329]="Attachments",e[e.AttachedFile=24999]="AttachedFile",e[e.FileDescription=18046]="FileDescription",e[e.FileName=18030]="FileName",e[e.FileMediaType=18016]="FileMediaType",e[e.FileData=18012]="FileData",e[e.FileUID=18094]="FileUID",e[e.Chapters=272869232]="Chapters",e[e.Tags=307544935]="Tags",e[e.Tag=29555]="Tag",e[e.Targets=25536]="Targets",e[e.TargetTypeValue=26826]="TargetTypeValue",e[e.TargetType=25546]="TargetType",e[e.TagTrackUID=25541]="TagTrackUID",e[e.TagEditionUID=25545]="TagEditionUID",e[e.TagChapterUID=25540]="TagChapterUID",e[e.TagAttachmentUID=25542]="TagAttachmentUID",e[e.SimpleTag=26568]="SimpleTag",e[e.TagName=17827]="TagName",e[e.TagLanguage=17530]="TagLanguage",e[e.TagString=17543]="TagString",e[e.TagBinary=17541]="TagBinary",e[e.ContentEncodings=28032]="ContentEncodings",e[e.ContentEncoding=25152]="ContentEncoding",e[e.ContentEncodingOrder=20529]="ContentEncodingOrder",e[e.ContentEncodingScope=20530]="ContentEncodingScope",e[e.ContentCompression=20532]="ContentCompression",e[e.ContentCompAlgo=16980]="ContentCompAlgo",e[e.ContentCompSettings=16981]="ContentCompSettings",e[e.ContentEncryption=20533]="ContentEncryption"})(N||(N={}));N.EBML,N.Segment;N.SeekHead,N.Info,N.Cluster,N.Tracks,N.Cues,N.Attachments,N.Chapters,N.Tags;const Bc=e=>e<256?1:e<65536?2:e<1<<24?3:e<2**32?4:e<2**40?5:6,Wc=e=>e<1n<<8n?1:e<1n<<16n?2:e<1n<<24n?3:e<1n<<32n?4:e<1n<<40n?5:e<1n<<48n?6:e<1n<<56n?7:8,$c=e=>e>=-64&&e<64?1:e>=-8192&&e<8192?2:e>=-1048576&&e<1<<20?3:e>=-134217728&&e<1<<27?4:e>=-17179869184&&e<2**34?5:6,Dg=e=>{if(e<127)return 1;if(e<16383)return 2;if(e<(1<<21)-1)return 3;if(e<(1<<28)-1)return 4;if(e<2**35-1)return 5;if(e<2**42-1)return 6;throw new Error("EBML varint size not supported "+e)};class Ig{constructor(t){this.writer=t,this.helper=new Uint8Array(8),this.helperView=new DataView(this.helper.buffer),this.offsets=new WeakMap,this.dataOffsets=new WeakMap}writeByte(t){this.helperView.setUint8(0,t),this.writer.write(this.helper.subarray(0,1))}writeFloat32(t){this.helperView.setFloat32(0,t,!1),this.writer.write(this.helper.subarray(0,4))}writeFloat64(t){this.helperView.setFloat64(0,t,!1),this.writer.write(this.helper)}writeUnsignedInt(t,r=Bc(t)){let n=0;switch(r){case 6:this.helperView.setUint8(n++,t/2**40|0);case 5:this.helperView.setUint8(n++,t/2**32|0);case 4:this.helperView.setUint8(n++,t>>24);case 3:this.helperView.setUint8(n++,t>>16);case 2:this.helperView.setUint8(n++,t>>8);case 1:this.helperView.setUint8(n++,t);break;default:throw new Error("Bad unsigned int size "+r)}this.writer.write(this.helper.subarray(0,n))}writeUnsignedBigInt(t,r=Wc(t)){let n=0;for(let i=r-1;i>=0;i--)this.helperView.setUint8(n++,Number(t>>BigInt(i*8)&0xffn));this.writer.write(this.helper.subarray(0,n))}writeSignedInt(t,r=$c(t)){t<0&&(t+=2**(r*8)),this.writeUnsignedInt(t,r)}writeVarInt(t,r=Dg(t)){let n=0;switch(r){case 1:this.helperView.setUint8(n++,128|t);break;case 2:this.helperView.setUint8(n++,64|t>>8),this.helperView.setUint8(n++,t);break;case 3:this.helperView.setUint8(n++,32|t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 4:this.helperView.setUint8(n++,16|t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 5:this.helperView.setUint8(n++,8|t/2**32&7),this.helperView.setUint8(n++,t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;case 6:this.helperView.setUint8(n++,4|t/2**40&3),this.helperView.setUint8(n++,t/2**32|0),this.helperView.setUint8(n++,t>>24),this.helperView.setUint8(n++,t>>16),this.helperView.setUint8(n++,t>>8),this.helperView.setUint8(n++,t);break;default:throw new Error("Bad EBML varint size "+r)}this.writer.write(this.helper.subarray(0,n))}writeAsciiString(t){this.writer.write(new Uint8Array(t.split("").map(r=>r.charCodeAt(0))))}writeEBML(t){if(t!==null)if(t instanceof Uint8Array)this.writer.write(t);else if(Array.isArray(t))for(const r of t)this.writeEBML(r);else if(this.offsets.set(t,this.writer.getPos()),this.writeUnsignedInt(t.id),Array.isArray(t.data)){const r=this.writer.getPos(),n=t.size===-1?1:t.size??4;t.size===-1?this.writeByte(255):this.writer.seek(this.writer.getPos()+n);const i=this.writer.getPos();if(this.dataOffsets.set(t,i),this.writeEBML(t.data),t.size!==-1){const s=this.writer.getPos()-i,o=this.writer.getPos();this.writer.seek(r),this.writeVarInt(s,n),this.writer.seek(o)}}else if(typeof t.data=="number"){const r=t.size??Bc(t.data);this.writeVarInt(r),this.writeUnsignedInt(t.data,r)}else if(typeof t.data=="bigint"){const r=t.size??Wc(t.data);this.writeVarInt(r),this.writeUnsignedBigInt(t.data,r)}else if(typeof t.data=="string")this.writeVarInt(t.data.length),this.writeAsciiString(t.data);else if(t.data instanceof Uint8Array)this.writeVarInt(t.data.byteLength,t.size),this.writer.write(t.data);else if(t.data instanceof cl)this.writeVarInt(4),this.writeFloat32(t.data.value);else if(t.data instanceof dl)this.writeVarInt(8),this.writeFloat64(t.data.value);else if(t.data instanceof Mh){const r=t.size??$c(t.data.value);this.writeVarInt(r),this.writeSignedInt(t.data.value,r)}else if(t.data instanceof ir){const r=Ts.encode(t.data.value);this.writeVarInt(r.length),this.writer.write(r)}else wo(t.data)}}const Og={avc:"V_MPEG4/ISO/AVC",hevc:"V_MPEGH/ISO/HEVC",vp8:"V_VP8",vp9:"V_VP9",av1:"V_AV1",aac:"A_AAC",mp3:"A_MPEG/L3",opus:"A_OPUS",vorbis:"A_VORBIS",flac:"A_FLAC",ac3:"A_AC3",eac3:"A_EAC3","pcm-u8":"A_PCM/INT/LIT","pcm-s16":"A_PCM/INT/LIT","pcm-s16be":"A_PCM/INT/BIG","pcm-s24":"A_PCM/INT/LIT","pcm-s24be":"A_PCM/INT/BIG","pcm-s32":"A_PCM/INT/LIT","pcm-s32be":"A_PCM/INT/BIG","pcm-f32":"A_PCM/FLOAT/IEEE","pcm-f64":"A_PCM/FLOAT/IEEE",webvtt:"S_TEXT/WEBVTT"};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Mg=e=>{let r=(e.hasVideo?"video/":e.hasAudio?"audio/":"application/")+(e.isWebM?"webm":"x-matroska");if(e.codecStrings.length>0){const n=[...new Set(e.codecStrings.filter(Boolean))];r+=`; codecs="${n.join(", ")}"`}return r};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Fg=7,zg=9,Hc=e=>{const t=e.filePos,r=Ug(e,9),n=new Bn(r);if(n.readBits(12)!==4095||(n.skipBits(1),n.readBits(2)!==0))return null;const o=n.readBits(1),a=n.readBits(2)+1,l=n.readBits(4);if(l===15)return null;n.skipBits(1);const c=n.readBits(3);if(c===0)throw new Error("ADTS frames with channel configuration 0 are not supported.");n.skipBits(1),n.skipBits(1),n.skipBits(1),n.skipBits(1);const d=n.readBits(13);n.skipBits(11);const f=n.readBits(2)+1;if(f!==1)throw new Error("ADTS frames with more than one AAC frame are not supported.");let y=null;return o===1?e.filePos-=2:y=n.readBits(16),{objectType:a,samplingFrequencyIndex:l,channelConfiguration:c,frameLength:d,numberOfAacFrames:f,crcCheck:y,startPos:t}};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Vi{constructor(t,r,n,i,s){this.bytes=t,this.view=r,this.offset=n,this.start=i,this.end=s,this.bufferPos=i-n}static tempFromBytes(t){return new Vi(t,fr(t),0,0,t.length)}get length(){return this.end-this.start}get filePos(){return this.offset+this.bufferPos}set filePos(t){this.bufferPos=t-this.offset}get remainingLength(){return Math.max(this.end-this.filePos,0)}skip(t){this.bufferPos+=t}slice(t,r=this.end-t){if(t<this.start||t+r>this.end)throw new RangeError("Slicing outside of original slice.");return new Vi(this.bytes,this.view,this.offset,t,t+r)}}const Vg=(e,t)=>{if(e.filePos<e.start||e.filePos+t>e.end)throw new RangeError(`Tried reading [${e.filePos}, ${e.filePos+t}), but slice is [${e.start}, ${e.end}). This is likely an internal error, please report it alongside the file that caused it.`)},Ug=(e,t)=>{Vg(e,t);const r=e.bytes.subarray(e.bufferPos,e.bufferPos+t);return e.bufferPos+=t,r};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Lg{constructor(t){this.mutex=new Ch,this.firstMediaStreamTimestamp=null,this.trackTimestampInfo=new WeakMap,this.output=t}onTrackClose(t){}validateAndNormalizeTimestamp(t,r,n){r+=t.source._timestampOffset;let i=this.trackTimestampInfo.get(t);if(!i){if(!n)throw new Error("First packet must be a key packet.");i={maxTimestamp:r,maxTimestampBeforeLastKeyPacket:r},this.trackTimestampInfo.set(t,i)}if(r<0)throw new Error(`Timestamps must be non-negative (got ${r}s).`);if(n&&(i.maxTimestampBeforeLastKeyPacket=i.maxTimestamp),r<i.maxTimestampBeforeLastKeyPacket)throw new Error(`Timestamps cannot be smaller than the largest timestamp of the previous GOP (a GOP begins with a key packet and ends right before the next key packet). Got ${r}s, but largest timestamp is ${i.maxTimestampBeforeLastKeyPacket}s.`);return i.maxTimestamp=Math.max(i.maxTimestamp,r),r}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Qc=/<(?:(\d{2}):)?(\d{2}):(\d{2}).(\d{3})>/g,Bg=/(?:(\d{2}):)?(\d{2}):(\d{2}).(\d{3})/,Wg=e=>{const t=Bg.exec(e);if(!t)throw new Error("Expected match.");return 60*60*1e3*Number(t[1]||"0")+60*1e3*Number(t[2])+1e3*Number(t[3])+Number(t[4])},$g=e=>{const t=Math.floor(e/36e5),r=Math.floor(e%(60*60*1e3)/(60*1e3)),n=Math.floor(e%(60*1e3)/1e3),i=e%1e3;return t.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+"."+i.toString().padStart(3,"0")};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Hg{constructor(){this.ensureMonotonicity=!1,this.trackedWrites=null,this.trackedStart=-1,this.trackedEnd=-1}start(){}maybeTrackWrites(t){if(!this.trackedWrites)return;let r=this.getPos();if(r<this.trackedStart){if(r+t.byteLength<=this.trackedStart)return;t=t.subarray(this.trackedStart-r),r=0}const n=r+t.byteLength-this.trackedStart;let i=this.trackedWrites.byteLength;for(;i<n;)i*=2;if(i!==this.trackedWrites.byteLength){const s=new Uint8Array(i);s.set(this.trackedWrites,0),this.trackedWrites=s}this.trackedWrites.set(t,r-this.trackedStart),this.trackedEnd=Math.max(this.trackedEnd,r+t.byteLength)}startTrackingWrites(){this.trackedWrites=new Uint8Array(2**10),this.trackedStart=this.getPos(),this.trackedEnd=this.trackedStart}stopTrackingWrites(){if(!this.trackedWrites)throw new Error("Internal error: Can't get tracked writes since nothing was tracked.");const r={data:this.trackedWrites.subarray(0,this.trackedEnd-this.trackedStart),start:this.trackedStart,end:this.trackedEnd};return this.trackedWrites=null,r}}const la=2**16,ua=2**32;class Qg extends Hg{constructor(t){if(super(),this.pos=0,this.maxPos=0,this.target=t,this.supportsResize="resize"in new ArrayBuffer(0),this.supportsResize)try{this.buffer=new ArrayBuffer(la,{maxByteLength:ua})}catch{this.buffer=new ArrayBuffer(la),this.supportsResize=!1}else this.buffer=new ArrayBuffer(la);this.bytes=new Uint8Array(this.buffer)}ensureSize(t){let r=this.buffer.byteLength;for(;r<t;)r*=2;if(r!==this.buffer.byteLength){if(r>ua)throw new Error(`ArrayBuffer exceeded maximum size of ${ua} bytes. Please consider using another target.`);if(this.supportsResize)this.buffer.resize(r);else{const n=new ArrayBuffer(r),i=new Uint8Array(n);i.set(this.bytes,0),this.buffer=n,this.bytes=i}}}write(t){var r,n;this.maybeTrackWrites(t),this.ensureSize(this.pos+t.byteLength),this.bytes.set(t,this.pos),(n=(r=this.target).onwrite)==null||n.call(r,this.pos,this.pos+t.byteLength),this.pos+=t.byteLength,this.maxPos=Math.max(this.maxPos,this.pos)}seek(t){this.pos=t}getPos(){return this.pos}async flush(){}async finalize(){this.ensureSize(this.pos),this.target.buffer=this.buffer.slice(0,Math.max(this.maxPos,this.pos))}async close(){}getSlice(t,r){return this.bytes.slice(t,r)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class Fh{constructor(){this._output=null,this.onwrite=null}}class Gg extends Fh{constructor(){super(...arguments),this.buffer=null}_createWriter(){return new Qg(this)}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Xg=-32768,Kg=2**15-1,Gc="Mediabunny",Xc=6,Kc=5,Yg={video:1,audio:2,subtitle:17};class qg extends Lg{constructor(t,r){super(t),this.trackDatas=[],this.allTracksKnown=Eh(),this.segment=null,this.segmentInfo=null,this.seekHead=null,this.tracksElement=null,this.tagsElement=null,this.attachmentsElement=null,this.segmentDuration=null,this.cues=null,this.currentCluster=null,this.currentClusterStartMsTimestamp=null,this.currentClusterMaxMsTimestamp=null,this.trackDatasInCurrentCluster=new Map,this.duration=0,this.writer=t._writer,this.format=r,this.ebmlWriter=new Ig(this.writer),this.format._options.appendOnly&&(this.writer.ensureMonotonicity=!0)}async start(){const t=await this.mutex.acquire();this.writeEBMLHeader(),this.createSegmentInfo(),this.createCues(),await this.writer.flush(),t()}writeEBMLHeader(){this.format._options.onEbmlHeader&&this.writer.startTrackingWrites();const t={id:N.EBML,data:[{id:N.EBMLVersion,data:1},{id:N.EBMLReadVersion,data:1},{id:N.EBMLMaxIDLength,data:4},{id:N.EBMLMaxSizeLength,data:8},{id:N.DocType,data:this.format instanceof fl?"webm":"matroska"},{id:N.DocTypeVersion,data:2},{id:N.DocTypeReadVersion,data:2}]};if(this.ebmlWriter.writeEBML(t),this.format._options.onEbmlHeader){const{data:r,start:n}=this.writer.stopTrackingWrites();this.format._options.onEbmlHeader(r,n)}}maybeCreateSeekHead(t){if(this.format._options.appendOnly)return;const r=new Uint8Array([28,83,187,107]),n=new Uint8Array([21,73,169,102]),i=new Uint8Array([22,84,174,107]),s=new Uint8Array([25,65,164,105]),o=new Uint8Array([18,84,195,103]),a={id:N.SeekHead,data:[{id:N.Seek,data:[{id:N.SeekID,data:r},{id:N.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.cues)-this.segmentDataOffset:0}]},{id:N.Seek,data:[{id:N.SeekID,data:n},{id:N.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.segmentInfo)-this.segmentDataOffset:0}]},{id:N.Seek,data:[{id:N.SeekID,data:i},{id:N.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.tracksElement)-this.segmentDataOffset:0}]},this.attachmentsElement?{id:N.Seek,data:[{id:N.SeekID,data:s},{id:N.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.attachmentsElement)-this.segmentDataOffset:0}]}:null,this.tagsElement?{id:N.Seek,data:[{id:N.SeekID,data:o},{id:N.SeekPosition,size:5,data:t?this.ebmlWriter.offsets.get(this.tagsElement)-this.segmentDataOffset:0}]}:null]};this.seekHead=a}createSegmentInfo(){const t={id:N.Duration,data:new dl(0)};this.segmentDuration=t;const r={id:N.Info,data:[{id:N.TimestampScale,data:1e6},{id:N.MuxingApp,data:Gc},{id:N.WritingApp,data:Gc},this.format._options.appendOnly?null:t]};this.segmentInfo=r}createTracks(){var r,n,i,s,o,a;const t={id:N.Tracks,data:[]};this.tracksElement=t;for(const l of this.trackDatas){const c=Og[l.track.source._codec];G(c);let d=0;if(l.type==="audio"&&l.track.source._codec==="opus"){d=1e6*80;const f=l.info.decoderConfig.description;if(f){const y=Yr(f),b=Eg(y);d=Math.round(1e9*(b.preSkip/fg))}}t.data.push({id:N.TrackEntry,data:[{id:N.TrackNumber,data:l.track.id},{id:N.TrackUID,data:l.track.id},{id:N.TrackType,data:Yg[l.type]},((r=l.track.metadata.disposition)==null?void 0:r.default)===!1?{id:N.FlagDefault,data:0}:null,(n=l.track.metadata.disposition)!=null&&n.forced?{id:N.FlagForced,data:1}:null,(i=l.track.metadata.disposition)!=null&&i.hearingImpaired?{id:N.FlagHearingImpaired,data:1}:null,(s=l.track.metadata.disposition)!=null&&s.visuallyImpaired?{id:N.FlagVisualImpaired,data:1}:null,(o=l.track.metadata.disposition)!=null&&o.original?{id:N.FlagOriginal,data:1}:null,(a=l.track.metadata.disposition)!=null&&a.commentary?{id:N.FlagCommentary,data:1}:null,{id:N.FlagLacing,data:0},{id:N.Language,data:l.track.metadata.languageCode??Y0},{id:N.CodecID,data:c},{id:N.CodecDelay,data:0},{id:N.SeekPreRoll,data:d},l.track.metadata.name!==void 0?{id:N.Name,data:new ir(l.track.metadata.name)}:null,l.type==="video"?this.videoSpecificTrackInfo(l):null,l.type==="audio"?this.audioSpecificTrackInfo(l):null,l.type==="subtitle"?this.subtitleSpecificTrackInfo(l):null]})}}videoSpecificTrackInfo(t){const{frameRate:r,rotation:n}=t.track.metadata,i=[t.info.decoderConfig.description?{id:N.CodecPrivate,data:Yr(t.info.decoderConfig.description)}:null,r?{id:N.DefaultDuration,data:1e9/r}:null],s=n?Q0(-n):0,o=t.info.decoderConfig.colorSpace,a={id:N.Video,data:[{id:N.PixelWidth,data:t.info.width},{id:N.PixelHeight,data:t.info.height},t.info.alphaMode?{id:N.AlphaMode,data:1}:null,X0(o)?{id:N.Colour,data:[{id:N.MatrixCoefficients,data:bh[o.matrix]},{id:N.TransferCharacteristics,data:kh[o.transfer]},{id:N.Primaries,data:xh[o.primaries]},{id:N.Range,data:o.fullRange?2:1}]}:null,s?{id:N.Projection,data:[{id:N.ProjectionType,data:0},{id:N.ProjectionPoseRoll,data:new cl((s+180)%360-180)}]}:null]};return i.push(a),i}audioSpecificTrackInfo(t){const r=jt.includes(t.track.source._codec)?Ah(t.track.source._codec):null;return[t.info.decoderConfig.description?{id:N.CodecPrivate,data:Yr(t.info.decoderConfig.description)}:null,{id:N.Audio,data:[{id:N.SamplingFrequency,data:new cl(t.info.sampleRate)},{id:N.Channels,data:t.info.numberOfChannels},r?{id:N.BitDepth,data:8*r.sampleSize}:null]}]}subtitleSpecificTrackInfo(t){return[{id:N.CodecPrivate,data:Ts.encode(t.info.config.description)}]}maybeCreateTags(){const t=[],r=(s,o)=>{t.push({id:N.SimpleTag,data:[{id:N.TagName,data:new ir(s)},typeof o=="string"?{id:N.TagString,data:new ir(o)}:{id:N.TagBinary,data:o}]})},n=this.output._metadataTags,i=new Set;for(const{key:s,value:o}of eg(n))switch(s){case"title":r("TITLE",o),i.add("TITLE");break;case"description":r("DESCRIPTION",o),i.add("DESCRIPTION");break;case"artist":r("ARTIST",o),i.add("ARTIST");break;case"album":r("ALBUM",o),i.add("ALBUM");break;case"albumArtist":r("ALBUM_ARTIST",o),i.add("ALBUM_ARTIST");break;case"genre":r("GENRE",o),i.add("GENRE");break;case"comment":r("COMMENT",o),i.add("COMMENT");break;case"lyrics":r("LYRICS",o),i.add("LYRICS");break;case"date":r("DATE",o.toISOString().slice(0,10)),i.add("DATE");break;case"trackNumber":{const a=n.tracksTotal!==void 0?`${o}/${n.tracksTotal}`:o.toString();r("PART_NUMBER",a),i.add("PART_NUMBER")}break;case"discNumber":{const a=n.discsTotal!==void 0?`${o}/${n.discsTotal}`:o.toString();r("DISC",a),i.add("DISC")}break;case"tracksTotal":case"discsTotal":break;case"images":case"raw":break;default:wo(s)}if(n.raw)for(const s in n.raw){const o=n.raw[s];o==null||i.has(s)||(typeof o=="string"||o instanceof Uint8Array)&&r(s,o)}t.length!==0&&(this.tagsElement={id:N.Tags,data:[{id:N.Tag,data:[{id:N.Targets,data:[{id:N.TargetTypeValue,data:50},{id:N.TargetType,data:"MOVIE"}]},...t]}]})}maybeCreateAttachments(){const t=this.output._metadataTags,r=[],n=new Set,i=t.images??[];for(const s of i){let o=s.name;o===void 0&&(o=(s.kind==="coverFront"?"cover":s.kind==="coverBack"?"back":"image")+(tg(s.mimeType)??""));let a;for(;;){a=0n;for(let l=0;l<8;l++)a<<=8n,a|=BigInt(Math.floor(Math.random()*256));if(a!==0n&&!n.has(a))break}n.add(a),r.push({id:N.AttachedFile,data:[s.description!==void 0?{id:N.FileDescription,data:new ir(s.description)}:null,{id:N.FileName,data:new ir(o)},{id:N.FileMediaType,data:s.mimeType},{id:N.FileData,data:s.data},{id:N.FileUID,data:a}]})}for(const[s,o]of Object.entries(t.raw??{}))!(o instanceof _h)||!/^\d+$/.test(s)||i.find(l=>l.mimeType===o.mimeType&&rg(l.data,o.data))||r.push({id:N.AttachedFile,data:[o.description!==void 0?{id:N.FileDescription,data:new ir(o.description)}:null,{id:N.FileName,data:new ir(o.name??"")},{id:N.FileMediaType,data:o.mimeType??""},{id:N.FileData,data:o.data},{id:N.FileUID,data:BigInt(s)}]});r.length!==0&&(this.attachmentsElement={id:N.Attachments,data:r})}createSegment(){this.createTracks(),this.maybeCreateTags(),this.maybeCreateAttachments(),this.maybeCreateSeekHead(!1);const t={id:N.Segment,size:this.format._options.appendOnly?-1:Xc,data:[this.seekHead,this.segmentInfo,this.tracksElement,this.attachmentsElement,this.tagsElement]};if(this.segment=t,this.format._options.onSegmentHeader&&this.writer.startTrackingWrites(),this.ebmlWriter.writeEBML(t),this.format._options.onSegmentHeader){const{data:r,start:n}=this.writer.stopTrackingWrites();this.format._options.onSegmentHeader(r,n)}}createCues(){this.cues={id:N.Cues,data:[]}}get segmentDataOffset(){return G(this.segment),this.ebmlWriter.dataOffsets.get(this.segment)}allTracksAreKnown(){for(const t of this.output._tracks)if(!t.source._closed&&!this.trackDatas.some(r=>r.track===t))return!1;return!0}async getMimeType(){await this.allTracksKnown.promise;const t=this.trackDatas.map(r=>r.type==="video"||r.type==="audio"?r.info.decoderConfig.codec:{webvtt:"wvtt"}[r.track.source._codec]);return Mg({isWebM:this.format instanceof fl,hasVideo:this.trackDatas.some(r=>r.type==="video"),hasAudio:this.trackDatas.some(r=>r.type==="audio"),codecStrings:t})}getVideoTrackData(t,r,n){const i=this.trackDatas.find(o=>o.track===t);if(i)return i;xg(n),G(n),G(n.decoderConfig),G(n.decoderConfig.codedWidth!==void 0),G(n.decoderConfig.codedHeight!==void 0);const s={track:t,type:"video",info:{width:n.decoderConfig.codedWidth,height:n.decoderConfig.codedHeight,decoderConfig:n.decoderConfig,alphaMode:!!r.sideData.alpha},chunkQueue:[],lastWrittenMsTimestamp:null};return t.source._codec==="vp9"?s.info.decoderConfig={...s.info.decoderConfig,description:new Uint8Array(lg(s.info.decoderConfig.codec))}:t.source._codec==="av1"&&(s.info.decoderConfig={...s.info.decoderConfig,description:new Uint8Array(ug(s.info.decoderConfig.codec))}),this.trackDatas.push(s),this.trackDatas.sort((o,a)=>o.track.id-a.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),s}getAudioTrackData(t,r,n){const i=this.trackDatas.find(l=>l.track===t);if(i)return i;bg(n),G(n),G(n.decoderConfig);const s={...n.decoderConfig};let o=!1;if(t.source._codec==="aac"&&!s.description){const l=Hc(Vi.tempFromBytes(r.data));if(!l)throw new Error("Couldn't parse ADTS header from the AAC packet. Make sure the packets are in ADTS format (as specified in ISO 13818-7) when not providing a description, or provide a description (must be an AudioSpecificConfig as specified in ISO 14496-3) and ensure the packets are raw AAC data.");const c=Zs[l.samplingFrequencyIndex],d=du[l.channelConfiguration];if(c===void 0||d===void 0)throw new Error("Invalid ADTS frame header.");s.description=Ph({objectType:l.objectType,sampleRate:c,numberOfChannels:d}),o=!0}const a={track:t,type:"audio",info:{numberOfChannels:n.decoderConfig.numberOfChannels,sampleRate:n.decoderConfig.sampleRate,decoderConfig:s,requiresAdtsStripping:o},chunkQueue:[],lastWrittenMsTimestamp:null};return this.trackDatas.push(a),this.trackDatas.sort((l,c)=>l.track.id-c.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),a}getSubtitleTrackData(t,r){const n=this.trackDatas.find(s=>s.track===t);if(n)return n;Cg(r),G(r),G(r.config);const i={track:t,type:"subtitle",info:{config:r.config},chunkQueue:[],lastWrittenMsTimestamp:null};return this.trackDatas.push(i),this.trackDatas.sort((s,o)=>s.track.id-o.track.id),this.allTracksAreKnown()&&this.allTracksKnown.resolve(),i}async addEncodedVideoPacket(t,r,n){const i=await this.mutex.acquire();try{const s=this.getVideoTrackData(t,r,n),o=r.type==="key";let a=this.validateAndNormalizeTimestamp(s.track,r.timestamp,o),l=r.duration;t.metadata.frameRate!==void 0&&(a=Rc(a,1/t.metadata.frameRate),l=Rc(l,1/t.metadata.frameRate));const c=s.info.alphaMode?r.sideData.alpha??null:null,d=this.createInternalChunk(r.data,a,l,r.type,c);t.source._codec==="vp9"&&this.fixVP9ColorSpace(s,d),s.chunkQueue.push(d),await this.interleaveChunks()}finally{i()}}async addEncodedAudioPacket(t,r,n){const i=await this.mutex.acquire();try{const s=this.getAudioTrackData(t,r,n);let o=r.data;if(s.info.requiresAdtsStripping){const d=Hc(Vi.tempFromBytes(o));if(!d)throw new Error("Expected ADTS frame, didn't get one.");const f=d.crcCheck===null?Fg:zg;o=o.subarray(f)}const a=r.type==="key",l=this.validateAndNormalizeTimestamp(s.track,r.timestamp,a),c=this.createInternalChunk(o,l,r.duration,r.type);s.chunkQueue.push(c),await this.interleaveChunks()}finally{i()}}async addSubtitleCue(t,r,n){const i=await this.mutex.acquire();try{const s=this.getSubtitleTrackData(t,n),o=this.validateAndNormalizeTimestamp(s.track,r.timestamp,!0);let a=r.text;const l=Math.round(o*1e3);Qc.lastIndex=0,a=a.replace(Qc,y=>{const k=Wg(y.slice(1,-1))-l;return`<${$g(k)}>`});const c=Ts.encode(a),d=`${r.settings??""}
${r.identifier??""}
${r.notes??""}`,f=this.createInternalChunk(c,o,r.duration,"key",d.trim()?Ts.encode(d):null);s.chunkQueue.push(f),await this.interleaveChunks()}finally{i()}}async interleaveChunks(t=!1){if(!(!t&&!this.allTracksAreKnown())){e:for(;;){let r=null,n=1/0;for(const s of this.trackDatas){if(!t&&s.chunkQueue.length===0&&!s.track.source._closed)break e;s.chunkQueue.length>0&&s.chunkQueue[0].timestamp<n&&(r=s,n=s.chunkQueue[0].timestamp)}if(!r)break;const i=r.chunkQueue.shift();this.writeBlock(r,i)}t||await this.writer.flush()}}fixVP9ColorSpace(t,r){if(r.type!=="key"||!t.info.decoderConfig.colorSpace||!t.info.decoderConfig.colorSpace.matrix)return;const n=new Bn(r.data);n.skipBits(2);const i=n.readBits(1),o=(n.readBits(1)<<1)+i;if(o===3&&n.skipBits(1),n.readBits(1)||n.readBits(1)!==0||(n.skipBits(2),n.readBits(24)!==4817730))return;o>=2&&n.skipBits(1);const d={rgb:7,bt709:2,bt470bg:1,smpte170m:3}[t.info.decoderConfig.colorSpace.matrix];G0(r.data,n.pos,n.pos+3,d)}createInternalChunk(t,r,n,i,s=null){return{data:t,type:i,timestamp:r,duration:n,additions:s}}writeBlock(t,r){this.segment||this.createSegment();const n=Math.round(1e3*r.timestamp),i=this.trackDatas.every(d=>{if(t===d)return r.type==="key";const f=d.chunkQueue[0];return f?f.type==="key":d.track.source._closed});let s=!1;if(!this.currentCluster)s=!0;else{G(this.currentClusterStartMsTimestamp!==null),G(this.currentClusterMaxMsTimestamp!==null);const d=n-this.currentClusterStartMsTimestamp;s=i&&n>this.currentClusterMaxMsTimestamp&&d>=1e3*(this.format._options.minimumClusterDuration??1)||d>Kg}s&&this.createNewCluster(n);const o=n-this.currentClusterStartMsTimestamp;if(o<Xg)return;const a=new Uint8Array(4),l=new DataView(a.buffer);l.setUint8(0,128|t.track.id),l.setInt16(1,o,!1);const c=Math.round(1e3*r.duration);if(r.additions){const d={id:N.BlockGroup,data:[{id:N.Block,data:[a,r.data]},r.type==="delta"?{id:N.ReferenceBlock,data:new Mh(t.lastWrittenMsTimestamp-n)}:null,r.additions?{id:N.BlockAdditions,data:[{id:N.BlockMore,data:[{id:N.BlockAddID,data:1},{id:N.BlockAdditional,data:r.additions}]}]}:null,c>0?{id:N.BlockDuration,data:c}:null]};this.ebmlWriter.writeEBML(d)}else{l.setUint8(3,+(r.type==="key")<<7);const d={id:N.SimpleBlock,data:[a,r.data]};this.ebmlWriter.writeEBML(d)}this.duration=Math.max(this.duration,n+c),t.lastWrittenMsTimestamp=n,this.trackDatasInCurrentCluster.has(t)||this.trackDatasInCurrentCluster.set(t,{firstMsTimestamp:n}),this.currentClusterMaxMsTimestamp=Math.max(this.currentClusterMaxMsTimestamp,n)}createNewCluster(t){this.currentCluster&&this.finalizeCurrentCluster(),this.format._options.onCluster&&this.writer.startTrackingWrites(),this.currentCluster={id:N.Cluster,size:this.format._options.appendOnly?-1:Kc,data:[{id:N.Timestamp,data:t}]},this.ebmlWriter.writeEBML(this.currentCluster),this.currentClusterStartMsTimestamp=t,this.currentClusterMaxMsTimestamp=t,this.trackDatasInCurrentCluster.clear()}finalizeCurrentCluster(){if(G(this.currentCluster),!this.format._options.appendOnly){const i=this.writer.getPos()-this.ebmlWriter.dataOffsets.get(this.currentCluster),s=this.writer.getPos();this.writer.seek(this.ebmlWriter.offsets.get(this.currentCluster)+4),this.ebmlWriter.writeVarInt(i,Kc),this.writer.seek(s)}if(this.format._options.onCluster){G(this.currentClusterStartMsTimestamp!==null);const{data:i,start:s}=this.writer.stopTrackingWrites();this.format._options.onCluster(i,s,this.currentClusterStartMsTimestamp/1e3)}const t=this.ebmlWriter.offsets.get(this.currentCluster)-this.segmentDataOffset,r=new Map;for(const[i,{firstMsTimestamp:s}]of this.trackDatasInCurrentCluster)r.has(s)||r.set(s,[]),r.get(s).push(i);const n=[...r.entries()].sort((i,s)=>i[0]-s[0]);for(const[i,s]of n)G(this.cues),this.cues.data.push({id:N.CuePoint,data:[{id:N.CueTime,data:i},...s.map(o=>({id:N.CueTrackPositions,data:[{id:N.CueTrack,data:o.track.id},{id:N.CueClusterPosition,data:t}]}))]})}async onTrackClose(){const t=await this.mutex.acquire();this.allTracksAreKnown()&&this.allTracksKnown.resolve(),await this.interleaveChunks(),t()}async finalize(){const t=await this.mutex.acquire();if(this.allTracksKnown.resolve(),this.segment||this.createSegment(),await this.interleaveChunks(!0),this.currentCluster&&this.finalizeCurrentCluster(),G(this.cues),this.ebmlWriter.writeEBML(this.cues),!this.format._options.appendOnly){const r=this.writer.getPos(),n=this.writer.getPos()-this.segmentDataOffset;this.writer.seek(this.ebmlWriter.offsets.get(this.segment)+4),this.ebmlWriter.writeVarInt(n,Xc),this.segmentDuration.data=new dl(this.duration),this.writer.seek(this.ebmlWriter.offsets.get(this.segmentDuration)),this.ebmlWriter.writeEBML(this.segmentDuration),G(this.seekHead),this.writer.seek(this.ebmlWriter.offsets.get(this.seekHead)),this.maybeCreateSeekHead(!0),this.ebmlWriter.writeEBML(this.seekHead),this.writer.seek(r)}t()}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class zh{getSupportedVideoCodecs(){return this.getSupportedCodecs().filter(t=>_r.includes(t))}getSupportedAudioCodecs(){return this.getSupportedCodecs().filter(t=>nn.includes(t))}getSupportedSubtitleCodecs(){return this.getSupportedCodecs().filter(t=>zi.includes(t))}_codecUnsupportedHint(t){return""}}class Yc extends zh{constructor(t={}){if(!t||typeof t!="object")throw new TypeError("options must be an object.");if(t.appendOnly!==void 0&&typeof t.appendOnly!="boolean")throw new TypeError("options.appendOnly, when provided, must be a boolean.");if(t.minimumClusterDuration!==void 0&&(!Number.isFinite(t.minimumClusterDuration)||t.minimumClusterDuration<0))throw new TypeError("options.minimumClusterDuration, when provided, must be a non-negative number.");if(t.onEbmlHeader!==void 0&&typeof t.onEbmlHeader!="function")throw new TypeError("options.onEbmlHeader, when provided, must be a function.");if(t.onSegmentHeader!==void 0&&typeof t.onSegmentHeader!="function")throw new TypeError("options.onHeader, when provided, must be a function.");if(t.onCluster!==void 0&&typeof t.onCluster!="function")throw new TypeError("options.onCluster, when provided, must be a function.");super(),this._options=t}_createMuxer(t){return new qg(t,this)}get _name(){return"Matroska"}getSupportedTrackCounts(){return{video:{min:0,max:127},audio:{min:0,max:127},subtitle:{min:0,max:127},total:{min:1,max:127}}}get fileExtension(){return".mkv"}get mimeType(){return"video/x-matroska"}getSupportedCodecs(){return[..._r,...Nh,...jt.filter(t=>!["pcm-s8","pcm-f32be","pcm-f64be","ulaw","alaw"].includes(t)),...zi]}get supportsVideoRotationMetadata(){return!1}get supportsTimestampedMediaData(){return!0}}class fl extends Yc{constructor(t){super(t)}getSupportedCodecs(){return[..._r.filter(t=>["vp8","vp9","av1"].includes(t)),...nn.filter(t=>["opus","vorbis"].includes(t)),...zi]}get _name(){return"WebM"}get fileExtension(){return".webm"}get mimeType(){return"video/webm"}_codecUnsupportedHint(t){return new Yc().getSupportedCodecs().includes(t)?" Switching to MKV will grant support for this codec.":""}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const Zg=e=>{if(!e||typeof e!="object")throw new TypeError("Encoding config must be an object.");if(!_r.includes(e.codec))throw new TypeError(`Invalid video codec '${e.codec}'. Must be one of: ${_r.join(", ")}.`);if(!(e.bitrate instanceof an)&&(!Number.isInteger(e.bitrate)||e.bitrate<=0))throw new TypeError("config.bitrate must be a positive integer or a quality.");if(e.keyFrameInterval!==void 0&&(!Number.isFinite(e.keyFrameInterval)||e.keyFrameInterval<0))throw new TypeError("config.keyFrameInterval, when provided, must be a non-negative number.");if(e.sizeChangeBehavior!==void 0&&!["deny","passThrough","fill","contain","cover"].includes(e.sizeChangeBehavior))throw new TypeError("config.sizeChangeBehavior, when provided, must be 'deny', 'passThrough', 'fill', 'contain' or 'cover'.");if(e.onEncodedPacket!==void 0&&typeof e.onEncodedPacket!="function")throw new TypeError("config.onEncodedChunk, when provided, must be a function.");if(e.onEncoderConfig!==void 0&&typeof e.onEncoderConfig!="function")throw new TypeError("config.onEncoderConfig, when provided, must be a function.");Vh(e.codec,e)},Vh=(e,t)=>{if(!t||typeof t!="object")throw new TypeError("Encoding options must be an object.");if(t.alpha!==void 0&&!["discard","keep"].includes(t.alpha))throw new TypeError("options.alpha, when provided, must be 'discard' or 'keep'.");if(t.bitrateMode!==void 0&&!["constant","variable"].includes(t.bitrateMode))throw new TypeError("bitrateMode, when provided, must be 'constant' or 'variable'.");if(t.latencyMode!==void 0&&!["quality","realtime"].includes(t.latencyMode))throw new TypeError("latencyMode, when provided, must be 'quality' or 'realtime'.");if(t.fullCodecString!==void 0&&typeof t.fullCodecString!="string")throw new TypeError("fullCodecString, when provided, must be a string.");if(t.fullCodecString!==void 0&&jh(t.fullCodecString)!==e)throw new TypeError(`fullCodecString, when provided, must be a string that matches the specified codec (${e}).`);if(t.hardwareAcceleration!==void 0&&!["no-preference","prefer-hardware","prefer-software"].includes(t.hardwareAcceleration))throw new TypeError("hardwareAcceleration, when provided, must be 'no-preference', 'prefer-hardware' or 'prefer-software'.");if(t.scalabilityMode!==void 0&&typeof t.scalabilityMode!="string")throw new TypeError("scalabilityMode, when provided, must be a string.");if(t.contentHint!==void 0&&typeof t.contentHint!="string")throw new TypeError("contentHint, when provided, must be a string.")},hl=e=>{const t=e.bitrate instanceof an?e.bitrate._toVideoBitrate(e.codec,e.width,e.height):e.bitrate;return{codec:e.fullCodecString??ag(e.codec,e.width,e.height,t),width:e.width,height:e.height,bitrate:t,bitrateMode:e.bitrateMode,alpha:e.alpha??"discard",framerate:e.framerate,latencyMode:e.latencyMode,hardwareAcceleration:e.hardwareAcceleration,scalabilityMode:e.scalabilityMode,contentHint:e.contentHint,...hg(e.codec)}},Jg=e=>{if(!e||typeof e!="object")throw new TypeError("Encoding config must be an object.");if(!nn.includes(e.codec))throw new TypeError(`Invalid audio codec '${e.codec}'. Must be one of: ${nn.join(", ")}.`);if(e.bitrate===void 0&&(!jt.includes(e.codec)||e.codec==="flac"))throw new TypeError("config.bitrate must be provided for compressed audio codecs.");if(e.bitrate!==void 0&&!(e.bitrate instanceof an)&&(!Number.isInteger(e.bitrate)||e.bitrate<=0))throw new TypeError("config.bitrate, when provided, must be a positive integer or a quality.");if(e.onEncodedPacket!==void 0&&typeof e.onEncodedPacket!="function")throw new TypeError("config.onEncodedChunk, when provided, must be a function.");if(e.onEncoderConfig!==void 0&&typeof e.onEncoderConfig!="function")throw new TypeError("config.onEncoderConfig, when provided, must be a function.");Uh(e.codec,e)},Uh=(e,t)=>{if(!t||typeof t!="object")throw new TypeError("Encoding options must be an object.");if(t.bitrateMode!==void 0&&!["constant","variable"].includes(t.bitrateMode))throw new TypeError("bitrateMode, when provided, must be 'constant' or 'variable'.");if(t.fullCodecString!==void 0&&typeof t.fullCodecString!="string")throw new TypeError("fullCodecString, when provided, must be a string.");if(t.fullCodecString!==void 0&&jh(t.fullCodecString)!==e)throw new TypeError(`fullCodecString, when provided, must be a string that matches the specified codec (${e}).`)},ml=e=>{const t=e.bitrate instanceof an?e.bitrate._toAudioBitrate(e.codec):e.bitrate;return{codec:e.fullCodecString??cg(e.codec,e.numberOfChannels,e.sampleRate),numberOfChannels:e.numberOfChannels,sampleRate:e.sampleRate,bitrate:t,bitrateMode:e.bitrateMode,...mg(e.codec)}};class an{constructor(t){this._factor=t}_toVideoBitrate(t,r,n){const i=r*n,s={avc:1,hevc:.6,vp9:.6,av1:.4,vp8:1.2},o=1920*1080,a=3e6,l=Math.pow(i/o,.95),f=a*l*s[t]*this._factor;return Math.ceil(f/1e3)*1e3}_toAudioBitrate(t){if(jt.includes(t)||t==="flac")return;const n={aac:128e3,opus:64e3,mp3:16e4,vorbis:64e3,ac3:384e3,eac3:192e3}[t];if(!n)throw new Error(`Unhandled codec: ${t}`);let i=n*this._factor;return t==="aac"?i=[96e3,128e3,16e4,192e3].reduce((o,a)=>Math.abs(a-i)<Math.abs(o-i)?a:o):t==="opus"||t==="vorbis"?i=Math.max(6e3,i):t==="mp3"&&(i=[8e3,16e3,24e3,32e3,4e4,48e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4].reduce((o,a)=>Math.abs(a-i)<Math.abs(o-i)?a:o)),Math.round(i/1e3)*1e3}}const ey=new an(2),ty=async(e,t={})=>{const{width:r=1280,height:n=720,bitrate:i=1e6,...s}=t;if(!_r.includes(e))return!1;if(!Number.isInteger(r)||r<=0)throw new TypeError("width must be a positive integer.");if(!Number.isInteger(n)||n<=0)throw new TypeError("height must be a positive integer.");if(!(i instanceof an)&&(!Number.isInteger(i)||i<=0))throw new TypeError("bitrate must be a positive integer or a quality.");Vh(e,s);let o=null;return ll.length>0&&(o??(o=hl({codec:e,width:r,height:n,bitrate:i,framerate:void 0,...s})),ll.some(l=>l.supports(e,o)))?!0:typeof VideoEncoder>"u"||(o??(o=hl({codec:e,width:r,height:n,bitrate:i,framerate:void 0,...s,alpha:"discard"})),!(await VideoEncoder.isConfigSupported(o)).supported)?!1:qs()?new Promise(async l=>{try{const c=new VideoEncoder({output:()=>{},error:()=>l(!1)});c.configure(o);const d=new Uint8Array(r*n*4),f=new VideoFrame(d,{format:"RGBA",codedWidth:r,codedHeight:n,timestamp:0});c.encode(f),f.close(),await c.flush(),l(!0)}catch{l(!1)}}):!0},ry=async(e,t={})=>{const{numberOfChannels:r=2,sampleRate:n=48e3,bitrate:i=128e3,...s}=t;if(!nn.includes(e))return!1;if(!Number.isInteger(r)||r<=0)throw new TypeError("numberOfChannels must be a positive integer.");if(!Number.isInteger(n)||n<=0)throw new TypeError("sampleRate must be a positive integer.");if(!(i instanceof an)&&(!Number.isInteger(i)||i<=0))throw new TypeError("bitrate must be a positive integer.");Uh(e,s);let o=null;return ul.length>0&&(o??(o=ml({codec:e,numberOfChannels:r,sampleRate:n,bitrate:i,...s})),ul.some(l=>l.supports(e,o)))||jt.includes(e)?!0:typeof AudioEncoder>"u"?!1:(o??(o=ml({codec:e,numberOfChannels:r,sampleRate:n,bitrate:i,...s})),(await AudioEncoder.isConfigSupported(o)).supported===!0)};/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */class fu{constructor(){this._connectedTrack=null,this._closingPromise=null,this._closed=!1,this._timestampOffset=0}_ensureValidAdd(){if(!this._connectedTrack)throw new Error("Source is not connected to an output track.");if(this._connectedTrack.output.state==="canceled")throw new Error("Output has been canceled.");if(this._connectedTrack.output.state==="finalizing"||this._connectedTrack.output.state==="finalized")throw new Error("Output has been finalized.");if(this._connectedTrack.output.state==="pending")throw new Error("Output has not started.");if(this._closed)throw new Error("Source is closed.")}async _start(){}async _flushAndClose(t){}close(){if(this._closingPromise)return;const t=this._connectedTrack;if(!t)throw new Error("Cannot call close without connecting the source to an output track.");if(t.output.state==="pending")throw new Error("Cannot call close before output has been started.");this._closingPromise=(async()=>{await this._flushAndClose(!1),this._closed=!0,!(t.output.state==="finalizing"||t.output.state==="finalized")&&t.output._muxer.onTrackClose(t)})()}async _flushOrWaitForOngoingClose(t){return this._closingPromise??(this._closingPromise=(async()=>{await this._flushAndClose(t),this._closed=!0})())}}class Lh extends fu{constructor(t){if(super(),this._connectedTrack=null,!_r.includes(t))throw new TypeError(`Invalid video codec '${t}'. Must be one of: ${_r.join(", ")}.`);this._codec=t}}class ny{constructor(t,r){this.source=t,this.encodingConfig=r,this.ensureEncoderPromise=null,this.encoderInitialized=!1,this.encoder=null,this.muxer=null,this.lastMultipleOfKeyFrameInterval=-1,this.codedWidth=null,this.codedHeight=null,this.resizeCanvas=null,this.customEncoder=null,this.customEncoderCallSerializer=new Th,this.customEncoderQueueSize=0,this.alphaEncoder=null,this.splitter=null,this.splitterCreationFailed=!1,this.alphaFrameQueue=[],this.error=null}async add(t,r,n){try{if(this.checkForEncoderError(),this.source._ensureValidAdd(),this.codedWidth!==null&&this.codedHeight!==null){if(t.codedWidth!==this.codedWidth||t.codedHeight!==this.codedHeight){const a=this.encodingConfig.sizeChangeBehavior??"deny";if(a!=="passThrough"){if(a==="deny")throw new Error(`Video sample size must remain constant. Expected ${this.codedWidth}x${this.codedHeight}, got ${t.codedWidth}x${t.codedHeight}. To allow the sample size to change over time, set \`sizeChangeBehavior\` to a value other than 'strict' in the encoding options.`);{let l=!1;this.resizeCanvas||(typeof document<"u"?(this.resizeCanvas=document.createElement("canvas"),this.resizeCanvas.width=this.codedWidth,this.resizeCanvas.height=this.codedHeight):this.resizeCanvas=new OffscreenCanvas(this.codedWidth,this.codedHeight),l=!0);const c=this.resizeCanvas.getContext("2d",{alpha:qs()});G(c),l||(qs()?(c.fillStyle="black",c.fillRect(0,0,this.codedWidth,this.codedHeight)):c.clearRect(0,0,this.codedWidth,this.codedHeight)),t.drawWithFit(c,{fit:a}),r&&t.close(),t=new Hr(this.resizeCanvas,{timestamp:t.timestamp,duration:t.duration,rotation:t.rotation}),r=!0}}}}else this.codedWidth=t.codedWidth,this.codedHeight=t.codedHeight;this.encoderInitialized||(this.ensureEncoderPromise||this.ensureEncoder(t),this.encoderInitialized||await this.ensureEncoderPromise),G(this.encoderInitialized);const i=this.encodingConfig.keyFrameInterval??5,s=Math.floor(t.timestamp/i),o={...n,keyFrame:(n==null?void 0:n.keyFrame)||i===0||s!==this.lastMultipleOfKeyFrameInterval};if(this.lastMultipleOfKeyFrameInterval=s,this.customEncoder){this.customEncoderQueueSize++;const a=t.clone(),l=this.customEncoderCallSerializer.call(()=>this.customEncoder.encode(a,o)).then(()=>this.customEncoderQueueSize--).catch(c=>this.error??(this.error=c)).finally(()=>{a.close()});this.customEncoderQueueSize>=4&&await l}else{G(this.encoder);const a=t.toVideoFrame();if(!this.alphaEncoder)this.encoder.encode(a,o),a.close();else if(!!a.format&&!a.format.includes("A")||this.splitterCreationFailed)this.alphaFrameQueue.push(null),this.encoder.encode(a,o),a.close();else{const c=a.displayWidth,d=a.displayHeight;if(!this.splitter)try{this.splitter=new iy(c,d)}catch(f){console.error("Due to an error, only color data will be encoded.",f),this.splitterCreationFailed=!0,this.alphaFrameQueue.push(null),this.encoder.encode(a,o),a.close()}if(this.splitter){const f=this.splitter.extractColor(a),y=this.splitter.extractAlpha(a);this.alphaFrameQueue.push(y),this.encoder.encode(f,o),f.close(),a.close()}}r&&t.close(),this.encoder.encodeQueueSize>=4&&await new Promise(l=>this.encoder.addEventListener("dequeue",l,{once:!0}))}await this.muxer.mutex.currentPromise}finally{r&&t.close()}}ensureEncoder(t){this.ensureEncoderPromise=(async()=>{var i,s,o;const r=hl({width:t.codedWidth,height:t.codedHeight,...this.encodingConfig,framerate:(i=this.source._connectedTrack)==null?void 0:i.metadata.frameRate});(o=(s=this.encodingConfig).onEncoderConfig)==null||o.call(s,r);const n=ll.find(a=>a.supports(this.encodingConfig.codec,r));if(n)this.customEncoder=new n,this.customEncoder.codec=this.encodingConfig.codec,this.customEncoder.config=r,this.customEncoder.onPacket=(a,l)=>{var c,d;if(!(a instanceof Er))throw new TypeError("The first argument passed to onPacket must be an EncodedPacket.");if(l!==void 0&&(!l||typeof l!="object"))throw new TypeError("The second argument passed to onPacket must be an object or undefined.");(d=(c=this.encodingConfig).onEncodedPacket)==null||d.call(c,a,l),this.muxer.addEncodedVideoPacket(this.source._connectedTrack,a,l).catch(f=>{this.error??(this.error=f)})},await this.customEncoder.init();else{if(typeof VideoEncoder>"u")throw new Error("VideoEncoder is not supported by this browser.");if(r.alpha="discard",this.encodingConfig.alpha==="keep"&&(r.latencyMode="quality"),(r.width%2===1||r.height%2===1)&&(this.encodingConfig.codec==="avc"||this.encodingConfig.codec==="hevc"))throw new Error(`The dimensions ${r.width}x${r.height} are not supported for codec '${this.encodingConfig.codec}'; both width and height must be even numbers. Make sure to round your dimensions to the nearest even number.`);if(!(await VideoEncoder.isConfigSupported(r)).supported)throw new Error(`This specific encoder configuration (${r.codec}, ${r.bitrate} bps, ${r.width}x${r.height}, hardware acceleration: ${r.hardwareAcceleration??"no-preference"}) is not supported by this browser. Consider using another codec or changing your video parameters.`);const c=[],d=[];let f=0,y=0;const b=(v,E,m)=>{var x,w;const h={};if(E){const S=new Uint8Array(E.byteLength);E.copyTo(S),h.alpha=S}const p=Er.fromEncodedChunk(v,h);(w=(x=this.encodingConfig).onEncodedPacket)==null||w.call(x,p,m),this.muxer.addEncodedVideoPacket(this.source._connectedTrack,p,m).catch(S=>{this.error??(this.error=S)})},k=new Error("Encoding error").stack;if(this.encoder=new VideoEncoder({output:(v,E)=>{if(!this.alphaEncoder){b(v,null,E);return}const m=this.alphaFrameQueue.shift();G(m!==void 0),m?(this.alphaEncoder.encode(m,{keyFrame:v.type==="key"}),y++,m.close(),c.push({chunk:v,meta:E})):y===0?b(v,null,E):(d.push(f+y),c.push({chunk:v,meta:E}))},error:v=>{v.stack=k,this.error??(this.error=v)}}),this.encoder.configure(r),this.encodingConfig.alpha==="keep"){const v=new Error("Encoding error").stack;this.alphaEncoder=new VideoEncoder({output:(E,m)=>{y--;const h=c.shift();for(G(h!==void 0),b(h.chunk,E,h.meta),f++;d.length>0&&d[0]===f;){d.shift();const p=c.shift();G(p!==void 0),b(p.chunk,null,p.meta)}},error:E=>{E.stack=v,this.error??(this.error=E)}}),this.alphaEncoder.configure(r)}}G(this.source._connectedTrack),this.muxer=this.source._connectedTrack.output._muxer,this.encoderInitialized=!0})()}async flushAndClose(t){var r,n;t||this.checkForEncoderError(),this.customEncoder?(t||this.customEncoderCallSerializer.call(()=>this.customEncoder.flush()),await this.customEncoderCallSerializer.call(()=>this.customEncoder.close())):this.encoder&&(t||(await this.encoder.flush(),await((r=this.alphaEncoder)==null?void 0:r.flush())),this.encoder.state!=="closed"&&this.encoder.close(),this.alphaEncoder&&this.alphaEncoder.state!=="closed"&&this.alphaEncoder.close(),this.alphaFrameQueue.forEach(i=>i==null?void 0:i.close()),(n=this.splitter)==null||n.close()),t||this.checkForEncoderError()}getQueueSize(){var t;return this.customEncoder?this.customEncoderQueueSize:((t=this.encoder)==null?void 0:t.encodeQueueSize)??0}checkForEncoderError(){if(this.error)throw this.error}}class iy{constructor(t,r){this.lastFrame=null,typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(t,r):(this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=r);const n=this.canvas.getContext("webgl2",{alpha:!0});if(!n)throw new Error("Couldn't acquire WebGL 2 context.");this.gl=n,this.colorProgram=this.createColorProgram(),this.alphaProgram=this.createAlphaProgram(),this.vao=this.createVAO(),this.sourceTexture=this.createTexture(),this.alphaResolutionLocation=this.gl.getUniformLocation(this.alphaProgram,"u_resolution"),this.gl.useProgram(this.colorProgram),this.gl.uniform1i(this.gl.getUniformLocation(this.colorProgram,"u_sourceTexture"),0),this.gl.useProgram(this.alphaProgram),this.gl.uniform1i(this.gl.getUniformLocation(this.alphaProgram,"u_sourceTexture"),0)}createVertexShader(){return this.createShader(this.gl.VERTEX_SHADER,`#version 300 es
			in vec2 a_position;
			in vec2 a_texCoord;
			out vec2 v_texCoord;
			
			void main() {
				gl_Position = vec4(a_position, 0.0, 1.0);
				v_texCoord = a_texCoord;
			}
		`)}createColorProgram(){const t=this.createVertexShader(),r=this.createShader(this.gl.FRAGMENT_SHADER,`#version 300 es
			precision highp float;
			
			uniform sampler2D u_sourceTexture;
			in vec2 v_texCoord;
			out vec4 fragColor;
			
			void main() {
				vec4 source = texture(u_sourceTexture, v_texCoord);
				fragColor = vec4(source.rgb, 1.0);
			}
		`),n=this.gl.createProgram();return this.gl.attachShader(n,t),this.gl.attachShader(n,r),this.gl.linkProgram(n),n}createAlphaProgram(){const t=this.createVertexShader(),r=this.createShader(this.gl.FRAGMENT_SHADER,`#version 300 es
			precision highp float;
			
			uniform sampler2D u_sourceTexture;
			uniform vec2 u_resolution; // The width and height of the canvas
			in vec2 v_texCoord;
			out vec4 fragColor;

			// This function determines the value for a single byte in the YUV stream
			float getByteValue(float byteOffset) {
				float width = u_resolution.x;
				float height = u_resolution.y;

				float yPlaneSize = width * height;

				if (byteOffset < yPlaneSize) {
					// This byte is in the luma plane. Find the corresponding pixel coordinates to sample from
					float y = floor(byteOffset / width);
					float x = mod(byteOffset, width);
					
					// Add 0.5 to sample the center of the texel
					vec2 sampleCoord = (vec2(x, y) + 0.5) / u_resolution;
					
					// The luma value is the alpha from the source texture
					return texture(u_sourceTexture, sampleCoord).a;
				} else {
					// Write a fixed value for chroma and beyond
					return 128.0 / 255.0;
				}
			}
			
			void main() {
				// Each fragment writes 4 bytes (R, G, B, A)
				float pixelIndex = floor(gl_FragCoord.y) * u_resolution.x + floor(gl_FragCoord.x);
				float baseByteOffset = pixelIndex * 4.0;

				vec4 result;
				for (int i = 0; i < 4; i++) {
					float currentByteOffset = baseByteOffset + float(i);
					result[i] = getByteValue(currentByteOffset);
				}
				
				fragColor = result;
			}
		`),n=this.gl.createProgram();return this.gl.attachShader(n,t),this.gl.attachShader(n,r),this.gl.linkProgram(n),n}createShader(t,r){const n=this.gl.createShader(t);return this.gl.shaderSource(n,r),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)||console.error("Shader compile error:",this.gl.getShaderInfoLog(n)),n}createVAO(){const t=this.gl.createVertexArray();this.gl.bindVertexArray(t);const r=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),n=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,r,this.gl.STATIC_DRAW);const i=this.gl.getAttribLocation(this.colorProgram,"a_position"),s=this.gl.getAttribLocation(this.colorProgram,"a_texCoord");return this.gl.enableVertexAttribArray(i),this.gl.vertexAttribPointer(i,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(s),this.gl.vertexAttribPointer(s,2,this.gl.FLOAT,!1,16,8),t}createTexture(){const t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),t}updateTexture(t){this.lastFrame!==t&&((t.displayWidth!==this.canvas.width||t.displayHeight!==this.canvas.height)&&(this.canvas.width=t.displayWidth,this.canvas.height=t.displayHeight),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.sourceTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.lastFrame=t)}extractColor(t){return this.updateTexture(t),this.gl.useProgram(this.colorProgram),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindVertexArray(this.vao),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),new VideoFrame(this.canvas,{timestamp:t.timestamp,duration:t.duration??void 0,alpha:"discard"})}extractAlpha(t){this.updateTexture(t),this.gl.useProgram(this.alphaProgram),this.gl.uniform2f(this.alphaResolutionLocation,this.canvas.width,this.canvas.height),this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.bindVertexArray(this.vao),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const{width:r,height:n}=this.canvas,i=Math.ceil(r/2)*Math.ceil(n/2),s=r*n+i*2,o=Math.ceil(s/(r*4));let a=new Uint8Array(4*r*o);this.gl.readPixels(0,0,r,o,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),a=a.subarray(0,s),G(a[r*n]===128),G(a[a.length-1]===128);const l={format:"I420",codedWidth:r,codedHeight:n,timestamp:t.timestamp,duration:t.duration??void 0,transfer:[a.buffer]};return new VideoFrame(a,l)}close(){var t;(t=this.gl.getExtension("WEBGL_lose_context"))==null||t.loseContext(),this.gl=null}}class sy extends Lh{constructor(t,r){if(!(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement)&&!(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas))throw new TypeError("canvas must be an HTMLCanvasElement or OffscreenCanvas.");Zg(r),super(r.codec),this._encoder=new ny(this,r),this._canvas=t}add(t,r=0,n){if(!Number.isFinite(t)||t<0)throw new TypeError("timestamp must be a non-negative number.");if(!Number.isFinite(r)||r<0)throw new TypeError("duration must be a non-negative number.");const i=new Hr(this._canvas,{timestamp:t,duration:r});return this._encoder.add(i,!0,n)}_flushAndClose(t){return this._encoder.flushAndClose(t)}}class Bh extends fu{constructor(t){if(super(),this._connectedTrack=null,!nn.includes(t))throw new TypeError(`Invalid audio codec '${t}'. Must be one of: ${nn.join(", ")}.`);this._codec=t}}class oy{constructor(t,r){this.source=t,this.encodingConfig=r,this.ensureEncoderPromise=null,this.encoderInitialized=!1,this.encoder=null,this.muxer=null,this.lastNumberOfChannels=null,this.lastSampleRate=null,this.isPcmEncoder=!1,this.outputSampleSize=null,this.writeOutputValue=null,this.customEncoder=null,this.customEncoderCallSerializer=new Th,this.customEncoderQueueSize=0,this.lastEndSampleIndex=null,this.error=null}async add(t,r){try{if(this.checkForEncoderError(),this.source._ensureValidAdd(),this.lastNumberOfChannels!==null&&this.lastSampleRate!==null){if(t.numberOfChannels!==this.lastNumberOfChannels||t.sampleRate!==this.lastSampleRate)throw new Error(`Audio parameters must remain constant. Expected ${this.lastNumberOfChannels} channels at ${this.lastSampleRate} Hz, got ${t.numberOfChannels} channels at ${t.sampleRate} Hz.`)}else this.lastNumberOfChannels=t.numberOfChannels,this.lastSampleRate=t.sampleRate;this.encoderInitialized||(this.ensureEncoderPromise||this.ensureEncoder(t),this.encoderInitialized||await this.ensureEncoderPromise),G(this.encoderInitialized);{const n=Math.round(t.timestamp*t.sampleRate),i=Math.round((t.timestamp+t.duration)*t.sampleRate);if(this.lastEndSampleIndex===null)this.lastEndSampleIndex=i;else{const s=n-this.lastEndSampleIndex;if(s>=64){const o=new mr({data:new Float32Array(s*t.numberOfChannels),format:"f32-planar",sampleRate:t.sampleRate,numberOfChannels:t.numberOfChannels,numberOfFrames:s,timestamp:this.lastEndSampleIndex/t.sampleRate});await this.add(o,!0)}this.lastEndSampleIndex+=t.numberOfFrames}}if(this.customEncoder){this.customEncoderQueueSize++;const n=t.clone(),i=this.customEncoderCallSerializer.call(()=>this.customEncoder.encode(n)).then(()=>this.customEncoderQueueSize--).catch(s=>this.error??(this.error=s)).finally(()=>{n.close()});this.customEncoderQueueSize>=4&&await i,await this.muxer.mutex.currentPromise}else if(this.isPcmEncoder)await this.doPcmEncoding(t,r);else{G(this.encoder);const n=t.toAudioData();this.encoder.encode(n),n.close(),r&&t.close(),this.encoder.encodeQueueSize>=4&&await new Promise(i=>this.encoder.addEventListener("dequeue",i,{once:!0})),await this.muxer.mutex.currentPromise}}finally{r&&t.close()}}async doPcmEncoding(t,r){var y,b;G(this.outputSampleSize),G(this.writeOutputValue);const{numberOfChannels:n,numberOfFrames:i,sampleRate:s,timestamp:o}=t,a=2048,l=[];for(let k=0;k<i;k+=a){const v=Math.min(a,t.numberOfFrames-k),E=v*n*this.outputSampleSize,m=new ArrayBuffer(E),h=new DataView(m);l.push({frameCount:v,view:h})}const c=t.allocationSize({planeIndex:0,format:"f32-planar"}),d=new Float32Array(c/Float32Array.BYTES_PER_ELEMENT);for(let k=0;k<n;k++){t.copyTo(d,{planeIndex:k,format:"f32-planar"});for(let v=0;v<l.length;v++){const{frameCount:E,view:m}=l[v];for(let h=0;h<E;h++)this.writeOutputValue(m,(h*n+k)*this.outputSampleSize,d[v*a+h])}}r&&t.close();const f={decoderConfig:{codec:this.encodingConfig.codec,numberOfChannels:n,sampleRate:s}};for(let k=0;k<l.length;k++){const{frameCount:v,view:E}=l[k],m=E.buffer,h=k*a,p=new Er(new Uint8Array(m),"key",o+h/s,v/s);(b=(y=this.encodingConfig).onEncodedPacket)==null||b.call(y,p,f),await this.muxer.addEncodedAudioPacket(this.source._connectedTrack,p,f)}}ensureEncoder(t){this.ensureEncoderPromise=(async()=>{var o,a;const{numberOfChannels:r,sampleRate:n}=t,i=ml({numberOfChannels:r,sampleRate:n,...this.encodingConfig});(a=(o=this.encodingConfig).onEncoderConfig)==null||a.call(o,i);const s=ul.find(l=>l.supports(this.encodingConfig.codec,i));if(s)this.customEncoder=new s,this.customEncoder.codec=this.encodingConfig.codec,this.customEncoder.config=i,this.customEncoder.onPacket=(l,c)=>{var d,f;if(!(l instanceof Er))throw new TypeError("The first argument passed to onPacket must be an EncodedPacket.");if(c!==void 0&&(!c||typeof c!="object"))throw new TypeError("The second argument passed to onPacket must be an object or undefined.");(f=(d=this.encodingConfig).onEncodedPacket)==null||f.call(d,l,c),this.muxer.addEncodedAudioPacket(this.source._connectedTrack,l,c).catch(y=>{this.error??(this.error=y)})},await this.customEncoder.init();else if(jt.includes(this.encodingConfig.codec))this.initPcmEncoder();else{if(typeof AudioEncoder>"u")throw new Error("AudioEncoder is not supported by this browser.");if(!(await AudioEncoder.isConfigSupported(i)).supported)throw new Error(`This specific encoder configuration (${i.codec}, ${i.bitrate} bps, ${i.numberOfChannels} channels, ${i.sampleRate} Hz) is not supported by this browser. Consider using another codec or changing your audio parameters.`);const c=new Error("Encoding error").stack;this.encoder=new AudioEncoder({output:(d,f)=>{var b,k;if(this.encodingConfig.codec==="aac"&&(f!=null&&f.decoderConfig)){let v=!1;if(!f.decoderConfig.description||f.decoderConfig.description.byteLength<2?v=!0:v=dg(Yr(f.decoderConfig.description)).objectType===0,v){const E=Number(ui(i.codec.split(".")));f.decoderConfig.description=Ph({objectType:E,numberOfChannels:f.decoderConfig.numberOfChannels,sampleRate:f.decoderConfig.sampleRate})}}const y=Er.fromEncodedChunk(d);(k=(b=this.encodingConfig).onEncodedPacket)==null||k.call(b,y,f),this.muxer.addEncodedAudioPacket(this.source._connectedTrack,y,f).catch(v=>{this.error??(this.error=v)})},error:d=>{d.stack=c,this.error??(this.error=d)}}),this.encoder.configure(i)}G(this.source._connectedTrack),this.muxer=this.source._connectedTrack.output._muxer,this.encoderInitialized=!0})()}initPcmEncoder(){this.isPcmEncoder=!0;const t=this.encodingConfig.codec,{dataType:r,sampleSize:n,littleEndian:i}=Ah(t);switch(this.outputSampleSize=n,n){case 1:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint8(o,qe((a+1)*127.5,0,255)):r==="signed"?this.writeOutputValue=(s,o,a)=>{s.setInt8(o,qe(Math.round(a*128),-128,127))}:r==="ulaw"?this.writeOutputValue=(s,o,a)=>{const l=qe(Math.floor(a*32767),-32768,32767);s.setUint8(o,Sg(l))}:r==="alaw"?this.writeOutputValue=(s,o,a)=>{const l=qe(Math.floor(a*32767),-32768,32767);s.setUint8(o,Tg(l))}:G(!1);break;case 2:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint16(o,qe((a+1)*32767.5,0,65535),i):r==="signed"?this.writeOutputValue=(s,o,a)=>s.setInt16(o,qe(Math.round(a*32767),-32768,32767),i):G(!1);break;case 3:r==="unsigned"?this.writeOutputValue=(s,o,a)=>Sh(s,o,qe((a+1)*83886075e-1,0,16777215),i):r==="signed"?this.writeOutputValue=(s,o,a)=>K0(s,o,qe(Math.round(a*8388607),-8388608,8388607),i):G(!1);break;case 4:r==="unsigned"?this.writeOutputValue=(s,o,a)=>s.setUint32(o,qe((a+1)*21474836475e-1,0,4294967295),i):r==="signed"?this.writeOutputValue=(s,o,a)=>s.setInt32(o,qe(Math.round(a*2147483647),-2147483648,2147483647),i):r==="float"?this.writeOutputValue=(s,o,a)=>s.setFloat32(o,a,i):G(!1);break;case 8:r==="float"?this.writeOutputValue=(s,o,a)=>s.setFloat64(o,a,i):G(!1);break;default:wo(n),G(!1)}}async flushAndClose(t){t||this.checkForEncoderError(),this.customEncoder?(t||this.customEncoderCallSerializer.call(()=>this.customEncoder.flush()),await this.customEncoderCallSerializer.call(()=>this.customEncoder.close())):this.encoder&&(t||await this.encoder.flush(),this.encoder.state!=="closed"&&this.encoder.close()),t||this.checkForEncoderError()}getQueueSize(){var t;return this.customEncoder?this.customEncoderQueueSize:this.isPcmEncoder?0:((t=this.encoder)==null?void 0:t.encodeQueueSize)??0}checkForEncoderError(){if(this.error)throw this.error}}class ay extends Bh{get errorPromise(){return this._errorPromiseAccessed=!0,this._promiseWithResolvers.promise}get paused(){return this._paused}constructor(t,r){if(!(t instanceof MediaStreamTrack)||t.kind!=="audio")throw new TypeError("track must be an audio MediaStreamTrack.");Jg(r),super(r.codec),this._abortController=null,this._audioContext=null,this._scriptProcessorNode=null,this._promiseWithResolvers=Eh(),this._errorPromiseAccessed=!1,this._paused=!1,this._lastSampleTimestamp=null,this._pauseOffset=0,this._encoder=new oy(this,r),this._track=t}async _start(){this._errorPromiseAccessed||console.warn("Make sure not to ignore the `errorPromise` field on MediaStreamVideoTrackSource, so that any internal errors get bubbled up properly."),this._abortController=new AbortController;let t=null,r=!1;const n=i=>{if(r){i.close();return}const s=i.timestamp;if(this._paused){if(t!==null){if(this._lastSampleTimestamp!==null){const a=s-this._lastSampleTimestamp;this._pauseOffset-=a}this._lastSampleTimestamp=s}i.close();return}if(t===null){t=i.timestamp;const o=this._connectedTrack.output._muxer;o.firstMediaStreamTimestamp===null?(o.firstMediaStreamTimestamp=performance.now()/1e3,this._timestampOffset=-t):this._timestampOffset=performance.now()/1e3-o.firstMediaStreamTimestamp-t}if(this._lastSampleTimestamp=s,this._encoder.getQueueSize()>=4){i.close();return}i.setTimestamp(s+this._pauseOffset),this._encoder.add(i,!0).catch(o=>{var a,l;r=!0,(a=this._abortController)==null||a.abort(),this._promiseWithResolvers.reject(o),(l=this._audioContext)==null||l.suspend()})};if(typeof MediaStreamTrackProcessor<"u"){const i=new MediaStreamTrackProcessor({track:this._track}),s=new WritableStream({write:o=>n(new mr(o))});i.readable.pipeTo(s,{signal:this._abortController.signal}).catch(o=>{o instanceof DOMException&&o.name==="AbortError"||this._promiseWithResolvers.reject(o)})}else{const i=window.AudioContext||window.webkitAudioContext;this._audioContext=new i({sampleRate:this._track.getSettings().sampleRate});const s=this._audioContext.createMediaStreamSource(new MediaStream([this._track]));this._scriptProcessorNode=this._audioContext.createScriptProcessor(4096),this._audioContext.state==="suspended"&&await this._audioContext.resume(),s.connect(this._scriptProcessorNode),this._scriptProcessorNode.connect(this._audioContext.destination);let o=0;this._scriptProcessorNode.onaudioprocess=a=>{const l=mr._fromAudioBuffer(a.inputBuffer,o);o+=a.inputBuffer.duration;for(const c of l)n(c)}}}pause(){this._paused=!0}resume(){this._paused=!1}async _flushAndClose(t){this._abortController&&(this._abortController.abort(),this._abortController=null),this._audioContext&&(G(this._scriptProcessorNode),this._scriptProcessorNode.disconnect(),await this._audioContext.suspend()),await this._encoder.flushAndClose(t)}}class ly extends fu{constructor(t){if(super(),this._connectedTrack=null,!zi.includes(t))throw new TypeError(`Invalid subtitle codec '${t}'. Must be one of: ${zi.join(", ")}.`);this._codec=t}}/*!
 * Copyright (c) 2026-present, Vanilagy and contributors
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const uy=["video","audio","subtitle"],ca=e=>{if(!e||typeof e!="object")throw new TypeError("metadata must be an object.");if(e.languageCode!==void 0&&!Z0(e.languageCode))throw new TypeError("metadata.languageCode, when provided, must be a three-letter, ISO 639-2/T language code.");if(e.name!==void 0&&typeof e.name!="string")throw new TypeError("metadata.name, when provided, must be a string.");if(e.disposition!==void 0&&og(e.disposition),e.maximumPacketCount!==void 0&&(!Number.isInteger(e.maximumPacketCount)||e.maximumPacketCount<0))throw new TypeError("metadata.maximumPacketCount, when provided, must be a non-negative integer.")};class cy{constructor(t){if(this.state="pending",this._tracks=[],this._startPromise=null,this._cancelPromise=null,this._finalizePromise=null,this._mutex=new Ch,this._metadataTags={},!t||typeof t!="object")throw new TypeError("options must be an object.");if(!(t.format instanceof zh))throw new TypeError("options.format must be an OutputFormat.");if(!(t.target instanceof Fh))throw new TypeError("options.target must be a Target.");if(t.target._output)throw new Error("Target is already used for another output.");t.target._output=this,this.format=t.format,this.target=t.target,this._writer=t.target._createWriter(),this._muxer=t.format._createMuxer(this)}addVideoTrack(t,r={}){if(!(t instanceof Lh))throw new TypeError("source must be a VideoSource.");if(ca(r),r.rotation!==void 0&&![0,90,180,270].includes(r.rotation))throw new TypeError(`Invalid video rotation: ${r.rotation}. Has to be 0, 90, 180 or 270.`);if(!this.format.supportsVideoRotationMetadata&&r.rotation)throw new Error(`${this.format._name} does not support video rotation metadata.`);if(r.frameRate!==void 0&&(!Number.isFinite(r.frameRate)||r.frameRate<=0))throw new TypeError(`Invalid video frame rate: ${r.frameRate}. Must be a positive number.`);this._addTrack("video",t,r)}addAudioTrack(t,r={}){if(!(t instanceof Bh))throw new TypeError("source must be an AudioSource.");ca(r),this._addTrack("audio",t,r)}addSubtitleTrack(t,r={}){if(!(t instanceof ly))throw new TypeError("source must be a SubtitleSource.");ca(r),this._addTrack("subtitle",t,r)}setMetadataTags(t){if(sg(t),this.state!=="pending")throw new Error("Cannot set metadata tags after output has been started or canceled.");this._metadataTags=t}_addTrack(t,r,n){if(this.state!=="pending")throw new Error("Cannot add track after output has been started or canceled.");if(r._connectedTrack)throw new Error("Source is already used for a track.");const i=this.format.getSupportedTrackCounts(),s=this._tracks.reduce((c,d)=>c+(d.type===t?1:0),0),o=i[t].max;if(s===o)throw new Error(o===0?`${this.format._name} does not support ${t} tracks.`:`${this.format._name} does not support more than ${o} ${t} track${o===1?"":"s"}.`);const a=i.total.max;if(this._tracks.length===a)throw new Error(`${this.format._name} does not support more than ${a} tracks${a===1?"":"s"} in total.`);const l={id:this._tracks.length+1,output:this,type:t,source:r,metadata:n};if(l.type==="video"){const c=this.format.getSupportedVideoCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support video tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported video codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}else if(l.type==="audio"){const c=this.format.getSupportedAudioCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support audio tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported audio codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}else if(l.type==="subtitle"){const c=this.format.getSupportedSubtitleCodecs();if(c.length===0)throw new Error(`${this.format._name} does not support subtitle tracks.`+this.format._codecUnsupportedHint(l.source._codec));if(!c.includes(l.source._codec))throw new Error(`Codec '${l.source._codec}' cannot be contained within ${this.format._name}. Supported subtitle codecs are: ${c.map(d=>`'${d}'`).join(", ")}.`+this.format._codecUnsupportedHint(l.source._codec))}this._tracks.push(l),r._connectedTrack=l}async start(){const t=this.format.getSupportedTrackCounts();for(const n of uy){const i=this._tracks.reduce((o,a)=>o+(a.type===n?1:0),0),s=t[n].min;if(i<s)throw new Error(s===t[n].max?`${this.format._name} requires exactly ${s} ${n} track${s===1?"":"s"}.`:`${this.format._name} requires at least ${s} ${n} track${s===1?"":"s"}.`)}const r=t.total.min;if(this._tracks.length<r)throw new Error(r===t.total.max?`${this.format._name} requires exactly ${r} track${r===1?"":"s"}.`:`${this.format._name} requires at least ${r} track${r===1?"":"s"}.`);if(this.state==="canceled")throw new Error("Output has been canceled.");return this._startPromise?(console.warn("Output has already been started."),this._startPromise):this._startPromise=(async()=>{this.state="started",this._writer.start();const n=await this._mutex.acquire();await this._muxer.start();const i=this._tracks.map(s=>s.source._start());await Promise.all(i),n()})()}getMimeType(){return this._muxer.getMimeType()}async cancel(){if(this._cancelPromise)return console.warn("Output has already been canceled."),this._cancelPromise;if(this.state==="finalizing"||this.state==="finalized"){console.warn("Output has already been finalized.");return}return this._cancelPromise=(async()=>{this.state="canceled";const t=await this._mutex.acquire(),r=this._tracks.map(n=>n.source._flushOrWaitForOngoingClose(!0));await Promise.all(r),await this._writer.close(),t()})()}async finalize(){if(this.state==="pending")throw new Error("Cannot finalize before starting.");if(this.state==="canceled")throw new Error("Cannot finalize after canceling.");return this._finalizePromise?(console.warn("Output has already been finalized."),this._finalizePromise):this._finalizePromise=(async()=>{this.state="finalizing";const t=await this._mutex.acquire(),r=this._tracks.map(n=>n.source._flushOrWaitForOngoingClose(!1));await Promise.all(r),await this._muxer.finalize(),await this._writer.flush(),await this._writer.finalize(),this.state="finalized",t()})()}}const pl={status:"idle",duration:0,blob:null,pauseRecording:()=>{},resumeRecording:()=>{},stopRecording:()=>{}},Wh=g.createContext({recording:pl,setRecording:()=>{},dismissRecording:()=>{},openInAnalyzerBlob:null,openRecordingInAnalyzer:()=>{},clearOpenInAnalyzer:()=>{}});function dy({children:e}){const[t,r]=g.useState(pl),[n,i]=g.useState(null),s=g.useCallback(c=>{r(d=>({...d,...c}))},[]),o=g.useCallback(()=>{r(pl)},[]),a=g.useCallback(c=>{i(c)},[]),l=g.useCallback(()=>{i(null)},[]);return u.jsx(Wh.Provider,{value:{recording:t,setRecording:s,dismissRecording:o,openInAnalyzerBlob:n,openRecordingInAnalyzer:a,clearOpenInAnalyzer:l},children:e})}function vo(){return g.useContext(Wh)}function qr(e){const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function fy({onBack:e,hidden:t=!1,onRecordingComplete:r}){var Xi;const{setRecording:n,recording:i}=vo(),[s,o]=g.useState("idle"),[a,l]=g.useState(0),[c,d]=g.useState(!0),[f,y]=g.useState(!0),[b,k]=g.useState([]),[v,E]=g.useState([]),[m,h]=g.useState(""),[p,x]=g.useState(""),[w,S]=g.useState(null),[T,_]=g.useState(null),[A,z]=g.useState(null),[I,j]=g.useState(null),[M,O]=g.useState(null),[H,B]=g.useState(null),[ne,F]=g.useState("top-right"),[Q,X]=g.useState(!0),re=g.useRef(null),Z=g.useRef(null),Ke=g.useRef([]),W=g.useRef(null),ae=g.useRef(null),ee=g.useRef([]),Y=g.useRef(null),xe=g.useRef(null),we=g.useRef(null),Ue=g.useRef(0),kt=g.useRef(0),Pe=g.useRef(0),Dt=g.useRef(null),Ar=g.useRef(null),er=g.useRef(null),Wn=g.useRef(ne),De=g.useRef(!1),jr=g.useRef(0),Dr=g.useRef(r);Wn.current=ne,jr.current=a,Dr.current=r;const $n=g.useRef(!1),Hn=g.useRef(!1),de=g.useRef(null),It=g.useRef(null),Le=g.useRef(null),Ce=g.useRef(null),Ir=g.useRef(-1),Ot=g.useRef(!1),Qn=g.useRef(()=>{}),Mt=g.useCallback(async()=>{if(!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{const P=await navigator.mediaDevices.enumerateDevices();if(k(P.filter(V=>V.kind==="videoinput").map(V=>({deviceId:V.deviceId,label:V.label||`Camera ${V.deviceId.slice(0,8)}`,kind:V.kind}))),E(P.filter(V=>V.kind==="audioinput").map(V=>({deviceId:V.deviceId,label:V.label||`Microphone ${V.deviceId.slice(0,8)}`,kind:V.kind}))),P.length&&!$n.current){const V=P.find(C=>C.kind==="videoinput");V&&(h(V.deviceId),$n.current=!0)}if(P.length&&!Hn.current){const V=P.find(C=>C.kind==="audioinput");V&&(x(V.deviceId),Hn.current=!0)}}catch(P){console.error("Failed to enumerate devices:",P);const V=P instanceof Error?P.message:"Could not list devices";O(`Could not list devices: ${V}`)}},[]);g.useEffect(()=>{Mt()},[Mt]),g.useEffect(()=>{if(!navigator.mediaDevices)return;const P=()=>Mt();return navigator.mediaDevices.addEventListener("devicechange",P),()=>navigator.mediaDevices.removeEventListener("devicechange",P)},[Mt]),g.useEffect(()=>{if(s!=="recording"&&s!=="paused")return;const P=V=>{V.preventDefault()};return window.addEventListener("beforeunload",P),()=>window.removeEventListener("beforeunload",P)},[s]),g.useEffect(()=>{if(H===null||H<=0)return;const P=setTimeout(()=>B(V=>(V??0)-1),1e3);return()=>clearTimeout(P)},[H]),Dt.current=w,Ar.current=T,er.current=A;const ln=g.useCallback(()=>{w==null||w.getTracks().forEach(P=>P.stop()),T==null||T.getTracks().forEach(P=>P.stop()),A==null||A.getTracks().forEach(P=>P.stop()),S(null),_(null),z(null)},[w,T,A]);g.useEffect(()=>()=>{var C,R,U;(C=Dt.current)==null||C.getTracks().forEach($=>$.stop()),(R=Ar.current)==null||R.getTracks().forEach($=>$.stop()),(U=er.current)==null||U.getTracks().forEach($=>$.stop()),Y.current&&(clearInterval(Y.current),Y.current=null),xe.current&&(clearInterval(xe.current),xe.current=null),Ce.current&&(clearInterval(Ce.current),Ce.current=null),we.current!=null&&(cancelAnimationFrame(we.current),we.current=null);const P=Z.current;if((P==null?void 0:P.state)!=="inactive")try{P==null||P.stop()}catch{}const V=de.current;V&&V.state!=="canceled"&&V.state!=="finalized"&&(V.cancel(),de.current=null)},[]);const xo=g.useCallback(async()=>{if(O(null),!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{T==null||T.getTracks().forEach(V=>V.stop());const P=await navigator.mediaDevices.getUserMedia({video:{width:320,height:240,facingMode:"user",deviceId:m||void 0}});_(P),W.current&&(W.current.srcObject=P),await Mt()}catch(P){console.error("Failed to connect camera:",P);const V=P instanceof Error?P.message:"Could not access camera";O(`Camera: ${V}`),_(null)}},[m,T,Mt]),ko=g.useCallback(()=>{T==null||T.getTracks().forEach(P=>P.stop()),_(null),W.current&&(W.current.srcObject=null)},[T]),bo=g.useCallback(async()=>{if(O(null),!navigator.mediaDevices){O("Media devices are not available. Use HTTPS or localhost.");return}try{A==null||A.getTracks().forEach(V=>V.stop());const P=await navigator.mediaDevices.getUserMedia({audio:{deviceId:p||void 0}});z(P),await Mt()}catch(P){console.error("Failed to connect microphone:",P);const V=P instanceof Error?P.message:"Could not access microphone";O(`Microphone: ${V}`),z(null)}},[p,A,Mt]),Hi=g.useCallback(()=>{A==null||A.getTracks().forEach(P=>P.stop()),z(null)},[A]);g.useEffect(()=>{const P=ae.current;!P||!w||P.srcObject!==w&&(P.srcObject=w,P.play().catch(()=>{}))},[w]);const Co=g.useCallback(async()=>{var P;if(O(null),!((P=navigator.mediaDevices)!=null&&P.getDisplayMedia)){O("Screen sharing is not supported in this browser. Try Chrome, Edge, or Firefox.");return}try{w==null||w.getTracks().forEach(C=>C.stop());let V;try{V=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0})}catch(C){if((C instanceof Error?C.message:String(C)).toLowerCase().includes("not supported"))V=await navigator.mediaDevices.getDisplayMedia({video:!0});else throw C}S(V),V.getVideoTracks()[0].onended=()=>{S(null)}}catch(V){console.error("Failed to connect screen:",V);const C=V instanceof Error?V.message:"Could not share screen",R=C.toLowerCase().includes("not supported")||C.toLowerCase().includes("not allowed")?" Screen sharing requires HTTPS (or localhost) and a supported browser (Chrome, Edge, Firefox, Safari).":"";O(`Could not share screen.${R}`),S(null)}},[w]),Eo=g.useCallback(()=>{w==null||w.getTracks().forEach(P=>P.stop()),S(null)},[w]),un=g.useCallback(async()=>{O(null),o("connecting");let P=w,V=null;c&&(T!=null&&T.active)&&T.getVideoTracks().length&&(V=T);let C=f?A:null;try{if(!P){try{P=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0})}catch{P=await navigator.mediaDevices.getDisplayMedia({video:!0})}S(P)}if(!(P!=null&&P.getVideoTracks().length)){O("Could not capture screen. Make sure you selected a window or screen to share."),o("idle");return}if(P.getVideoTracks()[0].onended=()=>{var J;if(Ot.current&&((J=de.current)==null?void 0:J.state)==="started")Qn.current();else{const ie=Z.current;((ie==null?void 0:ie.state)==="recording"||(ie==null?void 0:ie.state)==="paused")&&ie.stop()}},c&&!V)try{V=await navigator.mediaDevices.getUserMedia({video:{width:320,height:240,facingMode:"user",deviceId:m||void 0}}),_(V)}catch(J){V=null;const ie=J instanceof Error?J.message:"Could not access camera";O(`${ie} (camera may be in use by another app). Recording without face camera.`)}f&&!C&&(C=await navigator.mediaDevices.getUserMedia({audio:{deviceId:p||void 0}}),z(C));const R=document.createElement("video");R.srcObject=P,R.muted=!0,await R.play(),R.readyState<2&&await new Promise(J=>{R.onloadeddata=()=>J(),setTimeout(J,500)});const U=re.current;if(!U){O("Recording canvas not ready. Please try again."),o("idle");return}const $=U.getContext("2d");if(!$){O("Could not initialize recording canvas."),o("idle");return}const ke=P.getVideoTracks();if(!ke.length){O("No video track from screen share."),o("idle"),ln();return}const Te=ke[0];if(Te.readyState!=="live"||!Te.enabled){O("Screen track is not active. Cancel and choose a different window or screen to share."),o("idle"),ln();return}const{width:Ct,height:nt}=Te.getSettings();U.width=Ct||1920,U.height=nt||1080;const Ie=document.createElement("video");V&&(Ie.srcObject=V,Ie.muted=!0,await Ie.play(),Ie.readyState<2&&await new Promise(J=>{Ie.onloadeddata=()=>J(),setTimeout(J,300)}));const mt=new AudioContext;mt.state==="suspended"&&await mt.resume();const Bt=mt.createMediaStreamDestination();if(P.getAudioTracks().length&&mt.createMediaStreamSource(new MediaStream(P.getAudioTracks())).connect(Bt),C&&mt.createMediaStreamSource(C).connect(Bt),Bt.stream.getAudioTracks().length===0){const J=mt.createOscillator(),ie=mt.createGain();ie.gain.value=0,J.connect(ie),ie.connect(Bt),J.start()}const mu=Bt.stream.getAudioTracks().length>0,Xn=30;let To=!1;try{const[J,ie]=await Promise.all([ty("vp9",{width:U.width,height:U.height,bitrate:25e5}),mu?ry("opus",{bitrate:128e3}):Promise.resolve(!0)]);To=J&&ie}catch{To=!1}Ot.current=To;const Ki=16,$h=.2,pu=()=>{if(R.readyState>=2&&($.drawImage(R,0,0,U.width,U.height),V&&Ie.readyState>=2)){const J=Math.floor(U.width*$h),ie=Math.floor(J*(Ie.videoHeight/Ie.videoWidth)),Be=Wn.current,Et=Be==="top-right"||Be==="bottom-right"?U.width-J-Ki:Ki,Oe=Be==="top-right"||Be==="top-left"?Ki:U.height-ie-Ki;$.fillStyle="rgba(0,0,0,0.4)",$.fillRect(Et-4,Oe-4,J+8,ie+8),$.drawImage(Ie,Et,Oe,J,ie)}};pu();const _o=()=>{var Be,Et,Oe;pu();const J=((Be=Z.current)==null?void 0:Be.state)==="recording"||((Et=Z.current)==null?void 0:Et.state)==="paused",ie=Ot.current&&((Oe=de.current)==null?void 0:Oe.state)==="started";(J||ie)&&(we.current=requestAnimationFrame(_o))},gu=()=>Math.floor((performance.now()-Ue.current-kt.current)/1e3),Hh=(J,ie)=>{j(J),o("stopped"),n({status:"stopped",duration:ie,blob:J});const Be=Dr.current;Be&&Be(J,ie)};if(Ue.current=performance.now(),l(0),o("recording"),ee.current=[P],V&&ee.current.push(V),C&&ee.current.push(C),Y.current=setInterval(()=>l(gu()),200),Ot.current){const J=new cy({format:new fl,target:new Gg});de.current=J;const ie=new sy(U,{codec:"vp9",bitrate:ey,keyFrameInterval:1,latencyMode:"realtime"});It.current=ie,J.addVideoTrack(ie,{frameRate:Xn});const Be=Bt.stream.getAudioTracks()[0];if(Be){const Mr=new ay(Be,{codec:"opus",bitrate:128e3});Le.current=Mr,Mr.errorPromise.catch(fe=>{console.error("Mediabunny audio error:",fe),O(`Recording failed: ${fe instanceof Error?fe.message:String(fe)}`)}),J.addAudioTrack(Mr)}await J.start(),_o();let Et=!0;Ir.current=-1;const Oe=async()=>{var Fr;if(!Et||((Fr=de.current)==null?void 0:Fr.state)!=="started")return;const Mr=(performance.now()-Ue.current-kt.current)/1e3,fe=Math.round(Mr*Xn);if(fe===Ir.current)return;Ir.current=fe;const Ye=fe/Xn;Et=!1;try{await ie.add(Ye,1/Xn)}catch(cn){console.error("Frame capture error:",cn)}Et=!0};Ce.current=setInterval(()=>void Oe().catch(console.error),1e3/Xn),Oe().catch(console.error)}else{const J=["video/webm;codecs=vp9","video/webm;codecs=vp8","video/webm"],ie=fe=>{for(const Ye of J)if(MediaRecorder.isTypeSupported(Ye))try{return{recorder:new MediaRecorder(fe,{mimeType:Ye,videoBitsPerSecond:25e5,...mu&&{audioBitsPerSecond:128e3}}),mimeType:Ye}}catch{continue}try{const Ye=new MediaRecorder(fe);return{recorder:Ye,mimeType:Ye.mimeType||"video/webm;codecs=vp9"}}catch{throw new Error("Recording not supported in this browser. Try Chrome or Edge.")}},Be=P.getVideoTracks()[0],Et=new MediaStream([Be,...Bt.stream.getAudioTracks()]),{recorder:Oe,mimeType:Mr}=ie(Et);Z.current=Oe,Ke.current=[],Oe.ondataavailable=fe=>{fe.data&&fe.data.size>0&&Ke.current.push(fe.data)},Oe.onerror=fe=>{const Ye=fe instanceof Error?fe.message:String(fe);O(`Recording failed: ${Ye}. Try again or use Chrome/Edge.`)},Oe.start(1e3),_o(),xe.current=setInterval(()=>{var fe;try{((fe=Z.current)==null?void 0:fe.state)==="recording"&&Z.current.requestData()}catch{}},1500),Oe.onstop=()=>{we.current!=null&&(cancelAnimationFrame(we.current),we.current=null),Y.current&&(clearInterval(Y.current),Y.current=null),xe.current&&(clearInterval(xe.current),xe.current=null),ee.current.forEach(Fr=>Fr.getTracks().forEach(cn=>cn.stop())),ee.current=[],S(null),_(null),z(null),W.current&&(W.current.srcObject=null),ae.current&&(ae.current.srcObject=null);const fe=gu(),Ye=(Fr=!1)=>{const cn=[...Ke.current];try{if(cn.length===0){if(!Fr){setTimeout(()=>Ye(!0),600);return}O("Recording produced no data. Share a normal app window or your entire screen (not a browser tab with protected content), record for at least 5 seconds, then stop."),o("idle");return}const Yi=Oe.mimeType.startsWith("video/webm")?Oe.mimeType:Mr,No=new Blob(cn,{type:Yi});if(No.size<100){O(`Recording produced almost no data (${No.size} bytes). Try Chrome or Edge.`),o("idle");return}Hh(No,fe)}catch(Yi){O(Yi instanceof Error?Yi.message:"Recording failed to finalize."),o("idle")}};setTimeout(()=>Ye(!1),1e3)}}}catch(R){console.error("Failed to start recording:",R);const U=R instanceof Error?R.message:"Failed to start recording";let $="";(U.toLowerCase().includes("video source")||U.toLowerCase().includes("videosource")||U.toLowerCase().includes("failed to allocate"))&&($=' The camera or screen may be in use by another app. Close Zoom, Teams, or other video apps and try again. You can also try unchecking "face camera" to record screen only.'),O(`Could not start recording.${$}`),o("idle"),ln();return}},[c,f,w,T,A,m,p,ln]);g.useEffect(()=>{H===0&&(De.current||(De.current=!0,B(null),un()))},[H,un]),g.useEffect(()=>{s==="idle"&&(De.current=!1)},[s]);const ht=g.useCallback(()=>{var V,C;if(Ot.current){if(((V=de.current)==null?void 0:V.state)!=="started")return;(C=Le.current)==null||C.pause(),Ce.current&&(clearInterval(Ce.current),Ce.current=null),Pe.current=performance.now(),Y.current&&(clearInterval(Y.current),Y.current=null),o("paused");return}const P=Z.current;if((P==null?void 0:P.state)==="recording")try{P.pause(),Pe.current=performance.now(),Y.current&&(clearInterval(Y.current),Y.current=null),xe.current&&(clearInterval(xe.current),xe.current=null),o("paused")}catch(R){console.error("Failed to pause:",R),O(R instanceof Error?R.message:"Pause not supported in this browser")}},[]),Qi=g.useCallback(()=>{var V,C;if(Ot.current){if(((V=de.current)==null?void 0:V.state)!=="started")return;(C=Le.current)==null||C.resume(),kt.current+=performance.now()-Pe.current,Pe.current=0;const R=It.current;if(R){let $=!0;const ke=async()=>{var nt;if(!$||((nt=de.current)==null?void 0:nt.state)!=="started")return;const Te=(performance.now()-Ue.current-kt.current)/1e3,Ct=Math.round(Te*30);if(Ct!==Ir.current){Ir.current=Ct,$=!1;try{await R.add(Ct/30,1/30)}catch{}$=!0}};Ce.current=setInterval(()=>void ke().catch(()=>{}),1e3/30)}o("recording");const U=()=>Math.floor((performance.now()-Ue.current-kt.current)/1e3);Y.current=setInterval(()=>l(U()),200);return}const P=Z.current;if((P==null?void 0:P.state)==="paused")try{P.resume(),kt.current+=performance.now()-Pe.current,Pe.current=0,o("recording");const R=()=>Math.floor((performance.now()-Ue.current-kt.current)/1e3);Y.current=setInterval(()=>l(R()),200),xe.current=setInterval(()=>{var U;try{((U=Z.current)==null?void 0:U.state)==="recording"&&Z.current.requestData()}catch{}},1500)}catch(R){console.error("Failed to resume:",R),O(R instanceof Error?R.message:"Resume not supported in this browser")}},[]),bt=g.useCallback(()=>{if(Ot.current){const V=de.current;if(!V||V.state!=="started")return;(async()=>{var R,U;try{Ce.current&&(clearInterval(Ce.current),Ce.current=null),we.current!=null&&(cancelAnimationFrame(we.current),we.current=null),Y.current&&(clearInterval(Y.current),Y.current=null),(R=It.current)==null||R.close(),(U=Le.current)==null||U.close(),ee.current.forEach(nt=>nt.getTracks().forEach(Ie=>Ie.stop())),ee.current=[],S(null),_(null),z(null),W.current&&(W.current.srcObject=null),ae.current&&(ae.current.srcObject=null),await V.finalize(),de.current=null;const $=V.target.buffer;if(!$||$.byteLength<100){O("Recording produced almost no data. Try a different browser or disable the face camera."),o("idle");return}const ke=Math.floor((performance.now()-Ue.current-kt.current)/1e3),Te=new Blob([$],{type:"video/webm"});j(Te),o("stopped"),n({status:"stopped",duration:ke,blob:Te});const Ct=Dr.current;Ct&&Ct(Te,ke)}catch($){console.error("Mediabunny stop error:",$),O($ instanceof Error?$.message:"Recording failed to finalize."),o("idle")}})();return}const P=Z.current;if(!(!P||P.state==="inactive")){try{P.requestData()}catch{}P.stop()}},[]);g.useEffect(()=>{Qn.current=bt},[bt]),g.useEffect(()=>{n({status:s,duration:a,blob:I,pauseRecording:ht,resumeRecording:Qi,stopRecording:bt})},[s,a,I,ht,Qi,bt,n]),g.useEffect(()=>{i.status==="idle"&&!i.blob&&(s==="stopped"||I)&&(o("idle"),j(null),l(0),O(null))},[i.status,i.blob,s,I]);const Or=P=>{const V=Math.floor(P/60),C=P%60;return`${V.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`},Gi=w||s==="idle",Gn=typeof navigator<"u"&&!!((Xi=navigator.mediaDevices)!=null&&Xi.getDisplayMedia)&&typeof MediaRecorder<"u",So=s==="recording"||s==="paused"||s==="connecting";return u.jsx("div",{className:t?"sr-only min-h-0 overflow-hidden pointer-events-none":"min-h-screen p-6","aria-hidden":t,children:!t&&u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"RECORDING MODE"}),u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back to Analyzer"})]}),u.jsx("p",{className:"text-slate-400 mb-6",children:"Connect your camera, microphone, and screen before recording. You can preview each source and choose which devices to use."}),!Gn&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-amber-900/30 border border-amber-500/50 text-amber-200",children:"Screen recording requires a modern browser with getDisplayMedia and MediaRecorder support (Chrome, Edge, Firefox, or Safari 14.1+). Please use a supported browser."}),M&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-900/30 border border-red-500/50 text-red-300",children:M}),u.jsx("div",{className:So?"mb-6":"hidden",children:u.jsxs("div",{className:"rounded-xl border-2 border-red-500/50 bg-slate-900/80 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-2 flex items-center gap-2",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-500 animate-pulse ring-2 ring-red-400/50"}),"Live preview  You are recording"]}),u.jsx("p",{className:"text-slate-400 text-sm mb-3",children:Ot.current?"Screen, face overlay, and audio are being saved. Use the floating toolbar to pause or end.":"Screen and audio are being saved. Face bubble is preview only. Use the floating toolbar to pause or end."}),u.jsxs("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden border border-slate-600",children:[u.jsx("canvas",{ref:re,className:"w-full h-full",style:{objectFit:"contain"},"aria-hidden":!0}),s==="connecting"&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-900/80",children:u.jsx("p",{className:"text-slate-300 text-lg",children:"Connecting..."})})]}),(s==="recording"||s==="paused")&&u.jsx("p",{className:"text-slate-500 text-sm mt-2 font-mono",children:Or(a)})]})}),s==="idle"&&u.jsxs("div",{className:"space-y-6 mb-6",children:[u.jsxs("div",{className:"rounded-xl border-2 border-slate-600 bg-slate-900/80 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-2 flex items-center gap-2",children:[u.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 ring-2 ring-emerald-400/50"}),"Recording preview"]}),u.jsx("p",{className:"text-slate-400 text-sm mb-3",children:w?"This is exactly what will be recorded. Use it to position windows and check your setup.":"Connect a screen below to see a live preview here."}),u.jsx("div",{className:"w-full rounded-lg overflow-hidden border border-slate-600 bg-black min-h-[280px] flex items-center justify-center",children:w?u.jsx("video",{ref:ae,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full max-h-[70vh] object-contain",style:{aspectRatio:"16/9"}}):u.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 py-12 px-6 text-slate-500",children:[u.jsx("svg",{className:"w-14 h-14 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":!0,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),u.jsx("span",{className:"text-sm text-center max-w-sm",children:"No screen connected. Click Connect screen below and choose a window or your entire screen to see the live preview here."})]})})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Screen"]}),u.jsx("div",{className:"flex flex-wrap gap-4 items-start",children:u.jsx("div",{className:"flex-1 min-w-[200px]",children:w?u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-slate-400 text-sm",children:"Screen is connected. View the live preview above."}),u.jsx("button",{type:"button",onClick:Eo,className:"px-3 py-1.5 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 text-sm",children:"Disconnect screen"})]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:Co,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect screen"}),u.jsx("span",{className:"text-slate-500 text-sm",children:"Share a window or your entire screen"})]})})})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Camera"]}),u.jsxs("div",{className:"flex flex-wrap gap-4 items-start",children:[u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsxs("div",{className:"flex gap-2 mb-2",children:[u.jsxs("select",{value:m,onChange:P=>h(P.target.value),className:"px-3 py-2 rounded-lg bg-slate-700 text-slate-200 border border-slate-600 min-w-[180px]",children:[b.map(P=>u.jsx("option",{value:P.deviceId,children:P.label},P.deviceId)),b.length===0&&u.jsx("option",{value:"",children:"No cameras found"})]}),T?u.jsx("button",{type:"button",onClick:ko,className:"px-3 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500",children:"Disconnect"}):u.jsx("button",{type:"button",onClick:xo,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect camera"})]}),T&&u.jsx("video",{ref:W,autoPlay:!0,muted:!0,playsInline:!0,className:"w-48 aspect-video rounded-lg bg-black object-cover border border-slate-600"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:c,onChange:P=>d(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{className:"text-slate-300",children:"Include in recording (face bubble)"})]}),c&&u.jsxs("label",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[u.jsx("span",{children:"Position:"}),u.jsxs("select",{value:ne,onChange:P=>F(P.target.value),className:"px-2 py-1 rounded bg-slate-700 text-slate-200 border border-slate-600",children:[u.jsx("option",{value:"top-right",children:"Top right"}),u.jsx("option",{value:"top-left",children:"Top left"}),u.jsx("option",{value:"bottom-right",children:"Bottom right"}),u.jsx("option",{value:"bottom-left",children:"Bottom left"})]})]})]})]})]}),u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-800/30 p-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-white mb-3 flex items-center gap-2",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-500"}),"Microphone"]}),u.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[u.jsxs("select",{value:p,onChange:P=>x(P.target.value),className:"px-3 py-2 rounded-lg bg-slate-700 text-slate-200 border border-slate-600 min-w-[180px]",children:[v.map(P=>u.jsx("option",{value:P.deviceId,children:P.label},P.deviceId)),v.length===0&&u.jsx("option",{value:"",children:"No microphones found"})]}),A?u.jsx("button",{type:"button",onClick:Hi,className:"px-3 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500",children:"Disconnect"}):u.jsx("button",{type:"button",onClick:bo,className:"px-4 py-2 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Connect mic"}),A&&u.jsxs("span",{className:"text-green-400 text-sm flex items-center gap-1",children:[u.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"Connected"]}),u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:f,onChange:P=>y(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{className:"text-slate-300",children:"Include in recording"})]})]})]}),u.jsxs("div",{className:"pt-4 border-t border-slate-600/50 space-y-3",children:[u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-slate-300",children:[u.jsx("input",{type:"checkbox",checked:Q,onChange:P=>X(P.target.checked),className:"rounded accent-ring"}),u.jsx("span",{children:"3-second countdown before recording"})]}),u.jsx("button",{type:"button",onClick:()=>Q?B(3):un(),disabled:!Gi||!Gn||H!==null,className:"px-6 py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Recording"}),u.jsx("p",{className:"text-slate-500 text-sm",children:w?"Screen is connected. Click to start recording.":"Connect your screen first, or click Start Recording to choose what to share."})]})]}),H!==null&&H>0&&u.jsx("div",{className:"fixed inset-0 z-[9998] flex items-center justify-center bg-slate-950/90 backdrop-blur-sm",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-slate-400 text-lg mb-2",children:"Recording in"}),u.jsx("p",{className:"text-6xl font-bold text-white tabular-nums",children:H})]})})]})})}function hy(){const{recording:e}=vo(),{status:t,duration:r,pauseRecording:n,resumeRecording:i,stopRecording:s}=e,o=g.useRef(null);return g.useEffect(()=>{if(t!=="recording"&&t!=="paused")return;const a=l=>{l.key==="Escape"&&(l.preventDefault(),s())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,s]),t!=="recording"&&t!=="paused"?null:u.jsx("div",{ref:o,className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-[9999]",role:"toolbar","aria-label":"Recording controls",children:u.jsxs("div",{className:"rounded-xl border border-slate-600/50 bg-slate-900/95 backdrop-blur-sm shadow-xl px-5 py-3 flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`w-3 h-3 rounded-full ${t==="paused"?"bg-amber-500":"bg-red-500 animate-pulse"}`}),u.jsx("span",{className:"text-white font-medium",children:t==="paused"?"Paused":"Recording"})]}),u.jsx("span",{className:"text-slate-400 font-mono tabular-nums text-lg",children:qr(r)}),u.jsx("div",{className:"h-4 w-px bg-slate-600"}),t==="recording"&&u.jsxs("button",{type:"button",onClick:n,className:"px-4 py-2 rounded-lg bg-amber-600 text-white font-medium hover:bg-amber-500 transition-colors flex items-center gap-2",children:[u.jsx("span",{children:""})," Pause"]}),t==="paused"&&u.jsxs("button",{type:"button",onClick:i,className:"px-4 py-2 rounded-lg bg-green-600 text-white font-medium hover:bg-green-500 transition-colors flex items-center gap-2",children:[u.jsx("span",{children:""})," Resume"]}),u.jsxs("button",{type:"button",onClick:s,className:"px-4 py-2 rounded-lg bg-red-900/80 text-white font-medium hover:bg-red-800 border border-red-500/50 transition-colors flex items-center gap-2",title:"End recording (Escape)",children:[u.jsx("span",{children:""})," End"]}),u.jsx("span",{className:"text-slate-500 text-xs ml-1",children:"Esc to end"})]})})}var se;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.FFPROBE="FFPROBE",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(se||(se={}));const my=(()=>{let e=0;return()=>e++})(),py=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),gy=new Error("called FFmpeg.terminate()");var st,ur,Ht,Qr,Gr,Js,$e;class yy{constructor(){tr(this,st,null);tr(this,ur,{});tr(this,Ht,{});tr(this,Qr,[]);tr(this,Gr,[]);We(this,"loaded",!1);tr(this,Js,()=>{K(this,st)&&(K(this,st).onmessage=({data:{id:t,type:r,data:n}})=>{switch(r){case se.LOAD:this.loaded=!0,K(this,ur)[t](n);break;case se.MOUNT:case se.UNMOUNT:case se.EXEC:case se.FFPROBE:case se.WRITE_FILE:case se.READ_FILE:case se.DELETE_FILE:case se.RENAME:case se.CREATE_DIR:case se.LIST_DIR:case se.DELETE_DIR:K(this,ur)[t](n);break;case se.LOG:K(this,Qr).forEach(i=>i(n));break;case se.PROGRESS:K(this,Gr).forEach(i=>i(n));break;case se.ERROR:K(this,Ht)[t](n);break}delete K(this,ur)[t],delete K(this,Ht)[t]})});tr(this,$e,({type:t,data:r},n=[],i)=>K(this,st)?new Promise((s,o)=>{const a=my();K(this,st)&&K(this,st).postMessage({id:a,type:t,data:r},n),K(this,ur)[a]=s,K(this,Ht)[a]=o,i==null||i.addEventListener("abort",()=>{o(new DOMException(`Message # ${a} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(py));We(this,"load",({classWorkerURL:t,...r}={},{signal:n}={})=>(K(this,st)||(Kn(this,st,t?new Worker(new URL(t,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),K(this,Js).call(this)),K(this,$e).call(this,{type:se.LOAD,data:r},void 0,n)));We(this,"exec",(t,r=-1,{signal:n}={})=>K(this,$e).call(this,{type:se.EXEC,data:{args:t,timeout:r}},void 0,n));We(this,"ffprobe",(t,r=-1,{signal:n}={})=>K(this,$e).call(this,{type:se.FFPROBE,data:{args:t,timeout:r}},void 0,n));We(this,"terminate",()=>{const t=Object.keys(K(this,Ht));for(const r of t)K(this,Ht)[r](gy),delete K(this,Ht)[r],delete K(this,ur)[r];K(this,st)&&(K(this,st).terminate(),Kn(this,st,null),this.loaded=!1)});We(this,"writeFile",(t,r,{signal:n}={})=>{const i=[];return r instanceof Uint8Array&&i.push(r.buffer),K(this,$e).call(this,{type:se.WRITE_FILE,data:{path:t,data:r}},i,n)});We(this,"mount",(t,r,n)=>{const i=[];return K(this,$e).call(this,{type:se.MOUNT,data:{fsType:t,options:r,mountPoint:n}},i)});We(this,"unmount",t=>{const r=[];return K(this,$e).call(this,{type:se.UNMOUNT,data:{mountPoint:t}},r)});We(this,"readFile",(t,r="binary",{signal:n}={})=>K(this,$e).call(this,{type:se.READ_FILE,data:{path:t,encoding:r}},void 0,n));We(this,"deleteFile",(t,{signal:r}={})=>K(this,$e).call(this,{type:se.DELETE_FILE,data:{path:t}},void 0,r));We(this,"rename",(t,r,{signal:n}={})=>K(this,$e).call(this,{type:se.RENAME,data:{oldPath:t,newPath:r}},void 0,n));We(this,"createDir",(t,{signal:r}={})=>K(this,$e).call(this,{type:se.CREATE_DIR,data:{path:t}},void 0,r));We(this,"listDir",(t,{signal:r}={})=>K(this,$e).call(this,{type:se.LIST_DIR,data:{path:t}},void 0,r));We(this,"deleteDir",(t,{signal:r}={})=>K(this,$e).call(this,{type:se.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?K(this,Qr).push(r):t==="progress"&&K(this,Gr).push(r)}off(t,r){t==="log"?Kn(this,Qr,K(this,Qr).filter(n=>n!==r)):t==="progress"&&Kn(this,Gr,K(this,Gr).filter(n=>n!==r))}}st=new WeakMap,ur=new WeakMap,Ht=new WeakMap,Qr=new WeakMap,Gr=new WeakMap,Js=new WeakMap,$e=new WeakMap;var qc;(function(e){e.MEMFS="MEMFS",e.NODEFS="NODEFS",e.NODERAWFS="NODERAWFS",e.IDBFS="IDBFS",e.WORKERFS="WORKERFS",e.PROXYFS="PROXYFS"})(qc||(qc={}));const wy=new Error("failed to get response body reader"),vy=new Error("failed to complete download"),xy="Content-Length",ky=async(e,t)=>{var i;const r=await fetch(e);let n;try{const s=parseInt(r.headers.get(xy)||"-1"),o=(i=r.body)==null?void 0:i.getReader();if(!o)throw wy;const a=[];let l=0;for(;;){const{done:f,value:y}=await o.read(),b=y?y.length:0;if(f){if(s!=-1&&s!==l)throw vy;t&&t({url:e,total:s,received:l,delta:b,done:f});break}a.push(y),l+=b,t&&t({url:e,total:s,received:l,delta:b,done:f})}const c=new Uint8Array(l);let d=0;for(const f of a)c.set(f,d),d+=f.length;n=c.buffer}catch(s){console.log("failed to send download progress event: ",s),n=await r.arrayBuffer()}return n},Zc=async(e,t,r=!1,n)=>{const i=r?await ky(e,n):await(await fetch(e)).arrayBuffer(),s=new Blob([i],{type:t});return URL.createObjectURL(s)};let da=null;async function gl(){await hu()}async function hu(){if(da)return da;const e="https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.10/dist/esm",t=new yy;return await t.load({coreURL:await Zc(`${e}/ffmpeg-core.js`,"text/javascript"),wasmURL:await Zc(`${e}/ffmpeg-core.wasm`,"application/wasm")}),da=t,t}const fn=["-avoid_negative_ts","make_zero","-fflags","+genpts"];async function fa(e){try{await e.deleteFile("input.webm")}catch{}try{await e.deleteFile("output.mp4")}catch{}}async function by(e){const t=await hu();await fa(t);const r=new Uint8Array(await e.arrayBuffer());if(r.length===0)throw new Error("Recording is empty");await t.writeFile("input.webm",r);const n=[[...fn,"-i","input.webm","-c:v","libx264","-preset","ultrafast","-crf","28","-c:a","aac","-movflags","+faststart","output.mp4"],[...fn,"-i","input.webm","-c:v","libx264","-preset","ultrafast","-crf","28","-an","-movflags","+faststart","output.mp4"],[...fn,"-i","input.webm","-c:v","libx264","-preset","fast","-crf","23","-c:a","aac","-movflags","+faststart","output.mp4"],[...fn,"-i","input.webm","-c:v","libx264","-preset","fast","-crf","23","-an","-movflags","+faststart","output.mp4"],[...fn,"-i","input.webm","-c:v","mpeg4","-q:v","5","-c:a","aac","-movflags","+faststart","output.mp4"],[...fn,"-i","input.webm","-c:v","mpeg4","-q:v","5","-an","-movflags","+faststart","output.mp4"],["-i","input.webm","-c:v","mpeg4","-q:v","8","-an","-movflags","+faststart","output.mp4"]];let i;for(const s of n)try{await t.exec(s),i=null;break}catch(o){i=o,await fa(t),await t.writeFile("input.webm",r)}try{if(i)throw i;const s=await t.readFile("output.mp4");if(!s||s.length===0)throw new Error("Conversion produced empty output");return new Blob([s],{type:"video/mp4"})}finally{await fa(t)}}function Cy({blob:e,duration:t,onClose:r,onOpenInAnalyzer:n,onOpenInEditor:i}){const{dismissRecording:s}=vo(),o=g.useRef(null),[a,l]=g.useState(!1),[c,d]=g.useState(null),[f,y]=g.useState(null),[b,k]=g.useState(!0),[v,E]=g.useState(null),[m,h]=g.useState(null),[p,x]=g.useState(0),w=g.useRef(null),S=g.useRef(null),T=()=>{s(),r()},_=()=>{s(),r()},A=()=>{e&&(n==null||n(e))},z=()=>{i==null||i()},I=async(j=!1)=>{if(e){d(null);try{let M=e,O=e.type.includes("mp4")?"mp4":"webm";if(e.type.includes("webm")&&!j){l(!0);try{await gl(),M=await by(e),O="mp4"}catch(ne){d(ne instanceof Error?ne.message:'Conversion failed. Try "Download as WebM".');return}finally{l(!1)}}else e.type.includes("mp4")&&(O="mp4");const H=URL.createObjectURL(M),B=document.createElement("a");B.href=H,B.download=`boxing-recording-${Date.now()}.${O}`,B.click(),URL.revokeObjectURL(H)}catch(M){d(M instanceof Error?M.message:"Download failed")}}};return g.useEffect(()=>{var j;e&&e.size>0&&((j=e.type)!=null&&j.includes("webm"))&&gl().catch(()=>{})},[e]),g.useEffect(()=>{if(!e||e.size===0){k(!1),y(null),E("Recording produced no data.");return}S.current=e,E(null),h(null),w.current&&(URL.revokeObjectURL(w.current),w.current=null);let j=!1;const M=e,O=(B,ne)=>{j||S.current===M&&(y(B),h(ne),k(!1))};if(!e.type||e.type.includes("webm")||e.type.includes("matroska")){const B=URL.createObjectURL(e);w.current=B,O(B,"webm")}else O(URL.createObjectURL(e),"mp4");return()=>{j=!0,y(B=>(B&&URL.revokeObjectURL(B),null)),w.current&&(URL.revokeObjectURL(w.current),w.current=null)}},[e,p]),e?u.jsx("div",{className:"fixed inset-0 z-[10000] bg-slate-950/98 flex flex-col overflow-auto",children:u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-8 min-h-0",children:[u.jsx("h2",{className:"text-2xl font-display tracking-wider text-white mb-2",children:"Recording Complete"}),u.jsxs("p",{className:"text-slate-400 mb-6",children:["Duration: ",qr(t)]}),u.jsx("div",{className:"w-full max-w-4xl min-h-[300px] aspect-video bg-black rounded-xl overflow-hidden border border-slate-600 mb-6 flex-shrink-0",children:b?u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400",children:"Preparing preview..."}):f?u.jsx("video",{ref:o,src:f,controls:!0,autoPlay:!0,playsInline:!0,muted:!0,preload:"auto",onError:j=>{var M;m==="webm"?(y(null),h(null),E("Preview not available for this recording. You can still download it below.")):E(((M=j.currentTarget.error)==null?void 0:M.message)||"Video failed to load")},onLoadedData:j=>{j.currentTarget.play().catch(()=>{})},className:"w-full h-full object-contain",style:{minWidth:320,minHeight:180}}):u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-4 text-slate-400 p-4 text-center",children:[u.jsx("span",{children:"No preview available"}),u.jsx("span",{className:"text-sm text-slate-500",children:"You can still download the recording below."}),u.jsx("button",{type:"button",onClick:()=>x(j=>j+1),className:"px-4 py-2 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 text-sm",children:"Retry preview"})]})}),(c||v)&&u.jsx("p",{className:"text-red-400 text-sm mb-2",children:c||v}),u.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[u.jsx("button",{type:"button",onClick:z,className:"px-6 py-3 rounded-lg bg-emerald-600 text-white font-medium hover:bg-emerald-500 transition-colors",children:"Open in Video Editor"}),u.jsx("button",{type:"button",onClick:()=>I(!1),disabled:a,className:"px-6 py-3 rounded-lg bg-accent text-slate-900 font-medium hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Preparing download...":"Download as MP4"}),(!(e!=null&&e.type)||(e==null?void 0:e.type.includes("webm"))||(e==null?void 0:e.type.includes("matroska")))&&u.jsx("button",{type:"button",onClick:()=>I(!0),disabled:a,className:"px-6 py-3 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Download as WebM"}),n&&u.jsx("button",{type:"button",onClick:A,className:"px-6 py-3 rounded-lg bg-ring text-white font-medium hover:bg-red-600 transition-colors",children:"Open in Video Analyzer"}),u.jsx("button",{type:"button",onClick:_,className:"px-6 py-3 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 transition-colors",children:"Record again"}),u.jsx("button",{type:"button",onClick:T,className:"px-6 py-3 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 transition-colors",children:"Done"})]})]})}):null}const nr=.5;function it(e,t,r){return Math.max(t,Math.min(r,e))}function Ey({duration:e,startSeconds:t,endSeconds:r,currentTime:n,onStartChange:i,onEndChange:s,onSeek:o,disabled:a=!1}){const l=g.useRef(null),[c,d]=g.useState(null),f=g.useCallback(_=>e>0?it(_/e*100,0,100):0,[e]),y=g.useCallback(_=>it(_/100*e,0,e),[e]),b=_=>{if(a||!l.current)return;const A=l.current.getBoundingClientRect(),I=(_.clientX-A.left)/A.width*100,j=y(I);o(j)},k=_=>A=>{A.preventDefault(),!a&&d(_)},v=g.useCallback(_=>{if(!c||!l.current)return;const A=l.current.getBoundingClientRect(),I=it(_.clientX-A.left,0,A.width)/A.width*100,j=y(I);if(c==="start"){const M=it(j,0,r-nr);i(M)}else{const M=it(j,t+nr,e);s(M)}},[c,e,t,r,y,i,s]),E=g.useCallback(()=>{d(null)},[]),m=g.useCallback(_=>{if(a)return;const A=_.shiftKey?1:.1;if(!(_.target instanceof HTMLInputElement)){if(_.key==="ArrowLeft"){_.preventDefault();const z=it(t-A,0,r-nr);i(z)}else if(_.key==="ArrowRight"){_.preventDefault();const z=it(r+A,t+nr,e);s(z)}}},[a,t,r,e,i,s]);g.useEffect(()=>{if(c)return window.addEventListener("mousemove",v),window.addEventListener("mouseup",E),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",E)}},[c,v,E]);const h=f(t),p=f(r),x=f(n),w=r-t,S=_=>{const A=Math.floor(_/60),z=_%60,I=Math.floor(z),j=Math.round((z-I)*10);return`${A}:${I.toString().padStart(2,"0")}.${j}`},T=_=>{const A=_.trim().split(":");if(A.length===1){const z=parseFloat(A[0]);return isNaN(z)?null:it(z,0,e)}if(A.length===2){const z=parseInt(A[0],10),I=parseFloat(A[1]);return isNaN(z)||isNaN(I)?null:it(z*60+I,0,e)}return null};return u.jsxs("div",{className:"space-y-2",onKeyDown:m,children:[u.jsxs("div",{ref:l,role:"slider","aria-label":"Trim timeline","aria-valuemin":0,"aria-valuemax":e,"aria-valuenow":n,tabIndex:0,onClick:b,className:`relative h-10 rounded-lg bg-slate-800 cursor-pointer select-none overflow-hidden ${a?"opacity-60 cursor-not-allowed":""}`,children:[u.jsx("div",{className:"absolute inset-y-0 left-0 bg-slate-700/70",style:{width:`${h}%`}}),u.jsx("div",{className:"absolute inset-y-0 right-0 bg-slate-700/70",style:{width:`${100-p}%`}}),u.jsx("div",{className:"absolute inset-y-0 bg-emerald-600/30",style:{left:`${h}%`,width:`${p-h}%`}}),u.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white shadow-lg z-10",style:{left:`${x}%`}}),u.jsx("div",{role:"button","aria-label":"Trim start",onMouseDown:k("start"),className:"absolute top-0 bottom-0 w-3 cursor-ew-resize flex items-center justify-center z-20 bg-emerald-600 hover:bg-emerald-500 border border-emerald-400",style:{left:`${h}%`,transform:"translateX(-50%)"},children:u.jsx("div",{className:"w-1 h-4 bg-white/90 rounded"})}),u.jsx("div",{role:"button","aria-label":"Trim end",onMouseDown:k("end"),className:"absolute top-0 bottom-0 w-3 cursor-ew-resize flex items-center justify-center z-20 bg-emerald-600 hover:bg-emerald-500 border border-emerald-400",style:{left:`${p}%`,transform:"translateX(-50%)"},children:u.jsx("div",{className:"w-1 h-4 bg-white/90 rounded"})})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[u.jsxs("span",{className:"text-slate-400",children:["Trim: ",u.jsx("span",{className:"text-emerald-400 font-medium",children:qr(Math.floor(w))})]}),u.jsxs("label",{className:"flex items-center gap-2 text-slate-400",children:["Start",u.jsx("input",{type:"text",value:S(t),onChange:_=>{const A=T(_.target.value);A!=null&&i(it(A,0,r-nr))},onBlur:_=>{const A=T(_.target.value);A!=null&&i(it(A,0,r-nr))},disabled:a,className:"w-16 px-2 py-1 rounded bg-slate-800 border border-slate-600 text-white font-mono text-sm"})]}),u.jsxs("label",{className:"flex items-center gap-2 text-slate-400",children:["End",u.jsx("input",{type:"text",value:S(r),onChange:_=>{const A=T(_.target.value);A!=null&&s(it(A,t+nr,e))},onBlur:_=>{const A=T(_.target.value);A!=null&&s(it(A,t+nr,e))},disabled:a,className:"w-16 px-2 py-1 rounded bg-slate-800 border border-slate-600 text-white font-mono text-sm"})]}),u.jsxs("span",{className:"text-slate-500 text-xs",children:["Full: ",qr(Math.floor(e))]})]})]})}const Sy="trim_input",ci="trim_output.mp4";function Ty(e){var r;const t=((r=e.type)==null?void 0:r.toLowerCase())??"";return t.includes("webm")||t.includes("matroska")?"trim_input.webm":t.includes("mp4")||t.includes("quicktime")||t.includes("x-m4v")?"trim_input.mp4":"trim_input.webm"}async function ha(e){for(const t of[Sy,"trim_input.webm","trim_input.mp4",ci])try{await e.deleteFile(t)}catch{}}async function _y(e,t,r,n){if(e.size===0)throw new Error("Video is empty");if(t>=r)throw new Error("Start must be before end");if(t<0)throw new Error("Start time cannot be negative");const i=await hu();await ha(i);const s=Ty(e),o=new Uint8Array(await e.arrayBuffer());await i.writeFile(s,o);const a=r-t,l=["-avoid_negative_ts","make_zero","-fflags","+genpts"],c=s.endsWith(".webm"),d=[[...l,"-ss",String(t),"-i",s,"-to",String(a),"-c:v","libx264","-preset","ultrafast","-crf","28","-c:a","aac","-movflags","+faststart",ci],[...l,"-ss",String(t),"-i",s,"-to",String(a),"-c:v","libx264","-preset","ultrafast","-crf","28","-an","-movflags","+faststart",ci]],f=[...l,"-ss",String(t),"-i",s,"-to",String(a),"-c","copy",ci],y=({progress:b,time:k})=>{n==null||n({progress:b??0,time:k})};i.on("progress",y);try{if(c){let k;for(const v of d)try{await i.exec(v),k=null;break}catch(E){k=E,await ha(i),await i.writeFile(s,o)}if(k)throw k}else await i.exec(f);const b=await i.readFile(ci);if(!b||b.length===0)throw new Error("Trim produced empty output");return new Blob([b],{type:"video/mp4"})}finally{i.off("progress",y),await ha(i)}}function Ny({blob:e,duration:t,onBack:r}){const n=g.useRef(null),i=g.useRef(null),[s,o]=g.useState(null),[a,l]=g.useState(!1),[c,d]=g.useState(null),[f,y]=g.useState(null),[b,k]=g.useState(!1),[v,E]=g.useState(0),[m,h]=g.useState(0),[p,x]=g.useState(0),[w,S]=g.useState(0),[T,_]=g.useState(!1),[A,z]=g.useState(0),[I,j]=g.useState(null),M=a?s:e,O=m>0?m:t;g.useEffect(()=>{gl().catch(()=>{})},[]),g.useEffect(()=>{if(!M||M.size===0){d(null),y(a&&!s?null:"No recording to play.");return}y(null);const W=URL.createObjectURL(M);return d(W),()=>{URL.revokeObjectURL(W),d(null)}},[M,a,s]),g.useEffect(()=>{O>0&&(x(0),S(O))},[O]),g.useEffect(()=>{const W=n.current;if(!W)return;const ae=()=>E(W.currentTime),ee=()=>{const Ue=W.duration;isFinite(Ue)&&Ue>0&&h(Ue)},Y=()=>k(!0),xe=()=>k(!1),we=()=>{k(!1),W.currentTime=p,p<w-.1&&W.play().catch(()=>{})};return W.addEventListener("timeupdate",ae),W.addEventListener("durationchange",ee),W.addEventListener("play",Y),W.addEventListener("pause",xe),W.addEventListener("ended",we),()=>{W.removeEventListener("timeupdate",ae),W.removeEventListener("durationchange",ee),W.removeEventListener("play",Y),W.removeEventListener("pause",xe),W.removeEventListener("ended",we)}},[c,p,w]);const H=g.useCallback(()=>{const W=n.current;W&&(W.paused?((v<p||v>=w-.1)&&(W.currentTime=p),W.play().catch(()=>y("Playback failed"))):W.pause())},[v,p,w]),B=g.useCallback(W=>{const ae=n.current;if(!ae)return;const ee=Math.max(0,Math.min(O,W));ae.currentTime=ee,E(ee)},[O]),ne=g.useCallback(W=>{var ee;const ae=(ee=W.target.files)==null?void 0:ee[0];if(ae){if(!ae.type.startsWith("video/")){y("Please select a video file (MP4, WebM, MOV, etc.)");return}y(null),o(ae),l(!0),W.target.value=""}},[]),F=g.useCallback(()=>{var W;(W=i.current)==null||W.click()},[]),Q=g.useCallback(async()=>{if(!M||M.size===0)return;const W=Math.max(0,Math.min(p,O-.5)),ae=Math.min(O,Math.max(w,W+.5));if(W>=ae){j("Invalid trim range. Start must be before end.");return}_(!0),j(null),z(0);try{const ee=await _y(M,W,ae,we=>{z(Math.round((we.progress??0)*100))}),Y=URL.createObjectURL(ee),xe=document.createElement("a");xe.href=Y,xe.download=`boxing-trimmed-${Date.now()}.mp4`,xe.click(),URL.revokeObjectURL(Y)}catch(ee){j(ee instanceof Error?ee.message:"Export failed")}finally{_(!1),z(0)}},[M,p,w,O]),X=O,re=c?v:0,Z=Math.max(0,w-p),Ke=p>.1||w<O-.1;return M?u.jsxs("div",{className:"min-h-screen flex flex-col p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"VIDEO EDITOR"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{ref:i,type:"file",accept:"video/*",onChange:ne,className:"hidden"}),u.jsx("button",{type:"button",onClick:F,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 text-sm",children:"Upload different"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back"})]})]}),u.jsx("div",{className:"flex-1 min-h-0 flex flex-col max-w-5xl mx-auto w-full",children:u.jsxs("div",{className:"rounded-xl border-2 border-slate-600 bg-black overflow-hidden flex-1 min-h-0 flex flex-col",children:[u.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center p-4",children:c?u.jsx("video",{ref:n,src:c,playsInline:!0,preload:"auto",onError:()=>y("Video failed to load"),className:"w-full h-full max-h-[60vh] object-contain"}):u.jsx("div",{className:"text-slate-500",children:"Loading preview..."})}),f&&u.jsx("p",{className:"text-red-400 text-sm px-4 py-2 bg-red-900/20",children:f}),c&&u.jsxs("div",{className:"shrink-0 p-4 bg-slate-900/80 border-t border-slate-600 space-y-4",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsx("button",{type:"button",onClick:H,className:"px-4 py-2 rounded-lg bg-slate-700 text-white hover:bg-slate-600 font-medium flex items-center gap-2","aria-label":b?"Pause":"Play",children:b?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""})," Pause"]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""})," Play"]})}),u.jsxs("span",{className:"text-slate-400 font-mono tabular-nums text-sm",children:[qr(Math.floor(re))," / ",qr(Math.floor(X)),Ke&&u.jsxs("span",{className:"ml-2 text-emerald-400",children:["(trim: ",qr(Math.floor(Z)),")"]})]}),u.jsx("input",{type:"range",min:0,max:X||1,step:.1,value:re,onChange:W=>B(Number(W.target.value)),className:"flex-1 min-w-[120px] h-2 rounded-lg appearance-none bg-slate-600 accent-ring"})]}),u.jsx(Ey,{duration:X,startSeconds:p,endSeconds:w,currentTime:re,onStartChange:x,onEndChange:S,onSeek:B,disabled:T}),u.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[u.jsx("button",{type:"button",onClick:Q,disabled:T,className:"px-6 py-3 rounded-lg bg-emerald-600 text-white font-medium hover:bg-emerald-500 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",children:T?u.jsxs(u.Fragment,{children:["Exporting... ",A,"%"]}):Ke?"Export Trimmed Video":"Export Video (MP4)"}),I&&u.jsx("p",{className:"text-red-400 text-sm",children:I})]})]})]})})]}):u.jsxs("div",{className:"min-h-screen flex flex-col p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"font-display text-3xl tracking-wider text-white",children:"VIDEO EDITOR"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600",children:" Back"})]}),u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center max-w-md mx-auto text-center",children:[u.jsx("input",{ref:i,type:"file",accept:"video/*",onChange:ne,className:"hidden"}),u.jsxs("div",{onClick:()=>{var W;return(W=i.current)==null?void 0:W.click()},className:"w-full max-w-md border-2 border-dashed border-slate-500 rounded-xl p-12 text-center cursor-pointer hover:border-accent hover:bg-slate-800/30 transition-all mb-6",children:[u.jsx("div",{className:"text-5xl mb-4",children:""}),u.jsx("p",{className:"text-slate-300 mb-1",children:"Click to upload a video"}),u.jsx("p",{className:"text-slate-500 text-sm",children:"MP4, WebM, MOV supported"})]}),u.jsx("h2",{className:"text-xl font-medium text-white mb-2",children:"Or record first"}),u.jsx("p",{className:"text-slate-400 text-sm mb-6",children:'Record in Recording Mode, then choose "Open in Video Editor" when done.'}),u.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 rounded-lg bg-slate-600 text-slate-200 hover:bg-slate-500 transition-colors",children:"Go to Recording Mode"}),f&&u.jsx("p",{className:"mt-4 text-red-400 text-sm",children:f})]})]})}function Py(){const[e,t]=g.useState("analyzer"),[r,n]=g.useState(null),i=g.useRef(null),{recording:s,openInAnalyzerBlob:o,openRecordingInAnalyzer:a,clearOpenInAnalyzer:l,dismissRecording:c}=vo(),d=s.status==="recording"||s.status==="paused",f=r!==null,y=g.useCallback((x,w)=>{n({blob:x,duration:w})},[]);g.useEffect(()=>{s.status==="stopped"&&s.blob&&s.blob.size>0&&r===null&&n({blob:s.blob,duration:s.duration})},[s.status,s.blob,s.duration,r]);const b=async()=>{var w;if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}(await((w=i.current)==null?void 0:w.confirmLeave())??!0)&&t("recording")},k=async()=>{var w;if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}(await((w=i.current)==null?void 0:w.confirmLeave())??!0)&&t("analyzer")},v=()=>{if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}t("editor")},E=()=>{if(d){if(!window.confirm("This will stop your current recording. Continue?"))return;s.stopRecording()}t("analyzer")},m=x=>{a(x),c(),n(null),t("analyzer")},h=()=>{n(null),t("recording")},p=()=>{t("editor")};return u.jsxs("div",{className:"min-h-screen flex flex-col",children:[u.jsx("header",{className:"shrink-0 px-6 py-4 border-b border-slate-700/50 bg-slate-900/50",children:u.jsxs("div",{className:"max-w-7xl mx-auto flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:k,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="analyzer"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Video Analyzer"}),u.jsx("button",{type:"button",onClick:b,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="recording"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Recording Mode"}),u.jsx("button",{type:"button",onClick:v,className:`px-4 py-2 rounded-lg font-medium transition-all ${e==="editor"?"bg-ring text-white":"bg-slate-700/80 text-slate-400 hover:bg-slate-600"}`,children:"Video Editor"})]})}),u.jsxs("main",{className:"flex-1 min-h-0 relative",children:[(e==="recording"||d)&&u.jsx("div",{className:"min-h-full",children:u.jsx(fy,{onBack:E,onRecordingComplete:y},"recording-mode")},"recording-container"),e==="analyzer"&&!d&&u.jsx(H0,{ref:i,initialRecordingBlob:o,onRecordingConsumed:l}),e==="editor"&&u.jsx(Ny,{blob:(r==null?void 0:r.blob)??s.blob,duration:(r==null?void 0:r.duration)??s.duration,onBack:()=>t("recording")})]}),u.jsx(hy,{}),f&&u.jsx(Cy,{blob:r.blob,duration:r.duration,onClose:h,onOpenInAnalyzer:m,onOpenInEditor:p})]})}function Ry(){return u.jsx(dy,{children:u.jsx(Py,{})})}fh(document.getElementById("root")).render(u.jsx(g.StrictMode,{children:u.jsx(Ry,{})}));
